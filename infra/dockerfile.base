#syntax=docker/dockerfile:experimental
FROM python:3.7.3-slim

# Setup dependencies in a cachable step
COPY requirements.txt /requirements.txt
RUN apt-get update && \
		apt-get install -y gcc g++ libgomp1 && \
		pip install --disable-pip-version-check -r /requirements.txt && \
		apt-get remove -y gcc g++ && \
		apt-get autoremove -y

# Setup bugbug with a bind RO mount
RUN --mount=type=bind,target=/tmp/bugbug \
	pip install /tmp/bugbug
