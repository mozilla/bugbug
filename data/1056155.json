{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "attachments": [{"creator": "bugmail@mozilla.staktrace.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2014-08-21T03:44:28Z", "type_id": 4, "creation_date": "2014-08-20T15:38:15Z", "id": 956102, "setter": "matt.woodrow@gmail.com"}], "content_type": "text/plain", "id": 8475964}, {"creator": "bugmail@mozilla.staktrace.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2014-08-21T12:40:21Z", "type_id": 4, "creation_date": "2014-08-21T12:40:21Z", "id": 957186, "setter": "bugmail@mozilla.staktrace.com"}], "content_type": "text/plain", "id": 8476626}], "classification": "Components", "creator": "bugmail@mozilla.staktrace.com", "cc": ["asmodeusme@yahoo.com", "botond@mozilla.com", "jmathies@mozilla.com", "matt.woodrow@gmail.com", "tnikkel@gmail.com"], "depends_on": [1056427], "creation_time": "2014-08-20T15:32:43Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "x86", "cf_status_firefox58": "---", "cf_status_firefox59": "---", "keywords": [], "summary": "Don't assume FrameMetrics and APZC objects are only on ContainerLayers", "id": 1056155, "assigned_to_detail": {"email": "bugmail@mozilla.staktrace.com", "id": 426788, "name": "bugmail@mozilla.staktrace.com", "real_name": "Kartikaya Gupta (email:kats@mozilla.com)"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "assigned_to": "bugmail@mozilla.staktrace.com", "comment_count": 19, "comments": [{"text": "I missed a few spots in bug 1051985 when I moved the scrolling-related properties from ContainerLayer to Layer", "author": "bugmail@mozilla.staktrace.com", "id": 9206870, "time": "2014-08-20T15:32:43Z"}, {"text": "Created attachment 8475964\nPatch", "author": "bugmail@mozilla.staktrace.com", "id": 9206873, "time": "2014-08-20T15:33:40Z"}, {"text": "Comment on attachment 8475964\nPatch\n\nReview of attachment 8475964:\n-----------------------------------------------------------------\n\nAlso, do you understand the code in RenderFrameParent? Specifically the code at [1] - it looks like it's doing something very similar to AsyncCompositionManager and I'm wondering if the order of transforms there needs to be flipped to go with bug 1052063 (cset 7dc893ff9125).\n\n[1] http://mxr.mozilla.org/mozilla-central/source/layout/ipc/RenderFrameParent.cpp?rev=1ca58eced657#227", "author": "bugmail@mozilla.staktrace.com", "id": 9206897, "time": "2014-08-20T15:38:15Z"}, {"text": "Try push including this patch: https://tbpl.mozilla.org/?tree=Try&rev=ca10ab9d4739", "author": "bugmail@mozilla.staktrace.com", "id": 9206975, "time": "2014-08-20T15:50:08Z"}, {"text": "Bug 1056427 obsoletes the RenderFrameParent changes here but the rest is still valid I think.", "author": "bugmail@mozilla.staktrace.com", "id": 9209880, "time": "2014-08-21T00:55:19Z"}, {"text": "Comment on attachment 8475964\nPatch\n\nReview of attachment 8475964:\n-----------------------------------------------------------------\n\nFeel free to leave out the RenderFrameParent bits as I'll be removing them.", "author": "matt.woodrow@gmail.com", "id": 9210388, "time": "2014-08-21T03:44:28Z"}, {"text": "Created attachment 8476626\nPatch\n\nUpdated to remove the RFP bits; carrying r+", "author": "bugmail@mozilla.staktrace.com", "id": 9212175, "time": "2014-08-21T12:40:21Z"}, {"text": "checkin-needed because it's a simple patch and can be squashed with other things to save resources. Try push in comment 3 is green (except for the intermittents and the stuff I aborted).", "author": "bugmail@mozilla.staktrace.com", "id": 9212184, "time": "2014-08-21T12:41:41Z"}, {"text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/734451332c5b", "author": "ryanvm@gmail.com", "id": 9212423, "time": "2014-08-21T13:40:32Z"}, {"text": "Hm.. it looks like the latest version of your patch on bug 1056427 still keeps the bit in the RenderFrameParent constructor that gets the frame metrics from lm->GetRoot()->AsContainerLayer(). Will that also get axed at some point, or is that going to stick around?", "author": "bugmail@mozilla.staktrace.com", "id": 9212573, "time": "2014-08-21T14:06:45Z"}, {"text": "Metro and test-ipcbrowser both still use the nsIContentViewManager. I'm sure it's all dead code, because that interface can't have been working previously, and it needs to be ripped out. I don't know much about the metro code though, someone else might want to do that.", "author": "matt.woodrow@gmail.com", "id": 9214719, "time": "2014-08-21T20:51:58Z"}, {"text": "(In reply to Matt Woodrow (:mattwoodrow) from comment #10)\n> Metro and test-ipcbrowser both still use the nsIContentViewManager. I'm sure\n> it's all dead code, because that interface can't have been working\n> previously, and it needs to be ripped out. I don't know much about the metro\n> code though, someone else might want to do that.\n\nI filed bug 936690 a while ago about removing nsIContentView / nsIContentViewManager.", "author": "botond@mozilla.com", "id": 9214728, "time": "2014-08-21T20:53:06Z"}, {"text": "Jim, do you know about the code in metro that uses the nsIContentView[Manager] interfaces? It looks like that code is used for scrolling but is probably not used with APZC enabled, is that correct? Can we rip it out?\n\n[1] http://mxr.mozilla.org/mozilla-central/source/browser/metro/base/content/bindings/browser.xml?rev=cc298e4b0f47#25", "author": "bugmail@mozilla.staktrace.com", "id": 9214910, "time": "2014-08-21T21:22:12Z"}, {"text": "(This discussion should probably be happening on bug 1056427 and/or bug 936690, but whatever...)", "author": "bugmail@mozilla.staktrace.com", "id": 9214918, "time": "2014-08-21T21:23:02Z"}, {"text": "(In reply to Kartikaya Gupta (email:kats@mozilla.com) from comment #12)\n> Jim, do you know about the code in metro that uses the\n> nsIContentView[Manager] interfaces? It looks like that code is used for\n> scrolling but is probably not used with APZC enabled, is that correct? Can\n> we rip it out?\n> \n> [1]\n> http://mxr.mozilla.org/mozilla-central/source/browser/metro/base/content/\n> bindings/browser.xml?rev=cc298e4b0f47#25\n\nI haven't interacted with this code at all so I'm not sure what it does. It looks like it's mostly untouched from the original landing.\n\nThe plan was to move over to using toolkits remote-browser, but that work was never completed.\n\nMaybe we could just orphan this in the metro code, and file a bug on investigating what it's for knowing that the removal of the interfaces will break whatever it does.", "author": "jmathies@mozilla.com", "id": 9215350, "time": "2014-08-21T22:48:44Z"}, {"text": "(In reply to Jim Mathies [:jimm] from comment #14)\n> (In reply to Kartikaya Gupta (email:kats@mozilla.com) from comment #12)\n> > Jim, do you know about the code in metro that uses the\n> > nsIContentView[Manager] interfaces? It looks like that code is used for\n> > scrolling but is probably not used with APZC enabled, is that correct? Can\n> > we rip it out?\n> > \n> > [1]\n> > http://mxr.mozilla.org/mozilla-central/source/browser/metro/base/content/\n> > bindings/browser.xml?rev=cc298e4b0f47#25\n> \n> I haven't interacted with this code at all so I'm not sure what it does. It\n> looks like it's mostly untouched from the original landing.\n> \n> The plan was to move over to using toolkits remote-browser, but that work\n> was never completed.\n> \n> Maybe we could just orphan this in the metro code, and file a bug on\n> investigating what it's for knowing that the removal of the interfaces will\n> break whatever it does.\n\nThe code is already broken, because those interfaces aren't hooked up to anything useful. We just want it ripped out so we can remove the interface definitions and finish cleaning things up.", "author": "matt.woodrow@gmail.com", "id": 9215393, "time": "2014-08-21T22:57:05Z"}, {"text": "My vote is to set this._contentViewManager to null with a TODO and leave the rest of the code as is. We can deal with the fallout if any the next time we merge m-c to the metro branch. My assumption is that the code is not exercised in any meaningful way and so there should be no problem. I can do a metro build with that tomorrow to verify.", "author": "bugmail@mozilla.staktrace.com", "id": 9215470, "time": "2014-08-21T23:17:48Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/734451332c5b", "author": "kwierso@gmail.com", "id": 9215944, "time": "2014-08-22T01:25:20Z"}, {"text": "(In reply to Kartikaya Gupta (email:kats@mozilla.com) from comment #16)\n> I can do\n> a metro build with that tomorrow to verify.\n\nI verified that setting _contentViewManager to null seems to have no effect on the latest code in the metro branch. The browser still starts and works as expected. Moving discussion over to bug 936690.", "author": "bugmail@mozilla.staktrace.com", "id": 9218228, "time": "2014-08-22T15:39:21Z"}], "cf_last_resolved": "2014-08-22T01:25:20Z", "priority": "--", "mentors_detail": [], "cf_crash_signature": "", "version": "unspecified", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox59": "---", "last_change_time": "2014-08-22T15:39:21Z", "cf_platform_rel": "---", "product": "Core", "cf_status_firefox_esr52": "---", "blocks": [1051985], "qa_contact": "", "see_also": [], "cf_fx_iteration": "---", "component": "Graphics: Layers", "votes": 0, "groups": [], "cf_status_firefox60": "---", "target_milestone": "mozilla34", "is_cc_accessible": true, "cf_status_thunderbird_esr52": "---", "url": "", "creator_detail": {"email": "bugmail@mozilla.staktrace.com", "id": 426788, "name": "bugmail@mozilla.staktrace.com", "real_name": "Kartikaya Gupta (email:kats@mozilla.com)"}, "whiteboard": "", "mentors": [], "cc_detail": [{"email": "asmodeusme@yahoo.com", "id": 420570, "name": "asmodeusme@yahoo.com", "real_name": "Willy_ Foo_Foo"}, {"email": "botond@mozilla.com", "id": 474533, "name": "botond@mozilla.com", "real_name": "Botond Ballo [:botond]"}, {"email": "jmathies@mozilla.com", "id": 279663, "name": "jmathies@mozilla.com", "real_name": "Jim Mathies [:jimm]"}, {"email": "matt.woodrow@gmail.com", "id": 380838, "name": "matt.woodrow@gmail.com", "real_name": "Matt Woodrow (:mattwoodrow)"}, {"email": "tnikkel@gmail.com", "id": 255010, "name": "tnikkel@gmail.com", "real_name": "Timothy Nikkel (:tnikkel)"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "cf_tracking_firefox58": "---", "cf_rank": null, "is_open": false, "history": [{"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8475964, "added": "review?(matt.woodrow@gmail.com)"}, {"removed": "", "field_name": "cc", "added": "matt.woodrow@gmail.com"}], "who": "bugmail@mozilla.staktrace.com", "when": "2014-08-20T15:38:15Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "tnikkel@gmail.com"}], "who": "tnikkel@gmail.com", "when": "2014-08-20T17:51:58Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1056427"}], "who": "bugmail@mozilla.staktrace.com", "when": "2014-08-21T00:55:19Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(matt.woodrow@gmail.com)", "attachment_id": 8475964, "added": "review+"}], "who": "matt.woodrow@gmail.com", "when": "2014-08-21T03:44:28Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8475964, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8476626, "added": "review+"}], "who": "bugmail@mozilla.staktrace.com", "when": "2014-08-21T12:40:21Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "checkin-needed"}], "who": "bugmail@mozilla.staktrace.com", "when": "2014-08-21T12:41:41Z"}, {"changes": [{"removed": "checkin-needed", "field_name": "keywords", "added": ""}], "who": "ryanvm@gmail.com", "when": "2014-08-21T13:40:32Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(matt.woodrow@gmail.com)"}], "who": "bugmail@mozilla.staktrace.com", "when": "2014-08-21T14:06:45Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bezaleel360@gmail.com"}], "who": "asmodeusme@yahoo.com", "when": "2014-08-21T14:51:46Z"}, {"changes": [{"removed": "needinfo?(matt.woodrow@gmail.com)", "field_name": "flagtypes.name", "added": ""}], "who": "matt.woodrow@gmail.com", "when": "2014-08-21T20:51:58Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "botond@mozilla.com"}], "who": "botond@mozilla.com", "when": "2014-08-21T20:53:06Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jmathies@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(jmathies@mozilla.com)"}], "who": "bugmail@mozilla.staktrace.com", "when": "2014-08-21T21:22:12Z"}, {"changes": [{"removed": "needinfo?(jmathies@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "jmathies@mozilla.com", "when": "2014-08-21T22:48:44Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla34"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2014-08-21 18:25:20"}], "who": "kwierso@gmail.com", "when": "2014-08-22T01:25:20Z"}], "resolution": "FIXED", "op_sys": "Mac OS X", "cf_fx_points": "---", "cf_blocking_fennec": "---"}