{"status": "NEW", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "classification": "Client Software", "creator": "andres.rosales@live.com", "cc": ["david.olah@softvision.ro", "gijskruitbosch+bugs@gmail.com", "jaws@mozilla.com", "mcastelluccio@mozilla.com", "mconley@mozilla.com", "mheubusch@mozilla.com"], "depends_on": [], "creation_time": "2018-04-03T00:01:00Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "All", "cf_status_firefox59": "wontfix", "keywords": ["regression"], "summary": "Text or background colors remain on custom setting even when i click \"display\" never", "id": 1450832, "attachments": [{"creator": "andres.rosales@live.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/jpeg", "id": 8968931}, {"creator": "andres.rosales@live.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/jpeg", "id": 8968932}, {"creator": "andres.rosales@live.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/jpeg", "id": 8968933}], "assigned_to_detail": {"email": "nobody@mozilla.org", "id": 1, "name": "nobody@mozilla.org", "real_name": "Nobody; OK to take it and work on it"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 13, "comments": [{"text": "User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:59.0) Gecko/20100101 Firefox/59.0\nBuild ID: 20180323154952\n\nSteps to reproduce:\n\n--I manually changed text and background color, and set it to display always.\n\n-- then noticed that certain objects or texts would disappear by being changed into the background color. and i could only see it by highlighting it. also search bars were difficult to see. \n\n--so i changed display 'always' to 'never' however on some webpages, sometimes it'll be text,sometimes background, will be the color i had manually changed them to. \n\n\nActual results:\n\nColors are sometimes displaying in an undesired way, both with a custom set-up and when you disable that set-up.\n\n\nExpected results:\n\nColors should be returned to default setting when i click display 'never'.", "author": "andres.rosales@live.com", "id": 13175173, "time": "2018-04-03T00:01:00Z"}, {"text": "(In reply to Blur Blanc from comment #0)\n\n> --I manually changed text and background color, and set it to display always.\nCould you please provide actual steps on how you did this? \n\n> -- then noticed that certain objects or texts would disappear by being\n> changed into the background color. and i could only see it by highlighting\n> it. also search bars were difficult to see. \nA screenshot displaying the actual issue would be greatly appreciated.\n\n> --so i changed display 'always' to 'never' however on some webpages,\n> sometimes it'll be text,sometimes background, will be the color i had\n> manually changed them to. \nWould you please also provide where did you change this from and how?", "author": "david.olah@softvision.ro", "id": 13214798, "time": "2018-04-18T09:07:48Z"}, {"text": "Created attachment 8968931\nOptions window showing color settings", "author": "andres.rosales@live.com", "id": 13215675, "time": "2018-04-18T15:13:03Z"}, {"text": "Created attachment 8968932\nColor settings with options for always or never", "author": "andres.rosales@live.com", "id": 13215678, "time": "2018-04-18T15:13:36Z"}, {"text": "Created attachment 8968933\nYellow text still popping up", "author": "andres.rosales@live.com", "id": 13215679, "time": "2018-04-18T15:13:52Z"}, {"text": "Thank you for the reply!\n\nI managed to reproduce the issue on Windows 10 and Mac OS X, Nightly 61.0a1 (2018-04-18), Firefox 60 and Firefox 59.\n\nMarking the bug as New on Preferences component.", "author": "david.olah@softvision.ro", "id": 13217719, "time": "2018-04-19T08:16:06Z"}, {"text": "Gijs, I think this was broken ever since bug 639134 landed. I can reproduce it by setting the text color to bright yellow, changing the dropdown to \"Never\", and visiting data:text/html,<p>this is a test</p>", "author": "jaws@mozilla.com", "id": 13218774, "time": "2018-04-19T15:11:48Z"}, {"text": "(In reply to Jared Wein [:jaws] (please needinfo? me) from comment #6)\n> Gijs, I think this was broken ever since bug 639134 landed. I can reproduce\n> it by setting the text color to bright yellow, changing the dropdown to\n> \"Never\", and visiting data:text/html,<p>this is a test</p>\n\nI don't really understand. If you pick yellow text and have the default (ie white) background, then those are the colours we will use unless the website's CSS instructs us otherwise. In this case, there is no website CSS. So we use the default colours. So this is working as designed. The text in front of the dropdown where we're selecting \"Never\" doesn't say \"Do you want us to ever use these colors\", it says \"Override the colors specified by the page with your selections above\" - which is exactly what it's doing. If I visit the testcase you cited and use the devtools to add a stylesheet, and add `p { color: black }` then that overrides the defaults specified in the preferences as expected.\n\nThis worked the same way prior to bug 639134 - if I load the same testcase and have changed the colours the same way, and leave \"Allow pages to choose their own colours, instead of my selections above.\" ticked, text shows up yellow. (Ditto, of course, if I do untick that box.)\n\n\nSo as filed, I think this bug is invalid. I don't think setting the override functionality to 'never' should change the defaults back to what they are by default. If it did, then the colorpickers should all be greyed out in that case and we should only visually change the colorpickers without touching the pref (so that if you accidentally select 'never' and then go back, we put back your customized colors). But this would require some significant changes to layout in that it would mean users could never configure default colours without overriding website colours. It's also not clear how that'd work with the \"use system colours\" checkbox.\n\nGenerally, the colour preferences are pretty messy. I tend to think that the current colour selection doesn't provide enough options, provides some options that are unnecessary/redundant, and that it's too easy to end up in situations where either the foreground or background colour doesn't get overridden correctly (because the webpage hasn't set it), and on the other hand we don't offer users necessary control. We also aggressively remove various types of styled images, which sometimes make webpages hard to use. See e.g. bug 1266172 (and related) and bug 1430969 for some semi-recent examples.\n\nSo I wouldn't be opposed to rethinking this from a high level, but as-is I don't think there's much we can do here without that larger project, and I don't think we will be embarking on that larger project any time soon. Even if/when we do, I think the main plan would have to be decided by the a11y and layout teams - we would just build the required preference interface. So I think we should close this. Jared, thoughts?", "author": "gijskruitbosch+bugs@gmail.com", "id": 13219276, "time": "2018-04-19T18:13:22Z"}, {"text": "I think there is a legitimate bug here, such that the wording for this dialog can be confusing and \"Never\" may imply to users that these colors will _never_ be used. It seems the fix for this is to change the text to be less ambiguous.", "author": "jaws@mozilla.com", "id": 13219334, "time": "2018-04-19T18:28:49Z"}, {"text": "(In reply to Jared Wein [:jaws] (please needinfo? me) from comment #8)\n> I think there is a legitimate bug here, such that the wording for this\n> dialog can be confusing and \"Never\" may imply to users that these colors\n> will _never_ be used. It seems the fix for this is to change the text to be\n> less ambiguous.\n\nWe can add a verb (\"Never override\"), maybe? Would that help?\n\n... though then it'll be \"Only override in High Contrast themes\", which will be even longer than it already is in German. :-\\\n\n(Semi-related bug: the dropdown takes the size of the selected entry which means some/all the other items get clipped if you select \"Never\" or \"Always\". I wonder if that's a new bug...)", "author": "gijskruitbosch+bugs@gmail.com", "id": 13219366, "time": "2018-04-19T18:38:06Z"}, {"text": "(In reply to :Gijs (he/him) from comment #9)\n> (In reply to Jared Wein [:jaws] (please needinfo? me) from comment #8)\n> > I think there is a legitimate bug here, such that the wording for this\n> > dialog can be confusing and \"Never\" may imply to users that these colors\n> > will _never_ be used. It seems the fix for this is to change the text to be\n> > less ambiguous.\n> \n> We can add a verb (\"Never override\"), maybe? Would that help?\n\nMaybe \"Use as default\" would make more sense?\n\n> (Semi-related bug: the dropdown takes the size of the selected entry which\n> means some/all the other items get clipped if you select \"Never\" or\n> \"Always\". I wonder if that's a new bug...)\n\nI used mozregression to find that this was broken by https://hg.mozilla.org/mozilla-central/rev/28bddcbef8e1#l1.92", "author": "jaws@mozilla.com", "id": 13219647, "time": "2018-04-19T20:15:06Z"}, {"text": ":mheubusch, would it be possible for you to chime in?\n\nRight now we have some UI that looks like this:\n\n----\n{color picking options}\n\nOverride the colors specified by the page with your selections above\n[dropdown list with options:\n [Always]\n [Only with High Contrast themes]\n [Never]\n]\n----\n\nYou can see this yourself by going to Options/Preferences, searching for \"color\", and clicking the [Colors...] button that shows up.\n\n\nThe problem is this: the top colorpicker buttons all allow you to configure *default* colors.\nHowever, *most* but not *all* websites will include style information that tells the browser what colour the text and/or background should be. So changing the default will change a few websites completely, most websites only a bit (sometimes in ways that renders text unreadable because of the background/foreground combination) and some websites not at all (if the websites are very specific about the colours they want to use).\n\nNow, the bottom dropdown is meant to (sort of) deal with this. It allows the user to specify whether the default colors they pick should take precedence over whatever a website says. So if you select \"Always\", the selection of colours will override the ones from the website. If you select \"Never\", then the option works as I described earlier - we change the defaults, but websites that specify styling (nearly all websites) will override those defaults.\nThe middle option (Only with High Contrast themes) is the same as \"Never\" in almost all cases, *except* if the user is on Windows and is using a High Contrast theme in the operating system. This is primarily used by people who e.g. are colorblind or have other issues with the default colourschemes applications use. If the user is using such a theme, Firefox behaves as if \"Always\" was selected (so it will override website colours). This middle option is also the default option in this list (this is so that if a user uses such a theme, Firefox tries to render webpages using the same colours as those used in other Windows application, to help with whatever vision issues the user might have).\n\n\nIt seems some users are confused by this combination of controls. They expect \"Never\" to effectively \"turn off\" their alternative selection of default colours. Could you suggest better phrasing for the label and/or options of the dropdown control to clarify what it's supposed to do (ie control whether websites still get some measure of control over the colours used to render them, or not)?", "author": "gijskruitbosch+bugs@gmail.com", "id": 13219818, "time": "2018-04-19T21:17:52Z"}, {"text": "This bug sounds legit, but currently not earth shattering. Marking P3.", "author": "mconley@mozilla.com", "id": 13226533, "time": "2018-04-23T14:08:48Z"}], "cf_last_resolved": null, "priority": "P3", "mentors_detail": [], "cf_crash_signature": "", "version": "59 Branch", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox62": "---", "cf_platform_rel": "---", "product": "Firefox", "cf_status_firefox_esr52": "wontfix", "blocks": [639134], "qa_contact": "", "see_also": [], "cf_fx_iteration": "---", "component": "Preferences", "votes": 0, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "fix-optional", "cf_status_firefox60": "wontfix", "target_milestone": "---", "is_cc_accessible": true, "cf_rank": null, "groups": [], "url": "", "creator_detail": {"email": "andres.rosales@live.com", "id": 615306, "name": "andres.rosales@live.com", "real_name": "Blur Blanc"}, "whiteboard": "", "mentors": [], "cc_detail": [{"email": "david.olah@softvision.ro", "id": 613144, "name": "david.olah@softvision.ro", "real_name": "David Olah"}, {"email": "gijskruitbosch+bugs@gmail.com", "id": 159069, "name": "gijskruitbosch+bugs@gmail.com", "real_name": ":Gijs (he/him)"}, {"email": "jaws@mozilla.com", "id": 409754, "name": "jaws@mozilla.com", "real_name": "Jared Wein [:jaws] (please needinfo? me)"}, {"email": "mcastelluccio@mozilla.com", "id": 420453, "name": "mcastelluccio@mozilla.com", "real_name": "Marco Castelluccio [:marco]"}, {"email": "mconley@mozilla.com", "id": 403756, "name": "mconley@mozilla.com", "real_name": "Mike Conley (:mconley) (:\u2699\ufe0f) (Catching up on needinfos / reviews)"}, {"email": "mheubusch@mozilla.com", "id": 563864, "name": "mheubusch@mozilla.com", "real_name": ""}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [{"requestee": "mheubusch@mozilla.com", "status": "?", "name": "needinfo", "modification_date": "2018-04-19T21:17:52Z", "type_id": 800, "creation_date": "2018-04-19T21:17:52Z", "id": 1746582, "setter": "gijskruitbosch+bugs@gmail.com"}], "last_change_time": "2018-04-28T18:31:13Z", "cf_status_firefox_esr60": "wontfix", "assigned_to": "nobody@mozilla.org", "is_open": true, "resolution": "", "op_sys": "All", "cf_fx_points": "---", "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "david.olah@softvision.ro"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(andres.rosales@live.com)"}], "who": "david.olah@softvision.ro", "when": "2018-04-18T09:07:48Z"}, {"changes": [{"removed": "needinfo?(andres.rosales@live.com)", "field_name": "flagtypes.name", "added": ""}], "who": "andres.rosales@live.com", "when": "2018-04-18T15:13:03Z"}, {"changes": [{"removed": "UNCONFIRMED", "field_name": "status", "added": "NEW"}, {"removed": "Untriaged", "field_name": "component", "added": "Preferences"}, {"removed": "Unspecified", "field_name": "platform", "added": "All"}, {"removed": "0", "field_name": "is_confirmed", "added": "1"}, {"removed": "Unspecified", "field_name": "op_sys", "added": "All"}, {"removed": "---", "field_name": "cf_status_firefox59", "added": "affected"}, {"removed": "---", "field_name": "cf_status_firefox60", "added": "affected"}, {"removed": "---", "field_name": "cf_status_firefox61", "added": "affected"}], "who": "david.olah@softvision.ro", "when": "2018-04-19T08:16:06Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "gijskruitbosch+bugs@gmail.com, jaws@mozilla.com"}, {"removed": "", "field_name": "blocks", "added": "639134"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(gijskruitbosch+bugs@gmail.com)"}], "who": "jaws@mozilla.com", "when": "2018-04-19T15:11:48Z"}, {"changes": [{"removed": "needinfo?(gijskruitbosch+bugs@gmail.com)", "field_name": "flagtypes.name", "added": "needinfo?(jaws@mozilla.com)"}], "who": "gijskruitbosch+bugs@gmail.com", "when": "2018-04-19T18:13:22Z"}, {"changes": [{"removed": "needinfo?(jaws@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(gijskruitbosch+bugs@gmail.com)"}], "who": "jaws@mozilla.com", "when": "2018-04-19T18:28:49Z"}, {"changes": [{"removed": "needinfo?(gijskruitbosch+bugs@gmail.com)", "field_name": "flagtypes.name", "added": "needinfo?(jaws@mozilla.com)"}], "who": "gijskruitbosch+bugs@gmail.com", "when": "2018-04-19T18:38:06Z"}, {"changes": [{"removed": "needinfo?(jaws@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "jaws@mozilla.com", "when": "2018-04-19T20:15:06Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(gijskruitbosch+bugs@gmail.com)"}], "who": "jaws@mozilla.com", "when": "2018-04-19T20:15:14Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mheubusch@mozilla.com"}, {"removed": "needinfo?(gijskruitbosch+bugs@gmail.com)", "field_name": "flagtypes.name", "added": "needinfo?(mheubusch@mozilla.com)"}], "who": "gijskruitbosch+bugs@gmail.com", "when": "2018-04-19T21:17:52Z"}, {"changes": [{"removed": "--", "field_name": "priority", "added": "P3"}, {"removed": "", "field_name": "cc", "added": "mconley@mozilla.com"}], "who": "mconley@mozilla.com", "when": "2018-04-23T14:08:48Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "regression"}, {"removed": "", "field_name": "cc", "added": "mcastelluccio@mozilla.com"}], "who": "mcastelluccio@mozilla.com", "when": "2018-04-26T00:02:59Z"}, {"changes": [{"removed": "---", "field_name": "cf_status_firefox_esr52", "added": "wontfix"}, {"removed": "---", "field_name": "cf_status_firefox_esr60", "added": "wontfix"}, {"removed": "affected", "field_name": "cf_status_firefox59", "added": "wontfix"}, {"removed": "affected", "field_name": "cf_status_firefox60", "added": "wontfix"}, {"removed": "affected", "field_name": "cf_status_firefox61", "added": "fix-optional"}], "who": "ryanvm@gmail.com", "when": "2018-04-28T18:31:13Z"}]}