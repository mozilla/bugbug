{"cf_tracking_thunderbird_esr52": "---", "status": "NEW", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "cf_tracking_firefox62": "---", "creator": "roxana.leitan@softvision.ro", "mentors_detail": [], "depends_on": [], "cf_status_firefox_esr60": "---", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "keywords": ["regression"], "cc_detail": [{"email": "chris@chrislewis.codes", "id": 616749, "name": "chris@chrislewis.codes", "real_name": "Chris Lewis"}, {"email": "jfkthame@gmail.com", "id": 329583, "name": "jfkthame@gmail.com", "real_name": "Jonathan Kew (:jfkthame)"}, {"email": "lsalzman@mozilla.com", "id": 536714, "name": "lsalzman@mozilla.com", "real_name": "Lee Salzman [:lsalzman]"}, {"email": "milaninbugzilla@gmail.com", "id": 456486, "name": "milaninbugzilla@gmail.com", "real_name": "Milan Sreckovic [:milan] (needinfo for best results)"}, {"email": "sledru@mozilla.com", "id": 495955, "name": "sledru@mozilla.com", "real_name": "Sylvestre Ledru [:sylvestre]"}], "cf_last_resolved": null, "attachments": [{"creator": "roxana.leitan@softvision.ro", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 8973958}, {"creator": "jfkthame@gmail.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 8974130}], "votes": 0, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "yes", "comment_count": 9, "comments": [{"text": "Created attachment 8973958\nUntitled.png\n\n[Affected versions]:\nNightly 61.0a1 (2018-05-07)\n\n[Affected platforms]:\nMac OS X 10.13\n\n[Steps to reproduce]:\n1.Launch Nightly 61.0a1 with a new profile\n2.Open https://developer.microsoft.com/en-us/microsoft-edge/testdrive/demos/variable-fonts/\n\n[Expected results]:\nAll letters should be displayed correctly\n\n[Actual results]:\nSome letters are displayed with white lines inside", "author": "roxana.leitan@softvision.ro", "id": 13261799, "time": "2018-05-08T08:57:12Z"}, {"text": "This seems to be an issue at the graphics font-rendering level. These glyphs are constructed with multiple overlapping contours, and we're sometimes seeing faint edges of the pieces where they overlap. It seems to vary with size, perhaps depending exactly how the antialiasing of the individual parts works out.\n\nI've seen the same issue in Chrome, too (but haven't noticed it in Safari), though it seems to be more frequent/visible in Firefox. Perhaps it has something to do with how Skia composites the glyphs, or something like that? Given that it doesn't happen in Safari, AFAICT, it isn't necessarily inherent to Core Text glyph painting.", "author": "jfkthame@gmail.com", "id": 13261831, "time": "2018-05-08T09:10:47Z"}, {"text": "Is this a regression?", "author": "milaninbugzilla@gmail.com", "id": 13263242, "time": "2018-05-08T18:21:10Z"}, {"text": "(In reply to Milan Sreckovic [:milan] (needinfo for best results) from comment #2)\n> Is this a regression?\n\nNot a recent one, at least. I can reproduce with builds as far back as mozilla50, which is as old as mozregression is able to launch successfully on my current system.", "author": "jfkthame@gmail.com", "id": 13263385, "time": "2018-05-08T18:56:25Z"}, {"text": "Created attachment 8974130\nsimilar font-rendering issue in Safari\n\nOn further testing, I was able to spot the same problem occurring in Safari, as seen in this screenshot.\n\nAs such, I think we can regard this as a Core Text font rasterization issue, rather than a Firefox bug. Though if there's anything we can do to mitigate it, that would be good.", "author": "jfkthame@gmail.com", "id": 13263404, "time": "2018-05-08T19:07:06Z"}, {"text": "Mozregression on Mac OS X 10.12:\n\nLast good revision: 652ceb559a7459d466e1d580e3465f0e7608788c\nFirst bad revision: d85e4be1d7875e80e1217576dcaea195fb606edd\n\nPushlog:\nhttps://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=652ceb559a7459d466e1d580e3465f0e7608788c&tochange=d85e4be1d7875e80e1217576dcaea195fb606edd", "author": "roxana.leitan@softvision.ro", "id": 13265130, "time": "2018-05-09T12:09:01Z"}, {"text": "I don't think this is really a \"regression\" from bug 1341088, as suggested in comment 5; rather, the OTS update there enabled us to load the Bahnschrift font on the MS demo page, whereas previously we had rejected it and rendered a fallback.\n\nThe actual issue here is in Core Text's rendering of the font, where glyphs are constructed with multiple overlapping contours, and can be reproduced in much older builds (see comment 3) if the font is allowed to load (by disabling OpenType Layout sanitization). It also reproduces in both Chrome and Safari, though depending on the exact antialiasing mode being used, it may be more or less visible. Comment 4 has a screenshot showing the same issue in Safari (zoom the image to see the glitches, for example where the bowls of \"a\" and \"b\" join the vertical stems).", "author": "jfkthame@gmail.com", "id": 13265737, "time": "2018-05-09T15:48:39Z"}, {"text": "I'd agree that this is an issue with the way the font is constructed and not Firefox's problem.\n\nMore information on overlapping contours in fonts and the problems they cause:\n\nhttp://help.fontlab.com/fontlab-vi/Remove-Overlap/\nhttp://www.thomasphinney.com/2014/01/overlapping-paths-in-type-design/\nhttps://github.com/scribbletone/vardebug\n\nMost publicly-released fonts will have those overlaps removed during the final production process to avoid this kind of problem. \nIn fact, I think I read somewhere that overlapping contours might actually be formally disallowed in production-level variable fonts, but I can't find it now. I'll post here if I do.", "author": "chris@chrislewis.codes", "id": 13265845, "time": "2018-05-09T16:19:42Z"}, {"text": "Sorry, I have it backward, it was the earlier PostScript CFF .otf format that disallowed overlapping contours. The new OpenType 1.8 spec explicitly *allows* overlaps, because the variable-font point delta math for multiple contours would be infeasible to translate to a single combined contour. [See https://docs.microsoft.com/en-us/typography/opentype/spec/cff2#8-charstrings-index]\n\nI still agree it's Core Text's problem.", "author": "chris@chrislewis.codes", "id": 13266012, "time": "2018-05-09T17:09:29Z"}], "id": 1459858, "priority": "P3", "cc": ["chris@chrislewis.codes", "jfkthame@gmail.com", "lsalzman@mozilla.com", "milaninbugzilla@gmail.com", "sledru@mozilla.com"], "cf_crash_signature": "", "version": "61 Branch", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_thunderbird_esr60": "---", "cf_platform_rel": "---", "product": "Core", "cf_fx_iteration": "---", "blocks": [1302685, 1341088], "qa_contact": "", "creation_time": "2018-05-08T08:57:12Z", "cf_status_firefox_esr52": "---", "component": "Graphics: Text", "assigned_to_detail": {"email": "nobody@mozilla.org", "id": 1, "name": "nobody@mozilla.org", "real_name": "Nobody; OK to take it and work on it"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "---", "cf_status_firefox60": "---", "target_milestone": "---", "cf_rank": null, "cf_qa_whiteboard": "", "severity": "normal", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "roxana.leitan@softvision.ro", "id": 570200, "name": "roxana.leitan@softvision.ro", "real_name": "roxana.leitan@softvision.ro"}, "whiteboard": "[gfx-noted]", "mentors": [], "summary": "[Mac OS] Some letters are displayed with white lines inside on https://developer.microsoft.com/", "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-05-09T17:09:29Z", "assigned_to": "nobody@mozilla.org", "is_open": true, "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "jfkthame@gmail.com, lsalzman@mozilla.com"}, {"removed": "Layout: Text", "field_name": "component", "added": "Graphics: Text"}], "who": "jfkthame@gmail.com", "when": "2018-05-08T09:10:47Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "milaninbugzilla@gmail.com"}, {"removed": "", "field_name": "whiteboard", "added": "[gfx-noted]"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(roxana.leitan@softvision.ro)"}], "who": "milaninbugzilla@gmail.com", "when": "2018-05-08T18:21:10Z"}, {"changes": [{"removed": "needinfo?(roxana.leitan@softvision.ro)", "field_name": "flagtypes.name", "added": ""}], "who": "roxana.leitan@softvision.ro", "when": "2018-05-09T12:09:01Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "regression"}, {"removed": "", "field_name": "cc", "added": "sledru@mozilla.com"}, {"removed": "---", "field_name": "cf_has_regression_range", "added": "yes"}], "who": "sledru@mozilla.com", "when": "2018-05-09T12:13:27Z"}, {"changes": [{"removed": "--", "field_name": "priority", "added": "P3"}, {"removed": "", "field_name": "blocks", "added": "1341088"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(jfkthame@gmail.com)"}], "who": "milaninbugzilla@gmail.com", "when": "2018-05-09T14:59:33Z"}, {"changes": [{"removed": "needinfo?(jfkthame@gmail.com)", "field_name": "flagtypes.name", "added": ""}], "who": "jfkthame@gmail.com", "when": "2018-05-09T15:48:39Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "chris@chrislewis.codes"}], "who": "chris@chrislewis.codes", "when": "2018-05-09T16:19:42Z"}], "resolution": "", "op_sys": "Mac OS X", "cf_fx_points": "---", "cf_blocking_fennec": "---"}