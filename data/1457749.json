{"cf_tracking_thunderbird_esr52": "---", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "cf_tracking_firefox62": "---", "creator": "kmaglione+bmo@mozilla.com", "mentors_detail": [], "depends_on": [], "cf_status_firefox_esr60": "---", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "keywords": [], "cc_detail": [{"email": "acelists@atlas.sk", "id": 97012, "name": "acelists@atlas.sk", "real_name": ":aceman"}, {"email": "axel@pike.org", "id": 8123, "name": "axel@pike.org", "real_name": "Axel Hecht"}, {"email": "cosmin.badescu@softvision.ro", "id": 557772, "name": "cosmin.badescu@softvision.ro", "real_name": "CosminB"}, {"email": "dtownsend@mozilla.com", "id": 91159, "name": "dtownsend@mozilla.com", "real_name": "Dave Townsend [:mossop]"}, {"email": "emilio@crisal.io", "id": 546716, "name": "emilio@crisal.io", "real_name": "Emilio Cobos \u00c1lvarez [:emilio]"}, {"email": "jorgk@jorgk.com", "id": 176914, "name": "jorgk@jorgk.com", "real_name": "Jorg K (GMT+2)"}, {"email": "richard.marti@gmail.com", "id": 282357, "name": "richard.marti@gmail.com", "real_name": "Richard Marti (:Paenglab)"}], "cf_last_resolved": "2018-05-08T15:52:42Z", "attachments": [{"creator": "kmaglione+bmo@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2018-05-07T20:15:26Z", "type_id": 4, "creation_date": "2018-04-29T02:32:54Z", "id": 1750377, "setter": "dtownsend@mozilla.com"}], "content_type": "text/x-review-board-request", "id": 8971843}, {"creator": "kmaglione+bmo@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2018-05-07T20:29:31Z", "type_id": 4, "creation_date": "2018-04-29T02:32:54Z", "id": 1750378, "setter": "dtownsend@mozilla.com"}], "content_type": "text/x-review-board-request", "id": 8971844}, {"creator": "kmaglione+bmo@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2018-05-07T20:43:45Z", "type_id": 4, "creation_date": "2018-04-29T02:32:54Z", "id": 1750379, "setter": "dtownsend@mozilla.com"}], "content_type": "text/x-review-board-request", "id": 8971845}], "votes": 0, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 21, "comments": [{"text": "The RDF service is pretty bad, and is going away anyway. Our uses of it are also going away, but in the mean time, it's a pretty simple task to migrate them to a pure JS implementation.", "author": "kmaglione+bmo@mozilla.com", "id": 13240244, "time": "2018-04-29T02:24:50Z"}, {"text": "Created attachment 8971843\nBut 1457749: Part 1 - Import RDFDataSource from McCoy and modernize.\n\nReview commit: https://reviewboard.mozilla.org/r/240588/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/240588/", "author": "kmaglione+bmo@mozilla.com", "id": 13240247, "time": "2018-04-29T02:32:54Z"}, {"text": "Created attachment 8971844\nBug 1457749: Part 2 - Update UpdateRDFConverter to use RDFDataSource.jsm.\n\nReview commit: https://reviewboard.mozilla.org/r/240590/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/240590/", "author": "kmaglione+bmo@mozilla.com", "id": 13240248, "time": "2018-04-29T02:32:54Z"}, {"text": "Created attachment 8971845\nBug 1457749: Part 3 - Migrate install.rdf parser to use RDFDataSource.jsm.\n\nThis is based on a script I'd already created to migrate test extensions to\nthe JSON format we use to generate fixture add-ons.\n\nThe delay update add-ons used invalid XML in their manifests, which the\nbuilt-in parser ignored but the new parser doesn't accept, so I had to fix\nthose, too.\n\nReview commit: https://reviewboard.mozilla.org/r/240592/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/240592/", "author": "kmaglione+bmo@mozilla.com", "id": 13240249, "time": "2018-04-29T02:32:54Z"}, {"text": "Comment on attachment 8971843\nBut 1457749: Part 1 - Import RDFDataSource from McCoy and modernize.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/240588/diff/1-2/", "author": "kmaglione+bmo@mozilla.com", "id": 13240254, "time": "2018-04-29T03:23:28Z"}, {"text": "Comment on attachment 8971844\nBug 1457749: Part 2 - Update UpdateRDFConverter to use RDFDataSource.jsm.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/240590/diff/1-2/", "author": "kmaglione+bmo@mozilla.com", "id": 13240255, "time": "2018-04-29T03:23:28Z"}, {"text": "Comment on attachment 8971845\nBug 1457749: Part 3 - Migrate install.rdf parser to use RDFDataSource.jsm.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/240592/diff/1-2/", "author": "kmaglione+bmo@mozilla.com", "id": 13240256, "time": "2018-04-29T03:23:28Z"}, {"text": "Comment on attachment 8971843\nBut 1457749: Part 1 - Import RDFDataSource from McCoy and modernize.\n\nhttps://reviewboard.mozilla.org/r/240588/#review246430\n\nDo we actually care about serializing the data back to disk anywhere? If not there is substantial clean-up we could do here.\n\nStarted to review but then realised I'm basically reviewing code I wrote. Did you effectively review the code I wrote in the first place before making the changes to it?\n\n::: toolkit/mozapps/extensions/internal/RDFDataSource.jsm:3\n(Diff revision 2)\n> +/*\n> +# ***** BEGIN LICENSE BLOCK *****\n> +# Version: MPL 1.1/GPL 2.0/LGPL 2.1\n\nI believe that as the author of the entire code that this is based on I can say that it is ok to relicense this under MPL 2\n\n::: toolkit/mozapps/extensions/internal/RDFDataSource.jsm:67\n(Diff revision 2)\n> +const NS_RDF = \"http://www.w3.org/1999/02/22-rdf-syntax-ns#\";\n> +const NS_NC = \"http://home.netscape.com/NC-rdf#\";\n> +\n> +/* eslint prefer-template: 1 */\n> +\n> +function raw(strings) {\n\nNice!\n\n::: toolkit/mozapps/extensions/internal/RDFDataSource.jsm:204\n(Diff revision 2)\n> +function RDF_R(name) {\n> +  return NS_RDF + name;\n> +}\n> +\n> +/**\n> + * Because Mozilla doesn't support all of DOM3 yet :(\n\nNot sure what I was referring to here but I don't see anything in the spec that would allow this so I suggest just removing this comment.\n\n::: toolkit/mozapps/extensions/internal/RDFDataSource.jsm:218\n(Diff revision 2)\n> +      newdomnode.appendChild(domnode.firstChild);\n> +    for (let attr of domnode.attributes) {\n> +      domnode.removeAttributeNode(attr);\n> +      newdomnode.setAttributeNode(attr);\n> +    }\n> +    newdomnode.parentNode.removeChild(domnode);\n\nEither domnode.remove() or just replace the add/remove with domnode.parentNode.replaceChild(...)\n\n::: toolkit/mozapps/extensions/internal/RDFDataSource.jsm:232\n(Diff revision 2)\n> +    return attr;\n> +  }\n> +  throw new Error(\"cannot rename node of this type\");\n> +}\n> +\n> +function predicateOrder(a, b) {\n\nThis could be simplified as a.getPredicate().localeCompare(b.getPredicate())\n\n::: toolkit/mozapps/extensions/internal/RDFDataSource.jsm:306\n(Diff revision 2)\n> +    if (this._isSubjectElement)\n> +      return this._DOMnode;\n> +    return this._DOMnode.parentNode;\n> +  }\n> +\n> +  getSubject() {\n\nMaybe use getters for these. Not that bothered though.\n\n::: toolkit/mozapps/extensions/internal/RDFDataSource.jsm:347\n(Diff revision 2)\n> +\n> +  /**\n> +   * Compares this literal to another node.\n> +   */\n> +  equals(rdfnode) {\n> +    if (rdfnode instanceof RDFLiteral)\n\nI think if you compare constructors here you won't have to replicate this method so much.\n\n::: toolkit/mozapps/extensions/internal/RDFDataSource.jsm:1395\n(Diff revision 2)\n> +   * Guess the indent level within the given Element. The method looks for\n> +   * elements that are preceeded by whitespace including a newline. The\n> +   * whitespace following the newline is presumed to be the indentation for the\n> +   * element.\n> +   * If the indentation cannot be guessed then it recurses up the document\n> +   * hierarchy until it can guess the indent or untl the Document is reached.\n\nNit: s/untl/until/", "author": "dtownsend@mozilla.com", "id": 13244701, "time": "2018-04-30T21:00:50Z"}, {"text": "Comment on attachment 8971843\nBut 1457749: Part 1 - Import RDFDataSource from McCoy and modernize.\n\nhttps://reviewboard.mozilla.org/r/240588/#review246430\n\nI don't really care about serializing, no. I mostly left that code because it didn't seem worth the trouble to remove it.\n\nI reviewed most of the code that was relevant to me (i.e., not the serialization parts). I didn't pay much attention to the RDF logic, and mostly decided to trust tests to tell me if it was sane.", "author": "kmaglione+bmo@mozilla.com", "id": 13244765, "time": "2018-04-30T21:19:04Z"}, {"text": "Comment on attachment 8971843\nBut 1457749: Part 1 - Import RDFDataSource from McCoy and modernize.\n\nhttps://reviewboard.mozilla.org/r/240588/#review248002\n\nProbably some cleanups to be done here since we don't care about serialization, but that can be a follow-up.", "author": "dtownsend@mozilla.com", "id": 13260562, "time": "2018-05-07T20:15:26Z"}, {"text": "Comment on attachment 8971844\nBug 1457749: Part 2 - Update UpdateRDFConverter to use RDFDataSource.jsm.\n\nhttps://reviewboard.mozilla.org/r/240590/#review248010", "author": "dtownsend@mozilla.com", "id": 13260597, "time": "2018-05-07T20:29:31Z"}, {"text": "Comment on attachment 8971845\nBug 1457749: Part 3 - Migrate install.rdf parser to use RDFDataSource.jsm.\n\nhttps://reviewboard.mozilla.org/r/240592/#review248020", "author": "dtownsend@mozilla.com", "id": 13260650, "time": "2018-05-07T20:43:45Z"}, {"text": "Comment on attachment 8971843\nBut 1457749: Part 1 - Import RDFDataSource from McCoy and modernize.\n\nhttps://reviewboard.mozilla.org/r/240588/#review246430\n\n> Either domnode.remove() or just replace the add/remove with domnode.parentNode.replaceChild(...)\n\nTIL: https://developer.mozilla.org/en-US/docs/Web/API/ChildNode/replaceWith", "author": "kmaglione+bmo@mozilla.com", "id": 13261373, "time": "2018-05-08T02:35:04Z"}, {"text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/bef795f8c45c7cb33ab59c02348ad40e35660195\nBug 1457749: Part 1 - Import RDFDataSource from McCoy and modernize. r=Mossop\n\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/7f657f4d30880395e20f990c5c97ece275a61de2\nBug 1457749: Part 2 - Update UpdateRDFConverter to use RDFDataSource.jsm. r=Mossop\n\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/292cf80054b4734a0d7c84e987f68e229f2ccc24\nBug 1457749: Part 3 - Migrate install.rdf parser to use RDFDataSource.jsm. r=Mossop", "author": "kmaglione+bmo@mozilla.com", "id": 13261381, "time": "2018-05-08T02:43:09Z"}, {"text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/e640d678c9881de3f465257aac6858e34c76b034\nBug 1457749: Follow-up: Fix invalid install manifest in tabpaint test add-on. r=bustage CLOSED TREE", "author": "kmaglione+bmo@mozilla.com", "id": 13261777, "time": "2018-05-08T08:42:54Z"}, {"text": "Backed out 4 changesets (bug 1457749) for making T-e10s(o) hang\n\nLog:\nhttps://treeherder.mozilla.org/logviewer.html#?job_id=177417195&repo=mozilla-inbound\n\nPush with failures:\nhttps://treeherder.mozilla.org/#/jobs?repo=mozilla-inbound&revision=292cf80054b4734a0d7c84e987f68e229f2ccc24\n\nBackout:\nBacked out 4 changesets (bug 1457749) for making T-e10s(o) hang", "author": "dluca@mozilla.com", "id": 13262008, "time": "2018-05-08T10:54:46Z"}, {"text": "Backout by dluca@mozilla.com:\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/5f85b4722429\nBacked out 4 changesets for making T-e10s(o) hang", "author": "pulsebot@bots.tld", "id": 13262018, "time": "2018-05-08T11:02:09Z"}, {"text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/bc90a032770b4c4dfc80191da989b770ac3fc2cc\nBug 1457749: Part 1 - Import RDFDataSource from McCoy and modernize. r=Mossop\n\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/f470abadfa78fc38e8ecd394bb893e1a1a4c71e3\nBug 1457749: Part 2 - Update UpdateRDFConverter to use RDFDataSource.jsm. r=Mossop\n\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/a2bc8b64659ae9e3387aa7b599aa38be773041e5\nBug 1457749: Part 3 - Migrate install.rdf parser to use RDFDataSource.jsm. r=Mossop", "author": "kmaglione+bmo@mozilla.com", "id": 13262412, "time": "2018-05-08T13:53:49Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/bc90a032770b\nhttps://hg.mozilla.org/mozilla-central/rev/f470abadfa78\nhttps://hg.mozilla.org/mozilla-central/rev/a2bc8b64659a", "author": "ccoroiu@mozilla.com", "id": 13262831, "time": "2018-05-08T15:52:42Z"}, {"text": "Is manual testing required on this bug? If yes, please provide some STR and the proper extension(if required) or set the \u201cqe-verify -\u201c flag.\n\nThanks!", "author": "cosmin.badescu@softvision.ro", "id": 13293824, "time": "2018-05-21T11:43:21Z"}, {"text": "Probably does not need additional QA. We don't support install.rdf manifests aside from system add-ons and a few special cases, anymore. Might be a good idea to test non-AMO update.rdf manifests, if we knew which ones to check. But we don't.", "author": "kmaglione+bmo@mozilla.com", "id": 13295223, "time": "2018-05-21T21:54:20Z"}], "id": 1457749, "priority": "P2", "cc": ["acelists@atlas.sk", "axel@pike.org", "cosmin.badescu@softvision.ro", "dtownsend@mozilla.com", "emilio@crisal.io", "jorgk@jorgk.com", "richard.marti@gmail.com"], "cf_crash_signature": "", "version": "Trunk", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_thunderbird_esr60": "---", "status": "RESOLVED", "product": "Toolkit", "cf_fx_iteration": "---", "blocks": [833098], "qa_contact": "", "creation_time": "2018-04-29T02:24:50Z", "cf_status_firefox_esr52": "---", "component": "Add-ons Manager", "assigned_to_detail": {"email": "kmaglione+bmo@mozilla.com", "id": 106098, "name": "kmaglione+bmo@mozilla.com", "real_name": "Kris Maglione [:kmag]"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "fixed", "cf_status_firefox61": "wontfix", "cf_status_firefox60": "---", "target_milestone": "mozilla62", "cf_rank": null, "cf_qa_whiteboard": "", "severity": "normal", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "kmaglione+bmo@mozilla.com", "id": 106098, "name": "kmaglione+bmo@mozilla.com", "real_name": "Kris Maglione [:kmag]"}, "whiteboard": "", "mentors": [], "summary": "Stop using RDF service in add-on manager code", "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [{"status": "-", "name": "qe-verify", "modification_date": "2018-05-21T21:54:20Z", "type_id": 864, "creation_date": "2018-05-21T21:54:20Z", "id": 1759717, "setter": "kmaglione+bmo@mozilla.com"}], "last_change_time": "2018-05-21T21:54:20Z", "assigned_to": "kmaglione+bmo@mozilla.com", "is_open": false, "history": [{"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8971843, "added": "review?(dtownsend@mozilla.com)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8971844, "added": "review?(dtownsend@mozilla.com)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8971845, "added": "review?(dtownsend@mozilla.com)"}, {"removed": "", "field_name": "cc", "added": "dtownsend@mozilla.com"}], "who": "kmaglione+bmo@mozilla.com", "when": "2018-04-29T02:32:54Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "axel@pike.org"}], "who": "axel@pike.org", "when": "2018-04-30T10:41:16Z"}, {"changes": [{"removed": "--", "field_name": "priority", "added": "P2"}], "who": "aswan@mozilla.com", "when": "2018-05-03T18:13:18Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(dtownsend@mozilla.com)", "attachment_id": 8971843, "added": "review+"}], "who": "dtownsend@mozilla.com", "when": "2018-05-07T20:15:26Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(dtownsend@mozilla.com)", "attachment_id": 8971844, "added": "review+"}], "who": "dtownsend@mozilla.com", "when": "2018-05-07T20:29:31Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(dtownsend@mozilla.com)", "attachment_id": 8971845, "added": "review+"}], "who": "dtownsend@mozilla.com", "when": "2018-05-07T20:43:45Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(kmaglione+bmo@mozilla.com)"}], "who": "dluca@mozilla.com", "when": "2018-05-08T10:54:46Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "acelists@atlas.sk, jorgk@jorgk.com, richard.marti@gmail.com"}], "who": "jorgk@jorgk.com", "when": "2018-05-08T11:02:42Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "emilio@crisal.io"}], "who": "emilio@crisal.io", "when": "2018-05-08T13:29:36Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla62"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2018-05-08 15:52:42"}, {"removed": "---", "field_name": "cf_status_firefox62", "added": "fixed"}], "who": "ccoroiu@mozilla.com", "when": "2018-05-08T15:52:42Z"}, {"changes": [{"removed": "needinfo?(kmaglione+bmo@mozilla.com)", "field_name": "flagtypes.name", "added": ""}, {"removed": "affected", "field_name": "cf_status_firefox61", "added": "wontfix"}], "who": "ryanvm@gmail.com", "when": "2018-05-10T14:11:12Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "cosmin.badescu@softvision.ro"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(kmaglione+bmo@mozilla.com)"}], "who": "cosmin.badescu@softvision.ro", "when": "2018-05-21T11:43:21Z"}, {"changes": [{"removed": "needinfo?(kmaglione+bmo@mozilla.com)", "field_name": "flagtypes.name", "added": "qe-verify-"}], "who": "kmaglione+bmo@mozilla.com", "when": "2018-05-21T21:54:20Z"}], "resolution": "FIXED", "op_sys": "Unspecified", "cf_fx_points": "---", "cf_blocking_fennec": "---"}