{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "cf_tracking_firefox62": "---", "creator": "david.humphrey@senecacollege.ca", "mentors_detail": [], "depends_on": [], "cf_status_firefox_esr60": "---", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "All", "keywords": [], "cc_detail": [{"email": "andrebargull@googlemail.com", "id": 339940, "name": "andrebargull@googlemail.com", "real_name": "Andr\u00e9 Bargull [:anba]"}, {"email": "arpad.borsos@googlemail.com", "id": 140537, "name": "arpad.borsos@googlemail.com", "real_name": "Arpad Borsos [:Swatinem]"}, {"email": "dmandelin@mozilla.com", "id": 294323, "name": "dmandelin@mozilla.com", "real_name": "David Mandelin [:dmandelin]"}, {"email": "dvander@alliedmods.net", "id": 309316, "name": "dvander@alliedmods.net", "real_name": "David Anderson [:dvander] - inactive, e-mail if emergency"}, {"email": "jorendorff@mozilla.com", "id": 281791, "name": "jorendorff@mozilla.com", "real_name": "Jason Orendorff [:jorendorff]"}, {"email": "josh@joshmatthews.net", "id": 241497, "name": "josh@joshmatthews.net", "real_name": "Josh Matthews [:jdm]"}, {"email": "martinbijl@yahoo.es", "id": 370862, "name": "martinbijl@yahoo.es", "real_name": ""}, {"email": "mh+mozilla@glandium.org", "id": 47192, "name": "mh+mozilla@glandium.org", "real_name": "Mike Hommey [:glandium]"}, {"email": "taras.mozilla@glek.net", "id": 261603, "name": "taras.mozilla@glek.net", "real_name": "(dormant account)"}], "cf_last_resolved": "2018-04-26T14:27:55Z", "attachments": [{"creator": "martinbijl@yahoo.es", "is_obsolete": 0, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 423169}], "votes": 1, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 14, "comments": [{"text": "Today I'm trying to get callgraph stuff hooked into dxr, and I'm unable to get a working treehydra.  I've updated tried updating just dehydra, then I updated gcc w/plugins using the new stuff in the patch queue, and it doesn't matter.  Running make check_treehydra fails like this:\n\nTest Failure: \n    Test command: /var/www/html/dxr/tools/gcc-dehydra/installed/bin/../libexec/gcc/x86_64-unknown-linux-gnu/4.3.0/cc1plus -quiet -fplugin=../gcc_treehydra.so -o /dev/null -fplugin-arg=test_locks_bad3.js locks_bad3.cc\n    Failure msg: Expected 'locks_bad3.cc:10: error: precondition not met' in error output; not found. stderr:../libs/treehydra.js:12: JS Exception: No case_val in this lazy object\n:0:     #0: Error(\"No case_val in this lazy object\")\n../libs/treehydra.js:12:        #1: unhandledLazyProperty(\"case_val\")\n../libs/unstable/esp.js:481:    #2: ()\n./esp_lock.js:41:       #3: process_tree([object GCCNode])\n\nTest Failure: \n    Test command: /var/www/html/dxr/tools/gcc-dehydra/installed/bin/../libexec/gcc/x86_64-unknown-linux-gnu/4.3.0/cc1plus -quiet -fplugin=../gcc_treehydra.so -o /dev/null -fplugin-arg=test_locks_good.js locks_good.cc\n    Failure msg: Expected no error output, got error output :../libs/treehydra.js:12: JS Exception: No case_val in this lazy object\n:0:     #0: Error(\"No case_val in this lazy object\")\n../libs/treehydra.js:12:        #1: unhandledLazyProperty(\"case_val\")\n../libs/unstable/esp.js:481:    #2: ()\n./esp_lock.js:41:       #3: process_tree([object GCCNode])\n\nTest Failure: \n    Test command: /var/www/html/dxr/tools/gcc-dehydra/installed/bin/../libexec/gcc/x86_64-unknown-linux-gnu/4.3.0/cc1plus -quiet -fplugin=../gcc_treehydra.so -o /dev/null -fplugin-arg=test_locks_good2.js locks_good2.cc\n    Failure msg: Expected no error output, got error output :../libs/treehydra.js:12: JS Exception: No case_val in this lazy object\n:0:     #0: Error(\"No case_val in this lazy object\")\n../libs/treehydra.js:12:        #1: unhandledLazyProperty(\"case_val\")\n../libs/unstable/esp.js:481:    #2: ()\n./esp_lock.js:41:       #3: process_tree([object GCCNode])\n\nTest Failure: \n    Test command: /var/www/html/dxr/tools/gcc-dehydra/installed/bin/../libexec/gcc/x86_64-unknown-linux-gnu/4.3.0/cc1plus -quiet -fplugin=../gcc_treehydra.so -o /dev/null -fplugin-arg=test_locks_bad4.js locks_bad4.cc\n    Failure msg: Expected 'locks_bad4.cc:13: error: precondition not met' in error output; not found. stderr:../libs/treehydra.js:12: JS Exception: No case_val in this lazy object\n:0:     #0: Error(\"No case_val in this lazy object\")\n../libs/treehydra.js:12:        #1: unhandledLazyProperty(\"case_val\")\n../libs/unstable/esp.js:481:    #2: ()\n./esp_lock.js:41:       #3: process_tree([object GCCNode])\n\nTest Failure: \n    Test command: /var/www/html/dxr/tools/gcc-dehydra/installed/bin/../libexec/gcc/x86_64-unknown-linux-gnu/4.3.0/cc1plus -quiet -fplugin=../gcc_treehydra.so -o /dev/null -fplugin-arg=test_locks_bad2.js locks_bad2.cc\n    Failure msg: Expected 'locks_bad2.cc:12: error: precondition not met' in error output; not found. stderr:../libs/treehydra.js:12: JS Exception: No case_val in this lazy object\n:0:     #0: Error(\"No case_val in this lazy object\")\n../libs/treehydra.js:12:        #1: unhandledLazyProperty(\"case_val\")\n../libs/unstable/esp.js:481:    #2: ()\n./esp_lock.js:41:       #3: process_tree([object GCCNode])\n\nTest Failure: \n    Test command: /var/www/html/dxr/tools/gcc-dehydra/installed/bin/../libexec/gcc/x86_64-unknown-linux-gnu/4.3.0/cc1plus -quiet -fplugin=../gcc_treehydra.so -o /dev/null -fplugin-arg=test_locks_bad1.js locks_bad1.cc\n    Failure msg: Expected 'locks_bad1.cc:11: error: precondition not met' in error output; not found. stderr:../libs/treehydra.js:12: JS Exception: No case_val in this lazy object\n:0:     #0: Error(\"No case_val in this lazy object\")\n../libs/treehydra.js:12:        #1: unhandledLazyProperty(\"case_val\")\n../libs/unstable/esp.js:481:    #2: ()\n./esp_lock.js:41:       #3: process_tree([object GCCNode])\n\n\nUnit Test Suite Summary:\n     32 passed\n      6 failed\n      0 error(s)\nmake[1]: *** [check_treehydra] Error 1\nmake[1]: Leaving directory `/var/www/html/dxr/tools/gcc-dehydra/dehydra/test'\nmake: *** [check] Error 2", "author": "david.humphrey@senecacollege.ca", "id": 4378190, "time": "2009-11-03T19:56:03Z"}, {"text": "Rebuilt *everything* and no difference.  I'm on a 64-bit Fedora box, if that matters.", "author": "david.humphrey@senecacollege.ca", "id": 4378584, "time": "2009-11-03T22:31:40Z"}, {"text": "Regression window is between:\n\nhttp://hg.mozilla.org/mozilla-central/rev/89e665eb9944 (passes all tests)\nhttp://hg.mozilla.org/mozilla-central/rev/d04601f54db5 (6 tests fail)\n\nChangesets in between these don't build.", "author": "david.humphrey@senecacollege.ca", "id": 4378946, "time": "2009-11-04T01:24:07Z"}, {"text": "Looks like tracing recursion broke it.", "author": "dmandelin@mozilla.com", "id": 4381385, "time": "2009-11-05T01:37:03Z"}, {"text": "Taras, any idea at all what circumstances lead to these failures? A minimal jsapi-test makes this kind of thing much easier to fix.", "author": "jorendorff@mozilla.com", "id": 4390534, "time": "2009-11-10T20:02:39Z"}, {"text": "(In reply to comment #4)\n> Taras, any idea at all what circumstances lead to these failures? A minimal\n> jsapi-test makes this kind of thing much easier to fix.\n\nThe bugs haven't been related so far. I think they are caused by the the fact that we have a very large amount of js code and we embed spidermonkey slightly differently from firefox.", "author": "taras.mozilla@glek.net", "id": 4390540, "time": "2009-11-10T20:06:00Z"}, {"text": "Disregard comment 5, I thought I was replying to bug 527744.\n\nThis testcase would be pretty hard to reduce as it involves a native resolve func code and a pile of js code. At least one spidermonkey dev is very familiar with Dehydra code in question so it shouldn't be too much of a stumbling block to debug this in dehydra.", "author": "taras.mozilla@glek.net", "id": 4418484, "time": "2009-11-25T20:28:58Z"}, {"text": "Yeah, a JSAPI test can provide a native resolve func and you can copy the JS code in place.  I'm sure that some of the JS developers are familiar with dehydra, but not the one to whom the bug was assigned, so you can help them help you by reducing (or even telling how to reproduce with dehydra, starting from \"I have never tried to use dehydra before\", as a start).", "author": "shaver@mozilla.org", "id": 4418490, "time": "2009-11-25T20:32:23Z"}, {"text": "To reproduce this, follow Dehydra installation instructions on https://developer.mozilla.org/En/Dehydra/Installing_Dehydra\n\nAfter compiling dehydra, run make check_treehydra to see the failures. This will output the exact command that is failing so one can run it through gdb. I'm happy to help with any questions in #static\n\nIf setting up dehydra build env is too troublesome, we arrange ssh access to a mozilla machine with everything setup & ready to fail(but that is likely more time consuming).\n\nAs I said before, a testcase would be difficult to produce(ie weeks) without a better understanding of spidermonkey internals that are failing. It doesn't fail on every native resolve call, seems to require a certain codepath.", "author": "taras.mozilla@glek.net", "id": 4418544, "time": "2009-11-25T21:03:22Z"}, {"text": "As of my last comment, using 1.9.2 spidermonkey was a reasonable workaround while the trunk fixed. \n\nNow the bug is also in 1.9.2 spidermonkey and is likely to get released, meaning that Treehydra will not function with neither the mozilla's bleeding edge spidermonkeys, nor distribution ones.", "author": "taras.mozilla@glek.net", "id": 4488105, "time": "2010-01-14T23:34:13Z"}, {"text": "(In reply to comment #9)\n> As of my last comment, using 1.9.2 spidermonkey was a reasonable workaround\n> while the trunk fixed. \n\nCorrection, I got my build trees swapped, trunk is still broken and 192 is ok.", "author": "taras.mozilla@glek.net", "id": 4488280, "time": "2010-01-15T01:44:06Z"}, {"text": "*** Bug 541554 has been marked as a duplicate of this bug. ***", "author": "Pidgeot18@gmail.com", "id": 4501598, "time": "2010-01-23T15:04:38Z"}, {"text": "Created attachment 423169\nAdded check to see if property is defined. This results in a succesful build", "author": "martinbijl@yahoo.es", "id": 4501904, "time": "2010-01-23T21:01:58Z"}, {"text": "Dehydra is gone, therefore resolving as INCOMPLETE.", "author": "andrebargull@googlemail.com", "id": 13235418, "time": "2018-04-26T14:27:55Z"}], "id": 526299, "priority": "--", "cc": ["andrebargull@googlemail.com", "arpad.borsos@googlemail.com", "dmandelin@mozilla.com", "dvander@alliedmods.net", "jorendorff@mozilla.com", "josh@joshmatthews.net", "martinbijl@yahoo.es", "mh+mozilla@glandium.org", "taras.mozilla@glek.net"], "cf_crash_signature": "", "version": "Trunk", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_thunderbird_esr60": "---", "cf_platform_rel": "---", "product": "Core", "cf_fx_iteration": "---", "blocks": [437502, 489834, 569973], "qa_contact": "", "creation_time": "2009-11-03T19:56:03Z", "cf_status_firefox_esr52": "---", "component": "JavaScript Engine", "assigned_to_detail": {"email": "dvander@alliedmods.net", "id": 309316, "name": "dvander@alliedmods.net", "real_name": "David Anderson [:dvander] - inactive, e-mail if emergency"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "---", "cf_status_firefox60": "---", "target_milestone": "---", "cf_rank": null, "cf_qa_whiteboard": "", "severity": "normal", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "david.humphrey@senecacollege.ca", "id": 250232, "name": "david.humphrey@senecacollege.ca", "real_name": "David Humphrey (:humph)"}, "whiteboard": "", "mentors": [], "summary": "Spidermonkey regression causes treehydra trunk to fail 6 tests", "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-04-26T14:27:55Z", "assigned_to": "dvander@alliedmods.net", "is_open": false, "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "dmandelin@mozilla.com"}], "who": "dmandelin@mozilla.com", "when": "2009-11-03T19:58:33Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jorendorff@mozilla.com"}], "who": "jorendorff@mozilla.com", "when": "2009-11-03T23:13:53Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "dvander@alliedmods.net"}], "who": "david.humphrey@senecacollege.ca", "when": "2009-11-04T01:24:07Z"}, {"changes": [{"removed": "tglek@mozilla.com", "field_name": "assigned_to", "added": "nobody@mozilla.org"}], "who": "taras.mozilla@glek.net", "when": "2009-11-04T19:23:47Z"}, {"changes": [{"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "dvander@alliedmods.net"}], "who": "dmandelin@mozilla.com", "when": "2009-11-05T01:37:03Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "tglek@mozilla.com"}], "who": "taras.mozilla@glek.net", "when": "2009-11-10T20:06:00Z"}, {"changes": [{"removed": "treehydra trunk fails 6 tests", "field_name": "summary", "added": "Spidermonkey regression causes treehydra trunk to fail 6 tests"}, {"removed": "Rewriting and Analysis", "field_name": "component", "added": "JavaScript Engine"}, {"removed": "dvander@alliedmods.net", "field_name": "assigned_to", "added": "general@js.bugs"}, {"removed": "rewriting-and-analysis@core.bugs", "field_name": "qa_contact", "added": "general@spidermonkey.bugs"}], "who": "taras.mozilla@glek.net", "when": "2009-11-25T20:28:58Z"}, {"changes": [{"removed": "x86_64", "field_name": "platform", "added": "All"}, {"removed": "", "field_name": "blocks", "added": "437502"}], "who": "taras.mozilla@glek.net", "when": "2010-01-14T23:34:13Z"}, {"changes": [{"removed": "general@js.bugs", "field_name": "assigned_to", "added": "dvander@alliedmods.net"}], "who": "dvander@alliedmods.net", "when": "2010-01-15T01:51:32Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "martinbijl@yahoo.es"}], "who": "Pidgeot18@gmail.com", "when": "2010-01-23T15:04:38Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "josh@joshmatthews.net"}], "who": "josh@joshmatthews.net", "when": "2010-02-16T01:36:31Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mh+mozilla@glandium.org"}], "who": "mh+mozilla@glandium.org", "when": "2010-02-27T07:07:45Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "arpad.borsos@googlemail.com"}], "who": "arpad.borsos@googlemail.com", "when": "2010-02-27T11:11:13Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "569973"}], "who": "ehren.m@gmail.com", "when": "2010-06-03T18:51:15Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "cc", "added": "andrebargull@googlemail.com"}, {"removed": "", "field_name": "resolution", "added": "INCOMPLETE"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2018-04-26 14:27:55"}], "who": "andrebargull@googlemail.com", "when": "2018-04-26T14:27:55Z"}], "resolution": "INCOMPLETE", "op_sys": "Linux", "cf_fx_points": "---", "cf_blocking_fennec": "---"}