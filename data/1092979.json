{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "attachments": [{"creator": "jyavenard@mozilla.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2014-11-03T23:28:59Z", "type_id": 4, "creation_date": "2014-11-03T22:50:21Z", "id": 1023383, "setter": "cajbir.bugzilla@cd.pn"}], "content_type": "text/plain", "id": 8516286}, {"creator": "jyavenard@mozilla.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 8516329}, {"creator": "jyavenard@mozilla.com", "is_obsolete": 0, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 8518022}], "classification": "Components", "creator": "jyavenard@mozilla.com", "cc": ["cajbir.bugzilla@cd.pn", "cbook@mozilla.com", "karlt@mozbugz.karlt.net"], "depends_on": [1065827, 1092996], "creation_time": "2014-11-03T09:46:37Z", "cf_user_story": "", "cf_backlog": "---", "cf_tracking_firefox_relnote": "---", "platform": "All", "cf_status_firefox58": "---", "cf_status_firefox59": "---", "keywords": [], "summary": "Mochitest for making sure loadedmetadata event is fired as early as possible", "id": 1092979, "assigned_to_detail": {"email": "jyavenard@mozilla.com", "id": 512198, "name": "jyavenard@mozilla.com", "real_name": "Jean-Yves Avenard [:jya]"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "assigned_to": "jyavenard@mozilla.com", "comment_count": 15, "comments": [{"text": "This bug is to track mochitest to test bug 1065827 functionality/\n\nloadedmetadata event should be fired as soon as we have a duration and video size", "author": "jyavenard@mozilla.com", "id": 9536130, "time": "2014-11-03T09:46:37Z"}, {"text": "Created attachment 8516286\nAdd mochitest to ensure loadedmetada is emitted as early as possible\n\nMochitest: currently broken due to bug 1092996. Changing 318 for 348 will make it work", "author": "jyavenard@mozilla.com", "id": 9540018, "time": "2014-11-03T22:50:21Z"}, {"text": "Comment on attachment 8516286\nAdd mochitest to ensure loadedmetada is emitted as early as possible\n\nReview of attachment 8516286:\n-----------------------------------------------------------------\n\nr+ with test timeout removed.\n\n::: dom/media/mediasource/test/test_LoadedMetadataFired.html\n@@ +21,5 @@\n> +      v.play();\n> +    });\n> +\n> +    // don't wait longer than we have to in the event of failure\n> +    var myTimer = setInterval(function () {\n\nThis tends to be a cause for intermittent failures if for some reason the machine running the test is running slow. Best to remove this and rely on the standard test timeout.", "author": "cajbir.bugzilla@cd.pn", "id": 9540219, "time": "2014-11-03T23:28:59Z"}, {"text": "Created attachment 8516329\nAdd mochitest to ensure loadedmetada is emitted as early as possible\n\nCarrying r+. Remove timeout", "author": "jyavenard@mozilla.com", "id": 9540375, "time": "2014-11-04T00:03:45Z"}, {"text": "Comment on attachment 8516329\nAdd mochitest to ensure loadedmetada is emitted as early as possible\n\nReview of attachment 8516329:\n-----------------------------------------------------------------\n\n::: dom/media/mediasource/test/test_LoadedMetadataFired.html\n@@ +16,5 @@\n> +  ms.addEventListener(\"sourceopen\", function () {\n> +    var sb = ms.addSourceBuffer(\"video/webm\");\n> +\n> +    fetchWithXHR(\"seek.webm\", function (arrayBuffer) {\n> +      sb.appendBuffer(new Uint8Array(arrayBuffer, 0, 318));\n\nWhat does that '318' mean? Is it the amount of bytes containing metadata but no 1st frame?", "author": "suro001@gmail.com", "id": 9541227, "time": "2014-11-04T03:37:53Z"}, {"text": "(In reply to JW Wang [:jwwang] from comment #4)\n> Comment on attachment 8516329\n> Add mochitest to ensure loadedmetada is emitted as early as possible\n> \n> Review of attachment 8516329:\n> -----------------------------------------------------------------\n> \n> ::: dom/media/mediasource/test/test_LoadedMetadataFired.html\n> @@ +16,5 @@\n> > +  ms.addEventListener(\"sourceopen\", function () {\n> > +    var sb = ms.addSourceBuffer(\"video/webm\");\n> > +\n> > +    fetchWithXHR(\"seek.webm\", function (arrayBuffer) {\n> > +      sb.appendBuffer(new Uint8Array(arrayBuffer, 0, 318));\n> \n> What does that '318' mean? Is it the amount of bytes containing metadata but\n> no 1st frame?\n\nIt's the size of the init segment in this webm file. The value was taken from test_SplitAppend.html and test_SplitAppendDelay.html mediasource mochitest.\n\nActually, from my tries, it would work with a size of 250.\nI don't know how :cajbir calculated that value.", "author": "jyavenard@mozilla.com", "id": 9541246, "time": "2014-11-04T03:47:07Z"}, {"text": "(In reply to JW Wang [:jwwang] from comment #4)\n> What does that '318' mean? Is it the amount of bytes containing metadata but\n> no 1st frame?\n\nI should've added comments to the first test where I used this value so it's obvious how to derive it for the next person to come along.  It's the offset of the first Cluster:\n\n$ mkvinfo -v -v -v seek.webm\n+ EBML head at 0\n|+ Doc type: webm at 5\n|+ Doc type version: 2 at 12\n|+ Doc type read version: 2 at 16\n+ Segment, size 215502 at 20\n|+ Seek head at 27\n|+ Segment information at 74\n|+ Segment tracks at 193\n|+ Cues at 236\n|+ Cluster at 318\n|+ Cluster at 25523\n[...]", "author": "kinetik@flim.org", "id": 9541313, "time": "2014-11-04T04:21:22Z"}, {"text": "https://treeherder.mozilla.org/ui/#/jobs?repo=try&revision=c4db27d2d075", "author": "jyavenard@mozilla.com", "id": 9547932, "time": "2014-11-05T08:16:03Z"}, {"text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/04d5a617450f", "author": "cbook@mozilla.com", "id": 9553358, "time": "2014-11-06T08:51:42Z"}, {"text": "sorry had to back this out per discussion on irc, it needs to wait for bug 1065827", "author": "cbook@mozilla.com", "id": 9553456, "time": "2014-11-06T09:35:52Z"}, {"text": "Created attachment 8518022\nAdd mochitest to ensure loadedmetada is emitted as early as possible\n\nfix alphabetical order", "author": "jyavenard@mozilla.com", "id": 9553567, "time": "2014-11-06T10:03:49Z"}, {"text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/1c969fba2f64", "author": "cbook@mozilla.com", "id": 9553694, "time": "2014-11-06T10:39:54Z"}, {"text": "sorry had to back this out since bug 1065827 needed to be backed out", "author": "cbook@mozilla.com", "id": 9554421, "time": "2014-11-06T14:11:11Z"}, {"text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/3723a5bad5b6", "author": "cbook@mozilla.com", "id": 9559010, "time": "2014-11-07T07:19:49Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/3723a5bad5b6", "author": "cbook@mozilla.com", "id": 9560306, "time": "2014-11-07T13:57:35Z"}], "cf_last_resolved": "2014-11-07T13:57:35Z", "priority": "--", "mentors_detail": [], "cf_crash_signature": "", "version": "Trunk", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox59": "---", "last_change_time": "2014-11-07T13:57:35Z", "cf_platform_rel": "---", "product": "Core", "cf_status_firefox_esr52": "---", "blocks": [], "qa_contact": "", "see_also": [], "cf_fx_iteration": "---", "component": "Audio/Video", "votes": 0, "groups": [], "cf_status_firefox60": "---", "target_milestone": "mozilla36", "is_cc_accessible": true, "cf_status_thunderbird_esr52": "---", "url": "", "creator_detail": {"email": "jyavenard@mozilla.com", "id": 512198, "name": "jyavenard@mozilla.com", "real_name": "Jean-Yves Avenard [:jya]"}, "whiteboard": "the order to apply is: 1065827, 1092979 and 1093654", "mentors": [], "cc_detail": [{"email": "cajbir.bugzilla@cd.pn", "id": 248229, "name": "cajbir.bugzilla@cd.pn", "real_name": "cajbir (:cajbir)"}, {"email": "cbook@mozilla.com", "id": 277293, "name": "cbook@mozilla.com", "real_name": "Carsten Book [:Tomcat]"}, {"email": "karlt@mozbugz.karlt.net", "id": 274246, "name": "karlt@mozbugz.karlt.net", "real_name": "Karl Tomlinson (:karlt)"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "cf_tracking_firefox58": "---", "cf_rank": null, "is_open": false, "history": [{"changes": [{"removed": "", "field_name": "depends_on", "added": "1092996"}], "who": "jyavenard@mozilla.com", "when": "2014-11-03T10:14:04Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8516286, "added": "review?(cajbir.bugzilla@cd.pn)"}, {"removed": "", "field_name": "cc", "added": "cajbir.bugzilla@cd.pn"}], "who": "jyavenard@mozilla.com", "when": "2014-11-03T22:50:21Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "ASSIGNED"}, {"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "jyavenard@mozilla.com"}], "who": "jyavenard@mozilla.com", "when": "2014-11-03T22:50:26Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(cajbir.bugzilla@cd.pn)", "attachment_id": 8516286, "added": "review+"}], "who": "cajbir.bugzilla@cd.pn", "when": "2014-11-03T23:28:59Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8516286, "added": "1"}], "who": "jyavenard@mozilla.com", "when": "2014-11-04T00:03:50Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "karlt@mozbugz.karlt.net"}], "who": "karlt@mozbugz.karlt.net", "when": "2014-11-05T21:55:04Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "checkin-needed"}], "who": "jyavenard@mozilla.com", "when": "2014-11-06T06:30:51Z"}, {"changes": [{"removed": "checkin-needed", "field_name": "keywords", "added": ""}], "who": "cbook@mozilla.com", "when": "2014-11-06T08:51:42Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "cbook@mozilla.com"}], "who": "cbook@mozilla.com", "when": "2014-11-06T09:35:52Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8516329, "added": "1"}], "who": "jyavenard@mozilla.com", "when": "2014-11-06T10:03:52Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "checkin-needed"}, {"removed": "", "field_name": "whiteboard", "added": "the order to apply is: 1065827, 1092979 and 1093654"}], "who": "jyavenard@mozilla.com", "when": "2014-11-06T23:35:31Z"}, {"changes": [{"removed": "checkin-needed", "field_name": "keywords", "added": ""}], "who": "cbook@mozilla.com", "when": "2014-11-07T07:19:49Z"}, {"changes": [{"removed": "ASSIGNED", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla36"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2014-11-07 05:57:35"}], "who": "cbook@mozilla.com", "when": "2014-11-07T13:57:35Z"}], "resolution": "FIXED", "op_sys": "All", "cf_fx_points": "---", "cf_blocking_fennec": "---"}