{"status": "RESOLVED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "classification": "Client Software", "creator": "xidorn+moz@upsuper.org", "cc": ["florian@queze.net", "gijskruitbosch+bugs@gmail.com", "jan@ikenmeyer.eu", "jmuizelaar@mozilla.com", "mayankleoboy1@gmail.com"], "depends_on": [], "creation_time": "2018-04-17T13:36:02Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "keywords": [], "summary": "browser.startup.blankWindow slows down the startup", "cf_last_resolved": "2018-04-18T16:22:12Z", "attachments": [], "assigned_to_detail": {"email": "nobody@mozilla.org", "id": 1, "name": "nobody@mozilla.org", "real_name": "Nobody; OK to take it and work on it"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 8, "comments": [{"text": "It seems to me that browser.startup.blankWindow actually makes the startup much slower than before.\n\nI took a stopwatch on a Windows 7 virtual machine with a latest nightly and using the url bar as the hero element. With browser.startup.blankWindow switched off, the time between I click the icon to the url bar shows up is 1~1.5s, but when turning that on, the time of this becomes ~2.5s, which is much slower.", "author": "xidorn+moz@upsuper.org", "id": 13212365, "time": "2018-04-17T13:36:02Z"}, {"text": "(In reply to Xidorn Quan [:xidorn] UTC+10 from comment #0)\n> It seems to me that browser.startup.blankWindow actually makes the startup\n> much slower than before.\n> \n> I took a stopwatch on a Windows 7 virtual machine with a latest nightly and\n> using the url bar as the hero element. With browser.startup.blankWindow\n> switched off, the time between I click the icon to the url bar shows up is\n> 1~1.5s, but when turning that on, the time of this becomes ~2.5s, which is\n> much slower.\n\nIs this specific to your machine? Telemetry data doesn't seem to agree with your perception: https://mzl.la/2J46N6y\n\nIf you think something needs investigation, could you please capture startup profiles with both values of the pref so that we can compare them?", "author": "florian@queze.net", "id": 13212418, "time": "2018-04-17T13:53:15Z"}, {"text": "Profiles:\nblankWindow switched off: https://perfht.ml/2EU2W9T\nblankWindow switched on: https://perfht.ml/2EU39tH\n\nThis profile pretty much confirms my feeling. If you want I can also take a screencast, although I suspect how useful is that.\n\nThe telemetry tells nothing without a A/B testing I would argue...", "author": "xidorn+moz@upsuper.org", "id": 13212461, "time": "2018-04-17T14:05:14Z"}, {"text": "It's probably not specific to that machine. I think I have similar perception on my win10 dev box.", "author": "xidorn+moz@upsuper.org", "id": 13212471, "time": "2018-04-17T14:07:32Z"}, {"text": "(In reply to Xidorn Quan [:xidorn] UTC+10 from comment #2)\n> Profiles:\n> blankWindow switched off: https://perfht.ml/2EU2W9T\n> blankWindow switched on: https://perfht.ml/2EU39tH\n> \n> This profile pretty much confirms my feeling. If you want I can also take a\n> screencast, although I suspect how useful is that.\n> \n> The telemetry tells nothing without a A/B testing I would argue...\n\nIn the profile with the blank window enabled, I see about 800ms spent in nsAppShell::ProcessNextNativeEvent: https://perfht.ml/2H79NP6 I wonder which events are being processed and why it takes so long.", "author": "florian@queze.net", "id": 13212585, "time": "2018-04-17T14:39:48Z"}, {"text": "(In reply to Florian Qu\u00e8ze [:florian] from comment #4)\n> (In reply to Xidorn Quan [:xidorn] UTC+10 from comment #2)\n> > Profiles:\n> > blankWindow switched off: https://perfht.ml/2EU2W9T\n> > blankWindow switched on: https://perfht.ml/2EU39tH\n> > \n> > This profile pretty much confirms my feeling. If you want I can also take a\n> > screencast, although I suspect how useful is that.\n> > \n> > The telemetry tells nothing without a A/B testing I would argue...\n> \n> In the profile with the blank window enabled, I see about 800ms spent in\n> nsAppShell::ProcessNextNativeEvent: https://perfht.ml/2H79NP6 I wonder which\n> events are being processed and why it takes so long.\n\nHere is a better profile of it captured on my Windows 10 dev machine: https://perfht.ml/2qL41fl\n\nI strongly suspect this to be a regression from bug 1450293.", "author": "florian@queze.net", "id": 13213937, "time": "2018-04-17T22:58:14Z"}, {"text": "Jim, any idea of why we are spending so much time processing native events there?", "author": "florian@queze.net", "id": 13213940, "time": "2018-04-17T22:59:36Z"}, {"text": "I have a patch in bug 1454908.\n\n*** This bug has been marked as a duplicate of bug 1454908 ***", "author": "florian@queze.net", "id": 13215868, "time": "2018-04-18T16:22:12Z"}], "id": 1454638, "priority": "--", "mentors_detail": [], "cf_crash_signature": "", "version": "59 Branch", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox62": "---", "cf_platform_rel": "---", "product": "Firefox", "cf_status_firefox_esr52": "---", "blocks": [1450293], "qa_contact": "", "see_also": ["https://bugzilla.mozilla.org/show_bug.cgi?id=1454908"], "cf_fx_iteration": "---", "component": "General", "votes": 0, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "---", "cf_status_firefox60": "---", "target_milestone": "---", "is_cc_accessible": true, "cf_rank": null, "groups": [], "url": "", "creator_detail": {"email": "xidorn+moz@upsuper.org", "id": 373403, "name": "xidorn+moz@upsuper.org", "real_name": "Xidorn Quan [:xidorn] UTC+10"}, "whiteboard": "[fxperf:p1]", "mentors": [], "cc_detail": [{"email": "florian@queze.net", "id": 149052, "name": "florian@queze.net", "real_name": "Florian Qu\u00e8ze [:florian]"}, {"email": "gijskruitbosch+bugs@gmail.com", "id": 159069, "name": "gijskruitbosch+bugs@gmail.com", "real_name": ":Gijs (he/him)"}, {"email": "jan@ikenmeyer.eu", "id": 580271, "name": "jan@ikenmeyer.eu", "real_name": "Jan Andre Ikenmeyer [:darkspirit]"}, {"email": "jmuizelaar@mozilla.com", "id": 309398, "name": "jmuizelaar@mozilla.com", "real_name": "Jeff Muizelaar [:jrmuizel] on parental leave until at least June 25"}, {"email": "mayankleoboy1@gmail.com", "id": 440227, "name": "mayankleoboy1@gmail.com", "real_name": "Mayank Bansal"}], "cf_has_str": "---", "alias": null, "dupe_of": 1454908, "flags": [], "last_change_time": "2018-04-19T02:20:33Z", "cf_status_firefox_esr60": "---", "assigned_to": "nobody@mozilla.org", "is_open": false, "resolution": "DUPLICATE", "op_sys": "Unspecified", "cf_fx_points": "---", "history": [{"changes": [{"removed": "", "field_name": "blocks", "added": "1450293"}, {"removed": "", "field_name": "whiteboard", "added": "[fxperf:p1]"}], "who": "florian@queze.net", "when": "2018-04-17T22:58:14Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(jmathies@mozilla.com)"}], "who": "florian@queze.net", "when": "2018-04-17T22:59:36Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jan@ikenmeyer.eu"}], "who": "jan@ikenmeyer.eu", "when": "2018-04-17T23:02:59Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "gijskruitbosch+bugs@gmail.com"}], "who": "gijskruitbosch+bugs@gmail.com", "when": "2018-04-17T23:28:34Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mayankleoboy1@gmail.com"}], "who": "mayankleoboy1@gmail.com", "when": "2018-04-18T12:06:02Z"}, {"changes": [{"removed": "", "field_name": "see_also", "added": "https://bugzilla.mozilla.org/show_bug.cgi?id=1454908"}], "who": "florian@queze.net", "when": "2018-04-18T13:14:20Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "DUPLICATE"}, {"removed": "needinfo?(jmathies@mozilla.com)", "field_name": "flagtypes.name", "added": ""}, {"removed": "", "field_name": "cf_last_resolved", "added": "2018-04-18 16:22:12"}], "who": "florian@queze.net", "when": "2018-04-18T16:22:12Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jmuizelaar@mozilla.com"}], "who": "jmuizelaar@mozilla.com", "when": "2018-04-19T02:20:33Z"}]}