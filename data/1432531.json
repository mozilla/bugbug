{"cf_tracking_thunderbird_esr52": "---", "status": "NEW", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "cf_tracking_firefox62": "---", "creator": "rhunt@eqrion.net", "mentors_detail": [], "depends_on": [1383767], "cf_status_firefox_esr60": "---", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "cf_status_firefox58": "---", "cf_status_firefox59": "---", "keywords": [], "cf_status_firefox57": "---", "summary": "Enable OMTP on Linux", "cf_last_resolved": null, "attachments": [], "votes": 6, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 8, "comments": [{"text": "Try runs have been mostly green with a cairo-ft crash.", "author": "rhunt@eqrion.net", "id": 12989265, "time": "2018-01-23T17:22:13Z"}, {"text": "Is there anything we could do here?", "author": "bugs@pettay.fi", "id": 13252947, "time": "2018-05-03T18:51:28Z"}, {"text": "Mostly this just needs someone to look into the cairo-ft crash that was happening on try, and to follow up with any other regressions that happen. I can't find the try runs that I did with this, so I can't point to an example of it. If anyone is interested, that would be a good start.\n\nI've been working on enabling parallel OMTP with tiling on skia windows so I've been unable to look into this further.", "author": "rhunt@eqrion.net", "id": 13253174, "time": "2018-05-03T20:10:04Z"}, {"text": "Okay, I did another try run to see if the crash was still reproducible and got it. [1]\n\nIt only happens in AWSY, the rest of the tree looks green. I did a bunch of retriggers for mochitests, reftests, and web-platform-tests to be sure.\n\nThis is probably the major blocker to enabling this in nightly.\n\n[1] https://treeherder.mozilla.org/#/jobs?repo=try&revision=4bfa8d0fe6c467eb776b00a28fe0f1c898baaf50&selectedJob=181274869", "author": "rhunt@eqrion.net", "id": 13380158, "time": "2018-06-01T13:11:02Z"}, {"text": "Retriggers have caught four cases of this crash [1] [2] [3] [4]\n\n[1] https://treeherder.mozilla.org/logviewer.html#?job_id=181274869&repo=try&lineNumber=1231\n[2] https://treeherder.mozilla.org/logviewer.html#?job_id=181340470&repo=try&lineNumber=1016\n[3] https://treeherder.mozilla.org/logviewer.html#?job_id=181339762&repo=try&lineNumber=1016\n[4] https://treeherder.mozilla.org/logviewer.html#?job_id=181343291&repo=try&lineNumber=1016\n\nSomething is going on with the locking here. A relevant bug is bug 1383767 which introduced some thread safety here.", "author": "rhunt@eqrion.net", "id": 13380272, "time": "2018-06-01T13:49:56Z"}, {"text": "Here is one more crash from a retrigger that hadn't finished yet [1]\n\n[1] https://treeherder.mozilla.org/logviewer.html#?job_id=181343295&repo=try&lineNumber=1523", "author": "rhunt@eqrion.net", "id": 13380381, "time": "2018-06-01T14:39:19Z"}, {"text": "We have this in Pernosco: https://pernos.co/debug/zRDZGH95UZCvMta1ptf5-w/index.html\nAccess instructions: https://mana.mozilla.org/wiki/display/TS/Debugging+with+Pernosco", "author": "roc@ocallahan.org", "id": 13382551, "time": "2018-06-03T02:36:01Z"}, {"text": "Okay, I think I've figured out a cause of thread unsafety that we are running into with freetype.\n\nThe T1 font backend is using global state via the T1_Hints_Funcs which has a pointer to a PS_Hints/T1_Hints struct which is stored on the 'pshinter' module global. PS_Hints is then used when performing hinting which is done by either FT_Load_Glyph, FT_Get_Advances, and FT_Get_Advance. Our per FT_Face lock doesn't protect against this and this can cause crashes.\n\nOddly enough, from the try runs that Lee and I did that used the global freetype lock around all these functions, we're still seeing crashes. It's uncertain whether they are new crashes or I'm still missing something here.", "author": "rhunt@eqrion.net", "id": 13402977, "time": "2018-06-13T00:23:21Z"}], "id": 1432531, "priority": "P3", "cc": ["bordjukov@gmail.com", "bugs@pettay.fi", "bugzilla@flaki.hu", "bwat47@outlook.com", "dietrich@mozilla.com", "ehsan@mozilla.com", "grayshade@gmail.com", "hidenosuke@hidenosuke.org", "jan@ikenmeyer.eu", "mcastelluccio@mozilla.com", "mstange@themasta.com", "roc@ocallahan.org", "stefan-bmo@breunig.xyz"], "cf_crash_signature": "", "version": "unspecified", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_thunderbird_esr60": "---", "cf_platform_rel": "---", "product": "Core", "cf_fx_iteration": "---", "blocks": [1369541, 1467151], "qa_contact": "", "creation_time": "2018-01-23T17:22:13Z", "cf_status_firefox_esr52": "---", "component": "Graphics: Layers", "assigned_to_detail": {"email": "rhunt@eqrion.net", "id": 573202, "name": "rhunt@eqrion.net", "real_name": "Ryan Hunt [:rhunt]"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "---", "cf_status_firefox60": "---", "target_milestone": "---", "cf_rank": null, "cf_qa_whiteboard": "", "severity": "normal", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "rhunt@eqrion.net", "id": 573202, "name": "rhunt@eqrion.net", "real_name": "Ryan Hunt [:rhunt]"}, "whiteboard": "[gfx-noted]", "mentors": [], "cc_detail": [{"email": "bordjukov@gmail.com", "id": 309572, "name": "bordjukov@gmail.com", "real_name": "Petko Bordjukov"}, {"email": "bugs@pettay.fi", "id": 39966, "name": "bugs@pettay.fi", "real_name": "Olli Pettay [:smaug]"}, {"email": "bugzilla@flaki.hu", "id": 449932, "name": "bugzilla@flaki.hu", "real_name": "Szmozs\u00e1nszky Istv\u00e1n [:flaki]"}, {"email": "bwat47@outlook.com", "id": 399443, "name": "bwat47@outlook.com", "real_name": "Brandon Watkins"}, {"email": "dietrich@mozilla.com", "id": 213632, "name": "dietrich@mozilla.com", "real_name": "Dietrich Ayala (:dietrich)"}, {"email": "ehsan@mozilla.com", "id": 251051, "name": "ehsan@mozilla.com", "real_name": ":Ehsan Akhgari"}, {"email": "grayshade@gmail.com", "id": 296264, "name": "grayshade@gmail.com", "real_name": "Laurentiu Nicola"}, {"email": "hidenosuke@hidenosuke.org", "id": 31289, "name": "hidenosuke@hidenosuke.org", "real_name": "Hideo Oshima"}, {"email": "jan@ikenmeyer.eu", "id": 580271, "name": "jan@ikenmeyer.eu", "real_name": "Jan Andre Ikenmeyer [:darkspirit]"}, {"email": "mcastelluccio@mozilla.com", "id": 420453, "name": "mcastelluccio@mozilla.com", "real_name": "Marco Castelluccio [:marco]"}, {"email": "mstange@themasta.com", "id": 293943, "name": "mstange@themasta.com", "real_name": "Markus Stange [:mstange]"}, {"email": "roc@ocallahan.org", "id": 5038, "name": "roc@ocallahan.org", "real_name": "Robert O'Callahan (:roc) (email my personal email if necessary)"}, {"email": "stefan-bmo@breunig.xyz", "id": 606702, "name": "stefan-bmo@breunig.xyz", "real_name": "Stefan Breunig"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-06-13T00:23:21Z", "assigned_to": "rhunt@eqrion.net", "is_open": true, "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "dietrich@mozilla.com"}], "who": "dietrich@mozilla.com", "when": "2018-01-23T18:03:27Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jan@ikenmeyer.eu"}], "who": "jan@ikenmeyer.eu", "when": "2018-01-23T21:46:16Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mcastelluccio@mozilla.com"}], "who": "mcastelluccio@mozilla.com", "when": "2018-01-24T00:21:08Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "hidenosuke@hidenosuke.org"}], "who": "hidenosuke@hidenosuke.org", "when": "2018-01-24T13:42:24Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "grayshade@gmail.com"}], "who": "grayshade@gmail.com", "when": "2018-02-15T14:52:23Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bordjukov@gmail.com"}], "who": "bordjukov@gmail.com", "when": "2018-03-19T21:03:45Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bwat47@outlook.com"}], "who": "bwat47@outlook.com", "when": "2018-04-17T10:36:42Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bugs@pettay.fi"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(rhunt@eqrion.net)"}], "who": "bugs@pettay.fi", "when": "2018-05-03T18:51:28Z"}, {"changes": [{"removed": "needinfo?(rhunt@eqrion.net)", "field_name": "flagtypes.name", "added": ""}], "who": "rhunt@eqrion.net", "when": "2018-05-03T20:10:04Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bugzilla@flaki.hu"}], "who": "bugzilla@flaki.hu", "when": "2018-05-30T23:05:02Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1383767"}], "who": "rhunt@eqrion.net", "when": "2018-06-01T13:49:56Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "roc@ocallahan.org"}], "who": "roc@ocallahan.org", "when": "2018-06-03T02:36:01Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "stefan-bmo@breunig.xyz"}], "who": "stefan-bmo@breunig.xyz", "when": "2018-06-05T05:07:17Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1467151"}], "who": "rhunt@eqrion.net", "when": "2018-06-06T14:46:32Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mstange@themasta.com"}], "who": "mstange@themasta.com", "when": "2018-06-07T13:52:17Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "ehsan@mozilla.com"}], "who": "ehsan@mozilla.com", "when": "2018-06-12T20:58:55Z"}], "resolution": "", "op_sys": "Unspecified", "cf_fx_points": "---", "cf_blocking_fennec": "---"}