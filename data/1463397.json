{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "cf_tracking_firefox62": "---", "creator": "igoldan@mozilla.com", "mentors_detail": [], "depends_on": [], "cf_status_firefox_esr60": "unaffected", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "keywords": ["perf", "regression"], "cc_detail": [{"email": "bob@bclary.com", "id": 23402, "name": "bob@bclary.com", "real_name": "Bob Clary [:bc:]"}, {"email": "dothayer@mozilla.com", "id": 582499, "name": "dothayer@mozilla.com", "real_name": "Doug Thayer [:dthayer] (PTO on June 4)"}, {"email": "erahm@mozilla.com", "id": 496127, "name": "erahm@mozilla.com", "real_name": "Eric Rahm [:erahm] (please no mozreview requests)"}, {"email": "grayshade@gmail.com", "id": 296264, "name": "grayshade@gmail.com", "real_name": "Laurentiu Nicola"}, {"email": "igoldan@mozilla.com", "id": 590618, "name": "igoldan@mozilla.com", "real_name": "Ionu\u021b Goldan [:igoldan], Performance Sheriffing"}, {"email": "jmaher@mozilla.com", "id": 324370, "name": "jmaher@mozilla.com", "real_name": "Joel Maher ( :jmaher ) (UTC-4)"}, {"email": "mconley@mozilla.com", "id": 403756, "name": "mconley@mozilla.com", "real_name": "Mike Conley (:mconley) (:\u2699\ufe0f) (Catching up on needinfos / reviews)"}, {"email": "rwood@mozilla.com", "id": 447387, "name": "rwood@mozilla.com", "real_name": "Robert Wood [:rwood]"}, {"email": "Tobias.Marty@gmx.de", "id": 572549, "name": "Tobias.Marty@gmx.de", "real_name": "TMart"}], "cf_last_resolved": "2018-06-08T08:06:09Z", "attachments": [], "votes": 0, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 11, "comments": [{"text": "We have detected an awsy regression from push:\n\nhttps://hg.mozilla.org/integration/autoland/pushloghtml?changeset=9c10d9a7198331b7a650cef79ed37f36d23a2c88\n\nAs author of one of the patches included in that push, we need your help to address this regression.\n\nRegressions:\n\n  8%  Resident Memory osx-10-10 opt stylo     710,401,289.13 -> 764,896,204.03\n\nImprovements:\n\n  8%  Images linux64-qr opt stylo     6,896,641.37 -> 6,314,073.83\n\n\nYou can find links to graphs and comparison views for each of the above tests at: https://treeherder.mozilla.org/perf.html#/alerts?id=13354\n\nOn the page above you can see an alert for each affected platform as well as a link to a graph showing the history of scores for this test. There is also a link to a treeherder page showing the jobs in a pushlog format.\n\nTo learn more about the regressing test(s), please see: https://wiki.mozilla.org/AWSY/Tests", "author": "igoldan@mozilla.com", "id": 13296266, "time": "2018-05-22T12:04:06Z"}, {"text": ":dthayer This is the final question: are we going to accept this memory regression?", "author": "igoldan@mozilla.com", "id": 13296273, "time": "2018-05-22T12:06:58Z"}, {"text": "This is currently limited to Nightly via a pref. The plan is to measure the impact of bug 1176019 on tab switch spinner telemetry numbers in Nightly[1] before deciding how we want to go forward with this. If the results are significant, we have a few options we want to talk about, such as capping the memory footprint of our cache at a specific size, and/or flattening the layer tree for cached tabs to reduce the per-tab size.\n\n(Leaving my needinfo until we have more information from telemetry.)\n\n[1] https://mikeconley.github.io/bug1310250/", "author": "dothayer@mozilla.com", "id": 13296936, "time": "2018-05-22T15:24:14Z"}, {"text": "We noticed yet another set of regressions. From Talos, this time:\n\n== Change summary for alert #13370 (as of Tue, 22 May 2018 16:03:27 GMT) ==\n\nRegressions:\n\n 12%  tps windows7-32 pgo e10s stylo     12.51 -> 14.06\n 11%  tps windows10-64 pgo e10s stylo    12.97 -> 14.40\n 11%  tps windows10-64-qr opt e10s stylo 11.32 -> 12.56\n\nFor up to date results, see: https://treeherder.mozilla.org/perf.html#/alerts?id=13370", "author": "igoldan@mozilla.com", "id": 13298671, "time": "2018-05-23T07:35:21Z"}, {"text": "Hmm. That's certainly interesting. Ultimately tab switch time should be improved regardless, and what tps is now measuring is the time before the second, forced paint comes out, so if I understood why this was happening I think it would be acceptable, but I can't say I do understand. Any hunches, mconley?", "author": "dothayer@mozilla.com", "id": 13299799, "time": "2018-05-23T15:38:27Z"}, {"text": "(In reply to Ionu\u021b Goldan [:igoldan], Performance Sheriffing from comment #3)\nVery interesting. Do you have easy access to before and after profiles for this?", "author": "mconley@mozilla.com", "id": 13300605, "time": "2018-05-23T20:19:35Z"}, {"text": "(In reply to Mike Conley (:mconley) (:\u2699\ufe0f) (Catching up on needinfos / reviews) from comment #5)\n> (In reply to Ionu\u021b Goldan [:igoldan], Performance Sheriffing from comment #3)\n> Very interesting. Do you have easy access to before and after profiles for\n> this?\n\nYes, I can generate them.", "author": "igoldan@mozilla.com", "id": 13322704, "time": "2018-05-24T05:38:47Z"}, {"text": "Here are the before/after profiles:\n\nbefore: https://perf-html.io/from-url/https%3A%2F%2Fqueue.taskcluster.net%2Fv1%2Ftask%2FDesB3jkRTpC2xM_rR_PrTQ%2Fruns%2F0%2Fartifacts%2Fpublic%2Ftest_info%2Fprofile_tps.zip\n\nafter: https://perf-html.io/from-url/https%3A%2F%2Fqueue.taskcluster.net%2Fv1%2Ftask%2FMI3mVcYAQwqVcDYjsbAfig%2Fruns%2F0%2Fartifacts%2Fpublic%2Ftest_info%2Fprofile_tps.zip", "author": "igoldan@mozilla.com", "id": 13323648, "time": "2018-05-24T05:58:30Z"}, {"text": "Clearing the needinfo - this will go away while we disable the tab layer cache in bug 1465106. I don't know if you want to leave this open for tracking purposes or not given that.", "author": "dothayer@mozilla.com", "id": 13371510, "time": "2018-05-29T15:49:32Z"}, {"text": "Ah, for the tps regression, I have a theory.\n\ntps was modified in bug 1451460 to make it so that we use the MozLayerTreeReady event in the parent process to \"stop\" the Talos stopwatch when measuring tab switch time.\n\nI suspect that when we have cached layers, we don't actually get that event - that event is what's used to transition something from STATE_LOADING to STATE_LOADED.\n\nI suspect we'll either have to:\n\n1) Disable caching for tps, and make it explicit that tps measures the \"worst case scenario\", where a tab is not cached or warm\n2) Modify tps to account for cached layers.", "author": "mconley@mozilla.com", "id": 13371544, "time": "2018-05-29T15:58:30Z"}, {"text": "(In reply to Doug Thayer [:dthayer] (PTO on June 4) from comment #8)\n> Clearing the needinfo - this will go away while we disable the tab layer\n> cache in bug 1465106. I don't know if you want to leave this open for\n> tracking purposes or not given that.\n\nI'll close this bug.", "author": "igoldan@mozilla.com", "id": 13395642, "time": "2018-06-08T08:06:00Z"}], "id": 1463397, "priority": "--", "cc": ["bob@bclary.com", "dothayer@mozilla.com", "erahm@mozilla.com", "grayshade@gmail.com", "igoldan@mozilla.com", "jmaher@mozilla.com", "mconley@mozilla.com", "rwood@mozilla.com", "Tobias.Marty@gmx.de"], "cf_crash_signature": "", "version": "Trunk", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_thunderbird_esr60": "---", "cf_platform_rel": "---", "product": "Core", "cf_fx_iteration": "---", "blocks": [1459846, 1176019], "qa_contact": "", "creation_time": "2018-05-22T12:04:06Z", "cf_status_firefox_esr52": "unaffected", "component": "Graphics: Layers", "assigned_to_detail": {"email": "dothayer@mozilla.com", "id": 582499, "name": "dothayer@mozilla.com", "real_name": "Doug Thayer [:dthayer] (PTO on June 4)"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "fixed", "cf_status_firefox61": "unaffected", "cf_status_firefox60": "unaffected", "target_milestone": "mozilla62", "cf_rank": null, "cf_qa_whiteboard": "", "severity": "normal", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "igoldan@mozilla.com", "id": 590618, "name": "igoldan@mozilla.com", "real_name": "Ionu\u021b Goldan [:igoldan], Performance Sheriffing"}, "whiteboard": "gfx-noted", "mentors": [], "summary": "7.67% Resident Memory (osx-10-10) regression on push 9c10d9a7198331b7a650cef79ed37f36d23a2c88 (Tue May 22 2018)", "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-06-08T16:36:29Z", "assigned_to": "dothayer@mozilla.com", "is_open": false, "history": [{"changes": [{"removed": "General", "field_name": "component", "added": "Graphics: Layers"}, {"removed": "Testing", "field_name": "product", "added": "Core"}], "who": "igoldan@mozilla.com", "when": "2018-05-22T12:04:34Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "grayshade@gmail.com"}], "who": "grayshade@gmail.com", "when": "2018-05-22T12:05:23Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(dothayer@mozilla.com)"}], "who": "igoldan@mozilla.com", "when": "2018-05-22T12:06:58Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "Tobias.Marty@gmx.de"}], "who": "Tobias.Marty@gmx.de", "when": "2018-05-22T14:33:29Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(mconley@mozilla.com)"}], "who": "dothayer@mozilla.com", "when": "2018-05-23T15:38:27Z"}, {"changes": [{"removed": "needinfo?(mconley@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(igoldan@mozilla.com)"}], "who": "mconley@mozilla.com", "when": "2018-05-23T20:19:35Z"}, {"changes": [{"removed": "needinfo?(igoldan@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "igoldan@mozilla.com", "when": "2018-05-24T05:38:47Z"}, {"changes": [{"removed": "", "field_name": "whiteboard", "added": "gfx-noted"}], "who": "nical.bugzilla@gmail.com", "when": "2018-05-25T10:19:41Z"}, {"changes": [{"removed": "needinfo?(dothayer@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "dothayer@mozilla.com", "when": "2018-05-29T15:49:32Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2018-06-08 08:06:09"}], "who": "igoldan@mozilla.com", "when": "2018-06-08T08:06:09Z"}, {"changes": [{"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "dothayer@mozilla.com"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla62"}, {"removed": "---", "field_name": "cf_status_firefox_esr52", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_firefox_esr60", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_firefox60", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_firefox61", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_firefox62", "added": "fixed"}], "who": "ryanvm@gmail.com", "when": "2018-06-08T16:36:29Z"}], "resolution": "FIXED", "op_sys": "Unspecified", "cf_fx_points": "---", "cf_blocking_fennec": "---"}