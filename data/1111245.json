{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "attachments": [{"creator": "nth10sd@gmail.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "text/plain", "id": 8536060}, {"creator": "terrence.d.cole@gmail.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2015-01-05T18:25:56Z", "type_id": 4, "creation_date": "2014-12-18T00:23:27Z", "id": 1056736, "setter": "jorendorff@mozilla.com"}], "content_type": "text/plain", "id": 8538170}], "classification": "Components", "creator": "nth10sd@gmail.com", "cc": ["choller@mozilla.com", "jorendorff@mozilla.com", "jruderman@gmail.com", "terrence.d.cole@gmail.com"], "depends_on": [], "creation_time": "2014-12-13T18:51:54Z", "cf_status_firefox37": "affected", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "x86_64", "cf_status_firefox58": "---", "cf_status_firefox59": "---", "keywords": ["assertion", "regression", "testcase"], "summary": "Assertion failure: maybecx->runtime()->hadOutOfMemory, at jscntxt.cpp", "id": 1111245, "assigned_to_detail": {"email": "terrence.d.cole@gmail.com", "id": 231770, "name": "terrence.d.cole@gmail.com", "real_name": "Terrence Cole [:terrence]"}, "severity": "critical", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "assigned_to": "terrence.d.cole@gmail.com", "comment_count": 6, "comments": [{"text": "// Randomly chosen test: js/src/tests/ecma_2/Exceptions/exception-005.js\n// -- reduced away --\n// Randomly chosen test: js/src/jit-test/tests/basic/bug858097.js\ngcparam(\"maxBytes\", gcparam(\"gcBytes\"));\n// Randomly chosen test: js/src/jit-test/tests/gc/bug-906243.js\nx = []\nObject.defineProperty(x, 0, {\n    set: function() {}\n})\nfor (var y = 0; y < 99; ++y) {\n    Array.prototype.unshift.call(x, function() {})\n}\n\nasserts js debug shell on m-c changeset 5288b15d22de with --fuzzing-safe --no-threads --ion-eager at Assertion failure: maybecx->runtime()->hadOutOfMemory, at jscntxt.cpp.\n\nDebug configure options:\n\nCC=\"clang -Qunused-arguments\" CXX=\"clang++ -Qunused-arguments\" AR=ar AUTOCONF=/usr/local/Cellar/autoconf213/2.13/bin/autoconf213 sh /Users/skywalker/trees/mozilla-central/js/src/configure --target=x86_64-apple-darwin12.5.0 --enable-debug --enable-optimize --enable-nspr-build --enable-more-deterministic --with-ccache --enable-gczeal --enable-debug-symbols --disable-tests\n\nThis was found by combining random js tests together with jsfunfuzz, the specific file(s) is/are:\n\nhttp://hg.mozilla.org/mozilla-central/file/5288b15d22de/js/src/tests/ecma_2/Exceptions/exception-005.js\nhttp://hg.mozilla.org/mozilla-central/file/5288b15d22de/js/src/jit-test/tests/basic/bug858097.js\nhttp://hg.mozilla.org/mozilla-central/file/5288b15d22de/js/src/jit-test/tests/gc/bug-906243.js\n\nThis also asserts js shells from FTP at:\n\nhttps://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2014-12-11-mozilla-central-debug/jsshell-mac64.zip\n\nSince this seems to be a GC/OOM bug, the bisection(s) I ran did not make sense.\n\nTerrence, any idea what's going on here?", "author": "nth10sd@gmail.com", "id": 9691504, "time": "2014-12-13T18:51:54Z"}, {"text": "Created attachment 8536060\nstack\n\n(lldb) bt 5\n* thread #1: tid = 0x1dafea, 0x00000001004b9cf0 js-dbg-opt-64-dm-nsprBuild-darwin-5288b15d22de`js::ThreadSafeContext::recoverFromOutOfMemory(this=<unavailable>) + 224 at jscntxt.cpp:1003, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=1, address=0x0)\n  * frame #0: 0x00000001004b9cf0 js-dbg-opt-64-dm-nsprBuild-darwin-5288b15d22de`js::ThreadSafeContext::recoverFromOutOfMemory(this=<unavailable>) + 224 at jscntxt.cpp:1003\n    frame #1: 0x00000001006ad396 js-dbg-opt-64-dm-nsprBuild-darwin-5288b15d22de`js::Shape::search(cx=<unavailable>, start=0x0000000101f76b50, pspp=<unavailable>, adding=<unavailable>, id=<unavailable>) + 278 at Shape-inl.h:137\n    frame #2: 0x0000000100654066 js-dbg-opt-64-dm-nsprBuild-darwin-5288b15d22de`js::NativeObject::lookup(this=<unavailable>, cx=0x0000000101c14af0, id=<unavailable>) + 54 at NativeObject.cpp:284\n    frame #3: 0x000000010067f782 js-dbg-opt-64-dm-nsprBuild-darwin-5288b15d22de`bool js::LookupOwnPropertyInline<(cx=0x0000000101c14af0, donep=0x00007fff5fbfea37, obj=<unavailable>, id=<unavailable>, objp=<unavailable>, propp=<unavailable>)1>(js::ExclusiveContext*, js::MaybeRooted<js::NativeObject*, (js::AllowGC)1>::HandleType, js::MaybeRooted<jsid, (js::AllowGC)1>::HandleType, js::MaybeRooted<JSObject*, (js::AllowGC)1>::MutableHandleType, js::MaybeRooted<js::Shape*, (js::AllowGC)1>::MutableHandleType, bool*) + 290 at NativeObject-inl.h:531\n    frame #4: 0x000000010067ba56 js-dbg-opt-64-dm-nsprBuild-darwin-5288b15d22de`bool js::LookupPropertyInline<(cx=0x0000000101c14af0, obj=<unavailable>, id=<unavailable>, objp=<unavailable>, propp=<unavailable>)1>(js::ExclusiveContext*, js::MaybeRooted<js::NativeObject*, (js::AllowGC)1>::HandleType, js::MaybeRooted<jsid, (js::AllowGC)1>::HandleType, js::MaybeRooted<JSObject*, (js::AllowGC)1>::MutableHandleType, js::MaybeRooted<js::Shape*, (js::AllowGC)1>::MutableHandleType) + 86 at NativeObject-inl.h:595\n(lldb)", "author": "nth10sd@gmail.com", "id": 9691505, "time": "2014-12-13T18:52:55Z"}, {"text": "Shape::hashify is calling ensureOwnBaseShape; which is calling js_NewGCBaseShape<NoGC>; since we're out of memory we fail the alloc; but since we're NoGC, we cannot run a GC to free up memory; we thus return false without setting an OOM error as we're not sure if we're OOM yet. In this case, it is the caller's responsibility to handle the OOM. But looking further, the behavior of ReportOutOfMemory and recoverFromOutOfMemory is nonsensical in many cases. So I think we want to hurry up with the static analysis and just delete the nonsensical bits in the meantime. They're basically only serving to give us nonsensical fuzz bugs like this at the moment. I'll get a patch up to do that shortly.", "author": "terrence.d.cole@gmail.com", "id": 9706992, "time": "2014-12-18T00:18:39Z"}, {"text": "Created attachment 8538170\nbug-1111245-v0.diff", "author": "terrence.d.cole@gmail.com", "id": 9707004, "time": "2014-12-18T00:23:27Z"}, {"text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/69814624bb02", "author": "terrence.d.cole@gmail.com", "id": 9763855, "time": "2015-01-07T17:03:22Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/69814624bb02", "author": "kwierso@gmail.com", "id": 9765900, "time": "2015-01-07T23:45:51Z"}], "cf_last_resolved": "2015-01-07T23:45:51Z", "priority": "--", "mentors_detail": [], "cf_crash_signature": "", "version": "Trunk", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox59": "---", "last_change_time": "2015-01-07T23:45:51Z", "cf_platform_rel": "---", "product": "Core", "cf_status_firefox_esr52": "---", "blocks": [349611, 1100132], "qa_contact": "", "see_also": [], "cf_fx_iteration": "---", "component": "JavaScript Engine: JIT", "votes": 0, "groups": [], "cf_status_firefox60": "---", "target_milestone": "mozilla37", "is_cc_accessible": true, "cf_status_thunderbird_esr52": "---", "url": "", "creator_detail": {"email": "nth10sd@gmail.com", "id": 132034, "name": "nth10sd@gmail.com", "real_name": "Gary Kwong [:gkw] [:nth10sd]"}, "whiteboard": "[jsbugmon:update]", "mentors": [], "cc_detail": [{"email": "choller@mozilla.com", "id": 395101, "name": "choller@mozilla.com", "real_name": "Christian Holler (:decoder)"}, {"email": "jorendorff@mozilla.com", "id": 281791, "name": "jorendorff@mozilla.com", "real_name": "Jason Orendorff [:jorendorff]"}, {"email": "jruderman@gmail.com", "id": 11608, "name": "jruderman@gmail.com", "real_name": "Jesse Ruderman"}, {"email": "terrence.d.cole@gmail.com", "id": 231770, "name": "terrence.d.cole@gmail.com", "real_name": "Terrence Cole [:terrence]"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "cf_tracking_firefox58": "---", "cf_rank": null, "is_open": false, "history": [{"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(terrence@mozilla.com)"}], "who": "nth10sd@gmail.com", "when": "2014-12-13T18:51:54Z"}, {"changes": [{"removed": "needinfo?(terrence@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "terrence.d.cole@gmail.com", "when": "2014-12-18T00:18:39Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "ASSIGNED"}, {"removed": "", "field_name": "cc", "added": "jorendorff@mozilla.com"}, {"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "terrence@mozilla.com"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8538170, "added": "review?(jorendorff@mozilla.com)"}], "who": "terrence.d.cole@gmail.com", "when": "2014-12-18T00:23:27Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(jorendorff@mozilla.com)", "attachment_id": 8538170, "added": "review+"}], "who": "jorendorff@mozilla.com", "when": "2015-01-05T18:25:56Z"}, {"changes": [{"removed": "ASSIGNED", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla37"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2015-01-07 15:45:51"}], "who": "kwierso@gmail.com", "when": "2015-01-07T23:45:51Z"}], "resolution": "FIXED", "op_sys": "Mac OS X", "cf_fx_points": "---", "cf_blocking_fennec": "---"}