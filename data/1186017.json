{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "attachments": [{"creator": "masayuki@d-toybox.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2015-07-24T05:39:16Z", "type_id": 4, "creation_date": "2015-07-23T09:46:11Z", "id": 1216364, "setter": "karlt@mozbugz.karlt.net"}, {"status": "+", "name": "review", "modification_date": "2015-07-23T12:09:23Z", "type_id": 4, "creation_date": "2015-07-23T09:46:11Z", "id": 1216365, "setter": "m_kato@ga2.so-net.ne.jp"}], "content_type": "text/plain", "id": 8637793}, {"creator": "masayuki@d-toybox.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2015-07-26T20:44:15Z", "type_id": 4, "creation_date": "2015-07-24T07:17:00Z", "id": 1217234, "setter": "karlt@mozbugz.karlt.net"}], "content_type": "text/plain", "id": 8638392}], "classification": "Components", "creator": "masayuki@d-toybox.com", "cc": ["karlt@mozbugz.karlt.net", "masayuki@d-toybox.com", "m_kato@ga2.so-net.ne.jp"], "depends_on": [], "creation_time": "2015-07-21T14:48:07Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "x86", "cf_status_firefox58": "---", "cf_status_firefox59": "---", "keywords": ["inputmethod"], "summary": "[GTK] nsGtkIMModule should be renamed to mozilla::widget::IMContextWrapper", "id": 1186017, "assigned_to_detail": {"email": "masayuki@d-toybox.com", "id": 34283, "name": "masayuki@d-toybox.com", "real_name": "Masayuki Nakano [:masayuki] (JST, +0900)"}, "severity": "enhancement", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "assigned_to": "masayuki@d-toybox.com", "comment_count": 15, "comments": [{"text": "I think that nsGtkIMModule should be renamed to mozilla::widget::IMContextWrapper or something. It seems that \"Gtk\" is redundant and ending with \"Module\" isn't clear what it does. Currently, we're using a class named KeymapWrapper for handling keyboard event. Therefore, I think that IMContextWrapper is better name in widget/gtk/.\n\nIf you have better idea, let me know.", "author": "masayuki@d-toybox.com", "id": 10519222, "time": "2015-07-21T14:48:07Z"}, {"text": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=43656f38827e", "author": "masayuki@d-toybox.com", "id": 10528286, "time": "2015-07-23T07:11:18Z"}, {"text": "Created attachment 8637793\nRename nsGtkIMModule to mozilla::widget::IMContextWrapper\n\nRenaming widget/gtk/nsGtkIMModule.* -> widget/gtk/IMContextWrapper.*\n\nReplacing:\n\nnsGtkIMModule -> (mozilla::widget::)IMContextWrapper\n\"GtkIMModule(%p):\" in the logs -> \"GTKIM: %p \"\nsLastFocusedModule -> sLastFocusedContext\n\nAnd improving some log text.", "author": "masayuki@d-toybox.com", "id": 10528666, "time": "2015-07-23T09:46:11Z"}, {"text": "Ah, and also:\n\nFoo *aBar or Foo &aBar -> Foo* aBar or Foo& aBar", "author": "masayuki@d-toybox.com", "id": 10528670, "time": "2015-07-23T09:47:29Z"}, {"text": "Comment on attachment 8637793\nRename nsGtkIMModule to mozilla::widget::IMContextWrapper\n\n>+    'IMContextWrapper.cpp', # methods for logging conflict with other files\n>+    'nsGtkKeyUtils.cpp', # methods for logging conflict with other files\n\nWhich methods are these?\nIs this conflict caused by the rename or namespace change?\n\nPeople spent some time making unified sources work, so I don't want to revert that.  If you can find a solution there, then the rest is good.", "author": "karlt@mozbugz.karlt.net", "id": 10532143, "time": "2015-07-23T23:30:06Z"}, {"text": "Comment on attachment 8637793\nRename nsGtkIMModule to mozilla::widget::IMContextWrapper\n\nI filed bug 1186821 for that.\n\nIf you think that we should keep unifiedable forcibly, I can move them into different namespace temporarily. Do you want that?", "author": "masayuki@d-toybox.com", "id": 10532361, "time": "2015-07-24T00:57:40Z"}, {"text": "> Which methods are these?\n\nE.g., GetBoolName().\n\n> Is this conflict caused by the rename or namespace change?\n\nYes. They are not in same namespace.", "author": "masayuki@d-toybox.com", "id": 10532363, "time": "2015-07-24T00:58:28Z"}, {"text": "Would static inline GetBoolName() resolve the problem until a common location can be found for the function?  Each definition would need to be the same.", "author": "karlt@mozbugz.karlt.net", "id": 10532448, "time": "2015-07-24T01:38:18Z"}, {"text": "(In reply to Karl Tomlinson (ni?:karlt) from comment #7)\n> Would static inline GetBoolName() resolve the problem until a common\n> location can be found for the function?\n\nUnfortunately, no.\n\n> Each definition would need to be the same.\n\nYes, of course.\n\nAnd I tried with like using namespace hack:\n\nnamespace mozilla {\nnamespace widget {\n\nnamespace keymapwrappehelper {\n\n} // namespace keymapwrappehelper\n\nusing namespace keymapwrappehelper;\n\n} // namespace widget\n} // namespace mozilla\n\nnamespace mozilla {\nnamespace widget {\n\nnamespace imcontextwrapperhelper {\n\n} // namespace imcontextwrapperhelper \n\nusing namespace imcontextwrapperhelper;\n\n} // namespace widget\n} // namespace mozilla\n\nHowever, gcc doesn't stop |using namespace keymapwrappehelper;| when widget namespace is closed. So, in IMContextWrapper.cpp, |using namespace keymapwrappehelper;| is alive :-(\n\nCurrently, the only GetBoolName() conflicts. Perhaps, giving different name is better solution for now. How about you?", "author": "masayuki@d-toybox.com", "id": 10532698, "time": "2015-07-24T03:22:31Z"}, {"text": "Comment on attachment 8637793\nRename nsGtkIMModule to mozilla::widget::IMContextWrapper\n\nI don't know what the right solution is.\nPerhaps something like WidgetUtils.cpp would be OK.\n\nOther options like macros and renaming will probably just make this harder to move later, so let's go with this for now, but can you move one of the files, probably nsGtkKeyUtils because that is not changed significantly in this patch, back into UNIFIED_SOURCES please?", "author": "karlt@mozbugz.karlt.net", "id": 10532927, "time": "2015-07-24T05:39:16Z"}, {"text": "Created attachment 8638392\npart.2 Rename GetBoolName() in IMContextWrapper.cpp to ToChar()\n\ntemporarily, how about this?", "author": "masayuki@d-toybox.com", "id": 10533245, "time": "2015-07-24T07:17:00Z"}, {"text": "Comment on attachment 8638392\npart.2 Rename GetBoolName() in IMContextWrapper.cpp to ToChar()\n\nI don't mind if you want to do this for now, assuming you intend to find a suitable place to put these common utilities before adding more copies of the same function, but I'm not sure it is worth it.  Please ensure you have read and considered comment 9.\n\n>-static const char*\n>-GetBoolName(bool aBool)\n>+static inline const char*\n>+ToChar(bool aBool)", "author": "karlt@mozbugz.karlt.net", "id": 10538294, "time": "2015-07-26T20:44:15Z"}, {"text": "> Please ensure you have read and considered comment 9.\n\nYeah, of course. I don't like to use macro because if it will need to create a class derived from nsAutoCString, it's impossible. And I don't mind to rename the method for now because it's better for reducing build time.", "author": "masayuki@d-toybox.com", "id": 10538389, "time": "2015-07-26T23:18:17Z"}, {"text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/3e83a54b7fd2\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/58e46bf71dd1", "author": "pulsebot@bots.tld", "id": 10538397, "time": "2015-07-26T23:24:02Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/3e83a54b7fd2\nhttps://hg.mozilla.org/mozilla-central/rev/58e46bf71dd1", "author": "ryanvm@gmail.com", "id": 10540374, "time": "2015-07-27T14:20:03Z"}], "cf_last_resolved": "2015-07-27T14:20:03Z", "priority": "--", "mentors_detail": [], "cf_crash_signature": "", "version": "Trunk", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox59": "---", "last_change_time": "2015-07-27T14:20:03Z", "cf_platform_rel": "---", "product": "Core", "cf_status_firefox_esr52": "---", "blocks": [], "qa_contact": "", "see_also": [], "cf_fx_iteration": "---", "component": "Widget: Gtk", "votes": 0, "groups": [], "cf_status_firefox60": "---", "cf_status_firefox41": "---", "target_milestone": "mozilla42", "is_cc_accessible": true, "cf_status_thunderbird_esr52": "---", "url": "", "creator_detail": {"email": "masayuki@d-toybox.com", "id": 34283, "name": "masayuki@d-toybox.com", "real_name": "Masayuki Nakano [:masayuki] (JST, +0900)"}, "whiteboard": "", "mentors": [], "cc_detail": [{"email": "karlt@mozbugz.karlt.net", "id": 274246, "name": "karlt@mozbugz.karlt.net", "real_name": "Karl Tomlinson (:karlt)"}, {"email": "masayuki@d-toybox.com", "id": 34283, "name": "masayuki@d-toybox.com", "real_name": "Masayuki Nakano [:masayuki] (JST, +0900)"}, {"email": "m_kato@ga2.so-net.ne.jp", "id": 8636, "name": "m_kato@ga2.so-net.ne.jp", "real_name": "Makoto Kato [:m_kato]"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "cf_tracking_firefox58": "---", "cf_rank": null, "is_open": false, "history": [{"changes": [{"removed": "[GTK] nsGtkIMModule should be renamed to mozilla::widget::IMModuleHandler", "field_name": "summary", "added": "[GTK] nsGtkIMModule should be renamed to mozilla::widget::IMContextWrapper"}], "who": "masayuki@d-toybox.com", "when": "2015-07-23T04:34:14Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8637793, "added": "review?(karlt@mozbugz.karlt.net), review?(m_kato@ga2.so-net.ne.jp)"}], "who": "masayuki@d-toybox.com", "when": "2015-07-23T09:46:11Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(m_kato@ga2.so-net.ne.jp)", "attachment_id": 8637793, "added": "review+"}], "who": "m_kato@ga2.so-net.ne.jp", "when": "2015-07-23T12:09:23Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "masayuki@d-toybox.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(masayuki@d-toybox.com)"}, {"field_name": "flagtypes.name", "removed": "review?(karlt@mozbugz.karlt.net)", "attachment_id": 8637793, "added": "review-"}], "who": "karlt@mozbugz.karlt.net", "when": "2015-07-23T23:30:06Z"}, {"changes": [{"removed": "needinfo?(masayuki@d-toybox.com)", "field_name": "flagtypes.name", "added": "needinfo?(karlt@mozbugz.karlt.net)"}], "who": "masayuki@d-toybox.com", "when": "2015-07-24T00:57:40Z"}, {"changes": [{"removed": "needinfo?(karlt@mozbugz.karlt.net)", "field_name": "flagtypes.name", "added": "needinfo?(masayuki@d-toybox.com)"}], "who": "karlt@mozbugz.karlt.net", "when": "2015-07-24T01:38:18Z"}, {"changes": [{"removed": "needinfo?(masayuki@d-toybox.com)", "field_name": "flagtypes.name", "added": "needinfo?(karlt@mozbugz.karlt.net)"}], "who": "masayuki@d-toybox.com", "when": "2015-07-24T03:22:31Z"}, {"changes": [{"removed": "needinfo?(karlt@mozbugz.karlt.net)", "field_name": "flagtypes.name", "added": ""}, {"field_name": "flagtypes.name", "removed": "review-", "attachment_id": 8637793, "added": "review+"}], "who": "karlt@mozbugz.karlt.net", "when": "2015-07-24T05:39:16Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8638392, "added": "review?(karlt@mozbugz.karlt.net)"}], "who": "masayuki@d-toybox.com", "when": "2015-07-24T07:17:00Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(karlt@mozbugz.karlt.net)", "attachment_id": 8638392, "added": "review+"}], "who": "karlt@mozbugz.karlt.net", "when": "2015-07-26T20:44:15Z"}, {"changes": [{"removed": "ASSIGNED", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla42"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2015-07-27 07:20:03"}, {"removed": "affected", "field_name": "cf_status_firefox42", "added": "fixed"}], "who": "ryanvm@gmail.com", "when": "2015-07-27T14:20:03Z"}], "resolution": "FIXED", "op_sys": "Linux", "cf_fx_points": "---", "cf_blocking_fennec": "---"}