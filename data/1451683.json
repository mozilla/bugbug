{"cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "classification": "Components", "creator": "felash@gmail.com", "mentors_detail": [], "depends_on": [], "creation_time": "2018-04-05T10:03:13Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "keywords": ["regression"], "summary": "The \"resizing\" cursor isn't changed back to a normal cursor after resizing the subpanel", "cf_last_resolved": "2018-05-09T17:29:16Z", "attachments": [{"creator": "pbrosset@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2018-05-09T08:24:59Z", "type_id": 748, "creation_date": "2018-05-04T15:30:05Z", "id": 1752800, "setter": "mratcliffe@mozilla.com"}, {"status": "+", "name": "approval-mozilla-beta", "modification_date": "2018-05-14T12:46:31Z", "type_id": 721, "creation_date": "2018-05-14T07:38:07Z", "id": 1756266, "setter": "ryanvm@gmail.com"}], "content_type": "text/x-review-board-request", "id": 8973245}], "assigned_to_detail": {"email": "pbrosset@mozilla.com", "id": 478661, "name": "pbrosset@mozilla.com", "real_name": "Patrick Brosset <:pbro>"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "comments": [{"text": "STR:\n1. Open the inspector on any page.\n2. Resize the sidebar.\n\n=> Observe the cursor isn't back to normal when hovering empty spaces in the sidebar.\nThis is especially visible with the Layout or Font subpanels because there are no elements overriding the cursor in these panels.", "author": "felash@gmail.com", "id": 13182576, "time": "2018-04-05T10:03:13Z"}, {"text": "See also: bug 1451666. This issue was fixed for the animations tab, but the others tabs still reproduce the issue.", "author": "daniel.bodea@softvision.ro", "id": 13237927, "time": "2018-04-27T11:26:22Z"}, {"text": "Looks like this was fixed in the animation tab by forcing the default cursor there, but really I think the fix would be to find the root cause for this and fix it there.\nMy fut feeling so far is that this has to do with the SplitBox.js component:\n\n  onStartMove() {\n    const splitBox = ReactDOM.findDOMNode(this);\n    const doc = splitBox.ownerDocument;\n    let defaultCursor = doc.documentElement.style.cursor;\n    doc.documentElement.style.cursor = (this.state.vert ? \"ew-resize\" : \"ns-resize\");\n\n    splitBox.classList.add(\"dragging\");\n\n    this.setState({\n      defaultCursor: defaultCursor\n    });\n  }\n\nSomehow, it probably never resets the right cursor when the user stops moving.", "author": "pbrosset@mozilla.com", "id": 13252338, "time": "2018-05-03T15:19:43Z"}, {"text": "Looks like this is called twice in a row. The first time the code remembers the cursor (the default), then changes it to ew-resize (or ns-resize). But then the function gets called again for some reason, and that ends up storing ew-resize as the default cursor.", "author": "pbrosset@mozilla.com", "id": 13252366, "time": "2018-05-03T15:27:20Z"}, {"text": "I don't know why this is called twice. The caller is mousedown event listener in devtools/client/shared/components/splitter/Draggable.js.\nIf I log from that handler, I can see the log twice, with the same event target DOM element.\n\nSo just adding some local state like this.isDragging and setting it to true after the event listener was called the first time will fix the issue.\n\nIt would be nice to know when this started. I can reproduce it in Firefox 60 but not in 59. I may attempt to run mozregression to see if there is a better solution.", "author": "pbrosset@mozilla.com", "id": 13254647, "time": "2018-05-04T13:56:11Z"}, {"text": "Mozregression says:\n\nLast good revision: ff4c0d600d07c9a5e0fe503a326db767962ea052\nFirst bad revision: d17b9126dca6bb1f04a9bc454367159c7c10c861\nPushlog:\nhttps://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=ff4c0d600d07c9a5e0fe503a326db767962ea052&tochange=d17b9126dca6bb1f04a9bc454367159c7c10c861\n\nWhich means this was regressed by bug 1420130, which is related to when we migrated to React 16.", "author": "pbrosset@mozilla.com", "id": 13254721, "time": "2018-05-04T14:26:03Z"}, {"text": "I talked to Mike Ratcliffe who said this is a XUL-related bug that would need to be fixed. Bug 1342297 I believe.\nIn the meantime, doing the fix described in comment 4 would work.", "author": "pbrosset@mozilla.com", "id": 13254872, "time": "2018-05-04T15:11:18Z"}, {"text": "Created attachment 8973245\nBug 1451683 - Avoid reacting to mousedown twice in a row when starting to drag the splitter;\n\nReview commit: https://reviewboard.mozilla.org/r/241722/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/241722/", "author": "pbrosset@mozilla.com", "id": 13254935, "time": "2018-05-04T15:30:05Z"}, {"text": "Comment on attachment 8973245\nBug 1451683 - Avoid reacting to mousedown twice in a row when starting to drag the splitter;\n\nhttps://reviewboard.mozilla.org/r/241722/#review248458", "author": "mratcliffe@mozilla.com", "id": 13264675, "time": "2018-05-09T08:24:59Z"}, {"text": "Thanks Mike.\nTry push: https://treeherder.mozilla.org/#/jobs?repo=try&revision=52e03668baa3b17e2cbbaa24d91a345c703f2f54\nLanding this now in 62.\nI'll request uplift to 61 later.", "author": "pbrosset@mozilla.com", "id": 13264731, "time": "2018-05-09T08:48:51Z"}, {"text": "It would be great if someone could verify the fix once it's in nightly.", "author": "pbrosset@mozilla.com", "id": 13264737, "time": "2018-05-09T08:50:17Z"}, {"text": "Pushed by pbrosset@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/3024ee56e9db\nAvoid reacting to mousedown twice in a row when starting to drag the splitter; r=miker", "author": "pulsebot@bots.tld", "id": 13264738, "time": "2018-05-09T08:50:32Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/3024ee56e9db", "author": "csabou@mozilla.com", "id": 13266044, "time": "2018-05-09T17:29:16Z"}, {"text": "Hi,\n\nI have verified this fix on Windows 10 x64, Linux 16.04 LTS x64 and Mac OS X 10.12.6.\nThe described issue could not be reproduced anymore on any of the OSes.\nVerified fix in target version 62.", "author": "daniel.bodea@softvision.ro", "id": 13267701, "time": "2018-05-10T09:22:08Z"}, {"text": "Please request Beta approval on this. It grafts cleanly as-landed.", "author": "ryanvm@gmail.com", "id": 13269866, "time": "2018-05-11T02:42:33Z"}, {"text": "Comment on attachment 8973245\nBug 1451683 - Avoid reacting to mousedown twice in a row when starting to drag the splitter;\n\nApproval Request Comment\n[Feature/Bug causing the regression]: 1420130\n[User impact if declined]: If declined, users of the inspector panel in DevTools may see a resizing mouse cursor rather than a default mouse cursor, in some situations.\n[Is this code covered by automated tests?]: No, this does not impact DevTools itself apart from the cursor being stuck to the resizing icon, so I didn't add a test for this.\n[Has the fix been verified in Nightly?]: Yes.\n[Needs manual test from QE? If yes, steps to reproduce]: Already tested and verified in nightly, I don't think we need to test again in beta. The fix was made to a piece of code that hasn't changed between those 2 channels.\n[List of other uplifts needed for the feature/fix]: None\n[Is the change risky?]: No.\n[Why is the change risky/not risky?]: Very self-contained fix, to just one DevTools module. Only impacts the mouse cursor.\n[String changes made/needed]: None", "author": "pbrosset@mozilla.com", "id": 13274943, "time": "2018-05-14T07:38:07Z"}, {"text": "(In reply to Patrick Brosset <:pbro> from comment #10)\n> It would be great if someone could verify the fix once it's in nightly.\n\nThe original issue I had is fixed in latest nightly.\nThanks a lot !", "author": "felash@gmail.com", "id": 13275364, "time": "2018-05-14T10:45:09Z"}, {"text": "Comment on attachment 8973245\nBug 1451683 - Avoid reacting to mousedown twice in a row when starting to drag the splitter;\n\nAvoid situations where we sometimes end up with the wrong mouse cursor while using devtools. Approved for 61.0b5.", "author": "ryanvm@gmail.com", "id": 13275519, "time": "2018-05-14T12:46:31Z"}, {"text": "https://hg.mozilla.org/releases/mozilla-beta/rev/983cb96d1a3a", "author": "ryanvm@gmail.com", "id": 13275551, "time": "2018-05-14T12:54:05Z"}, {"text": "I reproduced this issue using Fx 61.0a1 (2018-04-05) on Windows 10 x64.\nI can confirm this issue is fixed, I verified using Fx 61.0b5 on Windows 10 x64, mac OS 10.12.6 and Ubuntu 14.04 LTS.", "author": "cristian.comorasu@softvision.ro", "id": 13280825, "time": "2018-05-16T08:32:15Z"}, {"text": "*** Bug 1452612 has been marked as a duplicate of this bug. ***", "author": "pbrosset@mozilla.com", "id": 13369090, "time": "2018-05-28T13:35:24Z"}], "id": 1451683, "priority": "P3", "platform": "Unspecified", "comment_count": 21, "version": "unspecified", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox62": "---", "status": "VERIFIED", "product": "DevTools", "cf_fx_iteration": "---", "blocks": [1420130], "qa_contact": "", "see_also": ["https://bugzilla.mozilla.org/show_bug.cgi?id=1451666"], "cf_status_firefox_esr52": "unaffected", "component": "Inspector", "votes": 0, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "verified", "cf_status_firefox61": "verified", "cf_status_firefox60": "wontfix", "target_milestone": "Firefox 62", "cc": ["cristian.comorasu@softvision.ro", "daniel.bodea@softvision.ro", "mcastelluccio@mozilla.com", "mratcliffe@mozilla.com", "nachtigall@web.de", "pbrosset@mozilla.com", "ryanvm@gmail.com"], "groups": [], "url": "", "creator_detail": {"email": "felash@gmail.com", "id": 364883, "name": "felash@gmail.com", "real_name": "Julien Wajsberg [:julienw]"}, "whiteboard": "", "mentors": [], "cc_detail": [{"email": "cristian.comorasu@softvision.ro", "id": 572409, "name": "cristian.comorasu@softvision.ro", "real_name": "Cristian Comorasu [:ccomorasu], Release Desktop QA"}, {"email": "daniel.bodea@softvision.ro", "id": 616104, "name": "daniel.bodea@softvision.ro", "real_name": "Bodea Daniel"}, {"email": "mcastelluccio@mozilla.com", "id": 420453, "name": "mcastelluccio@mozilla.com", "real_name": "Marco Castelluccio [:marco]"}, {"email": "mratcliffe@mozilla.com", "id": 313697, "name": "mratcliffe@mozilla.com", "real_name": "Mike Ratcliffe [:miker] [:mratcliffe] [:mikeratcliffe]"}, {"email": "nachtigall@web.de", "id": 81675, "name": "nachtigall@web.de", "real_name": "Jens"}, {"email": "pbrosset@mozilla.com", "id": 478661, "name": "pbrosset@mozilla.com", "real_name": "Patrick Brosset <:pbro>"}, {"email": "ryanvm@gmail.com", "id": 75935, "name": "ryanvm@gmail.com", "real_name": "Ryan VanderMeulen [:RyanVM]"}], "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-06-13T17:27:05Z", "cf_status_firefox_esr60": "wontfix", "assigned_to": "pbrosset@mozilla.com", "is_open": false, "cf_qa_whiteboard": "", "resolution": "FIXED", "op_sys": "Unspecified", "cf_fx_points": "---", "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "daniel.bodea@softvision.ro"}], "who": "daniel.bodea@softvision.ro", "when": "2018-04-27T11:26:22Z"}, {"changes": [{"removed": "", "field_name": "see_also", "added": "https://bugzilla.mozilla.org/show_bug.cgi?id=1451666"}], "who": "felash@gmail.com", "when": "2018-05-02T16:28:26Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "pbrosset@mozilla.com"}], "who": "pbrosset@mozilla.com", "when": "2018-05-03T15:19:43Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1420130"}], "who": "pbrosset@mozilla.com", "when": "2018-05-04T14:26:03Z"}, {"changes": [{"removed": "--", "field_name": "priority", "added": "P3"}, {"removed": "NEW", "field_name": "status", "added": "ASSIGNED"}, {"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "pbrosset@mozilla.com"}], "who": "pbrosset@mozilla.com", "when": "2018-05-04T15:12:52Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8973245, "added": "review?(mratcliffe@mozilla.com)"}, {"removed": "", "field_name": "cc", "added": "mratcliffe@mozilla.com"}], "who": "pbrosset@mozilla.com", "when": "2018-05-04T15:30:05Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "regression"}, {"removed": "", "field_name": "cc", "added": "mcastelluccio@mozilla.com"}], "who": "mcastelluccio@mozilla.com", "when": "2018-05-07T18:36:49Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(mratcliffe@mozilla.com)", "attachment_id": 8973245, "added": "review+"}], "who": "mratcliffe@mozilla.com", "when": "2018-05-09T08:24:59Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "qe-verify+"}], "who": "pbrosset@mozilla.com", "when": "2018-05-09T08:50:17Z"}, {"changes": [{"removed": "ASSIGNED", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "Firefox 62"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2018-05-09 17:29:16"}, {"removed": "---", "field_name": "cf_status_firefox62", "added": "fixed"}], "who": "csabou@mozilla.com", "when": "2018-05-09T17:29:16Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "ryanvm@gmail.com"}, {"removed": "---", "field_name": "cf_status_firefox_esr52", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_firefox_esr60", "added": "wontfix"}, {"removed": "---", "field_name": "cf_status_firefox60", "added": "wontfix"}, {"removed": "---", "field_name": "cf_status_firefox61", "added": "affected"}], "who": "ryanvm@gmail.com", "when": "2018-05-10T01:21:37Z"}, {"changes": [{"removed": "RESOLVED", "field_name": "status", "added": "VERIFIED"}, {"removed": "fixed", "field_name": "cf_status_firefox62", "added": "verified"}], "who": "daniel.bodea@softvision.ro", "when": "2018-05-10T09:22:08Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(pbrosset@mozilla.com)"}], "who": "ryanvm@gmail.com", "when": "2018-05-11T02:42:33Z"}, {"changes": [{"removed": "needinfo?(pbrosset@mozilla.com)", "field_name": "flagtypes.name", "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8973245, "added": "approval-mozilla-beta?"}], "who": "pbrosset@mozilla.com", "when": "2018-05-14T07:38:07Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "approval-mozilla-beta?", "attachment_id": 8973245, "added": "approval-mozilla-beta+"}], "who": "ryanvm@gmail.com", "when": "2018-05-14T12:46:31Z"}, {"changes": [{"removed": "affected", "field_name": "cf_status_firefox61", "added": "fixed"}], "who": "ryanvm@gmail.com", "when": "2018-05-14T12:54:05Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "cristian.comorasu@softvision.ro"}, {"removed": "qe-verify+", "field_name": "flagtypes.name", "added": ""}, {"removed": "fixed", "field_name": "cf_status_firefox61", "added": "verified"}], "who": "cristian.comorasu@softvision.ro", "when": "2018-05-16T08:32:15Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "nachtigall@web.de"}], "who": "pbrosset@mozilla.com", "when": "2018-05-28T13:35:24Z"}, {"changes": [{"removed": "Firefox", "field_name": "product", "added": "DevTools"}], "who": "automation@bmo.tld", "when": "2018-06-13T17:27:05Z"}]}