{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "+", "cf_tracking_firefox62": "---", "creator": "cdenizet@mozilla.com", "mentors_detail": [], "depends_on": [], "cf_status_firefox_esr60": "unaffected", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "cf_status_firefox59": "unaffected", "keywords": ["crash", "regression"], "cc_detail": [{"email": "nical.bugzilla@gmail.com", "id": 438998, "name": "nical.bugzilla@gmail.com", "real_name": "Nicolas Silva [:nical]"}, {"email": "rhunt@eqrion.net", "id": 573202, "name": "rhunt@eqrion.net", "real_name": "Ryan Hunt [:rhunt]"}, {"email": "ryanvm@gmail.com", "id": 75935, "name": "ryanvm@gmail.com", "real_name": "Ryan VanderMeulen [:RyanVM]"}], "cf_last_resolved": "2018-05-03T21:59:27Z", "attachments": [{"creator": "rhunt@eqrion.net", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2018-05-03T11:34:45Z", "type_id": 4, "creation_date": "2018-05-02T14:24:33Z", "id": 1751667, "setter": "nical.bugzilla@gmail.com"}], "content_type": "text/x-review-board-request", "id": 8972585}], "votes": 0, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 6, "comments": [{"text": "This bug was filed from the Socorro interface and is\nreport bp-4f6a5639-e03f-43de-a793-6b2760180501.\n=============================================================\n\nTop 10 frames of crashing thread:\n\n0 xul.dll mozilla::layers::PaintThread::PaintTiledContents gfx/layers/PaintThread.cpp:381\n1 xul.dll mozilla::layers::ClientSingleTiledLayerBuffer::PaintThebes gfx/layers/client/SingleTiledContentClient.cpp:312\n2 xul.dll mozilla::layers::ClientTiledPaintedLayer::RenderHighPrecision gfx/layers/client/ClientTiledPaintedLayer.cpp:353\n3 xul.dll mozilla::layers::ClientTiledPaintedLayer::RenderLayer gfx/layers/client/ClientTiledPaintedLayer.cpp:555\n4 xul.dll mozilla::layers::ClientContainerLayer::RenderLayer gfx/layers/client/ClientContainerLayer.h:58\n5 xul.dll mozilla::layers::ClientContainerLayer::RenderLayer gfx/layers/client/ClientContainerLayer.h:58\n6 xul.dll mozilla::layers::ClientLayerManager::EndTransactionInternal gfx/layers/client/ClientLayerManager.cpp:359\n7 xul.dll mozilla::layers::ClientLayerManager::EndTransaction gfx/layers/client/ClientLayerManager.cpp:423\n8 xul.dll nsDisplayList::PaintRoot layout/painting/nsDisplayList.cpp:2761\n9 xul.dll nsLayoutUtils::PaintFrame layout/base/nsLayoutUtils.cpp:3827\n\n=============================================================\n\nThere are 48 crashes (from 21 installations) in nightly 61 starting with buildid 20180501102731. In analyzing the backtrace, the regression may have been introduced by patch [1] to fix bug 1454978.\n\n[1] https://hg.mozilla.org/mozilla-central/rev?node=2ba500ed529b", "author": "cdenizet@mozilla.com", "id": 13247966, "time": "2018-05-02T08:02:19Z"}, {"text": "Created attachment 8972585\nBug 1458462 - Create paint workers if it's possible we could switch to tiling in the future.\n\nOn windows it's possible for us to fallback from D2D to Skia rendering at any time due to a device reset.\nIf this happens with `enable-tiles-if-skia-pomtp` enabled we could begin to use tiling. This can cause a\ncrash if we never created the worker threads because at initialization time we weren't using tiling.\n\nAnother way to fix this would be to dynamically create the worker threads in UpdateRenderMode if we\nhave switched to skia. That's a larger change and more might be required, so I'd rather just fix the\ncrash for now.\n\nThis commit also fixes a pref that should be `Once` instead of `Live`.\n\nReview commit: https://reviewboard.mozilla.org/r/241150/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/241150/", "author": "rhunt@eqrion.net", "id": 13248739, "time": "2018-05-02T14:24:33Z"}, {"text": "My guess is this is caused by us not creating the paint workers at startup because the conditions for using tiling are not met, and then it dynamically changes with a device reset or something. The attached patch should make sure in cases we can dynamically switch, we have created the paint worker threads.", "author": "rhunt@eqrion.net", "id": 13248823, "time": "2018-05-02T14:47:45Z"}, {"text": "Comment on attachment 8972585\nBug 1458462 - Create paint workers if it's possible we could switch to tiling in the future.\n\nhttps://reviewboard.mozilla.org/r/241150/#review247212", "author": "nical.bugzilla@gmail.com", "id": 13251735, "time": "2018-05-03T11:34:45Z"}, {"text": "Pushed by rhunt@eqrion.net:\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/895146c6b6bc\nCreate paint workers if it's possible we could switch to tiling in the future. r=nical", "author": "pulsebot@bots.tld", "id": 13252095, "time": "2018-05-03T14:15:01Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/895146c6b6bc", "author": "aciure@mozilla.com", "id": 13253467, "time": "2018-05-03T21:59:27Z"}], "id": 1458462, "priority": "--", "cc": ["nical.bugzilla@gmail.com", "rhunt@eqrion.net", "ryanvm@gmail.com"], "cf_crash_signature": "[@ mozilla::layers::PaintThread::PaintTiledContents]", "version": "Trunk", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_thunderbird_esr60": "---", "cf_platform_rel": "---", "product": "Core", "cf_fx_iteration": "---", "blocks": [1396527, 1454978], "qa_contact": "", "creation_time": "2018-05-02T08:02:19Z", "cf_status_firefox_esr52": "unaffected", "component": "Graphics: Layers", "assigned_to_detail": {"email": "rhunt@eqrion.net", "id": 573202, "name": "rhunt@eqrion.net", "real_name": "Ryan Hunt [:rhunt]"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "fixed", "cf_status_firefox60": "unaffected", "target_milestone": "mozilla61", "cf_rank": null, "cf_qa_whiteboard": "", "severity": "critical", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "cdenizet@mozilla.com", "id": 560431, "name": "cdenizet@mozilla.com", "real_name": "Calixte Denizet (:calixte)"}, "whiteboard": "", "mentors": [], "summary": "Crash in mozilla::layers::PaintThread::PaintTiledContents", "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-05-03T21:59:27Z", "assigned_to": "rhunt@eqrion.net", "is_open": false, "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "rhunt@eqrion.net"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(rhunt@eqrion.net)"}], "who": "cdenizet@mozilla.com", "when": "2018-05-02T08:02:19Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "ryanvm@gmail.com"}, {"removed": "---", "field_name": "cf_status_firefox_esr60", "added": "unaffected"}, {"removed": "---", "field_name": "cf_tracking_firefox61", "added": "+"}], "who": "ryanvm@gmail.com", "when": "2018-05-02T12:53:42Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8972585, "added": "review?(nical.bugzilla@gmail.com)"}, {"removed": "", "field_name": "cc", "added": "nical.bugzilla@gmail.com"}], "who": "rhunt@eqrion.net", "when": "2018-05-02T14:24:33Z"}, {"changes": [{"removed": "needinfo?(rhunt@eqrion.net)", "field_name": "flagtypes.name", "added": ""}], "who": "rhunt@eqrion.net", "when": "2018-05-02T14:47:45Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(nical.bugzilla@gmail.com)", "attachment_id": 8972585, "added": "review+"}], "who": "nical.bugzilla@gmail.com", "when": "2018-05-03T11:34:45Z"}, {"changes": [{"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "rhunt@eqrion.net"}], "who": "rhunt@eqrion.net", "when": "2018-05-03T14:10:51Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla61"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2018-05-03 21:59:27"}, {"removed": "affected", "field_name": "cf_status_firefox61", "added": "fixed"}], "who": "aciure@mozilla.com", "when": "2018-05-03T21:59:27Z"}], "resolution": "FIXED", "op_sys": "Windows 10", "cf_fx_points": "---", "cf_blocking_fennec": "---"}