{"cf_tracking_thunderbird_esr52": "---", "status": "VERIFIED", "cf_tracking_firefox60": "---", "attachments": [{"creator": "bugmail@mozilla.staktrace.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2016-07-12T20:14:00Z", "type_id": 4, "creation_date": "2016-07-06T13:31:35Z", "id": 1419220, "setter": "mstange@themasta.com"}, {"status": "+", "name": "approval-mozilla-aurora", "modification_date": "2016-07-15T15:50:02Z", "type_id": 720, "creation_date": "2016-07-14T19:41:05Z", "id": 1423798, "setter": "gchang@mozilla.com"}, {"status": "+", "name": "approval-mozilla-beta", "modification_date": "2016-07-15T15:50:02Z", "type_id": 721, "creation_date": "2016-07-14T19:41:05Z", "id": 1423799, "setter": "gchang@mozilla.com"}], "content_type": "text/x-review-board-request", "id": 8768387}, {"creator": "petruta.rasa@softvision.ro", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 8772824}], "classification": "Components", "creator": "bugmail@mozilla.staktrace.com", "mentors_detail": [], "depends_on": [], "cf_has_str": "---", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "cf_status_firefox58": "---", "cf_status_firefox59": "---", "keywords": [], "summary": "Disable paint-skipping for elements with the CSS clip property", "cf_last_resolved": "2016-07-14T09:48:26Z", "cf_status_firefox50": "verified", "votes": 0, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 18, "comments": [{"text": "The CSS clip and clip-path properties are not properly supported with APZ - the compositor doesn't move the clip properly during async scroll. Instead, it relies on main-thread repaints to update the clip to the right place. However, with paint-skipping, the observed behaviour got a lot worse because we don't paint nearly as often. We should disable paint-skipping when we run into clip or clip-path properties to avoid this problem. Bug 1214146 tracks fixing this more correctly, but this bug has a patch to disable paint-skipping for clip CSS properties.", "author": "bugmail@mozilla.staktrace.com", "id": 11524256, "time": "2016-07-05T18:13:09Z"}, {"text": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=b37d6b477782", "author": "bugmail@mozilla.staktrace.com", "id": 11524307, "time": "2016-07-05T18:25:08Z"}, {"text": "Created attachment 8768387\nBug 1284586 - Disable paint-skipping for scrollframes that we detect as having a CSS-clipped descendant.\n\nReview commit: https://reviewboard.mozilla.org/r/62656/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/62656/", "author": "bugmail@mozilla.staktrace.com", "id": 11527193, "time": "2016-07-06T13:31:35Z"}, {"text": "Comment on attachment 8768387\nBug 1284586 - Disable paint-skipping for scrollframes that we detect as having a CSS-clipped descendant.\n\nhttps://reviewboard.mozilla.org/r/62656/#review60782\n\n::: layout/base/DisplayListClipState.h:185\n(Diff revision 1)\n>     */\n>    const DisplayItemScrollClip* mScrollClipContentDescendants;\n>    const DisplayItemScrollClip* mScrollClipContainingBlockDescendants;\n>  \n>    /**\n> +   * Magical property from Markus.\n\n\"The scroll clip that was in effect when mClipContentDescendants was set.\"\n\n::: layout/generic/nsGfxScrollFrame.h:389\n(Diff revision 1)\n>    bool IsTransformingByAPZ() const {\n>      return mTransformingByAPZ;\n>    }\n>    void SetScrollableByAPZ(bool aScrollable);\n>    void SetZoomableByAPZ(bool aZoomable);\n> +  void SetHasCSSClippedDescendant();\n\nLet's call this \"SetScrollsClipOnUnscrolledOutOfFlow\".", "author": "mstange@themasta.com", "id": 11542995, "time": "2016-07-12T20:14:00Z"}, {"text": "Updated patch per review comments, did a new try push at https://treeherder.mozilla.org/#/jobs?repo=try&revision=377535c5888d&group_state=expanded which shows no obvious signs of bustage. I'll go ahead and land this.", "author": "bugmail@mozilla.staktrace.com", "id": 11546227, "time": "2016-07-13T20:05:51Z"}, {"text": "Pushed by kgupta@mozilla.com:\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/1d26ac38f26d\nDisable paint-skipping for scrollframes that we detect as having a CSS-clipped descendant. r=mstange", "author": "pulsebot@bots.tld", "id": 11546228, "time": "2016-07-13T20:06:35Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/1d26ac38f26d", "author": "cbook@mozilla.com", "id": 11547646, "time": "2016-07-14T09:48:26Z"}, {"text": "Comment on attachment 8768387\nBug 1284586 - Disable paint-skipping for scrollframes that we detect as having a CSS-clipped descendant.\n\nApproval Request Comment\n[Feature/regressing bug #]: APZ in general, but bug 1253860 made it more noticeable\n[User impact if declined]: CSS clips lag behind scrolling, which can result in temporarily mispainted content. It can be quite user-visible, since \"temporarily\" could be multiple seconds, and the mispaints can be large.\n[Describe test coverage new/current, TreeHerder]: manually tested\n[Risks and why]: Markus might be better able to answer this, since he wrote the hard parts of the patch. But fundamentally this patch just turns off paint-skipping on some pages, and so even in the worst case we just lose some performance that APZ bought us.\n[String/UUID change made/needed]: none", "author": "bugmail@mozilla.staktrace.com", "id": 11549120, "time": "2016-07-14T19:41:05Z"}, {"text": "Comment on attachment 8768387\nBug 1284586 - Disable paint-skipping for scrollframes that we detect as having a CSS-clipped descendant.\n\nThis patch fixes CSS clips issue while scrolling. Take it in 48 beta 9 and aurora.", "author": "gchang@mozilla.com", "id": 11551165, "time": "2016-07-15T15:50:02Z"}, {"text": "Hi Kartikaya,\nCan you help to provide some information to verify this? This needs to be verified in 48 beta 9.", "author": "gchang@mozilla.com", "id": 11551183, "time": "2016-07-15T15:57:15Z"}, {"text": "Please verify using the the reduced testcases in attachment 8673015, attachment 8673082, and the URL from bug 1214146 comment 0. In all of these cases the behaviour should be improved with this patch - although it still won't be perfect, it should be closer to what it looks like in other browsers.", "author": "bugmail@mozilla.staktrace.com", "id": 11551332, "time": "2016-07-15T17:12:51Z"}, {"text": "https://hg.mozilla.org/releases/mozilla-aurora/rev/1c72f075dd79", "author": "cbook@mozilla.com", "id": 11552469, "time": "2016-07-16T07:55:11Z"}, {"text": "  https://hg.mozilla.org/releases/mozilla-beta/rev/cf21aa15aad0", "author": "cbook@mozilla.com", "id": 11552470, "time": "2016-07-16T07:57:36Z"}, {"text": "Created attachment 8772824\n48beta scrolling.png\n\nEnvironments: Win 10 64-bit, Ubuntu 14.04 64-bit and Mac OS X 10.9.5.\nBuilds: Firefox 48 beta 9, latest Aurora 49.0a2, latest Nightly 50.0a1 2016-07-20\n\nThe scrolling on the test pages improved a lot with Aurora and Nightly across platforms. On the other hand, 48 beta 9 still has the scrolling issues (see attachment) even though the patch was uplifted on beta. \n\nKats, can I help in investigating further the reason for why this is happening?\n\nAlso, the scrolling (generally speaking) on Ubuntu seems a bit worse than on the other platforms. I haven't found anything logged on Bugzilla so I wonder if I should log it or it's caused by some platform limitations. \n\nThanks!", "author": "petruta.rasa@softvision.ro", "id": 11561703, "time": "2016-07-20T13:07:27Z"}, {"text": "I can reproduce what you're seeing using b9 on the two test pages. The full page at http://www.bbc.co.uk/news/resources/idt-248d9ac7-9784-4769-936a-8d3b435857a8 seems to behave fine with b9 though. I'll try to figure out what's going on, leaving needinfo on me for now.", "author": "bugmail@mozilla.staktrace.com", "id": 11563187, "time": "2016-07-20T20:21:38Z"}, {"text": "Markus and I looked at this a little bit. We're definitely taking a different codepath in beta than we are in Nightly, and it's something subtle that would take some time to track down fully. Even if we did track it down, it's unlikely that we could come up with a fix that would be safe to uplift this late in the 48 cycle.\n\nGiven that, and given that it's still fixed on most of the real-world pages we tested, we agreed that we'll just leave this as-is on 48. 49 and up will have the fuller fix anyway.", "author": "bugmail@mozilla.staktrace.com", "id": 11563532, "time": "2016-07-20T22:08:49Z"}, {"text": "I'm setting the flag to affected on 48 so we know that the fix didn't worked here.", "author": "petruta.rasa@softvision.ro", "id": 11565527, "time": "2016-07-21T15:40:12Z"}, {"text": "Changing it to wontfix then, that feels more appropriate.", "author": "bugmail@mozilla.staktrace.com", "id": 11567291, "time": "2016-07-22T03:11:11Z"}], "id": 1284586, "priority": "P1", "cc": ["cbook@mozilla.com", "gchang@mozilla.com", "mstange@themasta.com", "petruta.rasa@softvision.ro"], "cf_crash_signature": "", "version": "48 Branch", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_firefox59": "---", "last_change_time": "2016-07-22T03:11:11Z", "cf_platform_rel": "---", "product": "Core", "cf_fx_iteration": "---", "blocks": [1214146], "qa_contact": "", "creation_time": "2016-07-05T18:13:09Z", "cf_status_firefox_esr52": "---", "component": "Panning and Zooming", "assigned_to_detail": {"email": "bugmail@mozilla.staktrace.com", "id": 426788, "name": "bugmail@mozilla.staktrace.com", "real_name": "Kartikaya Gupta (email:kats@mozilla.com)"}, "cf_status_firefox49": "verified", "cf_status_firefox48": "wontfix", "groups": [], "cf_status_firefox60": "---", "target_milestone": "mozilla50", "is_cc_accessible": true, "cf_rank": null, "cf_status_thunderbird_esr52": "---", "url": "", "creator_detail": {"email": "bugmail@mozilla.staktrace.com", "id": 426788, "name": "bugmail@mozilla.staktrace.com", "real_name": "Kartikaya Gupta (email:kats@mozilla.com)"}, "whiteboard": "[gfx-noted]", "mentors": [], "cc_detail": [{"email": "cbook@mozilla.com", "id": 277293, "name": "cbook@mozilla.com", "real_name": "Carsten Book [:Tomcat]"}, {"email": "gchang@mozilla.com", "id": 506302, "name": "gchang@mozilla.com", "real_name": "Gerry Chang [:gchang]"}, {"email": "mstange@themasta.com", "id": 293943, "name": "mstange@themasta.com", "real_name": "Markus Stange [:mstange]"}, {"email": "petruta.rasa@softvision.ro", "id": 475155, "name": "petruta.rasa@softvision.ro", "real_name": "Petruta Rasa [QA] [:petruta]"}], "alias": null, "dupe_of": null, "flags": [{"status": "+", "name": "qe-verify", "modification_date": "2016-07-15T15:57:15Z", "type_id": 864, "creation_date": "2016-07-15T15:57:15Z", "id": 1424320, "setter": "gchang@mozilla.com"}], "cf_tracking_firefox58": "---", "assigned_to": "bugmail@mozilla.staktrace.com", "is_open": false, "history": [{"changes": [{"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "bugmail@mozilla.staktrace.com"}], "who": "bugmail@mozilla.staktrace.com", "when": "2016-07-05T18:25:47Z"}, {"changes": [{"removed": "--", "field_name": "priority", "added": "P1"}, {"removed": "", "field_name": "whiteboard", "added": "[gfx-noted]"}], "who": "bugmail@mozilla.staktrace.com", "when": "2016-07-05T20:00:42Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8768387, "added": "review?(mstange@themasta.com)"}], "who": "bugmail@mozilla.staktrace.com", "when": "2016-07-06T13:31:35Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(mstange@themasta.com)", "attachment_id": 8768387, "added": "review+"}], "who": "mstange@themasta.com", "when": "2016-07-12T20:14:00Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla50"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2016-07-14 09:48:26"}, {"removed": "affected", "field_name": "cf_status_firefox50", "added": "fixed"}], "who": "cbook@mozilla.com", "when": "2016-07-14T09:48:26Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8768387, "added": "approval-mozilla-aurora?, approval-mozilla-beta?"}], "who": "bugmail@mozilla.staktrace.com", "when": "2016-07-14T19:41:05Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "approval-mozilla-aurora?, approval-mozilla-beta?", "attachment_id": 8768387, "added": "approval-mozilla-aurora+, approval-mozilla-beta+"}], "who": "gchang@mozilla.com", "when": "2016-07-15T15:50:02Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "gchang@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(bugmail@mozilla.staktrace.com), qe-verify+"}], "who": "gchang@mozilla.com", "when": "2016-07-15T15:57:15Z"}, {"changes": [{"removed": "needinfo?(bugmail@mozilla.staktrace.com)", "field_name": "flagtypes.name", "added": ""}], "who": "bugmail@mozilla.staktrace.com", "when": "2016-07-15T17:12:51Z"}, {"changes": [{"removed": "affected", "field_name": "cf_status_firefox49", "added": "fixed"}], "who": "cbook@mozilla.com", "when": "2016-07-16T07:55:11Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "cbook@mozilla.com"}, {"removed": "affected", "field_name": "cf_status_firefox48", "added": "fixed"}], "who": "cbook@mozilla.com", "when": "2016-07-16T07:57:36Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(bugmail@mozilla.staktrace.com)"}], "who": "petruta.rasa@softvision.ro", "when": "2016-07-20T13:07:27Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "petruta.rasa@softvision.ro"}, {"removed": "fixed", "field_name": "cf_status_firefox49", "added": "verified"}, {"removed": "fixed", "field_name": "cf_status_firefox50", "added": "verified"}], "who": "petruta.rasa@softvision.ro", "when": "2016-07-20T13:08:05Z"}, {"changes": [{"removed": "needinfo?(bugmail@mozilla.staktrace.com)", "field_name": "flagtypes.name", "added": ""}], "who": "bugmail@mozilla.staktrace.com", "when": "2016-07-20T22:08:49Z"}, {"changes": [{"removed": "RESOLVED", "field_name": "status", "added": "VERIFIED"}, {"removed": "fixed", "field_name": "cf_status_firefox48", "added": "affected"}], "who": "petruta.rasa@softvision.ro", "when": "2016-07-21T15:40:12Z"}, {"changes": [{"removed": "affected", "field_name": "cf_status_firefox48", "added": "wontfix"}], "who": "bugmail@mozilla.staktrace.com", "when": "2016-07-22T03:11:11Z"}], "resolution": "FIXED", "op_sys": "Unspecified", "cf_fx_points": "---", "cf_blocking_fennec": "---"}