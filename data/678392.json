{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "cf_tracking_firefox62": "---", "creator": "beingalink@googlemail.com", "mentors_detail": [], "depends_on": [780362, 800443, 817700, 860779], "cf_status_firefox_esr60": "---", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "x86", "keywords": [], "cc_detail": [{"email": "alex@pointless.one", "id": 183987, "name": "alex@pointless.one", "real_name": "Cheba"}, {"email": "andrew@andrewmin.com", "id": 421057, "name": "andrew@andrewmin.com", "real_name": "Andrew Min"}, {"email": "anthony.s.hughes@gmail.com", "id": 279076, "name": "anthony.s.hughes@gmail.com", "real_name": "Anthony Hughes (:ashughes) [QA]"}, {"email": "anthony@ricaud.me", "id": 319615, "name": "anthony@ricaud.me", "real_name": "Anthony Ricaud (:rik)"}, {"email": "asa@mozilla.org", "id": 5003, "name": "asa@mozilla.org", "real_name": "Asa Dotzler [:asa]"}, {"email": "astravian@gmail.com", "id": 449778, "name": "astravian@gmail.com", "real_name": ""}, {"email": "astrolox+bugzilla@gmail.com", "id": 423253, "name": "astrolox+bugzilla@gmail.com", "real_name": ""}, {"email": "avihpit@yahoo.com", "id": 55598, "name": "avihpit@yahoo.com", "real_name": "Avi Halachmi (:avih)"}, {"email": "b56girard@gmail.com", "id": 368375, "name": "b56girard@gmail.com", "real_name": "Benoit Girard (:BenWa)"}, {"email": "bugs@junglecode.net", "id": 384647, "name": "bugs@junglecode.net", "real_name": "Jet Villegas (:jet)"}, {"email": "bugzilla@spray.se", "id": 25585, "name": "bugzilla@spray.se", "real_name": "Jos\u00e9 Jeria"}, {"email": "bugzillawatcher@gmail.com", "id": 43568, "name": "bugzillawatcher@gmail.com", "real_name": "Jos\u00e9 Jeria"}, {"email": "bzbarsky@mit.edu", "id": 20209, "name": "bzbarsky@mit.edu", "real_name": "Boris Zbarsky [:bz] (Vacation Jun 16-24) (no decent commit message means r-)"}, {"email": "camaran@gmail.com", "id": 458977, "name": "camaran@gmail.com", "real_name": "Thomas"}, {"email": "chris.blore@gmail.com", "id": 158177, "name": "chris.blore@gmail.com", "real_name": "Chris Blore"}, {"email": "clee@mozilla.com", "id": 421861, "name": "clee@mozilla.com", "real_name": "Chris Lee [:clee]"}, {"email": "dao+bmo@mozilla.com", "id": 219124, "name": "dao+bmo@mozilla.com", "real_name": "D\u00e3o Gottwald [::dao]"}, {"email": "deprecationmail@gmail.com", "id": 346332, "name": "deprecationmail@gmail.com", "real_name": "d"}, {"email": "djspiewak@gmail.com", "id": 246192, "name": "djspiewak@gmail.com", "real_name": "Daniel Spiewak"}, {"email": "e1857104@rtrtr.com", "id": 446565, "name": "e1857104@rtrtr.com", "real_name": "Lars Brennicke"}, {"email": "ehsan@mozilla.com", "id": 251051, "name": "ehsan@mozilla.com", "real_name": ":Ehsan Akhgari"}, {"email": "emanuele.alimonda@gmail.com", "id": 383077, "name": "emanuele.alimonda@gmail.com", "real_name": "Emanuele Alimonda"}, {"email": "felipc@gmail.com", "id": 208747, "name": "felipc@gmail.com", "real_name": ":Felipe Gomes (needinfo me!)"}, {"email": "gandalf@aviary.pl", "id": 41270, "name": "gandalf@aviary.pl", "real_name": "Zibi Braniecki [:gandalf][:zibi]"}, {"email": "gavin.sharp@gmail.com", "id": 103593, "name": "gavin.sharp@gmail.com", "real_name": ":Gavin Sharp [email: gavin@gavinsharp.com]"}, {"email": "ge3k0s@gmail.com", "id": 428464, "name": "ge3k0s@gmail.com", "real_name": "Ge3k0s"}, {"email": "hawkrives@gmail.com", "id": 323928, "name": "hawkrives@gmail.com", "real_name": "Hawken Rives"}, {"email": "hubert+bmo@hubertgajewski.com", "id": 186417, "name": "hubert+bmo@hubertgajewski.com", "real_name": "Hubert Gajewski"}, {"email": "iAbdulElah@gmail.com", "id": 455814, "name": "iAbdulElah@gmail.com", "real_name": "AbdulElah"}, {"email": "jaws@mozilla.com", "id": 409754, "name": "jaws@mozilla.com", "real_name": "Jared Wein [:jaws] (please needinfo? me)"}, {"email": "jboriss@mozilla.com", "id": 309079, "name": "jboriss@mozilla.com", "real_name": "Jennifer Morrow [:Boriss] (UX)"}, {"email": "joe@drew.ca", "id": 94, "name": "joe@drew.ca", "real_name": "Joe Drew (not getting mail)"}, {"email": "johan@johanl.se", "id": 410930, "name": "johan@johanl.se", "real_name": "Johan Larsson"}, {"email": "josh@joshmatthews.net", "id": 241497, "name": "josh@joshmatthews.net", "real_name": "Josh Matthews [:jdm]"}, {"email": "jsbruner@umich.edu", "id": 450032, "name": "jsbruner@umich.edu", "real_name": "Josiah Bruner [:jsbruner] (needinfo for responses)"}, {"email": "justin.lebar+bug@gmail.com", "id": 303454, "name": "justin.lebar+bug@gmail.com", "real_name": "Justin Lebar (not reading bugmail)"}, {"email": "jypenator@gmail.com", "id": 248150, "name": "jypenator@gmail.com", "real_name": "Jean-Yves Perrier [:teoli]"}, {"email": "limi@mozilla.com", "id": 12880, "name": "limi@mozilla.com", "real_name": "Alex Limi (:limi) \u2014 Firefox UX Team"}, {"email": "lmedinas@gmail.com", "id": 465600, "name": "lmedinas@gmail.com", "real_name": "lmedinas@gmail.com"}, {"email": "loganrosen@gmail.com", "id": 356925, "name": "loganrosen@gmail.com", "real_name": "Logan Rosen [:Logan]"}, {"email": "ludalex@gmail.com", "id": 458126, "name": "ludalex@gmail.com", "real_name": "Luca D."}, {"email": "lukasblakk+bugs@gmail.com", "id": 272375, "name": "lukasblakk+bugs@gmail.com", "real_name": "Lukas Blakk [:lsblakk] use ?needinfo"}, {"email": "madhava@mozilla.com", "id": 247483, "name": "madhava@mozilla.com", "real_name": "Madhava Enros [:madhava]"}, {"email": "marckjackubosky@gmail.com", "id": 451596, "name": "marckjackubosky@gmail.com", "real_name": "Mark Jackubosky"}, {"email": "masayuki@d-toybox.com", "id": 34283, "name": "masayuki@d-toybox.com", "real_name": "Masayuki Nakano [:masayuki] (JST, +0900)"}, {"email": "mbrubeck@mozilla.com", "id": 24045, "name": "mbrubeck@mozilla.com", "real_name": "Matt Brubeck (:mbrubeck)"}, {"email": "mcastelluccio@mozilla.com", "id": 420453, "name": "mcastelluccio@mozilla.com", "real_name": "Marco Castelluccio [:marco]"}, {"email": "mdeboer@mozilla.com", "id": 463945, "name": "mdeboer@mozilla.com", "real_name": "Mike de Boer [:mikedeboer]"}, {"email": "me@chrisb.xyz", "id": 386602, "name": "me@chrisb.xyz", "real_name": "Chris Barry [ChrisW_B]"}, {"email": "mehmet.sahin@gmx.net", "id": 310609, "name": "mehmet.sahin@gmx.net", "real_name": "Mehmet"}, {"email": "mozcbarrett@gmail.com", "id": 56157, "name": "mozcbarrett@gmail.com", "real_name": "Colin Barrett [:cbarrett]"}, {"email": "mozilla@metasieben.org", "id": 388139, "name": "mozilla@metasieben.org", "real_name": "matthias koplenig"}, {"email": "Ms2ger@gmail.com", "id": 302720, "name": "Ms2ger@gmail.com", "real_name": ":Ms2ger (\u231a UTC+1/+2)"}, {"email": "mstange@themasta.com", "id": 293943, "name": "mstange@themasta.com", "real_name": "Markus Stange [:mstange]"}, {"email": "Nomis101@web.de", "id": 299163, "name": "Nomis101@web.de", "real_name": "Nomis101"}, {"email": "notforyourmail@gmail.com", "id": 131582, "name": "notforyourmail@gmail.com", "real_name": "Michael"}, {"email": "pali@pali.sk", "id": 22123, "name": "pali@pali.sk", "real_name": "Pavol Vaskovic"}, {"email": "paul@mozilla.com", "id": 174962, "name": "paul@mozilla.com", "real_name": "Paul Rouget [:paul]"}, {"email": "philringnalda@gmail.com", "id": 135518, "name": "philringnalda@gmail.com", "real_name": "Phil Ringnalda (:philor)"}, {"email": "reuben.bmo@gmail.com", "id": 390952, "name": "reuben.bmo@gmail.com", "real_name": "Reuben Morais [:reuben]"}, {"email": "robert.strong.bugs@gmail.com", "id": 141755, "name": "robert.strong.bugs@gmail.com", "real_name": "Robert Strong [:rstrong] (use needinfo to contact me)"}, {"email": "roc@ocallahan.org", "id": 5038, "name": "roc@ocallahan.org", "real_name": "Robert O'Callahan (:roc) (email my personal email if necessary)"}, {"email": "saneyuki.s.snyk@gmail.com", "id": 360522, "name": "saneyuki.s.snyk@gmail.com", "real_name": "Tetsuharu OHZEKI [:tetsuharu] [UTC+9]"}, {"email": "sarentz@mozilla.com", "id": 388264, "name": "sarentz@mozilla.com", "real_name": "Stefan Arentz [:st3fan]"}, {"email": "scoobidiver@netcourrier.com", "id": 386758, "name": "scoobidiver@netcourrier.com", "real_name": "Scoobidiver (away)"}, {"email": "sergeyreym@gmail.com", "id": 360054, "name": "sergeyreym@gmail.com", "real_name": "Sergey Reymerov"}, {"email": "simo@kivimaki.fi", "id": 343890, "name": "simo@kivimaki.fi", "real_name": "Simo Kivim\u00e4ki"}, {"email": "smichaud@pobox.com", "id": 67806, "name": "smichaud@pobox.com", "real_name": "Steven Michaud [:smichaud] (Retired)"}, {"email": "spohl.mozilla.bugs@gmail.com", "id": 456485, "name": "spohl.mozilla.bugs@gmail.com", "real_name": "Stephen A Pohl [:spohl]"}, {"email": "starfx6464@gmail.com", "id": 466903, "name": "starfx6464@gmail.com", "real_name": "starfx6464"}, {"email": "swrobel@gmail.com", "id": 361547, "name": "swrobel@gmail.com", "real_name": "Stefan Wrobel"}, {"email": "thomas@thomasy.tw", "id": 435062, "name": "thomas@thomasy.tw", "real_name": "Thomasy"}, {"email": "timbugzilla@gmail.com", "id": 437905, "name": "timbugzilla@gmail.com", "real_name": ""}, {"email": "tnikkel@gmail.com", "id": 255010, "name": "tnikkel@gmail.com", "real_name": "Timothy Nikkel (:tnikkel)"}, {"email": "tommybxp@gmail.com", "id": 383681, "name": "tommybxp@gmail.com", "real_name": "Tommy XP"}, {"email": "valentin@tutu.ro", "id": 298185, "name": "valentin@tutu.ro", "real_name": "Valentin Tutu"}, {"email": "Virtual@teknik.io", "id": 342842, "name": "Virtual@teknik.io", "real_name": "Virtual_ManPL [:Virtual] - (please needinfo? me - so I will see your comment/reply/question/etc.)"}, {"email": "vulcain@gmx.com", "id": 403141, "name": "vulcain@gmx.com", "real_name": ""}, {"email": "xan1790@yahoo.com", "id": 414296, "name": "xan1790@yahoo.com", "real_name": "Xan"}, {"email": "zpletan@aol.com", "id": 432689, "name": "zpletan@aol.com", "real_name": ""}], "cf_last_resolved": "2013-04-10T12:23:28Z", "attachments": [{"creator": "mstange@themasta.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 553283}, {"creator": "mstange@themasta.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 553287}, {"creator": "mstange@themasta.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 553482}, {"creator": "mstange@themasta.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 553484}, {"creator": "mstange@themasta.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 553486}, {"creator": "mstange@themasta.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 553487}, {"creator": "mstange@themasta.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2011-11-02T18:37:19Z", "type_id": 4, "creation_date": "2011-11-02T12:55:30Z", "id": 475299, "setter": "bugs@pettay.fi"}], "content_type": "text/plain", "id": 571313}, {"creator": "mstange@themasta.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2011-11-07T22:36:30Z", "type_id": 4, "creation_date": "2011-11-02T12:59:07Z", "id": 475302, "setter": "smichaud@pobox.com"}], "content_type": "text/plain", "id": 571315}, {"creator": "mstange@themasta.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 571317}, {"creator": "mstange@themasta.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 571319}, {"creator": "mstange@themasta.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 571426}, {"creator": "clee@mozilla.com", "is_obsolete": 1, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 573552}, {"creator": "smichaud@pobox.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 580525}, {"creator": "smichaud@pobox.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 608120}, {"creator": "smichaud@pobox.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "-", "name": "feedback", "modification_date": "2012-05-10T02:06:40Z", "type_id": 607, "creation_date": "2012-04-24T19:18:25Z", "id": 512520, "setter": "fryn@frankyan.com"}], "content_type": "text/plain", "id": 617980}, {"creator": "mstange@themasta.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 626956}, {"creator": "mstange@themasta.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 626957}, {"creator": "mstange@themasta.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "feedback", "modification_date": "2012-08-09T09:40:39Z", "type_id": 607, "creation_date": "2012-08-09T09:40:39Z", "id": 540115, "setter": "fryn@frankyan.com"}], "content_type": "text/plain", "id": 626958}, {"creator": "mstange@themasta.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2012-08-09T09:30:45Z", "type_id": 4, "creation_date": "2012-05-24T21:14:39Z", "id": 520166, "setter": "fryn@frankyan.com"}], "content_type": "text/plain", "id": 626960}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 660348}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "feedback", "modification_date": "2012-09-17T16:10:06Z", "type_id": 607, "creation_date": "2012-09-12T08:46:29Z", "id": 548935, "setter": "smichaud@pobox.com"}], "content_type": "text/plain", "id": 660354}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "feedback", "modification_date": "2012-10-16T17:03:00Z", "type_id": 607, "creation_date": "2012-10-16T06:14:43Z", "id": 559573, "setter": "smichaud@pobox.com"}], "content_type": "text/plain", "id": 671734}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 685725}, {"creator": "jsbruner@umich.edu", "is_obsolete": 1, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 686076}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 686407}, {"creator": "me@chrisb.xyz", "is_obsolete": 1, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 686414}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 686741}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 687358}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 689386}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 689388}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 689982}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 689992}, {"creator": "jsbruner@umich.edu", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 690014}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 690541}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 691550}, {"creator": "me@chrisb.xyz", "is_obsolete": 1, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 691893}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 693784}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "feedback", "modification_date": "2012-12-20T21:38:54Z", "type_id": 607, "creation_date": "2012-12-20T21:12:12Z", "id": 584303, "setter": "smichaud@pobox.com"}], "content_type": "text/plain", "id": 694540}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 694745}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2012-12-21T23:21:27Z", "type_id": 4, "creation_date": "2012-12-21T19:06:48Z", "id": 584680, "setter": "smichaud@pobox.com"}], "content_type": "text/plain", "id": 694922}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 695053}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2012-12-22T01:04:01Z", "type_id": 4, "creation_date": "2012-12-22T01:04:01Z", "id": 584801, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 695054}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 696097}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2012-12-27T19:38:57Z", "type_id": 4, "creation_date": "2012-12-27T19:38:57Z", "id": 585938, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 696099}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 696438}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 696830}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 696831}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 697191}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 697507}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-01-18T22:18:53Z", "type_id": 4, "creation_date": "2013-01-03T21:33:43Z", "id": 587701, "setter": "smichaud@pobox.com"}], "content_type": "text/plain", "id": 697633}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-01-15T21:51:47Z", "type_id": 4, "creation_date": "2013-01-15T21:51:47Z", "id": 593459, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 702506}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 704990}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-01-22T19:25:57Z", "type_id": 4, "creation_date": "2013-01-22T19:00:56Z", "id": 596374, "setter": "smichaud@pobox.com"}], "content_type": "text/plain", "id": 705002}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-01-23T20:23:36Z", "type_id": 4, "creation_date": "2013-01-23T20:23:36Z", "id": 596969, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 705497}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 705932}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 706601}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 706652}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 706675}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 706687}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 706721}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-01-31T20:50:52Z", "type_id": 4, "creation_date": "2013-01-28T18:30:34Z", "id": 598829, "setter": "smichaud@pobox.com"}], "content_type": "text/plain", "id": 707178}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 708191}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 709101}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 709297}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "feedback", "modification_date": "2013-02-06T22:42:54Z", "type_id": 607, "creation_date": "2013-02-06T22:42:54Z", "id": 602949, "setter": "felipc@gmail.com"}], "content_type": "text/plain", "id": 709812}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 710422}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 711456}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-02-07T20:28:36Z", "type_id": 4, "creation_date": "2013-02-07T20:28:36Z", "id": 603582, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 711461}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-02-07T22:21:39Z", "type_id": 4, "creation_date": "2013-02-07T20:34:58Z", "id": 603583, "setter": "felipc@gmail.com"}], "content_type": "text/plain", "id": 711463}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-02-07T23:40:19Z", "type_id": 4, "creation_date": "2013-02-07T23:34:36Z", "id": 603709, "setter": "felipc@gmail.com"}, {"status": "-", "name": "feedback", "modification_date": "2013-02-08T11:35:20Z", "type_id": 607, "creation_date": "2013-02-08T11:35:20Z", "id": 603887, "setter": "dao+bmo@mozilla.com"}], "content_type": "text/plain", "id": 711566}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-02-07T23:43:40Z", "type_id": 4, "creation_date": "2013-02-07T23:36:18Z", "id": 603710, "setter": "felipc@gmail.com"}], "content_type": "text/plain", "id": 711567}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-02-07T23:57:37Z", "type_id": 4, "creation_date": "2013-02-07T23:57:37Z", "id": 603717, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 711581}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-02-08T17:37:20Z", "type_id": 4, "creation_date": "2013-02-08T17:37:20Z", "id": 604047, "setter": "spohl.mozilla.bugs@gmail.com"}, {"status": "-", "name": "feedback", "modification_date": "2013-02-08T17:37:20Z", "type_id": 607, "creation_date": "2013-02-08T17:37:20Z", "id": 604048, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 711877}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-02-08T18:23:57Z", "type_id": 4, "creation_date": "2013-02-08T18:23:57Z", "id": 604067, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 711896}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-02-13T00:54:47Z", "type_id": 4, "creation_date": "2013-02-13T00:54:47Z", "id": 605538, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 713190}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-02-14T21:06:56Z", "type_id": 4, "creation_date": "2013-02-14T19:14:39Z", "id": 606403, "setter": "smichaud@pobox.com"}], "content_type": "text/plain", "id": 714004}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-02-15T17:25:34Z", "type_id": 4, "creation_date": "2013-02-15T17:25:34Z", "id": 606883, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 714442}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-02-15T17:26:38Z", "type_id": 4, "creation_date": "2013-02-15T17:26:38Z", "id": 606884, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 714445}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-02-15T17:27:44Z", "type_id": 4, "creation_date": "2013-02-15T17:27:44Z", "id": 606886, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 714447}, {"creator": "jsbruner@umich.edu", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-02-26T01:24:43Z", "type_id": 4, "creation_date": "2013-02-26T01:24:43Z", "id": 610955, "setter": "jsbruner@umich.edu"}], "content_type": "text/plain", "id": 718185}, {"creator": "jsbruner@umich.edu", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-02-26T01:26:25Z", "type_id": 4, "creation_date": "2013-02-26T01:26:25Z", "id": 610957, "setter": "jsbruner@umich.edu"}], "content_type": "text/plain", "id": 718187}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-02-26T19:09:16Z", "type_id": 4, "creation_date": "2013-02-26T19:09:16Z", "id": 611478, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 718538}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-03-05T16:24:17Z", "type_id": 4, "creation_date": "2013-03-05T00:08:21Z", "id": 613985, "setter": "smichaud@pobox.com"}], "content_type": "text/plain", "id": 720958}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-03-06T18:15:05Z", "type_id": 4, "creation_date": "2013-03-06T18:15:05Z", "id": 614954, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 721784}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-03-06T18:17:23Z", "type_id": 4, "creation_date": "2013-03-06T18:17:23Z", "id": 614955, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 721785}, {"creator": "jboriss@mozilla.com", "is_obsolete": 1, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 729665}, {"creator": "jboriss@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 729667}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-04-01T19:18:56Z", "type_id": 4, "creation_date": "2013-04-01T19:18:56Z", "id": 626875, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 731981}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-04-01T19:27:41Z", "type_id": 4, "creation_date": "2013-04-01T19:27:41Z", "id": 626886, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 731988}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-04-04T16:06:53Z", "type_id": 4, "creation_date": "2013-04-04T16:06:53Z", "id": 628645, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 733379}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-04-04T16:12:28Z", "type_id": 4, "creation_date": "2013-04-04T16:12:28Z", "id": 628653, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 733383}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-04-04T16:34:54Z", "type_id": 4, "creation_date": "2013-04-04T16:34:54Z", "id": 628674, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 733398}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-04-04T21:09:34Z", "type_id": 4, "creation_date": "2013-04-04T21:09:34Z", "id": 628874, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 733547}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 733552}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 733554}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-04-04T22:05:22Z", "type_id": 4, "creation_date": "2013-04-04T21:26:35Z", "id": 628887, "setter": "smichaud@pobox.com"}], "content_type": "text/plain", "id": 733558}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-04-04T22:13:50Z", "type_id": 4, "creation_date": "2013-04-04T22:13:50Z", "id": 628907, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 733574}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-04-07T16:29:21Z", "type_id": 4, "creation_date": "2013-04-06T01:03:09Z", "id": 629645, "setter": "jaws@mozilla.com"}], "content_type": "text/plain", "id": 734172}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-04-06T04:54:33Z", "type_id": 4, "creation_date": "2013-04-06T04:54:33Z", "id": 629676, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 734196}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-04-08T15:48:54Z", "type_id": 4, "creation_date": "2013-04-08T15:48:54Z", "id": 630261, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 734660}, {"creator": "spohl.mozilla.bugs@gmail.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2013-04-08T15:49:53Z", "type_id": 4, "creation_date": "2013-04-08T15:49:53Z", "id": 630262, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 734662}, {"creator": "smichaud@pobox.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "feedback", "modification_date": "2013-04-09T17:38:44Z", "type_id": 607, "creation_date": "2013-04-09T17:24:18Z", "id": 631034, "setter": "spohl.mozilla.bugs@gmail.com"}], "content_type": "text/plain", "id": 735264}], "votes": 27, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 431, "comments": [{"text": "User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7) AppleWebKit/534.48.3 (KHTML, like Gecko) Version/5.1 Safari/534.48.3\n\nSteps to reproduce:\n\nGoing back and forth in browsing history using two-finger horizontal swipe on OSX Lion.\n\n\nActual results:\n\nSites get displayed normally without any animation.\n\n\nExpected results:\n\nThere should be a swipe animation as in Safari under Mac OS 10.7 Lion.", "author": "beingalink@googlemail.com", "id": 5648969, "time": "2011-08-11T23:23:49Z"}, {"text": "\n\n*** This bug has been marked as a duplicate of bug 668953 ***", "author": "gavin.sharp@gmail.com", "id": 5648982, "time": "2011-08-11T23:25:49Z"}, {"text": "This bug was spun off from bug 668953.", "author": "smichaud@pobox.com", "id": 5649029, "time": "2011-08-11T23:44:51Z"}, {"text": "*** Bug 678391 has been marked as a duplicate of this bug. ***", "author": "mstange@themasta.com", "id": 5649894, "time": "2011-08-12T14:37:41Z"}, {"text": "We need a UX spec here.\n\nHere are some questions. What should we do in these cases, and what does Safari do (if applicable)?\nI can't test Safari because I don't have access to my Lion machine this week.\n\n - If scrollbars are set to always visible, should they move with the page while\n   the page is being swiped away, or should they stay fixed?\n - What about notification bars? Should they swipe away or stay fixed?\n - In Safari, if you have a small window, click on a link, make the window\n   bigger, and swipe back halfway, is the rendering of the previous page that's\n   visible in the background complete?\n - In Safari, does it ever happen that swiping back causes a reload of the\n   previous page?\n   If so, is the preview image replaced by a half-loaded rendering during the\n   process, or does Safari wait for the page to load completely before hiding\n   the preview rendering?\n - If the previous page has received POST data, Firefox shows a confirmation\n   dialog before going back. (At least it did so in the past, does it still do\n   it?) Does Safari have such a dialog, too? If so, at which point is it shown?\n\nI'm also wondering how to implement this efficiently. We need to store a preview image of the last page at some point, and if we do it before every navigation action that's bound to regress page load performance numbers.", "author": "mstange@themasta.com", "id": 5653739, "time": "2011-08-15T10:28:43Z"}, {"text": "(In reply to Markus Stange from comment #4)\n>  - If scrollbars are set to always visible, should they move with the page\n> while the page is being swiped away, or should they stay fixed?\n\nThey're moved away with the page.  See [1].\n\n>  - What about notification bars? Should they swipe away or stay fixed?\n\nI'm not aware of any notification bars in Safari, are there any?\n\n>  - In Safari, if you have a small window, click on a link, make the window\n>    bigger, and swipe back halfway, is the rendering of the previous page\n> that's visible in the background complete?\n\nNo, it only includes the previous viewport. See [2].\n\n>  - In Safari, does it ever happen that swiping back causes a reload of the\n>    previous page?\n\nIt does (I believe it always does).  See [3].\n\n>    If so, is the preview image replaced by a half-loaded rendering during the\n>    process, or does Safari wait for the page to load completely before hiding\n>    the preview rendering?\n\nThe page always appears fully loaded, minus possibly script-generated contens.\nSee the News page behavior in [3].  I need to test this thoroughly with heavier\npages though.\n\n>  - If the previous page has received POST data, Firefox shows a confirmation\n>    dialog before going back. (At least it did so in the past, does it still\n> do it?) Does Safari have such a dialog, too? If so, at which point is it\n> shown?\n\nThere is no such dialog.  POST data is not re-submit.  See [4] (and compare it\nwith the behavior in Firefox, especially regarding the URLs given by the POST\npage at every new POST caused by a Back action.)\n\n[1]: http://alimonda.com/misc/firefox/Safari1.webm  [ 846KB]\n[2]: http://alimonda.com/misc/firefox/Safari2.webm  [4789KB]\n[3]: http://alimonda.com/misc/firefox/Safari3.webm  [2623KB]\n[4]: http://alimonda.com/misc/firefox/Safari4.webm  [ 903KB]", "author": "emanuele.alimonda@gmail.com", "id": 5653904, "time": "2011-08-15T13:13:00Z"}, {"text": "Thank you, that was very helpful.", "author": "mstange@themasta.com", "id": 5653916, "time": "2011-08-15T13:25:55Z"}, {"text": "Created attachment 553283\nwip\n\nHere's the first step. This patch adds code to browser.js that handles the animation overlay. Nothing calls the code yet, but you can test it like this:\nAfter navigating around, open the Error Console (Cmd+Shift+J) and execute:\n\ntop.opener.gHistorySwipeAnimation.startAnimation()\ntop.opener.gHistorySwipeAnimation.updateAnimation(-0.4)\n// ... play around with other values between -1 and 1 ...\ntop.opener.gHistorySwipeAnimation.stopAnimation()\n\nThe next step is to call these functions from the right places inside the swipe event tracking block in nsChildView.mm. A good way to do that might be to fire lots of swipe gesture events with sufficient data, and then to handle these events in browser.js gGestureSupport (and call the right gHistorySwipeAnimation functions from there). We might need to add one or two fields to the gesture event interface for that.", "author": "mstange@themasta.com", "id": 5655381, "time": "2011-08-15T22:21:56Z"}, {"text": "Created attachment 553287\nscreenshot", "author": "mstange@themasta.com", "id": 5655403, "time": "2011-08-15T22:28:47Z"}, {"text": "(In reply to Emanuele Alimonda from comment #5)\n> >  - If the previous page has received POST data, Firefox shows a confirmation\n> >    dialog before going back. (At least it did so in the past, does it still\n> > do it?) Does Safari have such a dialog, too? If so, at which point is it\n> > shown?\n> \n> There is no such dialog.  POST data is not re-submit. [...]\n\nA small correction to my previous comment.  Said confirmation dialog actually does exist in Safari ([1]), but it appears to be shown only when restoring a session (which, on a side note, would be a pretty neat behavior in my opinion - but that's beyond the scope of this bug).\nIt remains true, though, that it's never shown when swiping pages back and forward.\n\n[1]: http://alimonda.com/misc/firefox/Safari4.png", "author": "emanuele.alimonda@gmail.com", "id": 5656924, "time": "2011-08-16T14:25:58Z"}, {"text": "Created attachment 553482\npart 1, v1: add more swipe gesture event types", "author": "mstange@themasta.com", "id": 5657048, "time": "2011-08-16T15:13:31Z"}, {"text": "Created attachment 553484\npart 2, v1: send swipe events from the swipe tracking handler", "author": "mstange@themasta.com", "id": 5657056, "time": "2011-08-16T15:14:53Z"}, {"text": "Created attachment 553486\npart 3, v1: animation visuals\n\nThis part is very unfinished. Todo:\n - fix code formatting + add comments\n - decide when to take snapshots (currently on \"pagehide\" event)\n - decide how to take snapshots (currently we also capture any overlays over\n   the browser)\n - measure performance\n - fix direction (I think it's flipped at the moment)\n - only activate on Lion (currently activated on all platforms)\n   ... and ideally only if the system pref is set\n   ([NSEvent isSwipeTrackingFromScrollEventsEnabled])", "author": "mstange@themasta.com", "id": 5657063, "time": "2011-08-16T15:18:50Z"}, {"text": "Created attachment 553487\npart 4, v1: handle swipe animations to control animation", "author": "mstange@themasta.com", "id": 5657065, "time": "2011-08-16T15:19:52Z"}, {"text": "OK, that's all I've got time for. Somebody else will need to finish these patches, ideally somebody who can also test them :)\n\nI'm available for questions, of course.\n\nThese patches are still missing a very important part: If there's no page to go back / forward to, the animation still completes as though there was one. That's because we always pass -1 / +1 to the min / max arguments of -[NSEvent trackSwipeEventWithOptions:dampenAmountThresholdMin:max:usingHandler:].\nWe need some way for nsChildView.mm to find out whether the selected browser can go back / forward. Maybe we need to add another event, MozSwipeGestureConsiderStarting with write availablePageLeft / availablePageRight fields or something like that.", "author": "mstange@themasta.com", "id": 5657089, "time": "2011-08-16T15:27:22Z"}, {"text": "Thanks, Markus!\n\nI'm not going to have time for this soon, either.  But I hope your work will give us decent animation support a few months down the line.", "author": "smichaud@pobox.com", "id": 5657291, "time": "2011-08-16T16:39:06Z"}, {"text": "Here's a tryserver build: https://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/mstange@themasta.com-2368eae5dff9/try-macosx64/firefox-9.0a1.en-US.mac.dmg\n\nPlease test away.", "author": "mstange@themasta.com", "id": 5682471, "time": "2011-08-27T09:42:39Z"}, {"text": "This is great. It seems to work well on my side and I'd like this patch checked in as soon as possible to get it thoroughly tested. Just 2 minor things that I observed: 1) Currently you can swipe beyond the first/last page seeing an empty/white page which disappears as soon as you stop swiping. 2) The animation isn't as smooth as in Safari. I guess that's a firefox problem as I can also see this kind of distortion on other pages that use animated DOM (example: http://www.annapialink.de/wp/ )", "author": "beingalink@googlemail.com", "id": 5682478, "time": "2011-08-27T09:53:32Z"}, {"text": "Another thing: If you don't wait for the animation to complete and swipe back into the other direction, the animation gets disabled. If you do fast swiping afterwards, you won't see the animation anymore.", "author": "beingalink@googlemail.com", "id": 5682482, "time": "2011-08-27T09:57:46Z"}, {"text": "Additionally there seems to be a problem with the Google+ site ( https://plus.google.com/ logged in): Visiting another page afterwards and swiping back to Google+ works, but if you want to go forward again, the Google+ site just gets reloaded.", "author": "beingalink@googlemail.com", "id": 5682509, "time": "2011-08-27T11:05:03Z"}, {"text": "(In reply to beingalink from comment #19)\n> Additionally there seems to be a problem with the Google+ site (\n> https://plus.google.com/ logged in): Visiting another page afterwards and\n> swiping back to Google+ works, but if you want to go forward again, the\n> Google+ site just gets reloaded.\n\nInteresting. I suspect that fixing bug 682115 will fix this.", "author": "mstange@themasta.com", "id": 5682539, "time": "2011-08-27T12:28:38Z"}, {"text": "Here's a new build: https://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/mstange@themasta.com-d250e9905569/try-macosx64/firefox-9.0a1.en-US.mac.dmg\nIt adds the bounce when you can't go back / forward and fixes the problems that occurred when starting a new swipe while the existing animation was still in progress.", "author": "mstange@themasta.com", "id": 5684337, "time": "2011-08-29T08:54:34Z"}, {"text": "Bouncing when you can't go back/forward seems to work fine. Fast forward/backward (not waiting for animation to complete) still is quirky here. Swiping quickly from A to B to C ignores the swipe to C. Shows A for a short time, then B again and afterwards it goes to C.\n\nAlso the animation doesn't look really pleasant. I guess it uses Firfox's own graphics engine and not core animation (or whatever else api safari is using)? I hope that with azure on mac things will get better in this regard.", "author": "beingalink@googlemail.com", "id": 5684390, "time": "2011-08-29T09:30:06Z"}, {"text": "Tested out the build posted in comment 21. Working well on my machine (no dev tools installed). Going to use this build as my main Mac OS X browser for a short while.\n\nThe animation seemed smooth and pleasant to me - I have one of the higher end MacBook Pros, so perhaps the machine's specification affects this?\n\nTried to cause issues with swiping very fast and only one made it do something odd. It appeared after two very fast forward swipes from A to B to C, to start the animation with the content for B but then switch to the content for C right at or near the end of the animation. The effect was so quick however that I'm not really sure that I'm believing myself when I write this. Could not reproduce on successive attempts.\n\nEncountered the issue of resuming firefox, then swiping backwards in the history to find I was revealing a blank white page. Once the page was revealed it's content loaded and everything worked fine afterwards. \n\nNoticed that this includes rubber band scrolling style bouncing for when you try to go past the start or end of the history list. However this is only included for forward/backwards and not for normal scrolling (I think that there was a separate bug for that, but can't currently find it).", "author": "astrolox+bugzilla@gmail.com", "id": 5700966, "time": "2011-09-05T21:01:13Z"}, {"text": "On a side note.. I originally I thought that something such as an animation should be a low priority, nice to have feature. However I recently changed my mind after I started using Nightly as my default browser on my main machine (which is now Mac OS X Lion obviously). \n\nGoing back/forward with the gestures works well, in terms of the page changing. Yet without the animation I keep getting very confused with the results I obtain. This is because Lion has by default changed the direction you have to swipe, that is you now swipe to the right in order to go backwards. The idea being that you are swiping the current page off to the right and revealing the page underneath it. The reverse is true for going forwards. \n\nSo my point is that without the animation the support of the gesture does more harm than not supporting the gesture at all. If at all possible, I'd like to advise that Mozilla does not release the gesture support without having the appropriate animations in place. \n\nI suspect that if you haven't spent a lot of time using the gesture without the animation this may seem odd to you and so I thought I'd let you know my thoughts.", "author": "astrolox+bugzilla@gmail.com", "id": 5700968, "time": "2011-09-05T21:03:03Z"}, {"text": "I did a screen capture to demonstrate the scraggy looking animation but to my surprise, in the screen recording video everything looks more or less fine. The effect I wanted to show isn't there. I have no idea where the problem might be. Here's the now useless video anyway: http://dl.dropbox.com/u/232093/Bildschirmaufnahme.mov", "author": "beingalink@googlemail.com", "id": 5709306, "time": "2011-09-08T22:15:29Z"}, {"text": "Nevertheless you can see that the animation isn't as smooth as with Safari.", "author": "beingalink@googlemail.com", "id": 5709329, "time": "2011-09-08T22:21:31Z"}, {"text": "Now I've been using this a few days I have noticed a few things which weren't immediately obvious to start with. sorry, I'm still trying to work out which triggers these behaviors.\n\nThe animation does appear to have some jagged edges most of the time, but not always.\n\nRandomly it seems to just stop working and the browser goes back to no animation at all.\n\nAfter having used the browser for a few minutes on wikipedia, cnet, and sometimes other sites, a black gutter is added to the page on the bottom and right at the start of the animation and removed at the end of the animation.\n\nIt gets very confused when navigating in multiple tabs simultaneously. Steps:\n1. search in google\n2. click one of the links and wait until site is loaded (A)\n3. swipe back to google results\n4. middle-click (open in a tab in the background) one of the other links (B)\n5. swipe forward \nOn my machine this will causes a preview of the site which was loaded (A) to be slide in, but part way through the browser changes it to a white page. After this it forgets all navigation history for the tab. No page is loaded. The address bar remains the address of the google search results. No sure if it's coincidence but every time I have triggered this the tab loading site B doesn't complete.", "author": "astrolox+bugzilla@gmail.com", "id": 5709674, "time": "2011-09-09T00:49:49Z"}, {"text": "Is there any chance that the current patch will be landed before the Aurora merge?\n\nThe swipe gesture without animation is really confusing, and any animation - even if it's still a little quirky at times - is better than no animation.  A least in my opinion, the tryserver build from comment 21 is far more usable (concerning the one/two finger swipes) than the current Nightly builds.  Even more so it should be to those who haven't used Nightly for the last months.", "author": "emanuele.alimonda@gmail.com", "id": 5732647, "time": "2011-09-22T23:59:25Z"}, {"text": "I agree that the gesture without animation is really confusing. Unfortunately the animation as implemented so far is very buggy after extensive use.", "author": "astrolox+bugzilla@gmail.com", "id": 5756950, "time": "2011-10-04T11:04:17Z"}, {"text": "Sorry for taking so long to get back to this.\n\nHere's a new build:\nhttps://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/mstange@themasta.com-8a43f85a4f86/try-macosx64/firefox-10.0a1.en-US.mac.dmg\n\n(In reply to astrolox+bugzilla from comment #27)\n> The animation does appear to have some jagged edges most of the time, but\n> not always.\n\nThis is called \"tearing\" and occurs because we don't use vertical sync, see bug 555834 and bug 689418. It occurs on all animations, it's just more visible for horizontal animations (like the swipe animation here).\n\n> Randomly it seems to just stop working and the browser goes back to no\n> animation at all.\n\nThis was caused by a small typo in the code that handles discarding of saved snapshots as soon as the maximum of 10 snapshots per tab has been reached. So the animation would break after following 10 links in the same tab, for example.\n\n> After having used the browser for a few minutes on wikipedia, cnet, and\n> sometimes other sites, a black gutter is added to the page on the bottom and\n> right at the start of the animation and removed at the end of the animation.\n\nI think I've fixed that bug in the meantime.\n\n> It gets very confused when navigating in multiple tabs simultaneously. Steps:\n\nCan you reproduce the bug with the new build? I can't.", "author": "mstange@themasta.com", "id": 5820434, "time": "2011-11-02T12:54:35Z"}, {"text": "Created attachment 571313\npart 1, v2: add more swipe gesture event types / fields", "author": "mstange@themasta.com", "id": 5820436, "time": "2011-11-02T12:55:30Z"}, {"text": "Created attachment 571315\npart 2, v2: send swipe events from the swipe tracking handler\n\nThe lifecycle issues with the blocks here are interesting, but I think everything works out.", "author": "mstange@themasta.com", "id": 5820441, "time": "2011-11-02T12:59:07Z"}, {"text": "Created attachment 571317\npart 3, v2: animation visuals\n\nThis is the most controversial and tricky part.\n\nWe need to take a snapshot of a page right before it's navigated away from. We save the snapshot in a canvas and store up to 10 of them per tab. This snapshot is taken when the page receives the pagehide event.\nDuring the swipe animation, an animation overlay hides the true tab contents. We hide the animation overlay when we know that the navigation in the tab behind it has completed, which is when the pageshow event of the new page fires.\n\nThere are several problems here:\n - Memory use for the snapshots.\n - Snapshotting has to paint the whole tab again and does not interface with,\n   say, retained layers, so it takes time. This introduces latency to page\n   navigation that might not be justified.\n - The pagehide event does not catch navigations caused by pushState.\n - Waiting for the pageshow event before hiding the animation overlay blocks\n   interaction with the page for too long.\n\nAdding an event for paint unsuppression might address the last point, but I don't know what to do about the rest. Any ideas?", "author": "mstange@themasta.com", "id": 5820463, "time": "2011-11-02T13:15:14Z"}, {"text": "Created attachment 571319\npart 4, v2: handle swipe events", "author": "mstange@themasta.com", "id": 5820478, "time": "2011-11-02T13:22:16Z"}, {"text": "Markus, have you tried to reverse-engineer how Apple supports swipe animation in Safari?  If that's possible, it might be easier (and maybe more reliable) than building support from scratch.\n\nI'll do my review as soon as possible -- hopefully today or tomorrow.  I'll also test all the patches together.", "author": "smichaud@pobox.com", "id": 5820865, "time": "2011-11-02T15:52:27Z"}, {"text": "Comment on attachment 571313\npart 1, v2: add more swipe gesture event types / fields\n\n>diff --git a/browser/base/content/browser.js b/browser/base/content/browser.js\n>--- a/browser/base/content/browser.js\n>+++ b/browser/base/content/browser.js\n\nSomeone else should review these changes.\n\n\n\n\n>+/* attribute unsigned long allowedDirections; */\n>+NS_IMETHODIMP nsDOMSimpleGestureEvent::GetAllowedDirections(PRUint32 *aAllowedDirections)\n>+{\n>+  NS_ENSURE_ARG_POINTER(aAllowedDirections);\n>+  *aAllowedDirections = static_cast<nsSimpleGestureEvent*>(mEvent)->allowedDirections;\n>+  return NS_OK;\n>+}\n>+NS_IMETHODIMP nsDOMSimpleGestureEvent::SetAllowedDirections(PRUint32 aAllowedDirections)\n>+{\n>+  static_cast<nsSimpleGestureEvent*>(mEvent)->allowedDirections = aAllowedDirections;\n>+  return NS_OK;\n>+}\n\nNS_IMETHODIMP should be in the previous line.\nCould you add a newline between methods.", "author": "bugs@pettay.fi", "id": 5821448, "time": "2011-11-02T18:37:19Z"}, {"text": "I'm using the try server build at the moment. It initially worked fine but after a while the animation stopped working and the two finger swipe worked as in the current nightlies. Thanks for telling about bug 555834 and bug 689418. I didn't know about them and I hope they will be fixed soon. I don't think it makes sense landing this feature as long as these aren't fixed.", "author": "beingalink@googlemail.com", "id": 5821487, "time": "2011-11-02T18:46:04Z"}, {"text": "Markus, in what order should these patches be applied?\n\nI tried starting with \"part 1\", but that failed.", "author": "smichaud@pobox.com", "id": 5821512, "time": "2011-11-02T18:57:00Z"}, {"text": "Parts 2, 3 and 4 apply with offsets.  But part 1 fails to apply even after I've applied all the rest.  Looks like you need to update your patches to current mozilla-central code.", "author": "smichaud@pobox.com", "id": 5821569, "time": "2011-11-02T19:15:12Z"}, {"text": "Created attachment 571426\npart 1, v3\n\nUpdated to trunk and addressed comment 36.", "author": "mstange@themasta.com", "id": 5821692, "time": "2011-11-02T20:01:20Z"}, {"text": "When trying to build all patches at once, my build dies with the following error:\n\nRuntimeError: File \"linen-pattern.png\" not found in /Volumes/Keaton/usr/local/src/Mozilla/hg/bugzilla678392/mozilla-central/browser/themes/pinstripe/browser, /Volumes/Keaton/usr/local/src/Mozilla/hg/bugzilla678392/mozilla-central/obj-x86_64-apple-darwin11.2.0/browser/themes/pinstripe/browser", "author": "smichaud@pobox.com", "id": 5822309, "time": "2011-11-02T23:00:22Z"}, {"text": "There's a conflict I've found with horizontal scrolling. \n\nIf you go to http://itunes.apple.com/app/shantae-riskys-revenge/id431535202?mt=8, and try to scroll horizontally to see the next images, you can't scroll horizontally and instead triggers the swipe animation, even after clicking inside the little box. \n\nAnd also, thanks for working on this guys, the build with the new scrollbar + swipe animation looks great and the animation works better than Chrome (yay!) and I hope it will land on UX or Nightly soon.", "author": "xan1790@yahoo.com", "id": 5822852, "time": "2011-11-03T04:27:35Z"}, {"text": "(In reply to Xan from comment #42)\n> There's a conflict I've found with horizontal scrolling. \n\nI believe the conflict is caused by bug #668953 rather than this, as it's currently present in both Nightly and Aurora builds and absent in Beta and Release builds.\n\nHorizontal scrolling over the pictures moves them just by a few pixels when using a multitouch device (MagicMouse, MagicTrackpad, MBP glass trackpad). Diagonal scrolling works (if you diagonal scroll over the pictures, the page scrolls vertically, while images scroll horizontally).\nIf you use a legacy mouse or trackpad (i.e. the scrolling-ball Mighty Mouse or the old pre-unibody MacBook trackpad), horizontal scrolling work perfectly.", "author": "emanuele.alimonda@gmail.com", "id": 5822951, "time": "2011-11-03T05:55:13Z"}, {"text": "> We need to take a snapshot of a page right before it's navigated away from. We save the\n> snapshot in a canvas and store up to 10 of them per tab.\nIn order:\n\n1)  Memory.  We're talking, for my case, say, 10 images each 921x936 pixels, right?  That's about 35MB per tab (10 * 921 * 936 * 4), if all 10 image slots are in use.\n\nThat does seem like a lot...  Have you measured whether this is in fact about the sort of memory usage you see?\n\nIf so, I would be interested in the numbers if instead you take the canvas, call mozGetAsFile on it, then create a filedata URI from that and just use <img> pointed at that URI.  And only create actual HTMLImageElement objects for the ones that you're sticking in mozSetImageElement.  This does need more CPU to encode/decode; perhaps the right way to do it is off an idle timer of some sort?\n\n2)  Snapshotting time:  Please check with roc or tn?  Ccing them. If there's a way we can just get the data out of the layer system that would be ideal.\n\n3)  Pushstate.  We could fire a chrome-only event of some sort there, I guess.  ccing Justin.  But the page may well update itself before calling pushstate....  This is where the layer system might save us, I guess.\n\n4)  The point is that on history navigation we would block interaction until the pageshow?  I agree that adding an async unsuppress notification here would be the way to go.", "author": "bzbarsky@mit.edu", "id": 5824315, "time": "2011-11-03T19:03:44Z"}, {"text": "> - The pagehide event does not catch navigations caused by pushState.\n\n> 3)  Pushstate.  We could fire a chrome-only event of some sort there, I guess.\n\n> +    // Take a snapshot of a page whenever it's about to be navigated away\n> +    // from.\n> +    if (event.type == \"pagehide\")\n> +      this._takeSnapshot();\n\nIt's hash changes too, right?  The event I think you want is \"new session history entry created\".", "author": "justin.lebar+bug@gmail.com", "id": 5824405, "time": "2011-11-03T19:27:45Z"}, {"text": "...or maybe the event you want is \"navigating away from this session history entry\", since that's when you'd take a screenshot.", "author": "justin.lebar+bug@gmail.com", "id": 5824413, "time": "2011-11-03T19:31:04Z"}, {"text": "(In reply to Boris Zbarsky (:bz) from comment #44)\n> 1)  Memory.  We're talking, for my case, say, 10 images each 921x936 pixels,\n> right?  That's about 35MB per tab (10 * 921 * 936 * 4), if all 10 image\n> slots are in use.\n> \n> That does seem like a lot...  Have you measured whether this is in fact\n> about the sort of memory usage you see?\n\nDiscard on a timer maybe? there must be some nice heuristic we can use to limit this without much affecting the UX.\n\n> 2)  Snapshotting time:  Please check with roc or tn?  Ccing them. If there's\n> a way we can just get the data out of the layer system that would be ideal.\n\nPass the DRAWWINDOW_USE_WIDGET_LAYERS flag to drawWindow.", "author": "roc@ocallahan.org", "id": 5825191, "time": "2011-11-03T23:24:08Z"}, {"text": "(In reply to Robert O'Callahan (:roc) (Mozilla Corporation) from comment #47)\n> (In reply to Boris Zbarsky (:bz) from comment #44)\n> > 2)  Snapshotting time:  Please check with roc or tn?  Ccing them. If there's\n> > a way we can just get the data out of the layer system that would be ideal.\n> \n> Pass the DRAWWINDOW_USE_WIDGET_LAYERS flag to drawWindow.\n\nOn a content document which isn't a display root this flag will be silently ignored because we don't currently support pulling the layer contents starting at non-root container layers.", "author": "tnikkel@gmail.com", "id": 5825523, "time": "2011-11-04T01:51:14Z"}, {"text": "> Discard on a timer maybe?\n\nThat gives somewhat bizarre behavior where going back will swipe sometimes but not other times depending on how long you spent reading the second page, right?  Hence my proposal to compress to png on a timer...", "author": "bzbarsky@mit.edu", "id": 5825533, "time": "2011-11-04T02:04:30Z"}, {"text": "Or scale the image down and then compress... Didn't Panorama already deal with all these issues?\n\n(In reply to Timothy Nikkel (:tn) from comment #48)\n> On a content document which isn't a display root this flag will be silently\n> ignored because we don't currently support pulling the layer contents\n> starting at non-root container layers.\n\nTrue. We should fix that.", "author": "roc@ocallahan.org", "id": 5825569, "time": "2011-11-04T02:24:47Z"}, {"text": "> Didn't Panorama already deal with all these issues?\n\nGood question.  Note that panorama did not need to show the images at full page size, and was storing one image per tab, not 10 per tab... but seeing what they did could be useful.", "author": "bzbarsky@mit.edu", "id": 5825607, "time": "2011-11-04T02:56:11Z"}, {"text": "(In reply to Steven Michaud from comment #41)\n> When trying to build all patches at once, my build dies with the following\n> error:\n> \n> RuntimeError: File \"linen-pattern.png\" not found in\n\nThat file is added by the part 3 patch. Compiling works for me if I apply the patches using hg qimport. Did you use something else? (The normal patch command doesn't work with binary files in diffs.) In any case, if you remove the linen-pattern.png line from jar.mn, compiling should work even if the file isn't present.", "author": "mstange@themasta.com", "id": 5826149, "time": "2011-11-04T12:27:51Z"}, {"text": "Whatever we're storing in memory, be they compressed or uncompressed images, we should purge on a memory pressure notification.\n\nI think we should also have a global limit on how many images we store.", "author": "justin.lebar+bug@gmail.com", "id": 5828169, "time": "2011-11-05T05:27:54Z"}, {"text": "Comment on attachment 571315\npart 2, v2: send swipe events from the swipe tracking handler\n\nI can't see anything wrong with this patch.\n\nAnd now that I realize I need to use hg qimport, I've also built the\nwhole patch and tested it.  My tests weren't particularly thorough,\nand I did notice some problems.  But overall I was very impressed.\n\nThe worst problem I saw is that swiping isn't smooth on very busy\npages (e.g. swiping back and forth between http://www.theonion.com/\nand any of the \"Newswire\" links on that page).  But you see the same\njerkiness with my much simpler (and less resource-intensive) patch\nfrom bug 698761.  So I suspect this is some kind of Apple bug, or a\nbad interaction between how we manage event loops and how Apple\nmanages horizontal two-finger swiping.  (The jerkiness doesn't occur\nin Safari or Chrome, both of which are (of course) WebKit browsers.)\n\nI've started a tryserver build based on Markus' patches, which should\nbe available in the next hour or two.\n\nI also noticed another (relatively minor) bug.  But then I noticed the\nsame thing happens in Safari.  Which may make it a feature, or at\nleast may make it difficult for us to do anything about it.  Here's\nSTR:\n\n1) Open 3-4 pages in succession in the same browser window, all of\n   which have horizontal scroll bars (in other words, resize the\n   window so that this is true).\n\n2) As you swipe\tbetween them, either with Markus' patch\tor in Safari,\n   you'll notice that if you swipe slowly (if you pause for a few\n   seconds between swipes), you won't be able to swipe from page A to\n   page B until page A has been scrolled all the way to one side.  But\n   if you pause only briefly between swipes, you'll swipe to page B\n   even before page A has scrolled all the way to one side.\n\nThis doesn't seem right to me.  But Safari's behavior may somehow\nlegitimize it.  And since we, like Safari, use -[NSEvent\ntrackSwipeEventWithOptions:...] to track swipe events, there may not\nbe a lot we can do about it.", "author": "smichaud@pobox.com", "id": 5832327, "time": "2011-11-07T22:36:30Z"}, {"text": "Here's a tryserver build made with Markus' latest patches:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/smichaud@pobox.com-e8ec712227b5/try-macosx64/firefox-10.0a1.en-US.mac.dmg\n\nPlease try it out and let us know your results.", "author": "smichaud@pobox.com", "id": 5832337, "time": "2011-11-07T22:38:46Z"}, {"text": "(Following up comment #54)\n\n> I also noticed another (relatively minor) bug.  But then I noticed\n> the same thing happens in Safari.  Which may make it a feature, or\n> at least may make it difficult for us to do anything about it.\n> ...\n\nThe same thing happens with my patch for bug 698761.", "author": "smichaud@pobox.com", "id": 5832386, "time": "2011-11-07T22:55:44Z"}, {"text": "(In reply to Steven Michaud from comment #54)\n> The worst problem I saw is that swiping isn't smooth on very busy\n> pages (e.g. swiping back and forth between http://www.theonion.com/\n> and any of the \"Newswire\" links on that page).  But you see the same\n> jerkiness with my much simpler (and less resource-intensive) patch\n> from bug 698761.  So I suspect this is some kind of Apple bug, or a\n> bad interaction between how we manage event loops and how Apple\n> manages horizontal two-finger swiping.  (The jerkiness doesn't occur\n> in Safari or Chrome, both of which are (of course) WebKit browsers.)\n\nProbably because those browsers are multiprocess and we aren't (yet); in particular page JS can delay our animation repaints in Firefox, but it can't in those browsers. We need e10s or at least asynchronous compositing.", "author": "roc@ocallahan.org", "id": 5832460, "time": "2011-11-07T23:14:38Z"}, {"text": "Created attachment 573552\nwebpage does not fill entire browser window\n\nDownloaded the tryserver build and noticed that not all the page loaded for some reason.  See attached screenshot.  \n\nOne other observation was that the page appeared to have a slight lag when loading pages on nytimes.com  Not sure if this was due to the animation build or if Fx10 has some other issues.  \n\nI'm on 10.7.2.", "author": "clee@mozilla.com", "id": 5840458, "time": "2011-11-10T17:51:17Z"}, {"text": "> Downloaded the tryserver build and noticed that not all the page\n> loaded for some reason.  See attached screenshot.\n\nWas the page maximized when you saw this?\n\n> One other observation was that the page appeared to have a slight\n> lag when loading pages on nytimes.com\n\nAs I mentioned in comment #54, I saw severe choppiness and lag with\nbusy pages like those at http://www.theonion.com/.  And (oddly) these\nproblems seem just as bad with my (much less resource intensive) patch\nfor bug 698761.\n\nIs this also true of the problem(s) you saw?  Are they just as bad\nwith my patch for bug 698761 as they are with Markus' patches?", "author": "smichaud@pobox.com", "id": 5847106, "time": "2011-11-14T18:24:33Z"}, {"text": "(In reply to Steven Michaud from comment #59)\n> > Downloaded the tryserver build and noticed that not all the page\n> > loaded for some reason.  See attached screenshot.\n> \n> Was the page maximized when you saw this?\n\nYes.\n\n> \n> > One other observation was that the page appeared to have a slight\n> > lag when loading pages on nytimes.com\n> \n> As I mentioned in comment #54, I saw severe choppiness and lag with\n> busy pages like those at http://www.theonion.com/.  And (oddly) these\n> problems seem just as bad with my (much less resource intensive) patch\n> for bug 698761.\n> \n> Is this also true of the problem(s) you saw?  Are they just as bad\n> with my patch for bug 698761 as they are with Markus' patches?\nI didn't sense that they were as bad with your patch in bug 698761.  It was much more noticeable in this build for full animation support.", "author": "clee@mozilla.com", "id": 5865973, "time": "2011-11-22T18:52:50Z"}, {"text": "Created attachment 580525\nMarkus' latest patches, updated to current trunk\n\nHere are Markus' latest patches, updated to current trunk code.  A new tryserver build will follow in a few hours.", "author": "smichaud@pobox.com", "id": 5905190, "time": "2011-12-09T21:22:13Z"}, {"text": "> Markus' latest patches\n\nThe most recent of those that Markus attached above.", "author": "smichaud@pobox.com", "id": 5905210, "time": "2011-12-09T21:30:20Z"}, {"text": "Here's the new tryserver build:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/smichaud@pobox.com-dd4193296c37/try-macosx64/firefox-11.0a1.en-US.mac.dmg", "author": "smichaud@pobox.com", "id": 5905790, "time": "2011-12-10T00:53:19Z"}, {"text": "In order to get a rough idea how much further optimization may be\nneeded for Markus's patch, I just did a few experiments with it and\nSafari on OS X 10.7.2.  The impression I get is \"not much\".  In other\nwords, the performance of Markus' patch (in terms of memory and CPU\nusage) compares pretty well with Safari, and very well with Firefox\nwithout Markus' patch.\n\nIn all of these tests I did the following:\n\n1) Started the browser (FF with Markus' patch or Safari) and waited\n   about 60 seconds for memory usage to settle down.  Then I measured\n   its RSIZE and VSIZE in 'top' (ssh-ed in from another computer).\n\n   For Safari I measured RSIZE and VSIZE for both the \"Safari\" and\n   \"WebProcess\" processes.\n\n2) Entered the following (partial) URLs, in order, in the location\n   bar.  After entering each one, I waited for the page to finish\n   loading before I entered the next one.  (None of these pages\n   currently loads any plugins.)\n\n   mozilla.org\n   bugzilla.mozilla.org\n   ibm.com\n   microsoft.com\n   apple.com\n\n3) Used two-finger swipes or the Back and Forward buttons to do the\n   following ten times:  Go back in history to the first page, then go\n   forward in history to the last page.\n\n4) Then I waited about 60 seconds for top's RSIZE and VSIZE to\n   stabilize again, then measured them again.\n\nVSIZE didn't change much in any of these tests.  But RSIZE roughly\ndoubled for both Firefox and Safari, *whether or not the two-finger\nswipe or the Back and Forward buttons were used*.\n\nTwo-finger swiping with Markus's patch does temporarily use lots of\nRAM -- RSIZE maxes out at roughly 3.5 times its original size (before\nsetting down to twice the original size).  But even using the Back and\nForward buttons temporarily triples RSIZE.\n\nTwo-finger swiping (with Markus' patch) seems roughly twice as\nCPU-intensive in Firefox as using the Back and Forward buttons.  In\nSafari, interestingly, they appear to be equally CPU-intensive.  So\nmaybe there's some room for improvement here.  But we wouldn't want to\ngo too far -- two-finger swiping with Markus' current patch seems (to\nme) quite a bit more responsive than in Safari.  (I'm sure it helps\nthat none of the pages in my test have plugins.  As we've already\nseen, responsiveness is severely degraded with \"busy\" pages like those\nat http://www.theonion.com/ -- presumably because they have lots of\nplugins.)", "author": "smichaud@pobox.com", "id": 5923574, "time": "2011-12-16T23:46:52Z"}, {"text": "(In reply to Steven Michaud from comment #63)\n> Here's the new tryserver build:\n> http://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/smichaud@pobox.com-\n> dd4193296c37/try-macosx64/firefox-11.0a1.en-US.mac.dmg\n\nHi Steven,\nCould you do a new build please?\nThat one seems to have expired.", "author": "lexi@lexi.org.uk", "id": 6157684, "time": "2012-03-21T00:49:54Z"}, {"text": "Created attachment 608120\nMarkus' latest patches, updated to current trunk\n\nHere's the build:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/smichaud@pobox.com-b18d21ab3fad/try-macosx64/firefox-14.0a1.en-US.mac.dmg\n\nPlease download it (and test with it) as soon as possible.  It's likely to vanish off the servers in as little as a week.", "author": "smichaud@pobox.com", "id": 6160577, "time": "2012-03-21T22:42:48Z"}, {"text": "I have still the problem that when swiping back and forth between certain sites, it happens, that the old site gets displayed shortly before the correct site is displayed: http://dl.dropbox.com/u/232093/Bildschirmaufnahme.mov\n\nAnother old issue is vertical sync. You can't see it in the video but the animation doesn't look as good as in safari. This is not a problem of this patch but a general one of firefox (on the mac). Same problem appears with scrolling, video playback etc. Would be nice if this problem could be addressed soon, too.", "author": "beingalink@googlemail.com", "id": 6160702, "time": "2012-03-21T23:20:33Z"}, {"text": "I've managed to get stuck in between 2 pages:\nhttp://dl.dropbox.com/u/2311018/temp/2012-03-23_17.54.10.jpg\n\nI can swipe again to remove the 2nd page from the screen, but the swipe remains broken for that tab (after few swipes it behaves in the same way).\n\nI'm using the build posted by Steven.", "author": "valentin@tutu.ro", "id": 6165855, "time": "2012-03-23T16:09:49Z"}, {"text": "(In reply to comment #68)\n\nDo you have a way to reproduce this consistently?  One that works at least 50% of the time?\n\nIf so, please give us precise steps to reproduce.", "author": "smichaud@pobox.com", "id": 6165887, "time": "2012-03-23T16:25:34Z"}, {"text": "No, sorry. I will try to see if it happens again. It happened after a few hours of using the new build.", "author": "valentin@tutu.ro", "id": 6165906, "time": "2012-03-23T16:29:24Z"}, {"text": "Markus: Sorry that I haven't gotten around to reviewing this in a reasonable amount of time. Frank said he'd be able to take a look at the updated patch, I'll flag him for feedback.", "author": "gavin.sharp@gmail.com", "id": 6173436, "time": "2012-03-27T01:26:34Z"}, {"text": "Created attachment 617980\nMarkus' latest patches, updated to current trunk\n\nI've updated Markus' patches to current trunk again.  And this time I've taken the liberty of landing them on the ux branch (as Markus' patches for the Lion scrollbar style at bug 636564 were landed a while ago).\n\nhttp://hg.mozilla.org/projects/ux/rev/52161cd6e3ea\n\nIt seems pointless to keep producing tryserver builds that disappear in a week, and which nobody uses.", "author": "smichaud@pobox.com", "id": 6250158, "time": "2012-04-24T19:01:18Z"}, {"text": "The current implementation in the UX branch is a tremendous step up from no animation at all.\n\nIt tends to be a bit sluggish on media-heavy sites such as theverge.com but all in all it works quite well.", "author": "johan@johanl.se", "id": 6276616, "time": "2012-05-03T15:26:16Z"}, {"text": "(In reply to comment #73)\n\nThanks for your tests.\n\nAs for the sluggishness, please try comparing performance on the same sites (and with the same behavior) to that in Safari and Chrome.  If our performance is significantly worse than other browsers, we may need to make some changes.  If it's about the same, we might just decide to live with it (and spend our time on other things).", "author": "smichaud@pobox.com", "id": 6276698, "time": "2012-05-03T15:48:27Z"}, {"text": "Performance is definitely worse than with Safari here. It's quite sluggish like a 1st person shooter on underspecced hardware. I'm on a Macbook Core2Duo 2Ghz, 4GB RAM, NVIDIA GeForce 9400M.", "author": "beingalink@googlemail.com", "id": 6276740, "time": "2012-05-03T15:58:50Z"}, {"text": "(In reply to comment #75)\n\nI was talking about sluggishness while swiping.  Anything else is another bug.", "author": "smichaud@pobox.com", "id": 6276750, "time": "2012-05-03T16:00:57Z"}, {"text": "Of course I'm talking about the swipe animation.", "author": "beingalink@googlemail.com", "id": 6276755, "time": "2012-05-03T16:01:58Z"}, {"text": "You swipe back and forth between pages (in history) while playing a game?!", "author": "smichaud@pobox.com", "id": 6276823, "time": "2012-05-03T16:14:43Z"}, {"text": "Sorry, didn't think my English was that bad. I was just making a comparison. The swipe animation doesn't look ready-to-be-released good. The animation hangs and looks like it would have vsync issues. Someone was pointing me to corresponding bugs that might be related (Comment 30). Perhaps fixing these might make the animation look better. Perhaps it's also just my hardware not being sufficient. In Safari the animation looks mostly fine though.", "author": "beingalink@googlemail.com", "id": 6276885, "time": "2012-05-03T16:25:57Z"}, {"text": "I agree with beingalink. It's definitely more sluggish than Safari. I have an early 2008 Macbook Pro. Graphics card: 8600M GT. \n\nThe animation definitely looks great but in image heavy sites, the animation gets sluggish. I can't compare it to Chrome since it doesn't have the same style but Safari's animation is much more smoother for me. \n\nOne other thing I noticed is that if I'm on a tab and switch tabs for a while and come back to that tab and do a back animation, the animation shows me something completely different and then takes me to the correct page. \n\nFor example, lets say I have the verge loaded on a specific article and then go back to the front page of the Verge. Then I leave the article to visit other tabs and then come back to the tab and then press back. The animation shows me the article I was on and then loads the front page for me. Does this happen to anyone else?\n\nMaybe this is the reason why it's so sluggish sometimes?\n\nAnyways, I appreciate all the work that's gone into this bug. And like I said, it looks fantastic when it's smooth.", "author": "xan1790@yahoo.com", "id": 6278243, "time": "2012-05-03T21:33:37Z"}, {"text": "I also made a screen recording showing the bug. When I try the animation, the previous page shows the front page but when I complete the animation, it's actually loads the correct page. It just shows the animation page wrong. \n\nDropbox link(24MB screen recording): http://dl.dropbox.com/u/34865/firefox%20animation%20bug.mov\n\nI tried to also show the cpu and ram firefox was taking during the animation and you can see how sluggish it is. If I do the animation again after completing it on the same tab, the animation is smooth again and shows the correct page and loads the correct page.", "author": "xan1790@yahoo.com", "id": 6282210, "time": "2012-05-05T01:51:43Z"}, {"text": "Comment on attachment 617980\nMarkus' latest patches, updated to current trunk\n\nIn the common case, this already works great, at least on my machine. :)\n\nUnfortunately, this glitches when the viewport does not take up the entire width of the browser window, e.g. when a sidebar is open. The snapshot needs to stay at a z-index below any sidebars, and the positioning of the snapshot needs to account for any window width not taken up by the viewport.\n\nI'll give more detailed feedback, including for specific code, later tonight in another comment.", "author": "fryn@frankyan.com", "id": 6295501, "time": "2012-05-10T02:06:40Z"}, {"text": "Comment on attachment 617980\nMarkus' latest patches, updated to current trunk\n\nReview of attachment 617980:\n-----------------------------------------------------------------\n\nThis is an edge case, but if tabs get switched from tab A to tab B during a swipe (while the user is in contact with the trackpad), the history navigation gets applied to tab B, even though the animation was displayed on tab A.\n\n::: browser/base/content/browser.js\n@@ +1138,5 @@\n> +    this._doEnd = function GS__doEnd(aEvent) {\n> +      gHistorySwipeAnimation.stopAnimation();\n> +\n> +      self._doUpdate = function (aEvent) {};\n> +      self._doEnd = function (aEvent) {};\n\nWhy is `self` needed here?\n_doEnd is always called with the proper `this`.\n\n@@ +1477,5 @@\n> +  _farthestIndex: function HSA__farthestIndex(indices, fromIndex) {\n> +    indices.sort(function numberComparator(a, b) (a - b));\n> +    let lowestIndex = indices[0];\n> +    let highestIndex = indices[indices.length - 1];\n> +    let distanceToHighest = Math.abs(highestIndex - currentIndex);\n\ncurrentIndex is not defined, so cache eviction is broken in this patch.\n\n@@ +1499,5 @@\n> +      // Evict the snapshot for the page that is farthest away from the current page.\n> +      // TODO: evict everything on memory pressure notification\n> +      let indexToDelete = this._farthestIndex(Object.keys(snapshots), currentIndex);\n> +      delete snapshots[indexToDelete];\n> +    }\n\nWe should profile this to see how much memory this uses over time.\n\n::: browser/themes/pinstripe/browser.css\n@@ +1595,5 @@\n> +/* History Swipe Animation */\n> +\n> +#historySwipeAnimationCurrentPage,\n> +#historySwipeAnimationNextPage {\n> +  box-shadow: 0 3px 6px rgba(0, 0, 0, 0.6);\n\nOur built-in sidebars (bookmarks, etc.) need to be at a higher z-index than these pages, especially for cases in which these pages over-scroll (bounce back).\n\nAlso, we should prevent pages from being translated more than their width. To see what I mean in slow motion, open the bookmarks sidebar, click the back button and then start swiping with 2 fingers to the left (to go forward) and then hold them down. Use a third finger (easier with a second hand) to repeatedly swipe to the left until the page slides over the bookmarks sidebar.", "author": "fryn@frankyan.com", "id": 6329630, "time": "2012-05-23T00:47:51Z"}, {"text": "Created attachment 626956\npart 1", "author": "mstange@themasta.com", "id": 6336216, "time": "2012-05-24T21:12:05Z"}, {"text": "Created attachment 626957\npart 2", "author": "mstange@themasta.com", "id": 6336218, "time": "2012-05-24T21:12:35Z"}, {"text": "Created attachment 626958\npart 3", "author": "mstange@themasta.com", "id": 6336224, "time": "2012-05-24T21:14:00Z"}, {"text": "Created attachment 626960\npart 4", "author": "mstange@themasta.com", "id": 6336227, "time": "2012-05-24T21:14:39Z"}, {"text": "Thanks for the review, Frank!\n\n(In reply to Frank Yan (:fryn) from comment #82)\n> Unfortunately, this glitches when the viewport does not take up the entire\n> width of the browser window, e.g. when a sidebar is open. The snapshot needs\n> to stay at a z-index below any sidebars, and the positioning of the snapshot\n> needs to account for any window width not taken up by the viewport.\n\nI've fixed this by wrapping the overlay boxes in a <stack> and setting overflow: hidden on that stack. The positioning of the snapshots already took into account the available viewport area, it wasn't based on window dimensions.\n\nI've also removed the backdrop box and set the background pattern on the new container stack.\n\n> This is an edge case, but if tabs get switched from tab A to tab B during a\n> swipe (while the user is in contact with the trackpad), the history\n> navigation gets applied to tab B, even though the animation was displayed on\n> tab A.\n\nHmm, yes, this is unfortunate but don't see a simple fix here. Do you think it's worth worrying about?\n\n> \n> ::: browser/base/content/browser.js\n> @@ +1138,5 @@\n> > +    this._doEnd = function GS__doEnd(aEvent) {\n> > +      gHistorySwipeAnimation.stopAnimation();\n> > +\n> > +      self._doUpdate = function (aEvent) {};\n> > +      self._doEnd = function (aEvent) {};\n> \n> Why is `self` needed here?\n> _doEnd is always called with the proper `this`.\n\nGood catch, it's not needed. Fixed.\n\n> \n> @@ +1477,5 @@\n> > +  _farthestIndex: function HSA__farthestIndex(indices, fromIndex) {\n> > +    indices.sort(function numberComparator(a, b) (a - b));\n> > +    let lowestIndex = indices[0];\n> > +    let highestIndex = indices[indices.length - 1];\n> > +    let distanceToHighest = Math.abs(highestIndex - currentIndex);\n> \n> currentIndex is not defined, so cache eviction is broken in this patch.\n\nUgh, I had noticed that ages ago but apparently never uploaded a fixed patch. Anyway, fixed now by renaming the parameter to currentIndex.\n\n> \n> @@ +1499,5 @@\n> > +      // Evict the snapshot for the page that is farthest away from the current page.\n> > +      // TODO: evict everything on memory pressure notification\n> > +      let indexToDelete = this._farthestIndex(Object.keys(snapshots), currentIndex);\n> > +      delete snapshots[indexToDelete];\n> > +    }\n> \n> We should profile this to see how much memory this uses over time.\n\nI've done a few measurements; we need 3 to 5 MB per snapshot (depending on the viewport size), and we have a default limit of 10 per tab, so that means a maximal memory usage of 30 to 50MB per tab. If that turns out to be too much, browser.snapshots.maxPerTab can be tweaked.\n\nIt would be good to have a hard limit on the total number of snapshots, but I haven't thought of a good way to implement that yet. If we add a global snaphot registry, we lose the GC-based discarding of closed tabs' snapshots, so we'd have to discard them manually on tab close. It's probably better than unbounded memory growth, but I'm not sure if it's worth the effort.\n\n> ::: browser/themes/pinstripe/browser.css\n> @@ +1595,5 @@\n> > +/* History Swipe Animation */\n> > +\n> > +#historySwipeAnimationCurrentPage,\n> > +#historySwipeAnimationNextPage {\n> > +  box-shadow: 0 3px 6px rgba(0, 0, 0, 0.6);\n> \n> Our built-in sidebars (bookmarks, etc.) need to be at a higher z-index than\n> these pages, especially for cases in which these pages over-scroll (bounce\n> back).\n\nFixed with overflow:hidden, see above.\n\n> Also, we should prevent pages from being translated more than their width.\n> To see what I mean in slow motion, open the bookmarks sidebar, click the\n> back button and then start swiping with 2 fingers to the left (to go\n> forward) and then hold them down. Use a third finger (easier with a second\n> hand) to repeatedly swipe to the left until the page slides over the\n> bookmarks sidebar.\n\nNow that pages can't overlap the sidebar any more, I don't think we need to do anything here.", "author": "mstange@themasta.com", "id": 6336254, "time": "2012-05-24T21:24:49Z"}, {"text": "This patch was backed out of the UX Nightly branch due to code churn. Please update the patch and reland if you would like it to remain on the UX branch.", "author": "jaws@mozilla.com", "id": 6404293, "time": "2012-06-19T19:22:13Z"}, {"text": "I really don't understand why Mozilla doesn't invest more resources to fix this bug. Lion has been released a year ago. Swipe gestures are nearly unusable without the animation - one often goes back or forward accidentally and doesn't even realize what happened. I know many people who have switched back to Safari because they want to be able to swipe back and forward properly.\n\nMarkus quickly created a fantastic patch and noone seems to care. He replied to the review on May 24th. Instead of the Mozilla guys being very happy and doing everything they can to answer the last questions and get this patch into the next version of Firefox, they do: nothing at all.\n\n\"This patch was backed out of the UX Nightly branch due to code churn. Please update the patch and reland if you would like it to remain on the UX branch.\"\n\nAnd what happens if Markus does the work and updates the patch? Then it's back in the UX branch, great. If noone from Mozilla seems committed to this feature and it will get stuck in the UX branch forever, then we cannot expect from Markus that he invests any more work in his patch which is a real pity.", "author": "e1857104@rtrtr.com", "id": 6467128, "time": "2012-07-12T18:53:40Z"}, {"text": "We don't have enough Mac developers and those we do have are working on other bugs like bug 674373.", "author": "roc@ocallahan.org", "id": 6468509, "time": "2012-07-13T02:28:57Z"}, {"text": "#91 #90 That's exactly the point! \n\nThere is not enough developers and (apparently) the code generated by users are not being used. It doesn't make much sense to me. Since the problem is the lack of developers, user input should be very appreciated rather than ignored.\n\nOf course, it might be necessary some further verifications in the source code and maybe some optimisations. However this is better than working on the ticket from scratch.\n\nSorry if I judgment is mistaken here. I writing based only on this ticket and on another I submitted a couple years ago.", "author": "contact@marcelocarlos.com", "id": 6469302, "time": "2012-07-13T11:32:03Z"}, {"text": "(In reply to comment #92)\n\nPlease read the bug's comments more carefully.  If you do you'll see that, though Markus' work appears close to complete, there are still significant problems.  And Markus' patches reach into many parts of the tree, so it's difficult to predict how long it will take to fix the problems.\n\nFurthermore the current history swipe support is *not* unusable ... though it would certainly be improved by Markus' patches.\n\nFinally, since I'm the only full-time Mac developer, it's impossible for me to spend more than about a week at a time on any one bug.  And it's often difficult to find *any* time when I'm distracted by bugs that are clearly more urgent than this one -- things like topcrashers or particularly bad UI bugs.\n\nMozilla's been working at hiring more Mac developers.  With luck we'll soon start being able to pay more attention to second-tier bugs like this (ones that it'd be really nice to have fixes for, but which aren't critical).", "author": "smichaud@pobox.com", "id": 6469777, "time": "2012-07-13T14:37:24Z"}, {"text": "*** Bug 680261 has been marked as a duplicate of this bug. ***", "author": "joe@drew.ca", "id": 6533361, "time": "2012-08-06T05:11:54Z"}, {"text": "Comment on attachment 626958\npart 3\n\nReview of attachment 626958:\n-----------------------------------------------------------------\n\nUnfortunately, these patches have bitrotted, but the code seems ready for someone to take a look at it.", "author": "fryn@frankyan.com", "id": 6543036, "time": "2012-08-09T09:40:39Z"}, {"text": "I just wanted to chime in and say that even though I lack the skills to accomplish this bit of eye candy, I would really appreciate anyone who is able to and would make a donation for the effort.", "author": "astravian@gmail.com", "id": 6585006, "time": "2012-08-27T02:01:40Z"}, {"text": "Created attachment 660348\nA patch that folds Markus' parts 1-4 into one. Removed all conflicts/rejections with regards to the current nightly tip and tied up loose ends.\n\nI folded all four parts into one patch, removed the bitrot with regards to the current nightly tip and tied up the loose ends. Any feedback is appreciated.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6628152, "time": "2012-09-12T08:24:51Z"}, {"text": "Created attachment 660354\nA patch that folds Markus' parts 1-4 into one.\n\nRemoved a printf and comments used for debugging.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6628181, "time": "2012-09-12T08:46:29Z"}, {"text": "Stephen, here's what I suggest would be most valuable for you to do:\n\nUse your build (made with your patch) to go through all problems reported here, figure out which ones are still reproducible, and then document them in reasonable detail (conditions required, steps to reproduce, and so forth).\n\nAlso (of course) weed out any problems that *aren't* due to Markus' patches (that also happen in current mozilla-central nightly builds).\n\nEven better if you can find fixes for them! :-)", "author": "smichaud@pobox.com", "id": 6629543, "time": "2012-09-12T17:48:27Z"}, {"text": "Right, I should probably have mentioned that I won't be able to look into this until the weekend. I thought that fixing up the patch to compile with the current trunk might make it a bit easier for someone else to look into this too, if interested.\n\nI'll be going through the list of issues over the weekend, unless somebody beats me to it. :-)", "author": "spohl.mozilla.bugs@gmail.com", "id": 6630915, "time": "2012-09-13T00:26:36Z"}, {"text": "This is going to be a pretty long comment, so I'm summarizing it here:\nI didn't run into any performance problems or other bugs and think this patch is of good quality. However, performance might have been good due to my higher-end system (2.6 GHz i7 + 16GB RAM). Feedback from lower-end systems would be appreciated. There are a few questions that we might want to answer before landing this patch. These questions are listed first, followed by all the performance related issues where feedback would be welcome and the list ends with general bugs that were reported. All issues were either UTR for me, or expected behavior in my opinion.\n\n=== Questions (are these must-haves for this patch?) ===\nQ1.  (Boris Zbarsky) Memory.  We're talking, for my case, say, 10 images each 921x936 pixels, right?  That's about 35MB per tab (10 * 921 * 936 * 4), if all 10 image slots are in use. That does seem like a lot...  Have you measured whether this is in fact about the sort of memory usage you see? If so, I would be interested in the numbers if instead you take the canvas, call mozGetAsFile on it, then create a filedata URI from that and just use <img> pointed at that URI.  And only create actual HTMLImageElement objects for the ones that you're sticking in mozSetImageElement.  This does need more CPU to encode/decode; perhaps the right way to do it is off an idle timer of some sort?\n- (Stephen) Confirmed not currently implemented.\n\nQ2.  (Boris Zbarsky) Snapshotting time:  Please check with roc or tn?  Ccing them. If there's a way we can just get the data out of the layer system that would be ideal.\n- (Stephen) I haven't faced issues with the performance of the latest patch. This may be due to my higher-end system however.\n\nQ3. (Boris Zbarsky) Pushstate.  We could fire a chrome-only event of some sort there, I guess.  ccing Justin.  But the page may well update itself before calling pushstate....  This is where the layer system might save us, I guess.\n- (Stephen) Not sure if this feedback went into Markus' patches.\n\nQ4. (Justin Lebar) I think we should also have a global limit on how many images we store. Markus' comment: \"It would be good to have a hard limit on the total number of snapshots, but I haven't thought of a good way to implement that yet. If we add a global snaphot registry, we lose the GC-based discarding of closed tabs' snapshots, so we'd have to discard them manually on tab close. It's probably better than unbounded memory growth, but I'm not sure if it's worth the effort\"\n- (Stephen) Confirmed that we don't currently have a global limit.\n\nQ5. (Justin Lebar) Whatever we're storing in memory, be they compressed or uncompressed images, we should purge on a memory pressure notification.\n- Confirmed not currently implemented.\n\n=== Performance issues ===\nP1. Animation not as smooth as Safari. However, Comment 17 by beingalink@googlemail.com said: \"I guess that's a firefox problem as I can also see this kind of distortion on other pages that use animated DOM (example: http://www.annapialink.de/wp/ )\"\n- (Stephen) UTR, might be due to my higher-end system\n\nP2. Jagged edges during animation. Markus' comment: \"This is called \"tearing\" and occurs because we don't use vertical sync, see bug 555834 and bug 689418. It occurs on all animations, it's just more visible for horizontal animations (like the swipe animation here).\"\n- (Stephen) UTR, might be due to my higher-end system\n\nP3. The worst problem I saw is that swiping isn't smooth on very busy pages (e.g. swiping back and forth between http://www.theonion.com/ and any of the \"Newswire\" links on that page).  But you see the same jerkiness with my much simpler (and less resource-intensive) patch from bug 698761.  So I suspect this is some kind of Apple bug, or a bad interaction between how we manage event loops and how Apple manages horizontal two-finger swiping.  (The jerkiness doesn't occur in Safari or Chrome, both of which are (of course) WebKit browsers.) According to Robert O'Callahan: Probably because those browsers are multiprocess and we aren't (yet); in particular page JS can delay our animation repaints in Firefox, but it can't in those browsers. We need e10s or at least asynchronous compositing.\n- (Stephen) I was unable to reproduce this, but this may very well be due to my higher-end system.\n\nP4. Two-finger swiping with Markus's patch does temporarily use lots of RAM -- RSIZE maxes out at roughly 3.5 times its original size (before setting down to twice the original size).  But even using the Back and Forward buttons temporarily triples RSIZE.\n- (Stephen) UTR. Although RAM increases slightly, it doesn't seem to exceed 20% for me with a baseline of 300MB. It settles close to the original 300MB.\n\nP5. Two-finger swiping (with Markus' patch) seems roughly twice as CPU-intensive in Firefox as using the Back and Forward buttons.  In Safari, interestingly, they appear to be equally CPU-intensive.  So maybe there's some room for improvement here.  But we wouldn't want to go too far -- two-finger swiping with Markus' current patch seems (to me) quite a bit more responsive than in Safari.  (I'm sure it helps that none of the pages in my test have plugins.  As we've already seen, responsiveness is severely degraded with \"busy\" pages like those at http://www.theonion.com/ -- presumably because they have lots of plugins.)\n- (Stephen) I may not have used the same method that Steven used to profile this, but I couldn't detect a massive difference between swiping and using the back/forward buttons in terms of CPU usage.\n\n=== Issues and their current status ===\n1. swipe beyond first/last page is possible (white page)\n- (Stephen) UTR\n\n2. If you don't wait for animation to complete and swipe back into the other direction, the animation gets disabled. Fast swiping afterwards results in no animation anymore.\n- (Stephen) UTR\n\n3. Problem with Google+: Leaving Google+ to go to another page, then coming back, then going forward only reloads Google+, not the correct next page (might be due to bug 682115 according to Markus).\n- (Stephen) UTR, next page gets loaded correctly\n\n4. History navigation should block interaction until the pageshow.\n- (Stephen) Confirmed that page interaction is blocked until the animation completes.\n\n5. Sometimes animation just stops working (fixed according to Markus)\n- (Stephen) UTR\n\n6. Sometimes, a black gutter is added to the page on the bottom and right at the start of the animation (removed when animation completes) (Markus believes he has fixed this)\n- (Stephen) UTR\n\n7. It gets very confused when navigating in multiple tabs simultaneously. Steps:\na. search in google\nb. click one of the links and wait until site is loaded (A)\nc. swipe back to google results\nd. middle-click (open in a tab in the background) one of the other links (B)\ne. swipe forward \nOn my machine this will causes a preview of the site which was loaded (A) to be slide in, but part way through the browser changes it to a white page. After this it forgets all navigation history for the tab. No page is loaded. The address bar remains the address of the google search results. No sure if it's coincidence but every time I have triggered this the tab loading site B doesn't complete. (Markus could no longer reproduce this after his most recent changes)\n- (Stephen) UTR\n\n8. If you go to http://itunes.apple.com/app/shantae-riskys-revenge/id431535202?mt=8, and try to scroll horizontally to see the next images, you can't scroll horizontally and instead triggers the swipe animation, even after clicking inside the little box. (Emanuele believes that the conflict is caused by bug #668953 rather than this, as it's currently present in both Nightly and Aurora builds and absent in Beta and Release builds.)\n- (Stephen) Confirmed that this issue occurs, however, it also occurs in the nightly build without the swipe patch applied. This may very well be due to #668953 as Emanuele suggested.\n\n9. Open 3-4 pages in succession in the same browser window, all of which have horizontal scroll bars (in other words, resize the window so that this is true). As you swipe between them, either with Markus' patch\tor in Safari, you'll notice that if you swipe slowly (if you pause for a few seconds between swipes), you won't be able to swipe from page A to page B until page A has been scrolled all the way to one side.  But if you pause only briefly between swipes, you'll swipe to page B even before page A has scrolled all the way to one side. This doesn't seem right to me.  But Safari's behavior may somehow legitimize it.  And since we, like Safari, use -[NSEvent trackSwipeEventWithOptions:...] to track swipe events, there may not be a lot we can do about it.\n- (Stephen) Confirmed that we match the behavior in Safari. My personal opinion is that this should be the expected behavior.\n\n10. I have still the problem that when swiping back and forth between certain sites, it happens, that the old site gets displayed shortly before the correct site is displayed: http://dl.dropbox.com/u/232093/Bildschirmaufnahme.mov\n- (Stephen) UTR\n\n11. I've managed to get stuck in between 2 pages: http://dl.dropbox.com/u/2311018/temp/2012-03-23_17.54.10.jpg (no consistent repro steps)\n- (Stephen) UTR\n\n12. One other thing I noticed is that if I'm on a tab and switch tabs for a while and come back to that tab and do a back animation, the animation shows me something completely different and then takes me to the correct page.\n- (Stephen) UTR\n\n13. Unfortunately, this glitches when the viewport does not take up the entire width of the browser window, e.g. when a sidebar is open. The snapshot needs to stay at a z-index below any sidebars, and the positioning of the snapshot needs to account for any window width not taken up by the viewport.\n- (Stephen) UTR", "author": "spohl.mozilla.bugs@gmail.com", "id": 6637348, "time": "2012-09-15T07:01:40Z"}, {"text": "As far as must-haves go, I think having at least memory measurements for your typical half-dozen-tabs-reading-the-news case is a must-have.", "author": "bzbarsky@mit.edu", "id": 6637373, "time": "2012-09-15T07:29:47Z"}, {"text": "Comment on attachment 660354\nA patch that folds Markus' parts 1-4 into one.\n\nReview of attachment 660354:\n-----------------------------------------------------------------\n\nThanks, Stephen!\n\nI haven't gone over this in detail (I don't have the time right now).\n\nBut I'm inclined to say we can start asking for review(s) as soon as we have some way of measuring this patch's additional memory usage (in a debug build).  Whatever problems remain can be dealt with as separate bugs after the patch has landed.  But we probably want to land this early in a release cycle (to give it maximum baking time before a release).\n\nBy the way, when you ask for feedback or a review, you normally need to ask a specific person.", "author": "smichaud@pobox.com", "id": 6640353, "time": "2012-09-17T16:10:06Z"}, {"text": "(In reply to comment #93)\n\nDear Steven, I guess you are the one who hasn't carefully read the previous comments. If you do you'll see that at any moment the user is stating that the the patch is perfect or ready to be included in the trunk. Additionally, he does mention that it is expected that users' patches won't be perfect and will probably need further optimisations, verifications and fixes.\n\nI completely understand that there are more relevant bugs to be solved. I do not understand the tone Mozilla developers use in the tickets. There are several users trying to HELP mozilla to produce better software, and they and up being treated with irony or negligence.\n\nAnd I am sure that you are doing your best to attend users' demands. Being the *only* Mac developer is not a easy task, and it is not your fault. \n\nIn the last 2 or 3 posts in this ticket, the complaints were related to the lack of appreciation of user feedback. And it is indeed true! They spend their time to produce code to improve the software, or to come up with ideas to improve the software, for FREE. Instead of recognising the effort and giving them proper feedback, they are ignored in most cases.\n\nBack to the topic, current swipe in Firefox, in my opinion, is horrible. That is a relevant factor that made me choose Chrome as my main browser (although Chrome's implementation is not as good as Safari's in this specific case). Additionally, I know other people that don't like it either and don't use Firefox because of that. This might seem silly, but it actually makes Mozilla loose market to other companies. \n\nAnyway, if there are more relevant tickets to be solved, ok I understand. But it would be nice to hear more often from Mozilla about the progress of tickets like this. As a user who is here contributing for free, just trying to make the software even better, I would really like to have more feedback.\n\nAnyway, this will be my last post in bugzilla with this kind of message, in sick and tired of that. I hope that Mozilla developers start to appreciate more user feedback, but if you don't, be aware that you will loose more and more market. Users DO like to be heard and respected. The ironic \"Please read\u2026..\" in the previous message you post shows the opposite. If I was the user who posted that message, I would never come back and would stop using mozilla at the same moment.\n\nFor those who are not interested in this kind of message, I am really sorry. I just replied to this one because of the tone of the previous message. This is my last message of this kind.", "author": "marckjackubosky@gmail.com", "id": 6643388, "time": "2012-09-18T13:02:13Z"}, {"text": "Stephen: bz's comment about retrieving the snapshot bitmap from the Layers system will likely address most if not all the memory/performance concerns here. I think we're OK having that be a follow-up bug, provided the current patches don't blow up under low memory. Thanks!", "author": "bugs@junglecode.net", "id": 6644719, "time": "2012-09-18T18:21:26Z"}, {"text": "Thanks all for your feedback. What should be the next steps?\n\n1. Measure the memory use as bz suggested? If so, what's the best way to do this?\n\n2. Test low memory conditions? If so, is there a good and reliable way to put a system in that state?\n\n3. Request review by setting the patch to \"review?\"? If so, who should I ask for a review?", "author": "spohl.mozilla.bugs@gmail.com", "id": 6647631, "time": "2012-09-19T15:30:48Z"}, {"text": "(In reply to comment #106)\n\nWe're now (I think) in the 4th week of our 6-week release cycle.  I don't think this bug's patch should be landed until the beginning of a cycle (to give us the maximum amount of baking on pre-release channels).\n\nI currently don't have any time to answer your questions.  I've been eaten alive by the HiDPI bugs.  But I should get spat out again before too long -- in the next week or two.\n\nWhichever of your questions remain unanswered then, I'll try to answer myself.\n\nIn the meantime, I think we should plan to land this patch (or something like it) at the beginning of the next release cycle.", "author": "smichaud@pobox.com", "id": 6647700, "time": "2012-09-19T15:46:40Z"}, {"text": "Comment on attachment 660354\nA patch that folds Markus' parts 1-4 into one.\n\nStephen, I've now taken a closer look at your patch and have some questions about it.\n\nFirst, changes to the following files seem to be missing from it:\n\nbrowser/themes/pinstripe/jar.mn\ncontent/events/src/nsDOMEvent.h\n\nSecond, you've added a change to the following file:\n\nbrowser/base/content/tabbrowser.xml\n\nPlease explain why this is necessary.\n\nOnce these issues are resolved, we can go on to ask for reviews.", "author": "smichaud@pobox.com", "id": 6720437, "time": "2012-10-11T19:38:32Z"}, {"text": "(In reply to comment #102 and comment #105)\n\n> As far as must-haves go, I think having at least memory measurements\n> for your typical half-dozen-tabs-reading-the-news case is a\n> must-have.\n\n> Stephen: bz's comment about retrieving the snapshot bitmap from the\n> Layers system will likely address most if not all the\n> memory/performance concerns here. I think we're OK having that be a\n> follow-up bug, provided the current patches don't blow up under low\n> memory. Thanks!\n\nBoris, please expand on this.  What (if anything) do think needs to be\ndone before this patch lands?", "author": "smichaud@pobox.com", "id": 6720486, "time": "2012-10-11T19:58:02Z"}, {"text": "I'm not sure what there is to expand on from comment 102, which you quoted.\n\nThe last iteration of this patch I considered (comment 44) seemed to add overhead in the range of tens of megabytes or RAM per tab at run time.  Hundreds of megabytes in an average multi-tab browsing session. \n\nSo a must-have from my point or view is checking how much memory is in fact used by this patch under typical browsing conditions.  Once we have that number, we can see what the next steps are, depending on what the number is.", "author": "bzbarsky@mit.edu", "id": 6720622, "time": "2012-10-11T20:37:16Z"}, {"text": "So I suppose we'd need some kind of debug logging -- something that could tell us what the memory overhead of this patch was at any one time (possibly triggered by a special key combination), and also periodically (on a 5-10 second timer).\n\nWe'd also (of course) need to decide how to measure this \"memory overhead\".", "author": "smichaud@pobox.com", "id": 6720852, "time": "2012-10-11T21:27:45Z"}, {"text": "Well, one possibility is to take some measurements with about:memory with and without this patch.", "author": "bzbarsky@mit.edu", "id": 6720870, "time": "2012-10-11T21:31:38Z"}, {"text": "(In reply to Steven Michaud from comment #108)\n> First, changes to the following files seem to be missing from it:\n> \n> browser/themes/pinstripe/jar.mn\n\nThis was an oversight. This caused the background to be of a solid color when swiping past the history, instead of the linen-pattern. I'll be uploading a fixed patch shortly.\n\n> content/events/src/nsDOMEvent.h\n\nI believe this is no longer necessary, since nsDOMEvent::GetEventName() in nsDOMEvent.cpp now retrieves the name of the event from the list in nsEventNameList.h directly. The patch correctly adds the new events to nsEventNameList.h.\n\n> \n> Second, you've added a change to the following file:\n> \n> browser/base/content/tabbrowser.xml\n\nThis was necessary because function HSA__addBoxes() in browser.js tries to retrieve this element based on an anonid of \"browserStack\" in order to append a child element called \"historySwipeAnimationContainer\". The anonid was missing, so this kept failing.\n\nThe delay in my response might have given away that I'm a bit short on time right now. I will do my best to get some memory measurements soon.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6732237, "time": "2012-10-16T05:24:54Z"}, {"text": "Created attachment 671734\nA patch that folds Markus' parts 1-4 into one.\n\nFixed an oversight in jar.mn that caused the background to be of solid color when swiping past the browser history, instead of a linen-pattern. Also ensured that this patch is still working with current trunk.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6732292, "time": "2012-10-16T06:14:43Z"}, {"text": "Comment on attachment 671734\nA patch that folds Markus' parts 1-4 into one.\n\nLooks fine to me.\n\n>> content/events/src/nsDOMEvent.h\n>\n> I believe this is no longer necessary, since\n> nsDOMEvent::GetEventName() in nsDOMEvent.cpp now retrieves the name\n> of the event from the list in nsEventNameList.h directly. The patch\n> correctly adds the new events to nsEventNameList.h.\n\nMakes sense.\n\n>> Second, you've added a change to the following file:\n>>\n>> browser/base/content/tabbrowser.xml\n>\n> This was necessary because function HSA__addBoxes() in browser.js\n> tries to retrieve this element based on an anonid of \"browserStack\"\n> in order to append a child element called\n> \"historySwipeAnimationContainer\". The anonid was missing, so this\n> kept failing.\n\nMakes sense.\n\n> The delay in my response might have given away that I'm a bit short\n> on time right now. I will do my best to get some memory measurements\n> soon.\n\nThanks.  I may have time to do this myself by later this week or early\nnext week.", "author": "smichaud@pobox.com", "id": 6734136, "time": "2012-10-16T17:03:00Z"}, {"text": "Sorry to jump in here, but if I read this patch correctly, we're not compressing the data from these screenshots at all.\n\nThat's likely unacceptable from a memory-usage point of view, unless you set a low cap on how many of these images you're going to store (e.g., 2, globally).\n\nCan we extract the screenshot from the canvas with the new toBlob() function (bug 648610) and compress them?  This will likely save a /lot/ of memory.  It also gives us the ability to write these images out to disk.  For example, we may not need to store history images for all tabs in memory -- we could write some to disk and pull them in when the tab is activated.\n\nYou should try both PNG (nice because it's lossless) and JPEG (nice because it's probably smaller and because our JPEG encoder is highly optimized).\n\nYou may also be able to save a lot of memory by converting these images to grayscale.  If that's acceptable from a UX PoV, we may want to do that.", "author": "justin.lebar+bug@gmail.com", "id": 6734213, "time": "2012-10-16T17:19:01Z"}, {"text": "Hi,\nI stumbled onto this bug since I was wondering the state of getting proper animation support for my favorite Mac browser gesture (and the reason I'm not using FF right now). I am excited that this is getting addressed, but as a web developer do have some questions and concerns I would like to raise:\n\nSince I haven't tried (or know how) to install this fix, I was curious if this fix is following safari (animates going to the previous page) or chrome (simple arrow animation) way of animating. The Safari version is certainly pretty, but also has some unintended problems as well. For example, using the new HTML 5 history stuff if you animate changes between \"states\" then the safari method has some nasty usability issues that I am not sure how to get around. This is even present on Apples own icloud.com service. On that site you can open and close web applications and see the cool zooming css animations to transition between an opened application and the grid of application icon states (similar to IOS). If you swipe to go back from within an application it goes directly back to grid of icons (the pre-transitions state) and then re-animates the transition back to grid again.\n\nOn the other hand the far simpler chrome version works great in these cases, while doing a good enough job letting the user understand the threshold of when they have swiped far enough to go back or forward.\n\nMy post here is more to just raise awareness of the potential issues that face the Safari implementation of this animation. I'm not sure if there is a way to address this issue easily, it would be nice if you could detect if the user has done this gesture or not and respond accordingly for example. One thing that can be certain is more and more people are going to adopt the history api stuff since IE is finally getting support for this in the near future (and there is always the hash fallback for older browsers) and people like myself are going to start using css transitions more to offer visually appealing web applications.", "author": "cendrizzi@gmail.com", "id": 6743211, "time": "2012-10-18T19:06:21Z"}, {"text": "(In reply to comment #116)\n\n> Can we extract the screenshot from the canvas with the new toBlob()\n> function (bug 648610) and compress them?  This will likely save a\n> /lot/ of memory.  It also gives us the ability to write these images\n> out to disk.  For example, we may not need to store history images\n> for all tabs in memory -- we could write some to disk and pull them\n> in when the tab is activated.\n\nSounds reasonable.  Of course we'd need to make sure this didn't cause\ntoo much of a performance hit.\n\n> You may also be able to save a lot of memory by converting these\n> images to grayscale.  If that's acceptable from a UX PoV, we may\n> want to do that.\n\nI don't much like this idea, but others may disagree.", "author": "smichaud@pobox.com", "id": 6743436, "time": "2012-10-18T19:59:29Z"}, {"text": "(In reply to comment #117)\n\nWe've already covered some of this ground -- see bug 698761.\n\nMy personal feeling is that Safari-style animation looks a lot better,\nand we should use that if at all possible.\n\n> If you swipe to go back from within an application it goes directly\n> back to grid of icons (the pre-transitions state) and then\n> re-animates the transition back to grid again.\n\nDoes this also happen using the Back button?  If it does, it's a\nseparate problem.", "author": "smichaud@pobox.com", "id": 6743475, "time": "2012-10-18T20:07:33Z"}, {"text": "What version of Firefox are you building this on? I can't get that patches to work on a fresh pull of mozilla-central.", "author": "jsbruner@umich.edu", "id": 6834080, "time": "2012-11-19T15:22:11Z"}, {"text": "Never mind, I see why. Also, how far into this are you? How much work still needs to be done?", "author": "jsbruner@umich.edu", "id": 6846522, "time": "2012-11-22T22:32:05Z"}, {"text": "Revision 112190 \"Merge m-c to inbound.\" broke the patch.\n\nIt's a rather large change, but I'll work on updating the patch to work with the current trunk.\n\n@Josiah: The patch is (was) working as expected. One thing that needs improving is memory utilization. This could be achieved by compressing the snapshots (as suggested in Comment 116), unless the actual compression starts to affect performance.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6854248, "time": "2012-11-27T04:11:33Z"}, {"text": "> Revision 112190 \"Merge m-c to inbound.\" broke the patch.\n\nFYI, we always refer to hg csets using their hash identifier, not the decimal identifier.  The decimal identifier may not be the same across different clones of m-c.", "author": "justin.lebar+bug@gmail.com", "id": 6854260, "time": "2012-11-27T04:17:01Z"}, {"text": "(In reply to Justin Lebar [:jlebar] from comment #123)\n> > Revision 112190 \"Merge m-c to inbound.\" broke the patch.\n> \n> FYI, we always refer to hg csets using their hash identifier, not the\n> decimal identifier.  The decimal identifier may not be the same across\n> different clones of m-c.\n\nThank you for the heads up, Justin. That'd be fb8e7b959173 then.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6854271, "time": "2012-11-27T04:20:39Z"}, {"text": "What version does the patch work on? If it doesn't work on a fresh pull of Mozilla-Central, then what will work. I would like to take a look at this feature.", "author": "jsbruner@umich.edu", "id": 6855271, "time": "2012-11-27T13:47:25Z"}, {"text": "(In reply to Josiah from comment #125)\n> What version does the patch work on? If it doesn't work on a fresh pull of\n> Mozilla-Central, then what will work. I would like to take a look at this\n> feature.\n\nAfter a fresh pull, update to the revision prior to the one that broke like so:\n\nhg update -C -r 112189\n\nThen, apply the patch like you usually would. That should work.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6856109, "time": "2012-11-27T17:35:56Z"}, {"text": "Created attachment 685725\nUpdated patch for current trunk.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6856548, "time": "2012-11-27T19:05:32Z"}, {"text": "Try builds are available here:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-6904d927d682/", "author": "spohl.mozilla.bugs@gmail.com", "id": 6857061, "time": "2012-11-27T20:59:56Z"}, {"text": "How do you work the swiping animation. I must have missed something. At the moment nothing happens. Is there some code I need to run in the console?", "author": "jsbruner@umich.edu", "id": 6857095, "time": "2012-11-27T21:07:42Z"}, {"text": "(In reply to Josiah from comment #129)\n> How do you work the swiping animation. I must have missed something. At the\n> moment nothing happens. Is there some code I need to run in the console?\n\nThe swipe animation is for Mac OSX and two-finger swipe gestures and you don't need to run any special code. You swipe with two fingers to the right or to the left to navigate through your browsing history. If it doesn't work for you, please check if it works in Safari. If it doesn't work there either, you may have to enable \"Swipe between pages\" in System Preferences > More Gestures. Let me know if that did it for you or I'll have to investigate.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6857210, "time": "2012-11-27T21:30:52Z"}, {"text": "I am running OS X 10.8 on a Retina MacBook Pro, with Safari 6. \n\nSafari is doing its swipe animations, but this build of Firefox is just flipping back and forth between pages.", "author": "hawkrives@gmail.com", "id": 6857231, "time": "2012-11-27T21:34:34Z"}, {"text": "Same here. Both the trysever and custom builds are doing nothing. I am also on Mountain Lion. What version of OS X are you on Stephen? Perhaps it is a change with Mountain Lion.", "author": "jsbruner@umich.edu", "id": 6857241, "time": "2012-11-27T21:36:10Z"}, {"text": "Hmm. I'm on 10.8.2 and I just verified again that the swipe animation works with the build here: http://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-6904d927d682/try-macosx64/firefox-20.0a1.en-US.mac.dmg\n\nClicking the back and forward buttons (intentionally) won't show the animation, but two-finger swipe should...", "author": "spohl.mozilla.bugs@gmail.com", "id": 6857306, "time": "2012-11-27T21:52:18Z"}, {"text": "Never mind. It works. I downloaded the debug one the first time.", "author": "jsbruner@umich.edu", "id": 6857327, "time": "2012-11-27T21:56:24Z"}, {"text": "Alright, the problem is that this feature is quite unreliable. It seems to work if you have a session currently active, but not if you start a new one. Also, if you create a new tab and select something from the list of pages, the swiping feature will become disabled.", "author": "jsbruner@umich.edu", "id": 6857342, "time": "2012-11-27T22:00:50Z"}, {"text": "It seems to be something in my profile. I set a clean profile, and the animation looks great! Unlike Josiah, I can't reproduce it on my normal profile.", "author": "hawkrives@gmail.com", "id": 6857355, "time": "2012-11-27T22:03:19Z"}, {"text": "(In reply to Josiah from comment #135)\n> Alright, the problem is that this feature is quite unreliable. It seems to\n> work if you have a session currently active, but not if you start a new one.\n\nI'm not clear about this. When you say \"start a new one\", do you mean closing firefox and opening it again? I can't reproduce this issue.\n\n> Also, if you create a new tab and select something from the list of pages,\n> the swiping feature will become disabled.\n\n\nI was able to reproduce this problem. Looking into it.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6857429, "time": "2012-11-27T22:24:54Z"}, {"text": "That is what I meant. But I can no longer reproduce it. It might have been a fluke. But the new tab issue is where the real problem lies.", "author": "jsbruner@umich.edu", "id": 6857465, "time": "2012-11-27T22:33:27Z"}, {"text": "Just want to confirm that using the try server build with my default nightly profile doesn't exhibit the swipe animation. I didn't try with a clean profile yet. Just want to point out that when the patch lands, there might be a problems for nightly testers.", "author": "beingalink@googlemail.com", "id": 6857473, "time": "2012-11-27T22:35:08Z"}, {"text": "I can't trigger the swipe also (with my old profile). I'm using the one from comment #133. I'm here if you need to reproduce the problem. I'm on Lion (but I will migrate to Mountain Lion in the next few days).", "author": "valentin@tutu.ro", "id": 6859106, "time": "2012-11-28T10:36:12Z"}, {"text": "Comment on attachment 685725\nUpdated patch for current trunk.\n\n\n>diff --git a/browser/base/content/browser.js b/browser/base/content/browser.js\n>+  _addBoxes: function HSA__addBoxes() {\n>+    let browserStack =\n>+      document.getAnonymousElementByAttribute(gBrowser.getNotificationBox(),\n>+                                              \"anonid\", \"browserStack\");\n\nBug 768442 made browserStack use the class attribute instead of the anonid attribute. I think just replacing \"anonid\" with \"class\" here should fix the bug.", "author": "mstange@themasta.com", "id": 6859215, "time": "2012-11-28T11:23:02Z"}, {"text": "Created attachment 686076\nScreenshot of default page glitch\n\nIf you try to swipe on the \"default\" page, it will create a white border around it. Most likely because when a screenshot is being taken, it does not know to not include the white  background.", "author": "jsbruner@umich.edu", "id": 6859544, "time": "2012-11-28T14:06:48Z"}, {"text": "(In reply to Markus Stange from comment #141)\n> Comment on attachment 685725\n> Updated patch for current trunk.\n> \n> \n> >diff --git a/browser/base/content/browser.js b/browser/base/content/browser.js\n> >+  _addBoxes: function HSA__addBoxes() {\n> >+    let browserStack =\n> >+      document.getAnonymousElementByAttribute(gBrowser.getNotificationBox(),\n> >+                                              \"anonid\", \"browserStack\");\n> \n> Bug 768442 made browserStack use the class attribute instead of the anonid\n> attribute. I think just replacing \"anonid\" with \"class\" here should fix the\n> bug.\n\nYep. Just tried it. Works great, and it is a very easy. Thanks Markus.", "author": "jsbruner@umich.edu", "id": 6859593, "time": "2012-11-28T14:39:19Z"}, {"text": "(In reply to Markus Stange from comment #141)\n> Comment on attachment 685725\n> \n> Bug 768442 made browserStack use the class attribute instead of the anonid\n> attribute. I think just replacing \"anonid\" with \"class\" here should fix the\n> bug.\n\nNew try builds with this fixed are available here:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-6b83f1f57cab/try-macosx64/", "author": "spohl.mozilla.bugs@gmail.com", "id": 6862727, "time": "2012-11-29T03:18:48Z"}, {"text": "Created attachment 686407\nPatch\n\nIncorporated Markus' feedback", "author": "spohl.mozilla.bugs@gmail.com", "id": 6862729, "time": "2012-11-29T03:19:36Z"}, {"text": "(In reply to Josiah from comment #142)\n> Created attachment 686076\n> Screenshot of default page glitch\n> \n> If you try to swipe on the \"default\" page, it will create a white border\n> around it. Most likely because when a screenshot is being taken, it does not\n> know to not include the white  background.\n\nDoes this still happen with the latest try builds? I could not reproduce.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6862731, "time": "2012-11-29T03:20:41Z"}, {"text": "New build works with a restored session where the old one didn't, at least for me. The one bug Ive found so far is that going back and forth between pages that have been zoomed doesn't quite work- the image is resized to 100%, but only the part visible when zoomed is kept, which means you end up with a large white space and only part of the page in the upper left corner", "author": "me@chrisb.xyz", "id": 6862766, "time": "2012-11-29T03:43:47Z"}, {"text": "(In reply to Chris Barry [Christo27] from comment #147)\n> New build works with a restored session where the old one didn't, at least\n> for me. The one bug Ive found so far is that going back and forth between\n> pages that have been zoomed doesn't quite work- the image is resized to\n> 100%, but only the part visible when zoomed is kept, which means you end up\n> with a large white space and only part of the page in the upper left corner\n\nI think this matches what Safari is doing and we're sort of limited by what's actually visible at the time the snapshot is taken. Or are you saying that the behavior is different from Safari?", "author": "spohl.mozilla.bugs@gmail.com", "id": 6862773, "time": "2012-11-29T03:48:06Z"}, {"text": "Created attachment 686414\nScreenshot Comparing Safari Zoom and Firefox\n\nHere's a comparison of the two, I tried to zoom to a similar amount on Bing on both", "author": "me@chrisb.xyz", "id": 6862799, "time": "2012-11-29T04:04:35Z"}, {"text": "(In reply to Chris Barry [Christo27] from comment #149)\n> Created attachment 686414\n> Screenshot Comparing Safari Zoom and Firefox\n> \n> Here's a comparison of the two, I tried to zoom to a similar amount on Bing\n> on both\n\nAh, got it. I misread and thought you were referring to resizing the window, not zooming the page. I was able to reproduce the problem with zoomed pages.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6862815, "time": "2012-11-29T04:12:31Z"}, {"text": "Yeah, that was the problem. Turns out I had the default page zoomed up. Therefore, Chris's problem is what I was experiencing.", "author": "jsbruner@umich.edu", "id": 6863685, "time": "2012-11-29T13:08:52Z"}, {"text": "So really what needs to happen is a new screenshot needs to be taken every time the user zooms in/out.\n\nAlso, do you think we should have the animation occur when the back and forward buttons are pressed (For all platforms). It would be a quicker animation, but some visual feedback might be appreciated.", "author": "jsbruner@umich.edu", "id": 6863699, "time": "2012-11-29T13:12:26Z"}, {"text": "(In reply to Josiah from comment #152)\n\n> Also, do you think we should have the animation occur when the back and\n> forward buttons are pressed (For all platforms). It would be a quicker\n> animation, but some visual feedback might be appreciated.\n\nSafari doesn't do this. This sounds more like a separate request that should be dealt with in a separate bug.", "author": "bugzilla@spray.se", "id": 6863861, "time": "2012-11-29T14:00:48Z"}, {"text": "(In reply to Jos\u00e9 Jeria from comment #153)\n> (In reply to Josiah from comment #152)\n> \n> > Also, do you think we should have the animation occur when the back and\n> > forward buttons are pressed (For all platforms). It would be a quicker\n> > animation, but some visual feedback might be appreciated.\n> \n> Safari doesn't do this. This sounds more like a separate request that should\n> be dealt with in a separate bug.\n\nThat is true, but since all other bug requests to add swiping animation have been forwarded here, I figured it would be easiest to implement. Especially since this feature hasn't been pushed to the main mozilla-central. That said, I could create a new bug and copy the patches over.\n\nAnother idea is to just wait. I suppose we could implement the OS X feature first. And then after it is merged, maybe add an animation for the back/forward button.", "author": "jsbruner@umich.edu", "id": 6863880, "time": "2012-11-29T14:04:53Z"}, {"text": ">> Also, do you think we should have the animation occur when the back\n>> and forward buttons are pressed (For all platforms). It would be a\n>> quicker animation, but some visual feedback might be appreciated.\n>\n> Safari doesn't do this. This sounds more like a separate request\n> that should be dealt with in a separate bug.\n\nAnimation wouldn't be useful/appropriate on the back and forward\nbuttons ... at least I don't think so.\n\nThe reason animation is so useful for swipes is that swipes don't take\nplace all at once.  It's only when a left or right swipe crosses a\ncertain threshold that you go back or forward in history.  The\nanimation shows you the swipe's \"progress\", both before and after the\nthreshold has been reached.\n\nAnd in any case\tI agree this should go into a separate bug.  It's\nreally a separate problem, and this bug already has too many comments\n:-)", "author": "smichaud@pobox.com", "id": 6864212, "time": "2012-11-29T15:28:45Z"}, {"text": "Created attachment 686741\nPatch\n\nFixed zoom issue", "author": "spohl.mozilla.bugs@gmail.com", "id": 6865664, "time": "2012-11-29T20:20:32Z"}, {"text": "(In reply to Josiah from comment #154)\n> (In reply to Jos\u00e9 Jeria from comment #153)\n> > (In reply to Josiah from comment #152)\n> > \n> > > Also, do you think we should have the animation occur when the back and\n> > > forward buttons are pressed (For all platforms). It would be a quicker\n> > > animation, but some visual feedback might be appreciated.\n> > \n> > Safari doesn't do this. This sounds more like a separate request that should\n> > be dealt with in a separate bug.\n> \n> That is true, but since all other bug requests to add swiping animation have\n> been forwarded here, I figured it would be easiest to implement. Especially\n> since this feature hasn't been pushed to the main mozilla-central. That\n> said, I could create a new bug and copy the patches over.\n> \n> Another idea is to just wait. I suppose we could implement the OS X feature\n> first. And then after it is merged, maybe add an animation for the\n> back/forward button.\n\nAn animation for the back/forward buttons might look nice, but I agree that it should probably be tracked as a separate bug since it's not strictly related to swipe gestures anymore and could be implemented for all platforms. Users might also want to have a way to turn the animation off.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6865677, "time": "2012-11-29T20:25:02Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #157)\n> (In reply to Josiah from comment #154)\n> > (In reply to Jos\u00e9 Jeria from comment #153)\n> > > (In reply to Josiah from comment #152)\n> > > \n> > > > Also, do you think we should have the animation occur when the back and\n> > > > forward buttons are pressed (For all platforms). It would be a quicker\n> > > > animation, but some visual feedback might be appreciated.\n> > > \n> > > Safari doesn't do this. This sounds more like a separate request that should\n> > > be dealt with in a separate bug.\n> > \n> > That is true, but since all other bug requests to add swiping animation have\n> > been forwarded here, I figured it would be easiest to implement. Especially\n> > since this feature hasn't been pushed to the main mozilla-central. That\n> > said, I could create a new bug and copy the patches over.\n> > \n> > Another idea is to just wait. I suppose we could implement the OS X feature\n> > first. And then after it is merged, maybe add an animation for the\n> > back/forward button.\n> \n> An animation for the back/forward buttons might look nice, but I agree that\n> it should probably be tracked as a separate bug since it's not strictly\n> related to swipe gestures anymore and could be implemented for all\n> platforms. Users might also want to have a way to turn the animation off.\n\nVery well. I will create a new bug after this bug as been merged with the mainstream development.", "author": "jsbruner@umich.edu", "id": 6865733, "time": "2012-11-29T20:43:25Z"}, {"text": "I have the problem that after the animation to last/next page in history, I get to see the page of where I came from when the page reloading starts. When the reloading has finished, I get to see the correct page again.", "author": "beingalink@googlemail.com", "id": 6866026, "time": "2012-11-29T21:58:05Z"}, {"text": "This only happens with sites with dynamic content of course.", "author": "beingalink@googlemail.com", "id": 6866034, "time": "2012-11-29T21:59:46Z"}, {"text": "Try run for dd03ec79ffa7 is complete.\nDetailed breakdown of the results available here:\n    https://tbpl.mozilla.org/?tree=Try&rev=dd03ec79ffa7\nResults (out of 2 total builds):\n    success: 2\nBuilds (or logs if builds failed) available at:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-dd03ec79ffa7", "author": "release@mozilla.com", "id": 6866156, "time": "2012-11-29T22:30:34Z"}, {"text": "(In reply to Mozilla RelEng Bot from comment #161)\n> Try run for dd03ec79ffa7 is complete.\n\nTry builds with zoom fix available:\nhttp://ftp-scl3.mozilla.com/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-dd03ec79ffa7/try-macosx64/", "author": "spohl.mozilla.bugs@gmail.com", "id": 6866163, "time": "2012-11-29T22:32:19Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #162)\n> Try builds with zoom fix available:\n> http://ftp-scl3.mozilla.com/pub/mozilla.org/firefox/try-builds/spohl@mozilla.\n> com-dd03ec79ffa7/try-macosx64/\n\nJust tested this. Looks great! Also love the bounce effect when there are no more pages to go back/forward to. Would it be possible (I guess there is already a bug for this) to add this bounce effect when you reach the top/end of the page? Safari does this.", "author": "bugzilla@spray.se", "id": 6867913, "time": "2012-11-30T10:52:19Z"}, {"text": "It is possible. It will have to be part of another bug though. One might exist. We should try to finish one. We now have swiping pages, disappearing scrollbars, and then the elastic effect. If those three things were added to Firefox 20, then I think Firefox would finally have an OS X feel.", "author": "jsbruner@umich.edu", "id": 6868184, "time": "2012-11-30T12:33:27Z"}, {"text": "What code would I have to use to implement the animation from somewhere else all at once. I am trying to add the animation to the back button, I know I should ask this on another bug, but I need to know what the necessary code is? That is, with these patches in tact. \n\nI'm using:\n\n <method name=\"goBack\">\n        <body>\n          <![CDATA[\n            var webNavigation = this.webNavigation;\n            if (webNavigation.canGoBack) {\n              try {\n                this.userTypedClear++;\n                webNavigation.goBack();\n              } finally {\n                if (this.userTypedClear)\n                  this.userTypedClear--;\n              }\n            }\n          ]]>\n        </body>\n      </method>\n\nSo, what do I need to call for the animation to work while going back? Thanks.", "author": "jsbruner@umich.edu", "id": 6868387, "time": "2012-11-30T14:14:31Z"}, {"text": "(In reply to beingalink from comment #160)\n> This only happens with sites with dynamic content of course.\n\nDo you have a specific URL that reproduces this problem?", "author": "spohl.mozilla.bugs@gmail.com", "id": 6869340, "time": "2012-11-30T18:50:02Z"}, {"text": "(In reply to beingalink from comment #160)\n> This only happens with sites with dynamic content of course.\n\nLike Stephen, what URL? I can not reproduce this issue.", "author": "jsbruner@umich.edu", "id": 6869347, "time": "2012-11-30T18:51:11Z"}, {"text": "For example on my last.fm profile site. Go to http://www.last.fm/user/TheLink and then to https://encrypted.google.com and then swipe back to the last.fm page.", "author": "beingalink@googlemail.com", "id": 6869373, "time": "2012-11-30T18:55:19Z"}, {"text": "(In reply to Josiah from comment #165)\n> What code would I have to use to implement the animation from somewhere else\n> all at once.\n\nLooking at function HSA_updateAnimation(val) in the patch might give you a start. For swipe gestures, val is obtained via the swipe event and is used to control the animation progress.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6869382, "time": "2012-11-30T18:57:06Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #169)\n> (In reply to Josiah from comment #165)\n> > What code would I have to use to implement the animation from somewhere else\n> > all at once.\n> \n> Looking at function HSA_updateAnimation(val) in the patch might give you a\n> start. For swipe gestures, val is obtained via the swipe event and is used\n> to control the animation progress.\n\nRight, but since this is just a button press, I could use another value correct. That's just an integer right?", "author": "jsbruner@umich.edu", "id": 6869389, "time": "2012-11-30T18:58:54Z"}, {"text": "(In reply to Josiah from comment #170)\n> (In reply to Stephen Pohl [:spohl] from comment #169)\n> > (In reply to Josiah from comment #165)\n> > > What code would I have to use to implement the animation from somewhere else\n> > > all at once.\n> > \n> > Looking at function HSA_updateAnimation(val) in the patch might give you a\n> > start. For swipe gestures, val is obtained via the swipe event and is used\n> > to control the animation progress.\n> \n> Right, but since this is just a button press, I could use another value\n> correct. That's just an integer right?\n\nIt's a floating point number, representing the event's delta. Markus added this helpful description:\n+ * MozSwipeGestureUpdate - Generated periodically while the user is\n+ * continuing a horizontal swipe gesture.  The \"delta\" value represents\n+ * the current absolute gesture amount.\n\nIn order to get a true animation, you will want to continuously call this (or a similar) function with updated values that represent the animation progress. I think the tricky part will be to time this correctly.\n\nIt may also be a good time to file the separate bug we've been talking about to keep this information separate from the swipe bug here.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6869509, "time": "2012-11-30T19:17:12Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #171)\n> (In reply to Josiah from comment #170)\n> > (In reply to Stephen Pohl [:spohl] from comment #169)\n> > > (In reply to Josiah from comment #165)\n> > > > What code would I have to use to implement the animation from somewhere else\n> > > > all at once.\n> > > \n> > > Looking at function HSA_updateAnimation(val) in the patch might give you a\n> > > start. For swipe gestures, val is obtained via the swipe event and is used\n> > > to control the animation progress.\n> > \n> > Right, but since this is just a button press, I could use another value\n> > correct. That's just an integer right?\n> \n> It's a floating point number, representing the event's delta. Markus added\n> this helpful description:\n> + * MozSwipeGestureUpdate - Generated periodically while the user is\n> + * continuing a horizontal swipe gesture.  The \"delta\" value represents\n> + * the current absolute gesture amount.\n> \n> In order to get a true animation, you will want to continuously call this\n> (or a similar) function with updated values that represent the animation\n> progress. I think the tricky part will be to time this correctly.\n> \n> It may also be a good time to file the separate bug we've been talking about\n> to keep this information separate from the swipe bug here.\n\nI will want to keep calling what? HSA_updateAnimation, or MozSwipeGestureUpdate? And, I'll go make another bug.", "author": "jsbruner@umich.edu", "id": 6869530, "time": "2012-11-30T19:20:52Z"}, {"text": "(In reply to Josiah from comment #172)\n> I will want to keep calling what? HSA_updateAnimation, or\n> MozSwipeGestureUpdate? And, I'll go make another bug.\n\nYou will want to keep calling HSA_updateAnimation. MozSwipeGestureUpdate is just the event that the delta is taken from and then passed to HSA_updateAnimation. If you search for updateAnimation and how it's called in the patch it should make it clearer.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6869546, "time": "2012-11-30T19:24:58Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #173)\n> (In reply to Josiah from comment #172)\n> > I will want to keep calling what? HSA_updateAnimation, or\n> > MozSwipeGestureUpdate? And, I'll go make another bug.\n> \n> You will want to keep calling HSA_updateAnimation. MozSwipeGestureUpdate is\n> just the event that the delta is taken from and then passed to\n> HSA_updateAnimation. If you search for updateAnimation and how it's called\n> in the patch it should make it clearer.\n\nAlright, I'll take a look. In case any one is interested, here is the new bug: https://bugzilla.mozilla.org/show_bug.cgi?id=817074", "author": "jsbruner@umich.edu", "id": 6869556, "time": "2012-11-30T19:27:39Z"}, {"text": "So, just to make sure I am doing this right... I doubt I am. Before webNavigation.goBack(); I add \n\ngHistorySwipeAnimation.startAnimation;\ngHistorySwipeAnimation.updateAnimation(1)\ngHistroySwipeAnimation.stopAnimation;\n\nObviously, that is way to short to notice any difference, but is that the right idea? Perhaps you could give a very, very rough version of this. Maybe just a few frames, but that will show a little animation when pressing the back button. Once I see how, I can take it from there. \n\nFeel free to reply in the new bug, that way comments can stop here about this. Thanks.", "author": "jsbruner@umich.edu", "id": 6869729, "time": "2012-11-30T20:09:17Z"}, {"text": "I've been looking into compressing the snapshot data with both PNG and JPG encoding. I use canvas' toDataURL method to obtain a URL to use as src for Image objects and I use these image objects during animation (instead of the canvas object directly). I found that both PNG and JPG encoding work fast on my system. Also, if a quality of 100% is specified for JPG, both PNG and JPG seem to virtually even out in memory utilization, with considerable variation depending on the type of websites that are being visited (lots of different colors etc.). JPG seems to be a good choice if we use a quality of less than 100%. However, using a quality of less than 100% on a retina display may not be the right choice. It doesn't look very nice.\n\nAll these things considered, I'm tempted to favor PNG over JPG.\n\nAnother way to limit memory utilization for this feature is the number of pages that we store per tab. We currently have a default of 10, but maybe 4 or 5 would be enough.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6869849, "time": "2012-11-30T20:40:27Z"}, {"text": "Blobs reduce memory used by images by a factor of ~2.5 compared to data URIs.  I'd highly recommend using the blob api, even though it's more annoying than data URIs.\n\nSome users have hundreds of tabs; we're going to need a global limit on how many images are kept around, instead of or in addition to to a per-tab limit.", "author": "justin.lebar+bug@gmail.com", "id": 6869864, "time": "2012-11-30T20:44:07Z"}, {"text": "We could probably just store 4-5 images of the 3-4 most recently selected tabs.\n\nThe 3-4 number comes from this study, which shows the median of tabs open on navigation right around 3 to 4, http://dubroy.com/blog/how-many-tabs-do-people-use-now-with-real-data/", "author": "jaws@mozilla.com", "id": 6870010, "time": "2012-11-30T21:22:47Z"}, {"text": "(In reply to Justin Lebar [:jlebar] from comment #177)\n> Blobs reduce memory used by images by a factor of ~2.5 compared to data\n> URIs.  I'd highly recommend using the blob api, even though it's more\n> annoying than data URIs.\n\nI gave this a shot, but I'm running into an important performance problem. The conversion from a Blob back to an Image object seems to take a fair amount of time. When swiping between pages, there is considerable flickering. The conversion currently happens when the animation starts, which is not ideal. There should be as little processing as possible at the start of the animation to make it as smooth as possible.\n\nThere might be two ways how we can use blobs anyways:\n1. There might be a better/faster way to convert blobs to images. I've tried URL.createObjectURL() to get a URL that is then assigned to src of the image object.\n2. Our snapshot-array could hold blobs, but the previous, current and next page would always be available as image objects as well (in a separate array for example). The problem here is that quick swiping would still cause the performance problem described above (flickering).", "author": "spohl.mozilla.bugs@gmail.com", "id": 6870407, "time": "2012-11-30T23:25:42Z"}, {"text": "> but the previous, current and next page would always be available as image objects as well\n\nMaybe if you did this only for the current tab, that would be OK.  Although you'd probably want some sort of timeout before you start decoding a tab's images, otherwise we'll eat a lot of CPU if you quickly switch between tabs.\n\nI don't see why you need the current snapshot in memory, though.\n\nI'm surprised blobs would perform worse than data: URIs here.  But I don't know the implementation details, so I guess it's possible.", "author": "justin.lebar+bug@gmail.com", "id": 6870424, "time": "2012-11-30T23:32:48Z"}, {"text": "(In reply to Justin Lebar [:jlebar] from comment #180)\n> \n> I don't see why you need the current snapshot in memory, though.\n> \n\nThe current snapshot is needed because the animation actually consists of two box elements sliding over each other (previous and current, or current and next). The snapshots are used as background images for the box elements. This can be seen by the fact that any dynamic content on the current page stops during the animation (since it's a snapshot of when the animation started).", "author": "spohl.mozilla.bugs@gmail.com", "id": 6870470, "time": "2012-11-30T23:51:27Z"}, {"text": "Okay, but you're always going to have a decode lag problem with the current screenshot, right?  The current screenshot needs to be taken right before the animation begins, because it needs to reflect the current state of the page (and the current scroll state of the page, for sure).\n\nI guess there's no need to compress the current screenshot, though.\n\nIt's not clear to me why you can't pull the prev/next screenshot over the current one, but that's not for me to understand.  :)", "author": "justin.lebar+bug@gmail.com", "id": 6870479, "time": "2012-11-30T23:56:33Z"}, {"text": "(In reply to Justin Lebar [:jlebar] from comment #182)\n> Okay, but you're always going to have a decode lag problem with the current\n> screenshot, right?  The current screenshot needs to be taken right before\n> the animation begins, because it needs to reflect the current state of the\n> page (and the current scroll state of the page, for sure).\n\nThat's true. Storing canvas objects in the snapshot array definitely has the best performance. toDataURL causes a bit of flickering (and I'm not sure that's acceptable), not as much as toBlob though. I believe toDataURL() performs better in this scenario because it can be directly assigned to src of an image element. We then store these image elements in the snapshot array. After the snapshot is taken, there is no further processing necessary to assign the snapshot as background image of the box element. If we use blobs however, we would be storing blob elements in the snapshot array and we would have to convert them every time we need them during an animation. The URL.createObjectURL call for the conversion seems to be costly and cause the flickering.\n \n> It's not clear to me why you can't pull the prev/next screenshot over the\n> current one, but that's not for me to understand.  :)\n\nWe actually slide the next page over the current one, but we slide the current page away from the previous one. I think of it as a stack of paper. I either add a page (slide the next page onto the stack) or I remove a page (slide the current page away from the current stack). Not sure if this helps (or makes sense to) anybody else, but it sure helped me. :-)", "author": "spohl.mozilla.bugs@gmail.com", "id": 6870559, "time": "2012-12-01T00:21:47Z"}, {"text": "> The URL.createObjectURL call for the conversion seems to be costly and cause the \n> flickering.\n\nAIUI this is literally just a hashtable lookup.  I would be surprised if it's the slow part.  You can time it to see.\n\n> We actually slide the next page over the current one, but we slide the current page away \n> from the previous one. I think of it as a stack of paper.\n\nThere's an obvious disadvantage to this approach, which is that dynamic objects stop animating when you go back.  Also the memory usage is worse.  Do you do it this way because you need to move the current page, and this is the only way to do that?", "author": "justin.lebar+bug@gmail.com", "id": 6870680, "time": "2012-12-01T01:28:24Z"}, {"text": "(In reply to Justin Lebar [:jlebar] from comment #184)\n> > The URL.createObjectURL call for the conversion seems to be costly and cause the \n> > flickering.\n> \n> AIUI this is literally just a hashtable lookup.  I would be surprised if\n> it's the slow part.  You can time it to see.\n> \n\nGood point. I'll look into that.\n\n> > We actually slide the next page over the current one, but we slide the current page away \n> > from the previous one. I think of it as a stack of paper.\n> \n> There's an obvious disadvantage to this approach, which is that dynamic\n> objects stop animating when you go back.  Also the memory usage is worse. \n> Do you do it this way because you need to move the current page, and this is\n> the only way to do that?\n\nI think this approach was chosen because it matches what Safari is doing and what people are used to on OSX, the stoping of dynamic objects included.\n\nI may have a way to use blobs without the flickering, but I need to try this out first.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6870694, "time": "2012-12-01T01:41:42Z"}, {"text": "Created attachment 687358\nPatch\n\nThis patch implements compression via <canvas>.toBlob(). Flickering is avoided by using the raw canvas of the current page during swipe animations. The blobs for the previous and next pages are recovered from the array of snapshots and converted to an image when necessary for animations.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6870993, "time": "2012-12-01T08:32:06Z"}, {"text": "Try run for faaee8083d6a is complete.\nDetailed breakdown of the results available here:\n    https://tbpl.mozilla.org/?tree=Try&rev=faaee8083d6a\nResults (out of 2 total builds):\n    success: 2\nBuilds (or logs if builds failed) available at:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-faaee8083d6a", "author": "release@mozilla.com", "id": 6871066, "time": "2012-12-01T10:45:34Z"}, {"text": "(In reply to Mozilla RelEng Bot from comment #187)\n> Builds (or logs if builds failed) available at:\n> http://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-\n> faaee8083d6a\n\nThis build seems to be sluggish compared to the build in comment 162. It kind of freezes for a milisecond when going back/forward. It is more noticeable when you go forward. The animation kind of stops for a ms before reaching the left. This was tested with www.dn.se and Flash disabled.", "author": "bugzilla@spray.se", "id": 6871266, "time": "2012-12-01T14:43:17Z"}, {"text": "I agree with Jose. The swiping does not seem as smooth as before, in fact, I had quite some problems getting the swiping to complete because of the stuttering. I tested on Cnet.com with Flash. \n\nNote: I am not using the builds, just the patches, although I believe they should be the same thing.", "author": "jsbruner@umich.edu", "id": 6872603, "time": "2012-12-02T20:15:56Z"}, {"text": "To compare this issue. I have started a test on memory use. I am starting with the new build. You can view results here: https://docs.google.com/spreadsheet/ccc?key=0Am1zicD3k5IfdEFZT05rMjFYLTI2WU5zMWFLZS1oYnc\n\nI will update that as I get more results. This is a \"normal\" browsing experience. However, for testing purposes I will never close tabs. After this test, I will do a similar test on the previous build.", "author": "jsbruner@umich.edu", "id": 6875584, "time": "2012-12-03T19:28:28Z"}, {"text": "(In reply to Josiah from comment #189)\n> I agree with Jose. The swiping does not seem as smooth as before, in fact, I\n> had quite some problems getting the swiping to complete because of the\n> stuttering. I tested on Cnet.com with Flash. \n> \n> Note: I am not using the builds, just the patches, although I believe they\n> should be the same thing.\n\nThanks for testing Jose and Josiah. This matches what I've observed as well. I'm currently looking into possible improvements and will be discussing them shortly.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6876073, "time": "2012-12-03T21:26:43Z"}, {"text": "Just in case anybody wants to compare, here are the first twenty minutes of the previous build: https://docs.google.com/spreadsheet/ccc?key=0Am1zicD3k5IfdFc5OGRTR2h1UE1JWGJqVHYxTF8xV1E", "author": "jsbruner@umich.edu", "id": 6876369, "time": "2012-12-03T22:35:29Z"}, {"text": "There are two main issues with the current patch:\n\n1. The current snapshot compression causes the animation to become sluggish.\n2. There is no global limit to the number of snapshots a browser session could be holding on to in memory.\n\nI'd like to share a few ideas to address these issues. Please provide any feedback that you have and if you have suggestions how/where to implement this, please don't hold back.\n\n1. In order to avoid sluggishness during the animation, I would like to compress the snapshot off the main thread. <canvas>.toBlob() doesn't currently do this (bug 817700), causing the animation to stutter. This might just be the right incentive to look at 817700 more closely once I've addressed the second issue below.\n\n2. If we think of all the snapshots that the browser will take, they seem to be easily representable as a doubly-linked list. This approach has a few advantages:\n* If we store a \"global\" (read: accessible from all tabs) doubly-linked list, the individual nodes would hold data that identifies the tab in which the snapshot was taken as well as the index in the array of snapshots for that tab.\n* The ordering of the linked list would be most-recent visited page (head) to oldest (tail).\n* The per-tab limit of snapshots could be replaced by a global limit.\n* New snapshots are still added to the per-tab array of snapshots, but the tab identifier and array index is also pushed to the head of the linked list.\n* Snapshots beyond the limit are deleted from the per-tab array and removed from the tail of the linked list.\n* There are some implementation details that would need some thought put into. For example, what happens if the user goes back a few pages and then browses to a different website, with snapshots overwriting existing snapshots in the array that are also referenced from the middle of the linked list. However, nothing strikes me as unsolvable or very costly from a performance standpoint.\n\nThe advantage of this linked-list solution is that we have a way of predicting the amount of memory required for this feature to work across all users: users with only a few tabs as well as users with hundreds of tabs. If we're generous and set the global limit to 100 snapshots, and assuming that each snapshot takes 1MB, the maximum amount of memory required would be 100MB (plus some overhead). In a next step we could further decrease this by storing the \"older\" snapshots on disk rather than in memory while providing a fantastic experience: swipe animations with meaningful snapshots would work across the last 100 pages in history!", "author": "spohl.mozilla.bugs@gmail.com", "id": 6876373, "time": "2012-12-03T22:37:01Z"}, {"text": "I will examine your other thoughts shortly, but I would like to throw out a suggestion. In order to save some memory, what if \"old\" snapshots were converted to grayscale, but I mean really old ones. For example, if the user has say 5 tabs, each tab has a website, and in each website they navigate. Then we would have quite a bit of snapshots already. \n\nThen, let's say the user navigates away to a different page on a new site and then navigates somewhere in there. We can conclude then that most likely, they will not go back all the way to the first page of the first site on that tab. So, we could take quite a few snapshots for the previous site and convert them to grayscale (Perhaps other memory-saving techniques as well.) That way, in case they do go back, an image is there, it just looks faded to the user, not a bad experience in my experience. Then, as the site loads, perhaps we just animate the snapshot away, which will make it look like the site is rebuilding.\n\nThis is based off of a browser I used on iOS, K9 browser. However, it used grayscale when it was \"closed\", then as the page reloads, it animated into a normal page. Of course, I'm not sure how well this would work, as I am mostly an Objective-C person, and ARC handles a lot of this. Let me know what you think.", "author": "jsbruner@umich.edu", "id": 6876490, "time": "2012-12-03T23:00:11Z"}, {"text": "Also, for a final version of my testing see here: https://docs.google.com/spreadsheet/ccc?key=0Am1zicD3k5IfdHZHNDEzRFI3MnRTODUzVXNVTHY5aUE\n\nYou can see the improvements made with the new swiping compression, but surprisingly it performs worse to the user. This is a result of what Stephen mentioned:\n\n\"1. The current snapshot compression causes the animation to become sluggish.\"", "author": "jsbruner@umich.edu", "id": 6876565, "time": "2012-12-03T23:14:02Z"}, {"text": "I like all of your ideas. Also, storing snapshots on the hard drive is something I was going to mention, so that does seem like a good idea. In that case, we could do something like I mentioned. Very old snapshots could be converted to grayscale, then saved on the hard drive. That of course, gives us many more snapshots, but we could read it from the hard drive quicker.\n\nAnyway, I agree with all your suggestions. Creating a doubly-linked list is the way to go. At least for now.", "author": "jsbruner@umich.edu", "id": 6883482, "time": "2012-12-05T14:59:07Z"}, {"text": "Created attachment 689386\nPatch\n\nPatch with doubly-linked list implemented. Will need to test some more and write automated tests.\n\nIn order to test the eviction of old snapshots, set browser.snapshots.limit to 3 in about:config (the default is currently 100). You should now be able to see that if you swipe past the last three pages in history, older pages will appear blank. Note that this works across tabs. The snapshot limit no longer applies per tab.\n\nI'm going to kick off a try build that includes Markus' latest patch to bug 817700 for async <canvas>.toBlob(). This will bring the performance closer to what we ultimately want.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6889661, "time": "2012-12-06T22:15:45Z"}, {"text": "Created attachment 689388\nPatch\n\nRemoved id property on linked list node (previously used for debugging) and some whitespace.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6889686, "time": "2012-12-06T22:20:49Z"}, {"text": "Thanks Stephen. I need to re-clone the mozilla source, and then I will apply the patch. Afterward, I will do another memory test and compare to previous results. If needed, I will try again with Markus' patch as well.", "author": "jsbruner@umich.edu", "id": 6889985, "time": "2012-12-06T23:27:49Z"}, {"text": "Try run for 77a73eb5eeff is complete.\nDetailed breakdown of the results available here:\n    https://tbpl.mozilla.org/?tree=Try&rev=77a73eb5eeff\nResults (out of 2 total builds):\n    success: 2\nBuilds (or logs if builds failed) available at:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-77a73eb5eeff", "author": "release@mozilla.com", "id": 6890245, "time": "2012-12-07T00:45:37Z"}, {"text": "One thing I'd like to annotate, also with regard to my comment 159, is that the page I'm navigating to shouldn't start to get reloaded during the animation process. It should wait till the animation finished and then reload the page if needed. Perhaps this would already solve mentioned issue and possibly improve the overall visual impression.", "author": "beingalink@googlemail.com", "id": 6891026, "time": "2012-12-07T07:47:39Z"}, {"text": "To, I finished test results. However, I am not sure how accurate these are, as the different sites, pages, or something else could interfere. Occurring to the test, this new patch made Firefox's memory be pretty close to what it was without any memory management at all. \n\nOf course, my test could just be messed up, but I do know that it is not using much more memory than before. \n\nNow, I have seen some problems. First, like beingalink said, I'm not sure if reloading while swiping is a good idea. I do not believe Safari does this, and this might be what is causing the swiping animation to not perform as smoothly. That said, I have yet to try the build with Markus' patch, so perhaps that will improve the swiping. This is slightly odd, as performance is improved, but so far to the user, the swiping seems to be worse. I am hoping Markus' patch fixes this, but if not, then reloading will need to be done after the swipe.\n\nSecond, there have been occurrences that even when the screenshot taking limit is set at 100, that certain pages still swipe with a blank page. Actually, they tend to start with an image, but then it disappears. I have had that happen a few times on Cnet.com.\n\nEither way, if you would like to see the memory comparison, see: https://docs.google.com/spreadsheet/ccc?key=0Am1zicD3k5IfdHZHNDEzRFI3MnRTODUzVXNVTHY5aUE#gid=0", "author": "jsbruner@umich.edu", "id": 6891781, "time": "2012-12-07T13:40:36Z"}, {"text": "Oh, I'm also having a problem where sometimes swiping back to a page doesn't actually remove the picture from view, but it appears to have done so. What I mean is that it looks like I am on the previous page, but nothing is working. You can't click on anything, scroll, so on and so fourth. \n\nHowever, if you slightly slide the page forward and then back again, the page will then load correctly.", "author": "jsbruner@umich.edu", "id": 6891810, "time": "2012-12-07T13:52:08Z"}, {"text": "I've tried build from comment 200. There are some lags on it (in comparison with Safari 6). Suppose it just debug (or beta) problem and may be doesn't matter for this bug.\nAlso I've found that there is no take into pixel ratio for Retina Display. So when I swipe fingers current and prev picture makes with big pixels. When I release fingers page view become normal. Support for retina resolved in bug 674373.", "author": "sergeyreym@gmail.com", "id": 6891856, "time": "2012-12-07T14:14:25Z"}, {"text": "Yes, I just tested with Markus' patch, and although improved, it does not fix the problem. The swiping is still quite lagy, especially when compared to Safari and the swiping build before the memory management was started.\n\nThis could still be from the reloading issue. We should try another patch/build where the page reloads after the swiping is complete. Perhaps make it work like Safari, where if the page needs to be reloaded after the swipe, the page fades white for a bit, then turns back to normal after the reload. It is a nice effect and appears to make things work faster.\n\nWe could do the same with grayscale or something else.", "author": "jsbruner@umich.edu", "id": 6891870, "time": "2012-12-07T14:20:01Z"}, {"text": "(In reply to Sergey Reymerov from comment #204)\n> I've tried build from comment 200. There are some lags on it (in comparison\n> with Safari 6). Suppose it just debug (or beta) problem and may be doesn't\n> matter for this bug.\n\nThe swipe animation should definitely be tested with the optimized build, not debug. It would be great to know if you're still seeing the lag with the optimized build.\n\n> Also I've found that there is no take into pixel ratio for Retina Display.\n> So when I swipe fingers current and prev picture makes with big pixels. When\n> I release fingers page view become normal. Support for retina resolved in\n> bug 674373.\n\nWe're limited by the canvas drawing code. According to bug 780362, HiDPI isn't working right now.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6893138, "time": "2012-12-07T19:31:03Z"}, {"text": "I'll keep looking into", "author": "spohl.mozilla.bugs@gmail.com", "id": 6893181, "time": "2012-12-07T19:38:25Z"}, {"text": "Hmm, my previous comment 207 got cut off. I meant:\n\nI'll keep looking into the \"reloading during animation\" and \"showing of previous page while loading the new page\" problems.\n\nIt would be great to get some feedback regarding the handling of snapshots across tabs. Is the browser.snapshots.limit property working for you? If you swipe past the limit, do the old pages appear blank during the animation? I highly recommend testing with the optimized try builds (or with the latest patch from bug 817700 applied) to keep animation performance at an acceptable level.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6893230, "time": "2012-12-07T19:46:06Z"}, {"text": "Yep. That snapshot property is working properly. I still suggest having the white page fade in to the reloaded page, as the page suddenly jumping from blank to content isn't visually appealing. Other than that, the global snapshot limit works like a charm. So far at least.", "author": "jsbruner@umich.edu", "id": 6893304, "time": "2012-12-07T20:03:01Z"}, {"text": "Created attachment 689982\nPatch\n\nThis patch addresses the \"reloading during animation\" problem. We will now wait for the animation to complete before reloading the page we navigated to. Just from visual comparison, this seems to match what Safari is doing. You should find that animations are much smoother now and complete fully before the new page is reloaded.\n\nA side-effect of this improvement is that the \"showing of previous page while loading the new page\" is occurring more frequently. I'm still looking into this.\n\nAlso removed some attachments (screenshots) that have become obsolete.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6894183, "time": "2012-12-07T23:58:27Z"}, {"text": "Created attachment 689992\nPatch\n\nAvoid blank pages during fast swiping when the snapshot compression can't complete quickly enough.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6894238, "time": "2012-12-08T00:19:56Z"}, {"text": "Very nice. Speed works well, only problem is that old pages show up while the new one is loading. Hopefully Stephen will find a fix soon. As I am sure Stephen will have a better try server build up soon, I just decided to make a quick .dmg with a build containing the latest patch here, and Markus'. I only built once, so I can not be sure it will work on your system, but I believe it should. \n\nhttps://www.dropbox.com/s/pw01575l7ucemxe/Firefox-Scroll-4.dmg?dl=1", "author": "jsbruner@umich.edu", "id": 6894353, "time": "2012-12-08T01:09:50Z"}, {"text": "Oops. It didn't let me finish. Anyway, after Stephen adds a try build I will remove the file, therefore the link will be broken.", "author": "jsbruner@umich.edu", "id": 6894357, "time": "2012-12-08T01:12:04Z"}, {"text": "Created attachment 690014\nDemonstrates HiDPI problem with swiping.\n\nI also added a screenshot showing the HiDPI problem. However, I don't believe we can do anything about that in this case.", "author": "jsbruner@umich.edu", "id": 6894365, "time": "2012-12-08T01:19:16Z"}, {"text": "try builds are struggling, but should eventually show up.\n\nI noticed that when swiping in the forward direction, I'm intermittently able to pull the next page further across the previous page than what I should be able to. This causes the previous page to appear on the right. We'll want to make sure that the animation box stops before this happens.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6894415, "time": "2012-12-08T01:42:44Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #215)\n> try builds are struggling, but should eventually show up.\n> \n> I noticed that when swiping in the forward direction, I'm intermittently\n> able to pull the next page further across the previous page than what I\n> should be able to. This causes the previous page to appear on the right.\n> We'll want to make sure that the animation box stops before this happens.\n\nRight. Also, if you are using a trackpad, perhaps only the magic trackpad, I am able to take a third finger and keep swiping over to move the page. However, there is no limit. That means I am able to actually push the page completely off the view, leaving only the texture background. The animation will need to be limited from both sides.", "author": "jsbruner@umich.edu", "id": 6894422, "time": "2012-12-08T01:46:35Z"}, {"text": "Try run for ea95ca4398bd is complete.\nDetailed breakdown of the results available here:\n    https://tbpl.mozilla.org/?tree=Try&rev=ea95ca4398bd\nResults (out of 4 total builds):\n    failure: 4\nBuilds (or logs if builds failed) available at:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-ea95ca4398bd", "author": "release@mozilla.com", "id": 6894432, "time": "2012-12-08T02:00:39Z"}, {"text": "(In reply to Mozilla RelEng Bot from comment #217)\n> Try run for ea95ca4398bd is complete.\n> Detailed breakdown of the results available here:\n>     https://tbpl.mozilla.org/?tree=Try&rev=ea95ca4398bd\n> Results (out of 4 total builds):\n>     failure: 4\n> Builds (or logs if builds failed) available at:\n> http://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-\n> ea95ca4398bd\n\nWell... That didn't turn out to well. My build is still up though, but it did go down for a little bit. It should be working now. Hopefully the try server will be up soon.", "author": "jsbruner@umich.edu", "id": 6894435, "time": "2012-12-08T02:04:19Z"}, {"text": "Try run for 87683cddc69b is complete.\nDetailed breakdown of the results available here:\n    https://tbpl.mozilla.org/?tree=Try&rev=87683cddc69b\nResults (out of 2 total builds):\n    success: 1\n    failure: 1\nBuilds (or logs if builds failed) available at:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-87683cddc69b", "author": "release@mozilla.com", "id": 6894468, "time": "2012-12-08T02:30:40Z"}, {"text": "Try run for ea95ca4398bd is complete.\nDetailed breakdown of the results available here:\n    https://tbpl.mozilla.org/?tree=Try&rev=ea95ca4398bd\nResults (out of 6 total builds):\n    failure: 6\nBuilds (or logs if builds failed) available at:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-ea95ca4398bd", "author": "release@mozilla.com", "id": 6894488, "time": "2012-12-08T02:45:37Z"}, {"text": "Optimized try build is available here:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-87683cddc69b/try-macosx64/firefox-20.0a1.en-US.mac.dmg", "author": "spohl.mozilla.bugs@gmail.com", "id": 6894511, "time": "2012-12-08T03:04:03Z"}, {"text": "Try run for 933f128d75a5 is complete.\nDetailed breakdown of the results available here:\n    https://tbpl.mozilla.org/?tree=Try&rev=933f128d75a5\nResults (out of 2 total builds):\n    success: 1\n    failure: 1\nBuilds (or logs if builds failed) available at:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-933f128d75a5", "author": "release@mozilla.com", "id": 6894540, "time": "2012-12-08T03:45:36Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #221)\n> Optimized try build is available here:\n> http://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-\n> 87683cddc69b/try-macosx64/firefox-20.0a1.en-US.mac.dmg\n\nThis build works great. Very smooth animation. Great!", "author": "bugzilla@spray.se", "id": 6894762, "time": "2012-12-08T10:31:48Z"}, {"text": "Works great here as well!\n\nMacBook Air (2011), OS X 10.8.2\n\nDarwin mieszko-macbook1.home 12.2.0 Darwin Kernel Version 12.2.0: Sat Aug 25 00:48:52 PDT 2012; root:xnu-2050.18.24~1/RELEASE_X86_64 x86_64", "author": "mieszkoslusarczyk@gmail.com", "id": 6894866, "time": "2012-12-08T13:32:23Z"}, {"text": "Works great here too, Macbook Air as ^.\n\nWhen will it be merged with official Nightly?", "author": "ludalex@gmail.com", "id": 6895140, "time": "2012-12-08T19:45:07Z"}, {"text": "We need Markus's patch to merge either first or with this patch. Most likely we'll wait till his goes through  We should shoot for Firefox 21. Perhaps sooner.", "author": "jsbruner@umich.edu", "id": 6895145, "time": "2012-12-08T19:50:30Z"}, {"text": "Created attachment 690541\nPatch\n\nThis fixes the issue where we would display the old page while the new page is loading. This is particularly visible by using the sites in comment 168:\n1. Go to http://www.last.fm/user/TheLink\n2. Then go to https://encrypted.google.com\n3. Now swipe back to the last.fm page.\n\nThis patch doesn't address the following problems yet:\n1. Fast swiping, i.e. starting a new swipe animation before another one ends. This is intentionally broken right now since I'm working on it.\n2. Swiping past the bounds of the page, displaying the box underneath.\n3. Making swipe animations available if (and only if) [NSEvent isSwipeTrackingFromScrollEventsEnabled].", "author": "spohl.mozilla.bugs@gmail.com", "id": 6899162, "time": "2012-12-10T21:28:15Z"}, {"text": "Try run for 2100b0bd1171 is complete.\nDetailed breakdown of the results available here:\n    https://tbpl.mozilla.org/?tree=Try&rev=2100b0bd1171\nResults (out of 2 total builds):\n    exception: 2\nBuilds (or logs if builds failed) available at:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-2100b0bd1171", "author": "release@mozilla.com", "id": 6899168, "time": "2012-12-10T21:30:37Z"}, {"text": "(In reply to Mozilla RelEng Bot from comment #228)\n\nThis try run was cancelled. New one is running now.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6899191, "time": "2012-12-10T21:39:13Z"}, {"text": "Try run for ec7a9b756db6 is complete.\nDetailed breakdown of the results available here:\n    https://tbpl.mozilla.org/?tree=Try&rev=ec7a9b756db6\nResults (out of 2 total builds):\n    success: 2\nBuilds (or logs if builds failed) available at:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-ec7a9b756db6", "author": "release@mozilla.com", "id": 6899671, "time": "2012-12-10T23:30:37Z"}, {"text": "Well, it works great so far. Fast, reliable. We just need the few things you (Stephen) mentioned to work. We're getting pretty close to finishing this. Thanks Stephen.", "author": "jsbruner@umich.edu", "id": 6899818, "time": "2012-12-11T00:10:53Z"}, {"text": "Unfortunately, I found another bug. If you go to the Add-On page, just try navigating around in there. Go to extensions, then to plugins and so fourth. Then try swiping back and forward to navigate. Sometimes it will work, but almost always it eventually turns all pages into \"blank\" pages and you then get stuck.", "author": "jsbruner@umich.edu", "id": 6903632, "time": "2012-12-11T21:41:48Z"}, {"text": "(In reply to Josiah from comment #232)\n> Unfortunately, I found another bug. If you go to the Add-On page, just try\n> navigating around in there. Go to extensions, then to plugins and so fourth.\n> Then try swiping back and forward to navigate. Sometimes it will work, but\n> almost always it eventually turns all pages into \"blank\" pages and you then\n> get stuck.\n\nI've been unable to reproduce this, unless I fast swipe (which I'm still working on). Could you confirm that even when all pages have time to reload after a swipe, this bug still reproduces?", "author": "spohl.mozilla.bugs@gmail.com", "id": 6903801, "time": "2012-12-11T22:29:10Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #233)\n> (In reply to Josiah from comment #232)\n> > Unfortunately, I found another bug. If you go to the Add-On page, just try\n> > navigating around in there. Go to extensions, then to plugins and so fourth.\n> > Then try swiping back and forward to navigate. Sometimes it will work, but\n> > almost always it eventually turns all pages into \"blank\" pages and you then\n> > get stuck.\n> \n> I've been unable to reproduce this, unless I fast swipe (which I'm still\n> working on). Could you confirm that even when all pages have time to reload\n> after a swipe, this bug still reproduces?\n\nNo, I am pretty sure it is another error. I can reproduce it. I do not believe I am swiping fast, and the page appears to load fully. Once my video is uploaded, I will link it here, and you can look at what I did and decide if it is another problem.", "author": "jsbruner@umich.edu", "id": 6904154, "time": "2012-12-12T00:07:59Z"}, {"text": "https://www.dropbox.com/s/mggdeho5xhaz0au/Bug.movhttps://www.dropbox.com/s/mggdeho5xhaz0au/Bug.mov\n\nThere's the link. Take a look at it yourself.", "author": "jsbruner@umich.edu", "id": 6904200, "time": "2012-12-12T00:16:58Z"}, {"text": "https://www.dropbox.com/s/mggdeho5xhaz0au/Bug.mov\n\nSorry. Messed up the last one. My keyboard is wrecked right now. I can barely type.", "author": "jsbruner@umich.edu", "id": 6904212, "time": "2012-12-12T00:18:57Z"}, {"text": "Does it really make sense to have the swipe animations in the settings page? Swiping the menu as well looks odd.", "author": "bugzilla@spray.se", "id": 6905120, "time": "2012-12-12T08:30:29Z"}, {"text": "(In reply to Jos\u00e9 Jeria from comment #237)\n> Does it really make sense to have the swipe animations in the settings page?\n> Swiping the menu as well looks odd.\n\nI have to agree. In many cases swiping looks great, but there I'm not sure it is the way to go. Since the menu was made to be navigated like an app, swiping doesn't look right there. You should still be able to physically swipe, but the animation needs to go.", "author": "jsbruner@umich.edu", "id": 6905977, "time": "2012-12-12T13:49:46Z"}, {"text": "Created attachment 691550\nPatch\n\nThis patch:\n* implements support for fast swiping.\n* fixes the issue of pages being swipable past the bounds of the window.\n* fixes some instances of flickering when swipe animations stop.\n\nStill to do:\n* Support for swipe animations should be conditional on [NSEvent isSwipeTrackingFromScrollEventsEnabled] (most likely requires new component interface).\n* Might want to revise the dispatching of swipe events in nsChildView.mm for better fast swiping support.\n\nTry build is running.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6908519, "time": "2012-12-12T23:11:15Z"}, {"text": "(In reply to Josiah from comment #238)\n> (In reply to Jos\u00e9 Jeria from comment #237)\n> > Does it really make sense to have the swipe animations in the settings page?\n> > Swiping the menu as well looks odd.\n> \n> I have to agree. In many cases swiping looks great, but there I'm not sure\n> it is the way to go. Since the menu was made to be navigated like an app,\n> swiping doesn't look right there. You should still be able to physically\n> swipe, but the animation needs to go.\n\nI was able to track this down to the fact that pageshow and pagehide events aren't being properly dispatched when navigating in the add-ons manager. There might be a workaround for it, but I'm not sure I'll be able to cover this as part of this bug.\n\nIf you see this behavior on any real website (i.e. not on a 'built-in' page like the add-ons manager), please speak up.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6908539, "time": "2012-12-12T23:16:43Z"}, {"text": "Try run for ef2fe216bd52 is complete.\nDetailed breakdown of the results available here:\n    https://tbpl.mozilla.org/?tree=Try&rev=ef2fe216bd52\nResults (out of 2 total builds):\n    success: 2\nBuilds (or logs if builds failed) available at:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-ef2fe216bd52", "author": "release@mozilla.com", "id": 6909007, "time": "2012-12-13T01:15:38Z"}, {"text": "Is there something in the new build that would affect three finger swipe gestures? I've had three finger swipe up/down set to open panorama, which no longer seems to work, nor does the shift+3 finger to scroll to top/bottom. Running 10.8.2 on a 2012 Macbook Air", "author": "me@chrisb.xyz", "id": 6910362, "time": "2012-12-13T14:05:29Z"}, {"text": "(In reply to Chris Barry [CB_27] from comment #242)\n> Is there something in the new build that would affect three finger swipe\n> gestures? I've had three finger swipe up/down set to open panorama, which no\n> longer seems to work, nor does the shift+3 finger to scroll to top/bottom.\n> Running 10.8.2 on a 2012 Macbook Air\n\nAre you talking about swipe gestures from System Preferences? Or from another application? I'm not sure what \"open panorama\" means.", "author": "jsbruner@umich.edu", "id": 6910413, "time": "2012-12-13T14:19:45Z"}, {"text": "I have found another bug that is similar to the Add-On bug, however it has to do with an actual site (Mozilla.org actually). This error appears to happen when a site changes it's content based on changes such as #mobile and #desktop. This causes white pages to appear, on those sites. \n\nTo Reproduce: \n\nOpen a new tab\n\nGo to mozilla.org\n\nClick on Mozilla->Firefox\n\n(You should not be on the Firefox page that shows tabs for mobile and desktop.)\n\nClick on the other tab and then go back and forward.  Then try swiping back, for every change containing #whatever, there is a white page instead of an image. It does this until you leave https://www.mozilla.org/en-US/firefox/fx/.", "author": "jsbruner@umich.edu", "id": 6910489, "time": "2012-12-13T14:47:14Z"}, {"text": "Sorry, when I said go back and forward, I mean click on the alternate mobile/desktop tabs.", "author": "jsbruner@umich.edu", "id": 6910492, "time": "2012-12-13T14:48:22Z"}, {"text": "(In reply to Josiah from comment #243)\n> (In reply to Chris Barry [CB_27] from comment #242)\n\n> Are you talking about swipe gestures from System Preferences? Or from\n> another application? I'm not sure what \"open panorama\" means.\n\n\nSorry, I had modified the gesture in about:config to open panorama (cmd+shift+e), the default for a 3 finger up/down swipe is to scroll to the top or bottom of the page, which still does not work in a clean profile for this build. However, it still works in other applications, so it seems to be only this build of firefox", "author": "me@chrisb.xyz", "id": 6910701, "time": "2012-12-13T15:54:33Z"}, {"text": "(In reply to Chris Barry [CB_27] from comment #246)\n> (In reply to Josiah from comment #243)\n> > (In reply to Chris Barry [CB_27] from comment #242)\n> \n> > Are you talking about swipe gestures from System Preferences? Or from\n> > another application? I'm not sure what \"open panorama\" means.\n> \n> \n> Sorry, I had modified the gesture in about:config to open panorama\n> (cmd+shift+e), the default for a 3 finger up/down swipe is to scroll to the\n> top or bottom of the page, which still does not work in a clean profile for\n> this build. However, it still works in other applications, so it seems to be\n> only this build of firefox\n\nOdd. I did not see anything in about:config about three-finger gestures. Three finger swiping never did anything on any version of Firefox for me, however, I do have mission control set with that gesture.", "author": "jsbruner@umich.edu", "id": 6910726, "time": "2012-12-13T15:59:01Z"}, {"text": "The entry is \"browser.gesture.swipe.down\", and if I set it to default, the value is \"cmd_scrollBottom\", but I think it will only work if mission control is set to 4 fingers, and Swipe between pages is set to Swipe with 2 or 3 fingers", "author": "me@chrisb.xyz", "id": 6910848, "time": "2012-12-13T16:13:31Z"}, {"text": "(In reply to Chris Barry [CB_27] from comment #248)\n> The entry is \"browser.gesture.swipe.down\", and if I set it to default, the\n> value is \"cmd_scrollBottom\", but I think it will only work if mission\n> control is set to 4 fingers, and Swipe between pages is set to Swipe with 2\n> or 3 fingers\n\nHmm. I can't get the gesture to work even with Mission control off. (On the regular Nightly)", "author": "jsbruner@umich.edu", "id": 6910866, "time": "2012-12-13T16:17:29Z"}, {"text": "(In reply to Josiah from comment #249)\n\n> \n> Hmm. I can't get the gesture to work even with Mission control off. (On the\n> regular Nightly)\n\nHmm, I only have UX and This version of nightly, so I suppose it could be a problem with the newest Nightly build", "author": "me@chrisb.xyz", "id": 6911073, "time": "2012-12-13T17:11:18Z"}, {"text": "Very possible. When I get a chance I'll try the Aurora build.", "author": "jsbruner@umich.edu", "id": 6911124, "time": "2012-12-13T17:24:08Z"}, {"text": "(In reply to Chris Barry [CB_27] from comment #242)\n> Is there something in the new build that would affect three finger swipe\n> gestures? I've had three finger swipe up/down set to open panorama, which no\n> longer seems to work, nor does the shift+3 finger to scroll to top/bottom.\n> Running 10.8.2 on a 2012 Macbook Air\n\nThe latest patch is unlikely to be the reason for this behavior (there were no changes that would intercept/affect these gestures). If you can reproduce in the regular nightly, please file a new bug.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6911456, "time": "2012-12-13T18:28:39Z"}, {"text": "Also, I can not reproduce this behavior on any version of Firefox. However, if you can get the behavior working on Firefox, but not the Nightly, then you should file a bug.  \n\nhttp://nightly.mozilla.org/", "author": "jsbruner@umich.edu", "id": 6911488, "time": "2012-12-13T18:33:10Z"}, {"text": "(In reply to Josiah from comment #244)\n> Click on the other tab and then go back and forward.  Then try swiping back,\n> for every change containing #whatever, there is a white page instead of an\n> image. It does this until you leave\n> https://www.mozilla.org/en-US/firefox/fx/.\n\nI can reproduce this. Will have to look into it. Thanks!", "author": "spohl.mozilla.bugs@gmail.com", "id": 6911500, "time": "2012-12-13T18:35:47Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #252)\n> The latest patch is unlikely to be the reason for this behavior (there were\n> no changes that would intercept/affect these gestures). If you can reproduce\n> in the regular nightly, please file a new bug.\n\nI've just downloaded the latest version of Nightly, and all gestures are working fine, and scroll to the top/bottom when on a clean profile, as they should. I've attached a screenshot of my trackpad settings and my about:config entries", "author": "me@chrisb.xyz", "id": 6911558, "time": "2012-12-13T18:47:33Z"}, {"text": "Created attachment 691893\nSettings to Reproduce 3 Finger Swipe", "author": "me@chrisb.xyz", "id": 6911564, "time": "2012-12-13T18:48:30Z"}, {"text": "(In reply to Chris Barry [CB_27] from comment #255)\n> (In reply to Stephen Pohl [:spohl] from comment #252)\n> I've just downloaded the latest version of Nightly, and all gestures are\n> working fine, and scroll to the top/bottom when on a clean profile, as they\n> should. I've attached a screenshot of my trackpad settings and my\n> about:config entries\n\nDid this start happening with the very latest patch, or do previous try builds in this bug reproduce the same problem?", "author": "spohl.mozilla.bugs@gmail.com", "id": 6912054, "time": "2012-12-13T20:25:36Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #257) \n> Did this start happening with the very latest patch, or do previous try\n> builds in this bug reproduce the same problem?\n\nIt only started occurring with the latest trybuild, I've been using this daily without problem before", "author": "me@chrisb.xyz", "id": 6912118, "time": "2012-12-13T20:49:45Z"}, {"text": "(In reply to Chris Barry [CB_27] from comment #258)\n> (In reply to Stephen Pohl [:spohl] from comment #257) \n> > Did this start happening with the very latest patch, or do previous try\n> > builds in this bug reproduce the same problem?\n> \n> It only started occurring with the latest trybuild, I've been using this\n> daily without problem before\n\nAnd if you go back to previous try builds today, you're still unable to reproduce the problem? I just want to make sure that nothing else has changed on your system and we're really dealing with a new problem in the latest patch.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6912131, "time": "2012-12-13T20:53:18Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #259)\n> And if you go back to previous try builds today, you're still unable to\n> reproduce the problem? I just want to make sure that nothing else has\n> changed on your system and we're really dealing with a new problem in the\n> latest patch.\n\nJust downloaded and installed the build in Comment #230, and everything works, I'm assuming I didn't accidentally scroll past a more recent one", "author": "me@chrisb.xyz", "id": 6912161, "time": "2012-12-13T21:02:09Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #254)\n> (In reply to Josiah from comment #244)\n> > Click on the other tab and then go back and forward.  Then try swiping back,\n> > for every change containing #whatever, there is a white page instead of an\n> > image. It does this until you leave\n> > https://www.mozilla.org/en-US/firefox/fx/.\n> \n> I can reproduce this. Will have to look into it. Thanks!\n\nInterestingly enough, Safari has difficulties with this page as well. Especially fast swiping causes the page to become unresponsive (i.e. links aren't clickable) and after a few seconds, the page turns blank.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6913963, "time": "2012-12-14T08:14:23Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #261)\n> (In reply to Stephen Pohl [:spohl] from comment #254)\n> > (In reply to Josiah from comment #244)\n> > \n> > I can reproduce this. Will have to look into it. Thanks!\n> \n> Interestingly enough, Safari has difficulties with this page as well.\n> Especially fast swiping causes the page to become unresponsive (i.e. links\n> aren't clickable) and after a few seconds, the page turns blank.\n\nThat is odd. Perhaps the website needs some work. In the meantime, it should still be looked at. I think it has to do with javascript. I could be wrong though.", "author": "jsbruner@umich.edu", "id": 6914767, "time": "2012-12-14T14:44:03Z"}, {"text": "(In reply to Chris Barry [CB_27] from comment #260) \n> Just downloaded and installed the build in Comment #230, and everything\n> works, I'm assuming I didn't accidentally scroll past a more recent one\n\nCould you give this build a shot and tell me if it works or not? Thanks!\nhttp://ftp-scl3.mozilla.com/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-8094a9b9168c/try-macosx64/firefox-20.0a1.en-US.mac.dmg", "author": "spohl.mozilla.bugs@gmail.com", "id": 6915582, "time": "2012-12-14T17:57:24Z"}, {"text": "@Stephen Pohl\n\nI just tried your build, i don't know how to use patches so i was happy to see your build, its OK but if you go a little bit fast you won't be happy with the animation.\n\nanyway nice work and keep improving it, thanks", "author": "iAbdulElah@gmail.com", "id": 6916015, "time": "2012-12-14T19:18:45Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #263)\n> Could you give this build a shot and tell me if it works or not? Thanks!\n> http://ftp-scl3.mozilla.com/pub/mozilla.org/firefox/try-builds/spohl@mozilla.\n> com-8094a9b9168c/try-macosx64/firefox-20.0a1.en-US.mac.dmg\n\nyep, works fine in that build!", "author": "me@chrisb.xyz", "id": 6916101, "time": "2012-12-14T19:35:14Z"}, {"text": "(In reply to Chris Barry [CB_27] from comment #265)\n> (In reply to Stephen Pohl [:spohl] from comment #263)\n> > Could you give this build a shot and tell me if it works or not? Thanks!\n> > http://ftp-scl3.mozilla.com/pub/mozilla.org/firefox/try-builds/spohl@mozilla.\n> > com-8094a9b9168c/try-macosx64/firefox-20.0a1.en-US.mac.dmg\n> \n> yep, works fine in that build!\n\n@Stephen, What changes were made in that build?", "author": "jsbruner@umich.edu", "id": 6916106, "time": "2012-12-14T19:36:22Z"}, {"text": "(In reply to Chris Barry [CB_27] from comment #265)\n> (In reply to Stephen Pohl [:spohl] from comment #263)\n> > Could you give this build a shot and tell me if it works or not? Thanks!\n> > http://ftp-scl3.mozilla.com/pub/mozilla.org/firefox/try-builds/spohl@mozilla.\n> > com-8094a9b9168c/try-macosx64/firefox-20.0a1.en-US.mac.dmg\n> \n> yep, works fine in that build!\n\nInteresting. What about the build below? This should give me enough info to proceed:\nhttp://ftp-scl3.mozilla.com/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-b49ce8c01272/try-macosx64/firefox-20.0a1.en-US.mac.dmg", "author": "spohl.mozilla.bugs@gmail.com", "id": 6916554, "time": "2012-12-14T21:34:03Z"}, {"text": "(In reply to AbdulElah from comment #264)\n> its OK but if you go a little bit fast you won't be happy\n> with the animation.\n\nThanks for the feedback. Would you mind trying the build at the bottom of comment 267 and let me know if the animation is better during fast swiping?", "author": "spohl.mozilla.bugs@gmail.com", "id": 6916566, "time": "2012-12-14T21:36:37Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #267)\n> Interesting. What about the build below? This should give me enough info to\n> proceed:\n> http://ftp-scl3.mozilla.com/pub/mozilla.org/firefox/try-builds/spohl@mozilla.\n> com-b49ce8c01272/try-macosx64/firefox-20.0a1.en-US.mac.dmg\n\nnope, doesnt work in that one", "author": "me@chrisb.xyz", "id": 6916626, "time": "2012-12-14T21:55:05Z"}, {"text": "Created attachment 693784\nPatch\n\nFixes issue with three finger swipe up/down", "author": "spohl.mozilla.bugs@gmail.com", "id": 6928278, "time": "2012-12-19T08:06:47Z"}, {"text": "(In reply to Chris Barry [CB_27] from comment #269)\n> (In reply to Stephen Pohl [:spohl] from comment #267)\n> > http://ftp-scl3.mozilla.com/pub/mozilla.org/firefox/try-builds/spohl@mozilla.\n> > com-b49ce8c01272/try-macosx64/firefox-20.0a1.en-US.mac.dmg\n> \n> nope, doesnt work in that one\n\nI was able to reproduce the problem. This should be fixed with the latest try build:\nhttp://ftp-scl3.mozilla.com/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-ce2ffcc18114/try-macosx64/firefox-20.0a1.en-US.mac.dmg", "author": "spohl.mozilla.bugs@gmail.com", "id": 6928294, "time": "2012-12-19T08:13:34Z"}, {"text": "So far, that build works great. However, one issue still needs to be addressed, although it is not severe. If you have trackpad (I have the magic trackpad) you can swipe with two fingers, but use a third finger to keep pushing the page. I could go on forever. I am able to completely remove the from view leaving nothing but the textured background.\n\nThis should not happen. Safari stops you about half way on the window.", "author": "jsbruner@umich.edu", "id": 6929387, "time": "2012-12-19T16:14:17Z"}, {"text": "(In reply to Josiah from comment #244)\n> I have found another bug that is similar to the Add-On bug, however it has\n> to do with an actual site (Mozilla.org actually). This error appears to\n> happen when a site changes it's content based on changes such as #mobile and\n> #desktop. This causes white pages to appear, on those sites. \n> \n> To Reproduce: \n> \n> Open a new tab\n> \n> Go to mozilla.org\n> \n> Click on Mozilla->Firefox\n> \n> (You should not be on the Firefox page that shows tabs for mobile and\n> desktop.)\n> \n> Click on the other tab and then go back and forward.  Then try swiping back,\n> for every change containing #whatever, there is a white page instead of an\n> image. It does this until you leave\n> https://www.mozilla.org/en-US/firefox/fx/.\n\nThere seems to be a similar issue on Dropbox.", "author": "jsbruner@umich.edu", "id": 6929408, "time": "2012-12-19T16:19:46Z"}, {"text": "Also, is this swiping animation completely done through Firefox/Gecko source? Or is this using NSPageController as the backbone?", "author": "jsbruner@umich.edu", "id": 6930672, "time": "2012-12-19T21:10:59Z"}, {"text": "Also, I just noticed that Firefox is using 1.88 GB of memory for me. This is with pretty standard use. Is it because I haven't changed the snapshot-limit? Obviously, if it has to do with that, 100 can not be the standard setting.", "author": "jsbruner@umich.edu", "id": 6933653, "time": "2012-12-20T16:18:15Z"}, {"text": "about:memory would probably clear up where that memory usage comes from.", "author": "josh@joshmatthews.net", "id": 6933726, "time": "2012-12-20T16:40:34Z"}, {"text": "What am I looking for that would contain the snapshots. Explict->images?", "author": "jsbruner@umich.edu", "id": 6933748, "time": "2012-12-20T16:44:30Z"}, {"text": "There's no direct explicit -> images memory reporter.  Images are reported under the window which owns them.\n\nElements in about:memory are sorted by the amount of memory each element uses, so if you have hundreds of mb of image data /somewhere/, it should appear near the top of about:memory.\n\nIt's also possible that we don't have good memory reporters for this data and it will show up as heap-unclassified.", "author": "justin.lebar+bug@gmail.com", "id": 6933821, "time": "2012-12-20T17:05:13Z"}, {"text": "(In reply to Josiah from comment #274)\n> Also, is this swiping animation completely done through Firefox/Gecko\n> source? Or is this using NSPageController as the backbone?\n\nThe animation itself is done in browser.js.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6934573, "time": "2012-12-20T19:42:08Z"}, {"text": "Created attachment 694540\nPatch for availability check\n\nThis patch adds the ability to check whether or not swipe animations are available on a platform/configuration. The changes here are made to nsIDragService under widget. I'm not sure if this functionality should live in a component under widget, and I certainly don't think that it should be part of nsIDragService. I'm wondering:\n1. Is there a good existing component to add this functionality to, or should I write an entirely new component?\n2. Where should the component live?\n\nnsIDragService was chosen because it demonstrates the ability to have different interface implementations for different platforms and I think this would be the right approach.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6934928, "time": "2012-12-20T21:12:12Z"}, {"text": "Comment on attachment 694540\nPatch for availability check\n\nLeaving aside the question of which interface it belongs to, this looks fine to me.\n\nBut you need to make sure +[NSEvent isSwipeTrackingFromScrollEventsEnabled] is only called on OS X 10.7 and up, since that method doesn't exist on earlier versions of OS X.", "author": "smichaud@pobox.com", "id": 6935049, "time": "2012-12-20T21:38:54Z"}, {"text": "> 2. Where should the component live?\n\nI think it's best to put it somewhere under widget.\n\n> 1. Is there a good existing component to add this functionality to,\n>    or should I write an entirely new component?\n\nI can't find an existing interface that fits better than\nnsIDragService.  And yes, that's probably not the best match.\n\nWe have examples of platform-specific interfaces (for example\nnsPIWidgetCocoa).  If you go that way it should be under widget/cocoa.\n\nBut I get the impression we'd like to have swiping support (and\nsupport for swiping animation) on more than one platform.  So how\nabout you create a new nsISwiping interface under widget?", "author": "smichaud@pobox.com", "id": 6935168, "time": "2012-12-20T21:55:17Z"}, {"text": "Created attachment 694745\nPatch for availability check\n\nAdds a new interface nsISwipeService to check for the availability of history swipe animations on a given platform.\n\nAlso fixed the method call on NSEvent to ensure that it is only called when available.\n\nWaiting for try builds to finish before asking for feedback/review.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6936587, "time": "2012-12-21T09:01:41Z"}, {"text": "Created attachment 694922\nPatch for availability check\n\nI think this part of the patch can be reviewed before the rest, but please let me know if you'd rather review everything at the same time.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6938326, "time": "2012-12-21T19:06:48Z"}, {"text": "Comment on attachment 694922\nPatch for availability check\n\nThis looks fine to me.  Though creating platform-specific stubs for os2 and qt is probably overkill.\n\nI've started a tryserver build to make sure this compiles on all platforms.  The results so far are all positive.  When the builds finish (presuming there are no failures), I'll r+ the patch.", "author": "smichaud@pobox.com", "id": 6939041, "time": "2012-12-21T22:12:23Z"}, {"text": "Created attachment 695053\nPatch\n\nImproved the way we deal with fast swiping. This is now done in nsChildView.mm instead of browser.js and helps prevent potential race conditions between initiating the next swipe animation and tearing down the boxes with snapshots.\n\nThe last thing I'm going to look at before asking for a review is the issue encountered with named anchors (add-ons manager & mozilla.com website). This might be a simple fix and ideally, we'd want this as part of this patch.\n\nIf I'm missing anything crucial for this first patch, please let me know.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6939551, "time": "2012-12-22T01:01:01Z"}, {"text": "Created attachment 695054\nPatch for availability check\n\nUpdated this patch to compile with attachment 695053. Carrying over r+ flag since there were no functional changes. Thanks Steven for the review!", "author": "spohl.mozilla.bugs@gmail.com", "id": 6939560, "time": "2012-12-22T01:04:01Z"}, {"text": "(In reply to Steven Michaud from comment #282)\n> We have examples of platform-specific interfaces (for example\n> nsPIWidgetCocoa).  If you go that way it should be under widget/cocoa.\n> \n> But I get the impression we'd like to have swiping support (and\n> support for swiping animation) on more than one platform.  So how\n> about you create a new nsISwiping interface under widget?\n\nYes, do that. We will want the swiping itself on other platform (Perhaps Windows 8, as it seems to be more gesture-based), and just the swiping animation is going to be implemented on all platforms. See bug 817074.\n\nI am running a build now with all three patches, toBlob fix, swipe patch, and compatibility. \n\n(In reply to Stephen Pohl [:spohl] from comment #286)\n> If I'm missing anything crucial for this first patch, please let me know.\n\nI do not believe you are missing anything. As I have said before, a swipe animation limit could be added to keep the page from completely leaving the window, but that is optional. NSPageController that many apps use have this problem as well, and it does not really effect anything, I just find is slightly distracting.", "author": "jsbruner@umich.edu", "id": 6941488, "time": "2012-12-23T14:30:07Z"}, {"text": "Created attachment 696097\nPatch\n\nFixed some more flickering, added function descriptions and improved the way we handle navigation to named anchors and popstate events.\n\nOn firefox.com and the add-ons manager, the initial swipe back to a previously visited site will still be blank. However, a swipe forward will now work with proper snapshots. With named anchors, popstate events take the place of pageshow events when swiping. I was unable to identify an event that is consistently dispatched when a named anchor is clicked, but before the anchor is navigated to. This would take the place of pagehide events in the context of named anchors. The consequence is that the pages are initially blank when navigating back to them. The most important thing is that we now always tear down the animation overlay when the swipe gesture ends. Previously, we could run into situations where the overlay remained on top of the page and the user could no longer interact with the page.\n\nI believe this is ready for a first review. We may want to open a separate bug to further improve the navigation to named anchors.\n\nMarkus, since you had such a huge part in this patch it would be great if you could have a quick look at it too.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6947648, "time": "2012-12-27T19:37:42Z"}, {"text": "Created attachment 696099\nPatch for availability check\n\nUpdated for latest patch, no functional changes. Carrying r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6947654, "time": "2012-12-27T19:38:57Z"}, {"text": "Try builds with latest changes:\nhttp://ftp-scl3.mozilla.com/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-25af20f814d4/try-macosx64/", "author": "spohl.mozilla.bugs@gmail.com", "id": 6947746, "time": "2012-12-27T20:10:30Z"}, {"text": "This is getting ready to land. This try build is the first one where I didn't run into obvious glitches during the first few minutes. I'll do some further testing the next few days but in my opinion this bug is ready to land in the nightlies to become tested on a broader base. Thanks for all the hard work!", "author": "beingalink@googlemail.com", "id": 6947863, "time": "2012-12-27T21:13:34Z"}, {"text": "Comment on attachment 696097\nPatch\n\nAdding Madhava for feedback from a UX perspective.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6948135, "time": "2012-12-27T22:53:45Z"}, {"text": "Created attachment 696438\nTests in progress\n\nBrowser chrome mochitests.\nMain focus: doubly-linked list implementation.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6950678, "time": "2012-12-29T00:34:59Z"}, {"text": "Before we can land this, we need to understand the memory usage effects of this patch.\n\nHow many screenshots does this patch cause us to keep in memory?  Are they compressed?  If so, with what algorithm?\n\nWe also need to experimentally confirm that the actual memory usage increase from this patch matches our expectations.", "author": "justin.lebar+bug@gmail.com", "id": 6951664, "time": "2012-12-29T23:25:57Z"}, {"text": "Yes, there is quite a memory problem. I haven't tried the latest build yet, I will soon. Anyway, on the previous build I got up two 2.2 GB of memory. The regular nightly doesn't do that.", "author": "jsbruner@umich.edu", "id": 6951704, "time": "2012-12-29T23:57:14Z"}, {"text": "Okay, thanks.  FYI we don't usually ask for review on patches which the author doesn't consider ready to be checked in.", "author": "justin.lebar+bug@gmail.com", "id": 6951712, "time": "2012-12-30T00:04:46Z"}, {"text": "(In reply to Justin Lebar [:jlebar] (away 12/21-1/2) from comment #295)\n> How many screenshots does this patch cause us to keep in memory?\n\nRight, this may have gone under in the multitude of comments in this bug. We currently have a global limit of 100 snapshots. This number is not set in stone and I'm more than willing to change it to a number that makes sense. 100 is the current number since there haven't been any objections to this limit (yet).\n\n>  Are they compressed?\n\nWe use <canvas>.toBlob() to compress the snapshot.\n\n>  If so, with what algorithm?\n\nimage/png. My justification for this is that a loss-less algorithm seemed ideal for Retina displays. image/jpg did not result in a significant decrease in memory utilization, unless the quality was reduced. A quality of less than 100% quickly looked ugly on Retina displays.\n\n> We also need to experimentally confirm that the actual memory usage increase\n> from this patch matches our expectations.\n\nMy limited testing showed that the memory usage increase matched our expectations, but I'll have another focused look at this on Monday.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6951766, "time": "2012-12-30T01:26:24Z"}, {"text": "(In reply to Justin Lebar [:jlebar] (away 12/21-1/2) from comment #297)\n> Okay, thanks.  FYI we don't usually ask for review on patches which the\n> author doesn't consider ready to be checked in.\n\nThe latest patch addressed the last outstanding issues (see comment 289). Since I haven't been able to reproduce a memory problem thus far, I considered this patch ready for a review and ultimately a check in. I'll have a closer look at memory utilization on Monday.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6951782, "time": "2012-12-30T01:33:16Z"}, {"text": "To put this in perspective: Average memory usage is ~600mb for nightly users on Mac.  (Our telemetry numbers on Mac are pretty bad, but the more reliable Windows numbers peg it at ~500mb.)\n\nAt 2mb per image, 100 images would be a 1.3x (800/600) increase over the average memory usage.  Granted, I don't know how many browsing sessions would hit the 100 image cap.  But OTOH, I imagine the images would be larger than 2mb, particularly on retina displays.\n\nI'd be much more comfortable with a 5 or 10 image cap to start with, personally.  We can add telemetry to see how often we have a cache miss versus a cache hit so as to tune this size.", "author": "justin.lebar+bug@gmail.com", "id": 6951814, "time": "2012-12-30T02:46:14Z"}, {"text": "I agree. I would suggest we start the cap at 20 though. I am a pretty average web browser, and I found twenty to be pretty good. 5-10 seems small. 10 is okay. But you are right, telemetry could have us decide later.", "author": "jsbruner@umich.edu", "id": 6951823, "time": "2012-12-30T02:49:13Z"}, {"text": "I'd like something a bit better than \"I am a pretty average web browser, and I found twenty to be pretty good.\" \n\nIf we don't have science here, we should get it somehow. In absence of that, we should look at what other browsers do and strive for parity until we have our own science to apply.", "author": "asa@mozilla.org", "id": 6952481, "time": "2012-12-30T20:43:16Z"}, {"text": "(In reply to Asa Dotzler [:asa] from comment #302)\n> I'd like something a bit better than \"I am a pretty average web browser, and\n> I found twenty to be pretty good.\" \n> \n> If we don't have science here, we should get it somehow. In absence of that,\n> we should look at what other browsers do and strive for parity until we have\n> our own science to apply.\n\nIndeed. And as for parity, we do have a problem there. Suppose we discover that Safari holds say about 30 snapshots. What then? Safari also has a much lower memory usage if I remember correctly. As much as I hate to say it, Firefox is a bit of a memory hog, especially on OS X. \n\nNow, I built again with the newest patches and memory no longer goes above ~600 MB, but that is still high. Anyway, I am just suggesting that always following the lead of other browsers may not help here. Instead, a science is necessary. \n\nI am quite new at this. So I am not sure how we would go about achieving some kind of test, but it definitely needs to be done. \n\n(In reply to Justin Lebar [:jlebar] (away 12/21-1/2) from comment #300)\n> At 2mb per image, 100 images would be a 1.3x (800/600) increase over the\n> average memory usage.  Granted, I don't know how many browsing sessions\n> would hit the 100 image cap.  But OTOH, I imagine the images would be larger\n> than 2mb, particularly on retina displays.\n\nIt isn't really retina that is the problem, as the screenshot could still be say 800 x 600. The problem is the larger resolution screens. Obviously, if a user has a maximized window on a Cinema display, then the amount of content would be huge. Retina is more of a challenge, as the user is really displaying twice the content it usually does, assuming you ignore the change in PPI. (Am I correct here? I didn't work on taking screenshots, so I am not positive it works that way.)", "author": "jsbruner@umich.edu", "id": 6952492, "time": "2012-12-30T21:01:54Z"}, {"text": "Oh, and what about the idea for using either lower resolution, grayscale, or something else to make images smaller past a point. We could then store about 10 regular images, and perhaps 5 grayscale ones. That would slightly lower the memory usage.\n\nThere was also an idea to store images on the hard drive? In light of the new patches, is this still a possibility, would it really help?", "author": "jsbruner@umich.edu", "id": 6952493, "time": "2012-12-30T21:05:14Z"}, {"text": "I found that about:memory reliably reports the memory utilization for the snapshots in memory under explicit > dom/memory-file-data/large.\n\nA quick experiment has shown that a session with 20 snapshots uses 7.2MB of memory to store the compressed snapshots, or 0.36MB per snapshot on average. I was positively surprised by this, since I expected about the same 2MB per snapshot as Justin. The snapshots range from 0.04MB to 1.47MB (the last one was a complex image found via Google Image search). This is on a MacBook Pro, 15.4\" retina display with 2880 x 1800 resolution. The browser was maximized to cause the snapshots to be as large as possible on this system.\n\nUsing about:memory, I was also able to confirm that the GC correctly collects old snapshots when they're being overwritten. Overwrites occur when an animation is initiated more than once, but the user ends up staying on the current page. They also occur when a user goes back in history and then navigates to new pages.\n\nWhat may be working in our favor right now on retina displays is that the <canvas> drawing code doesn't support HiDPI (bug 780362). This may cause snapshots on systems with retina displays to be equal in size as snapshots on non-retina systems.\n\nHaving had a closer look at the memory utilization, I believe that it matches our expectations. I believe that the latest patch continues to be ready for a first review, with the exception of the final decision on the global limit of snapshots we want to keep. Safari seems to have a limit of roughly 20 snapshots and I'm inclined to change it to the same.\n\nPersonally, I don't think lower resolution images, grayscale or storing images on disk will solve a crucial problem at the moment. In fact, I'm afraid that the additional processing would slow down the browsing experience. I would prefer to set the global limit to something reasonable and that we drop older snapshots.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6954276, "time": "2012-12-31T23:11:09Z"}, {"text": "Created attachment 696830\nPatch\n\nChanged snapshot limit to 20 and made the list of snapshots a property of gHistorySwipeAnimation.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6954443, "time": "2013-01-01T00:38:05Z"}, {"text": "Created attachment 696831\nTests in progress\n\nUpdated tests for latest patch.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6954450, "time": "2013-01-01T00:42:59Z"}, {"text": "Try build for latest patch:\nhttp://ftp-scl3.mozilla.com/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-2e0f3cf3dd6a/try-macosx64/firefox-20.0a1.en-US.mac.dmg", "author": "spohl.mozilla.bugs@gmail.com", "id": 6954596, "time": "2013-01-01T03:48:03Z"}, {"text": "FWIW I'm happy with 20 screenshots at < 10mb.  We can add telemetry to try to determine whether we should bump this up or down, but I wouldn't be disappointed if we didn't do that.  (Experiments are hard and shouldn't be undertaken lightly.)\n\nThanks a lot for checking this out, Stephen.", "author": "justin.lebar+bug@gmail.com", "id": 6955076, "time": "2013-01-01T22:02:36Z"}, {"text": "Created attachment 697191\nPatch\n\nUpdated for current trunk.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6957582, "time": "2013-01-02T21:48:43Z"}, {"text": "Created attachment 697507\nTests\n\nSome more tests and verified that they pass on platforms that don't support swipe gestures. Steven, I'm wondering if you could give me feedback whether or not these tests cover what we want to test before I ask for a review. I'm not currently testing the actual events, since there are some tests for those in the actual patch (in browser_gestureSupport.js).\nThe latest try run showed some errors, but they seemed unrelated to my new tests:\nhttps://tbpl.mozilla.org/?tree=Try&rev=54a4c0f7ce47", "author": "spohl.mozilla.bugs@gmail.com", "id": 6960202, "time": "2013-01-03T17:36:44Z"}, {"text": "Created attachment 697633\nPatch\n\nFixed warnings in error console caused by GS_handleEvent in browser.js. No functional changes.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6961296, "time": "2013-01-03T21:33:43Z"}, {"text": "FYI, Availability check patch is broken since the latest merge. The main swipe patch is fine though.", "author": "jsbruner@umich.edu", "id": 6975582, "time": "2013-01-08T17:47:37Z"}, {"text": "(In reply to Josiah from comment #313)\n> FYI, Availability check patch is broken\n\nThe patch for bug 817700 was broken. I just updated the patch there.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6975694, "time": "2013-01-08T18:10:27Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #314)\n> (In reply to Josiah from comment #313)\n> > FYI, Availability check patch is broken\n> \n> The patch for bug 817700 was broken. I just updated the patch there.\n\nAnd is that related to the availability patch?", "author": "jsbruner@umich.edu", "id": 6975700, "time": "2013-01-08T18:12:07Z"}, {"text": "The patch for the availability check doesn't seem to be broken for me. You rolled three patches into one for bug 817074. One of them was the patch for bug 817700, which was indeed broken.\n\nAlso, make sure that you apply the general patch for bug 678392 before you apply the patch for the availability check.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6975739, "time": "2013-01-08T18:19:32Z"}, {"text": "That makes sense. I tried applying the availability check first.", "author": "jsbruner@umich.edu", "id": 6976318, "time": "2013-01-08T20:27:18Z"}, {"text": "There is one potential issue I want to mention. It probably won't matter, but I want to make sure. \n\nWe are taking snapshots of pages before the user leaves the page, and we keep it in memory. But could this cause a security vulnerability? It seems like if we take a snapshot of some confidential data, that any types of viruses could examine the memory and pull the snapshot. So, is this data being encrypted in any way? Does it even matter? \n\nI am not a security hacker, so I can not be sure of this. But we need to be sure that this is not an issue. Even if it is difficult, millions of people use Firefox. If hackers find a way to access this data, it could be pretty bad.", "author": "jsbruner@umich.edu", "id": 6985437, "time": "2013-01-10T16:04:02Z"}, {"text": "My understanding is that browser chrome privileges are necessary to access the snapshot arrays directly. With respect to malware, it is true that we keep the snapshots in memory and that malware may be able to access them. I'm hoping that we have general mitigations in place (like ASLR) that would automatically apply to the snapshots in memory as well. It would be great if someone could confirm.\n\nSince performance is so important here it would be great if we could do without encryption.", "author": "spohl.mozilla.bugs@gmail.com", "id": 6986078, "time": "2013-01-10T17:51:26Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #319)\n> My understanding is that browser chrome privileges are necessary to access\n> the snapshot arrays directly. With respect to malware, it is true that we\n> keep the snapshots in memory and that malware may be able to access them.\n> I'm hoping that we have general mitigations in place (like ASLR) that would\n> automatically apply to the snapshots in memory as well. It would be great if\n> someone could confirm.\n> \n> Since performance is so important here it would be great if we could do\n> without encryption.\n\nOf course. Most confidential information already has some security that is being displayed, like the ***** in passwords and such. But there are cases when raw information can be found. \n\nI'm bringing this up because of how hard Firefox pushes privacy. It would not go over well if something like this did happen. So, somebody should check this before it gets merged or at least before it merges to the normal channel.", "author": "jsbruner@umich.edu", "id": 6986154, "time": "2013-01-10T18:03:26Z"}, {"text": "Created attachment 702506\nPatch for availability check\n\nUpdated patch for current trunk. Carrying r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7004860, "time": "2013-01-15T21:51:47Z"}, {"text": "Here's another bug. If you are in a form page, and you swipe away, it will remove the page from view, but then pull down the sheet asking if you want to navigate away from the page (And lose data), or stay on it. If you choose to stay on it. Nothing happens. \n\nThe \"previous\" page is shown and you can not get back to the other. If you swipe back, it will poppup the message again, and again, you can choose to stay on the page. Now it appears we are on the \"right\" page. However, there is no user interaction enabled.\n\nKeep up the good work!", "author": "jsbruner@umich.edu", "id": 7010795, "time": "2013-01-17T02:56:12Z"}, {"text": "Comment on attachment 697633\nPatch\n\nThis looks fine to me.\n\nI looked at all of it, but (of course) I paid special attention to the Cocoa widgets parts.\n\nThere is one fairly major problem -- the mCancelSwipeAnimation block pointer might be used uninitialized.  To fix this you should add \"mCancelSwipeAnimation = nil;\" just after the following line:\n\nhttp://hg.mozilla.org/mozilla-central/annotate/b52c02f77cf5/widget/cocoa/nsChildView.mm#l2024\n\nAlso the #ifdef __LP64__ blocks around the swipe stuff can now be removed.  They were needed for as long as we still supported OS X 10.5, because 10.5 didn't have support for \"blocks\".  (We also didn't support 64-bit mode on 10.5, so we *could* support blocks in 64-bit mode, since we only compiled (and ran) 64-bit binaries on 10.6 and up.)  But now that we've stopped supporting 10.5, we can support swiping (and swipe animation) in both 64-bit mode and 32-bit mode.\n\nI did some testing, and found no major problems.  But I'm going to postpone any really serious testing until after this patch has landed.  Then any problems that are found can be reported in separate bugs, rather than risking getting lost among all the comments that have already been made on this bug.", "author": "smichaud@pobox.com", "id": 7018159, "time": "2013-01-18T22:18:53Z"}, {"text": "Created attachment 704990\nPatch\n\nAddressed Steven's feedback. Gavin, would you have time to review the front-end pieces of this patch?", "author": "spohl.mozilla.bugs@gmail.com", "id": 7026523, "time": "2013-01-22T18:55:21Z"}, {"text": "Created attachment 705002\nFix for animation getting stuck (intermittent)\n\nThis is a straightforward fix for the animation getting stuck in some scenarios.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7026569, "time": "2013-01-22T19:00:56Z"}, {"text": "Comment on attachment 705002\nFix for animation getting stuck (intermittent)\n\nOdd that this should make a difference.  But I don't think it can cause any harm.", "author": "smichaud@pobox.com", "id": 7026711, "time": "2013-01-22T19:25:57Z"}, {"text": "(In reply to Steven Michaud from comment #326)\n> Odd that this should make a difference.  But I don't think it can cause any\n> harm.\n\nApologies for not providing a better explanation: We have a series of checks that need to pass before we start a new swipe animation. Without this patch, we abort the currently running tracking of gesture events (if any) before performing the checks. This patch ensures that the checks all pass before we abort tracking.\n\nSpecifically, when a user swiped slightly sideways (or quickly switched from horizontal to vertical swiping), this if statement would be true and cause the method to return:\n  if ((deltaX == 0) || (fabs(deltaX) <= fabs(deltaY) * 8))\n    return;\n\nSince we had the tracking of gesture events aborted by the time we got here, the animation would be stuck. Note that just stopping the tracking does not mean that we necessarily tear down the animation overlay to avoid flickering, which is the case here.\n\nI hope this clarifies things.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7026746, "time": "2013-01-22T19:34:32Z"}, {"text": "> I hope this clarifies things.\n\nIt does.  Thanks!", "author": "smichaud@pobox.com", "id": 7026815, "time": "2013-01-22T19:43:37Z"}, {"text": "Created attachment 705497\nPatch for availability check\n\nUpdated for current trunk. Carrying r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7031401, "time": "2013-01-23T20:23:36Z"}, {"text": "Comment on attachment 704990\nPatch\n\nReview of attachment 704990:\n-----------------------------------------------------------------\n\n::: browser/base/content/browser.js\n@@ +881,5 @@\n> +  _swipeNavigatesHistory: function GS__swipeNavigatesHistory(aEvent) {\n> +    return this._getCommand(aEvent, [\"swipe\", \"left\"])\n> +              == \"Browser:BackOrBackDuplicate\" &&\n> +           this._getCommand(aEvent, [\"swipe\", \"right\"])\n> +              == \"Browser:ForwardOrForwardDuplicate\";\n\nHow will these handle users in RTL locales? If the app is in RTL mode, then swiping to the right should go back and swiping to the left should go forward.", "author": "jaws@mozilla.com", "id": 7031428, "time": "2013-01-23T20:30:58Z"}, {"text": "Comment on attachment 704990\nPatch\n\nHi Stephen,\n\nI'm sorry for the delay here, I was on vacation and I'm slowly catching up with the backlog.\n\nThank you very much for driving this patch into a landable form. The ideas behind the changes are good but I have some problems with some of the implementation details.\n\n>diff --git a/browser/base/content/browser.js b/browser/base/content/browser.js\n\n>+// History Swipe Animation Support (bug 678392)\n>+let gHistorySwipeAnimation = {\n>+\n>+  active: false,\n>+\n>+  /**\n>+   * Initializes the support for history swipe animations, if it is supported\n>+   * by the platform/configuration.\n>+   */\n>+  init: function HSA_init() {\n>+    if (!this._isSupported())\n>+      return;\n>+    \n>+    gBrowser.addEventListener(\"pagehide\", this, false);\n>+    gBrowser.addEventListener(\"pageshow\", this, false);\n>+    gBrowser.addEventListener(\"popstate\", this, false);\n>+\n>+    this.active = true;\n>+    this._snapshotList = this._createDoublyLinkedList();\n\nIt's very uncommon to implement your own list data structures in JavaScript. Usually everybody uses normal JS arrays, except in cases where it really does make a noticeable difference in execution speed. I don't think that applies here. So I think you should just make this\nthis._snapshotList = [];\nThat also means:\n - remove \"prev\" and \"next\" properties from the list nodes\n - list.head becomes list[0], list.tail becomes list[list.length - 1]\n - list.size becomes list.length\n - list.remove(elem) becomes list.splice(list.indexOf(elem), 1)\n - inserting an element to the beginning of the list becomes list.unshift(elem)\n\nAlso, I'm not sure if the name \"snapshotList\" reflects the fact that these are all the snapshots we know to be in memory. Maybe rename it to _availableSnapshots? _trackedSnapshots? _snapshotsCurrentlyKeptInMemory?\n\n>+  /**\n>+   * Moves a given box to a given X coordinate position.\n>+   *\n>+   * @param aBox\n>+   *        The box element to position.\n>+   * @param aPosition\n>+   *        The position (in X coordinates) to move the box element to.\n>+   */\n>+  _positionBox: function HSA__positionBox(aBox, aPosition) {\n>+    let width = this._curBox.getBoundingClientRect().width;\n>+    aBox.style.MozTransform = \"translateX(\" + width * aPosition + \"px)\";\n\nCSS transforms have been unprefixed, so this can become aBox.style.transform.\n\n>+  /**\n>+   * Adds a snapshot to the list and initiates the compression of said snapshot.\n>+   * Once the compression is completed, it will replace the uncompressed\n>+   * snapshot in the list.\n>+   *\n>+   * @param aCanvas\n>+   *        The snapshot to add to the list and compress.\n>+   */\n>+  _assignSnapshotToCurrentBrowser:\n>+  function HSA__assignSnapshotToCurrentBrowser(aCanvas) {\n>+    let browser = gBrowser.selectedBrowser;\n>+    let currIndex = browser.webNavigation.sessionHistory.index;\n>+\n>+    if (!(\"snapshots\" in browser))\n>+      browser.snapshots = {};\n>+    let snapshots = browser.snapshots;\n>+\n>+    if(snapshots[currIndex])\n>+      this._snapshotList.removeNode(snapshots[currIndex].nodeRef);\n\nI'd get rid of the nodeRef property. We can always find the right node in the list because we know that node.tab == browser and node.index = currIndex.\n\n>+\n>+    let newNode = this._addSnapshotNodeToList(currIndex, browser);\n>+    snapshots[currIndex] = this._createSnapshotElement(newNode);\n\nGetting rid of nodeRef would also allow you to remove this and just assign the canvas / blob directly to snapshots[currIndex].\n\n>+    // Temporarily store the canvas as the compressed snapshot.\n>+    // This avoids a blank page if the user swipes quickly\n>+    // between pages before the compression could complete.\n>+    snapshots[currIndex].snapshot = aCanvas;\n>+    \n>+    // Kick off snapshot compression.\n>+    aCanvas.toBlob(function(aBlob) {\n>+        if(snapshots[currIndex].snapshot)\n>+          delete snapshots[currIndex].snapshot;\n>+        snapshots[currIndex].snapshot = aBlob;\n>+      }, \"image/png\"\n>+    );\n\nOkay, so a snapshot can be both a canvas and a blob...\n\n>+  _installCurrentPageSnapshot:\n>+  function HSA__installCurrentPageSnapshot(aCanvas) {\n>+    let currSnapshot = aCanvas;\n>+    if (!currSnapshot) {\n>+      let snapshots = gBrowser.selectedBrowser.snapshots || {};\n>+      let currIndex = this._historyIndex;\n>+      if (currIndex in snapshots)\n>+        currSnapshot = this._convertBlobToImg(snapshots[currIndex].snapshot);\n\n... but here you only handle the case that snapshot is a blob. I know that it's unlikely that we'll arrive here before the canvas encoding has completed, but we should still handle that case. Maybe just rename _convertBlobToImg to _convertToImg and have it return directly if it notices that it has been passed a canvas instead of a blob. (snapshot instanceof HTMLCanvasElement)\n\n>+  _createSnapshotElement: function HSA__createSnapshotElement(aNode) {\n>+    let element = new function() {\n>+      this.snapshot = null;\n>+      this.nodeRef = aNode; // Reference to node in linked list.\n>+    };\n>+    return element;\n\nThe (almost) completely equivalent and preferable version of this would be:\nreturn {\n  snapshot: null,\n  nodeRef: aNode\n};\n\n>+        let snapshots = aNode.tab.snapshots;\n>+        if (snapshots[aNode.index]) {\n>+          if (snapshots[aNode.index].snapshot)\n>+            delete snapshots[aNode.index].snapshot;\n>+          delete snapshots[aNode.index].nodeRef;\n\nA quick note on delete: \"delete obj.prop;\" does NOT mean \"destroy the object that obj.prop references\". It means \"remove the property named 'prop' from the object 'obj'.\". JS doesn't have a way of saying \"destroy this object\"; the only thing that can destroy objects is the GC, when it notices that an object is not referenced anymore. Of course, when you want object D to be destroyed, and the last reference to D is in A.prop, then deleting prop from A will result in the destruction of D during the next GC.\n\nIn the code I quoted above, delete snapshots[aNode.index] would make sense. But you're not going to need it if you use array.splice to remove the element.\n\n>+        if(prev)\n\nHouse style is to have a space between \"if\" and the opening paren. This happens in several places.\n\n>+  /**\n>+   * Creates a node that can be used with the doubly linked list\n>+   * for snapshot tracking.\n>+   *\n>+   * @param aIndex\n>+   *        The index in history where a snapshot is stored.\n>+   * @param aTab\n>+   *        The tab in which the snapshot is stored in.\n>+   * @return the newly created node object.\n>+   */\n>+  _createListNode: function HSA__createListNode(aIndex, aTab) {\n>+    let node = new (function() {\n>+      this.index = aIndex;\n>+      this.tab = aTab;\n>+      this.next = null;\n>+      this.prev = null;\n>+    });\n>+    return node;\n>+  }\n\nThis should become\nreturn {\n  tab: aTab,\n  index: aIndex\n};\n... though you could probably pull that up into the calling function.\n\nOne problem that hasn't been addressed in this patch is to release snapshots when their tab is closed. At the moment, snapshots are only discarded when a new snapshot is added which would exceed the limit, or when the whole window is closed (which destroys gHistorySwipeAnimation and _snapshotList and so on). The snapshots of closed tabs are kept alive by the snapshot list, for example like this: gHistorySwipeAnimation._snapshotList.head.next.tab.snapshots[0].snapshot.\nThe more alarming implication is that the browser elements of closed tabs are kept alive, too, but thanks to the hueyfix the browsers' content documents are not.\nSo you'll need to listen for an event that fires when a tab closes, and remove the references to that tab from the list of open snapshots. Then, when the tab/browser isn't referenced any more, the snapshots it carries aren't, either, and are destroyed together with the tab.\n\n(Before the introduction of the snapshot list, we didn't have that problem, because nothing kept closed browsers alive, so their snapshots were destroyed automatically. That was the main factor that made me reluctant to add a per-window list of snapshots... but it has to be done.)\n\nFurther ideas (probably for a follow-up bug):\n - In the CSS rules that apply the snapshots to the XUL boxes, add background-size:contain so that the snapshots are scaled to fit. Might look bad if the window is resized between taking the snapshot and shouwing it.\n - In HiDPI mode (on retina screens), double the canvas size and push a scale transform on the canvas before drawing. Then the snapshots should be high-resolution, too, and are scaled to the right size by the background-size rule.", "author": "mstange@themasta.com", "id": 7033858, "time": "2013-01-24T11:29:49Z"}, {"text": "Comment on attachment 705497\nPatch for availability check\n\nSorry to come back to this after you've already got r+ and everything, but I really don't think the introduction of nsSwipeService will be of much use. I think using a system metric would be much simpler, so that you can do window.matchMedia(\"(-moz-swipe-animation-enabled)\").matches.\n\nYou can use this patch as a guide:\nhttp://hg.mozilla.org/integration/mozilla-inbound/rev/805cd41a9b9f", "author": "mstange@themasta.com", "id": 7033883, "time": "2013-01-24T11:46:07Z"}, {"text": "First of all, welcome back Markus! Hope you have a good trip.\n\nNow, unfortunately, I found a pretty significant bug that needs to be addressed. However, I am not exactly sure what triggered it, as I haven't noticed it before. I do know I recently started using tab groups, which may contribute to it, but it is unlikely.\n\nAnyway, at times, if you have two tabs open, and one was recently loaded and can go forward, then you move to the other tab that can't go forward, on that second tab you can still swipe forward, and the entire page moves over. I created a video demonstrating this. \n\nNote: I before also had this happen in the opposite direction, but could not reproduce it fast enough to keep this video short in time.\n\n\nhttps://www.dropbox.com/s/i72715cgj7m65gc/FirefoxSwipeError.mov", "author": "jsbruner@umich.edu", "id": 7034219, "time": "2013-01-24T14:29:38Z"}, {"text": "Comment on attachment 704990\nPatch\n\nRemoving r? for now.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7034814, "time": "2013-01-24T17:05:40Z"}, {"text": "Created attachment 705932\nWip for RTL support\n\nThis adds RTL support. Unless I'm told not to, I'll be folding a cleaned-up version of this patch into the general patch when addressing the feedback in comment 331 and 332.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7035137, "time": "2013-01-24T17:58:01Z"}, {"text": "Created attachment 706601\nPatch\n\n- Addressed all implementation feedback (top portion of comment 331).\n- Implemented the release of snapshots for tabs when they're closed by listening for \"TabClose\" events on gBrowser.tabContainer (bottom of comment 331).\n- Addressed bug identified in comment 333.\n- Cleaned up \"RTL support\" patch and folded into this patch.\n- Folded \"fix for animation getting stuck (intermittent)\" patch into this patch (smichaud:r+)\n\nCarrying over the r+ from smichaud for platform code, since no changes were made in platform code.\n\nAsking Felipe for a review of the front-end pieces.\n\nWill be updating the \"availability check\" patch (addressing comment 332) and tests next.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7040446, "time": "2013-01-25T22:31:24Z"}, {"text": "Created attachment 706652\nPatch for availability check\n\nAddressed feedback in comment 332.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7040869, "time": "2013-01-26T00:08:48Z"}, {"text": "Created attachment 706675\nTests\n\nUpdated tests for latest patch and sending for review.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7041000, "time": "2013-01-26T00:50:13Z"}, {"text": "Created attachment 706687\nPatch\n\nFixed oversight.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7041056, "time": "2013-01-26T01:12:54Z"}, {"text": "Created attachment 706721\nPatch\n\nRestoring use of #ifdef __LP64__. The OSX 10.6 SDK has trouble without it.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7041244, "time": "2013-01-26T04:00:45Z"}, {"text": "Try builds with all the latest patches available here:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-2952261d00f8/", "author": "spohl.mozilla.bugs@gmail.com", "id": 7041335, "time": "2013-01-26T05:34:10Z"}, {"text": "Created attachment 707178\nPatch for availability check\n\nUpdated for current trunk.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7045429, "time": "2013-01-28T18:30:34Z"}, {"text": "Created attachment 708191\nPatch\n\nUpdated for current trunk.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7054094, "time": "2013-01-30T17:47:22Z"}, {"text": "(In reply to Markus Stange from comment #331)\n> Further ideas (probably for a follow-up bug):\n>  - In the CSS rules that apply the snapshots to the XUL boxes, add\n> background-size:contain so that the snapshots are scaled to fit. Might look\n> bad if the window is resized between taking the snapshot and shouwing it.\n\nCould you explain what would be improved by doing this? We already maintain the browser zoom level for the snapshots. Personally, I think scaling would be undesirable.\n\n>  - In HiDPI mode (on retina screens), double the canvas size and push a\n> scale transform on the canvas before drawing. Then the snapshots should be\n> high-resolution, too, and are scaled to the right size by the\n> background-size rule.\n\nFiled bug 836430.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7054812, "time": "2013-01-30T20:13:42Z"}, {"text": "Comment on attachment 707178\nPatch for availability check\n\nLooks fine to me.", "author": "smichaud@pobox.com", "id": 7059115, "time": "2013-01-31T20:50:52Z"}, {"text": "Created attachment 709101\nPatch\n\nThe last patch incorrectly referenced the new linen-pattern.png from jar.mn in winstripe instead of pinstripe. Fixed this by moving it back to jar.mn under pinstripe.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7062137, "time": "2013-02-01T17:54:54Z"}, {"text": "Created attachment 709297\nPatch\n\nUpdated for current trunk.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7063792, "time": "2013-02-02T00:57:51Z"}, {"text": "Created attachment 709812\nPatch\n\nUpdated for current trunk.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7068111, "time": "2013-02-04T19:30:32Z"}, {"text": "*** Bug 698761 has been marked as a duplicate of this bug. ***", "author": "robert.strong.bugs@gmail.com", "id": 7068947, "time": "2013-02-04T22:47:01Z"}, {"text": "Created attachment 710422\nTests\n\nFixed test failures that went undetected before. Try run looks green with this updated patch now:\nhttps://tbpl.mozilla.org/?tree=Try&rev=6debdef2e066", "author": "spohl.mozilla.bugs@gmail.com", "id": 7073593, "time": "2013-02-05T23:54:03Z"}, {"text": "Comment on attachment 709812\nPatch\n\nReview of attachment 709812:\n-----------------------------------------------------------------\n\nThis looks very very good! Just a few things as usual with a patch of this size:\n\nYou're using the terms \"tab\" and \"browser\" interchangeably, but they actually have two different meanings in our front-end code, which made the code a bit confusing to understand. Tab is used for the <tab> element in the tabstrip (which is the target of some of your events, like TabClose), and browser is the <browser> element that holds the content of each page.\nAn example: you get the tab element in the TabClose event and get its browser through getBrowserForTab, and pass the browser as a parameter to _removeTrackedSnapshot, but that function parameter is named \"aTab\".\nAnother case is that the objects stored in your trackedSnapshots (\"{index, tab}\"), the field name is tab but you're holding a ref to a browser. So please make that naming consistent.\n\n\nAlso, we are trending towards splitting up these big modules out from browser.js and #include them (so technically there's no difference in code behavior, just that browser.js is kept smaller and easier to use).  See here: http://mxr.mozilla.org/mozilla-central/source/browser/base/content/browser.js#147\nIt'd be great if you could create a new file to host your gHistorySwipeAnimation object and include it. (the other pieces can still go in browser.js).  Bonus points if you also move gGestureSupport to this new file in a separate commit!  (the file could be called browser-gestureSupport.js perhaps).\n\nWith this we can also do some trickery to not ship this swipe animation code to Windows/Linux users that will not benefit from it. That can be left for a follow-up if you want.\n\n::: browser/base/content/browser.js\n@@ +1276,5 @@\n> +   */\n> +  startAnimation: function HSA_startAnimation() {\n> +    if (this.isAnimationRunning()) {\n> +      gBrowser.stop();\n> +      this._lastSwipeDir = \"RELOAD\";\n\nI don't see where RELOAD is used anywhere else.. or is it just to ensure != \"\" ?\n\n@@ +1287,5 @@\n> +      this._canGoBack = this.canGoBack();\n> +      this._canGoForward = this.canGoForward();\n> +      this._takeSnapshot();\n> +      this._installPrevAndNextSnapshots();\n> +      this._animatedBrowser = gBrowser.selectedBrowser;\n\n_animatedBrowser is unused\n\n@@ +1373,5 @@\n> +    }\n> +    else if (aEvent.type == \"pagehide\") {\n> +      // Take a snapshot of a page whenever it's about to be navigated away\n> +      // from.\n> +      this._takeSnapshot();\n\nyou may get a pagehide event for another tab which is not the current one being displayed. So you'll either need to filter this event out to not take a snapshot, or allow the _takeSnapshot (and subsequent functions) to take the tab to operate as a parameter.\n\nProbably the same consideration applies above to the pageshow and popstate case.\n\n@@ +1413,5 @@\n> +  canGoBack: function HSA_canGoBack() {\n> +    let index = gBrowser.webNavigation.sessionHistory.index;\n> +    if (this.isAnimationRunning())\n> +      index = this._historyIndex;\n> +    return this._doesIndexExistInHistory(index - 1);\n\nIIRC, getEntryAtIndex is considerably slower than sessionHistory.canGoBack().. So for the case where the animation is not running I suppose you can simply call canGoBack/canGoForward\n\n@@ +1475,5 @@\n> +   * return true if supported, false otherwise.\n> +   */\n> +  _isSupported: function HSA__isSupported() {\n> +    // Only activate on Lion.\n> +    // TODO: Only if [NSEvent isSwipeTrackingFromScrollEventsEnabled]\n\nplease have a bug on file to have its bug # on the comment\n\n@@ +1532,5 @@\n> +   * @return a new box element with a given identifier.\n> +   */\n> +  _createBox: function HSA__createBox(aID) {\n> +    return this._createElement(aID, \"box\");\n> +  },\n\nthis function is too specific, i'd prefer if you just called _createElement with box as a parameter.\n\n@@ +1559,5 @@\n> +   * @param aPosition\n> +   *        The position (in X coordinates) to move the box element to.\n> +   */\n> +  _positionBox: function HSA__positionBox(aBox, aPosition) {\n> +    let width = this._curBox.getBoundingClientRect().width;\n\nIt's safe to assume that during an animation the width of the browser window (and thus the window of the box) won't change. getBoundingClientRect() is quite expensive as it triggers a reflow. So it'd be good if you cached the width at the beginning of the animation and retrieve the cached version in subsequent calls to this function.. and then you can remove the cached val at the end of the animation (or actually you don't need to since you remove the boxes)\n\n@@ +1595,5 @@\n> +   * Retrieves the maximum number of snapshots that should be kept in memory.\n> +   * This limit is a global limit and is valid across all open tabs.\n> +   */\n> +  _maxSnapshots: function HSA__maxSnapshots() {\n> +    return gPrefService.getIntPref(\"browser.snapshots.limit\");\n\nyou should cache this value after first retrieval. I don't think it's important to live update it so there are is no need to listen for pref changes\n\n@@ +1753,5 @@\n> +\n> +  /**\n> +   * Removes the snapshots for the current, previous and next page.\n> +   */\n> +  _uninstallSnapshots: function HSA__uninstallSnapshots() {\n\nis this necessary, given that you remove the boxes when the animation finishes?", "author": "felipc@gmail.com", "id": 7078088, "time": "2013-02-06T22:42:54Z"}, {"text": "Created attachment 711456\nPatch\n\nAddressed feedback.\n\n(In reply to :Felipe Gomes from comment #351)\n> Review of attachment 709812:\n> -----------------------------------------------------------------\n> \n> ::: browser/base/content/browser.js\n> @@ +1276,5 @@\n> > +   */\n> > +  startAnimation: function HSA_startAnimation() {\n> > +    if (this.isAnimationRunning()) {\n> > +      gBrowser.stop();\n> > +      this._lastSwipeDir = \"RELOAD\";\n> \n> I don't see where RELOAD is used anywhere else.. or is it just to ensure !=\n> \"\" ?\n\nRight, it's just to ensure != \"\". Added a comment to clarify.\n\n@@ +1413,5 @@\n> > +  canGoBack: function HSA_canGoBack() {\n> > +    let index = gBrowser.webNavigation.sessionHistory.index;\n> > +    if (this.isAnimationRunning())\n> > +      index = this._historyIndex;\n> > +    return this._doesIndexExistInHistory(index - 1);\n> \n> IIRC, getEntryAtIndex is considerably slower than sessionHistory.canGoBack().. So for the \n> case where the animation is not running I suppose you can simply call\n> canGoBack/canGoForward\n\nI'm assuming you meant webNavigation.canGoBack/canGoForward. Fixed.\n \n> @@ +1475,5 @@\n> > +   * return true if supported, false otherwise.\n> > +   */\n> > +  _isSupported: function HSA__isSupported() {\n> > +    // Only activate on Lion.\n> > +    // TODO: Only if [NSEvent isSwipeTrackingFromScrollEventsEnabled]\n> \n> please have a bug on file to have its bug # on the comment\n\nThis is addressed by patch \"Patch for availability check\" in this bug and has been r+'d by smichaud.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7081963, "time": "2013-02-07T20:16:04Z"}, {"text": "Created attachment 711461\nPart 2: Patch for availability check\n\nUpdated to build with the latest patch. Carrying over r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7081999, "time": "2013-02-07T20:28:36Z"}, {"text": "Created attachment 711463\nMove gGestureSupport to browser-gestureSupport.js", "author": "spohl.mozilla.bugs@gmail.com", "id": 7082016, "time": "2013-02-07T20:34:58Z"}, {"text": "Comment on attachment 711456\nPatch\n\nReview of attachment 711456:\n-----------------------------------------------------------------\n\n::: browser/base/content/browser-gestureSupport.js\n@@ +140,5 @@\n> +    if (aEvent.type == \"TabClose\") {\n> +      let browser = gBrowser.getBrowserForTab(aEvent.target);\n> +      this._removeTrackedSnapshot(-1, browser);\n> +    }\n> +    else if (this.isAnimationRunning() &&\n\ndid you mean to use || here?", "author": "felipc@gmail.com", "id": 7082469, "time": "2013-02-07T22:20:16Z"}, {"text": "Created attachment 711566\nPatch\n\nReworked HSA_handleEvent based on discussion with felipe.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7082797, "time": "2013-02-07T23:34:36Z"}, {"text": "Created attachment 711567\nTests\n\nUpdated for latest patch.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7082821, "time": "2013-02-07T23:36:18Z"}, {"text": "Created attachment 711581\nPart 4: Tests\n\nJust added the html pages for the tests to the Makefile. Carrying over r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7082927, "time": "2013-02-07T23:57:37Z"}, {"text": "Comment on attachment 711566\nPatch\n\nUse a WeakMap instead of setting browser.snapshots.", "author": "dao+bmo@mozilla.com", "id": 7084298, "time": "2013-02-08T11:35:20Z"}, {"text": "What would be the advantage of that?", "author": "mstange@themasta.com", "id": 7084497, "time": "2013-02-08T13:21:33Z"}, {"text": "It keeps external data separate from data owned by the code backing browsers.", "author": "dao+bmo@mozilla.com", "id": 7084518, "time": "2013-02-08T13:30:39Z"}, {"text": "Created attachment 711877\nPart 1: Patch\n\nRemoved trailing white space. Carrying over r+ and f- flags.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7085404, "time": "2013-02-08T17:37:20Z"}, {"text": "Created attachment 711896\nPart 3: Move gGestureSupport to browser-gestureSupport.js\n\nUpdated for latest patch. Carrying over r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7085653, "time": "2013-02-08T18:23:57Z"}, {"text": "Pushed to Mozilla-Inbound:\n\n69c2332c6f77 Patch\nd16647e05acd Move gGestureSupport to browser-gestureSupport.js\n1f8810ef3a5a Patch for availability check\n9a7e608e63e7 Tests", "author": "spohl.mozilla.bugs@gmail.com", "id": 7086494, "time": "2013-02-08T22:07:50Z"}, {"text": "(In reply to D\u00e3o Gottwald [:dao] from comment #359)\n> Comment on attachment 711566\n> Patch\n> \n> Use a WeakMap instead of setting browser.snapshots.\n\nI will be replacing browser.snapshots by a WeakMap in bug 839549.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7086497, "time": "2013-02-08T22:09:10Z"}, {"text": "Pushed to mozilla-inbound with links :)\n\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/69c2332c6f77\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/d16647e05acd\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/1f8810ef3a5a\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/9a7e608e63e7", "author": "robert.strong.bugs@gmail.com", "id": 7086541, "time": "2013-02-08T22:20:08Z"}, {"text": "Backed out of mozilla-inbound due to test failures\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/02430bf44958\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/b4d767109f2e", "author": "robert.strong.bugs@gmail.com", "id": 7087133, "time": "2013-02-09T00:54:38Z"}, {"text": "Weird that tests pass on try and not on inbound\nhttps://tbpl.mozilla.org/?tree=Try&rev=0fc8b7799aff\nhttps://tbpl.mozilla.org/?tree=Mozilla-Inbound&rev=9a7e608e63e7", "author": "robert.strong.bugs@gmail.com", "id": 7087141, "time": "2013-02-09T00:59:42Z"}, {"text": "Weird, but sensible once you remember that dependencies in our build system are quite often best described as \"vague hopes\", that the tests continue to fail on just one build on your backout.\n\nAdd touching http://mxr.mozilla.org/mozilla-central/source/CLOBBER to the patch, set a clobber with https://secure.pub.build.mozilla.org/clobberer/?branch=mozilla-inbound before landing, and keep a close eye out for builds that manage to evade the clobberer anyway, and you can probably reland and make it stick.", "author": "philringnalda@gmail.com", "id": 7087326, "time": "2013-02-09T03:19:28Z"}, {"text": "Created attachment 713190\nPart 1: Patch\n\nUpdated for current trunk and added touching CLOBBER. Carrying over r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7097563, "time": "2013-02-13T00:54:47Z"}, {"text": "Created attachment 714004\nPart 5: Performance modifications\n\nThese are the performance modifications that we discussed:\n1. Lower the default number of snapshots from 20 to 5.\n2. Ensure that setting the number of snapshots to 0 turns the feature off.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7104846, "time": "2013-02-14T19:14:39Z"}, {"text": "Comment on attachment 714004\nPart 5: Performance modifications\n\nLooks good to me.", "author": "smichaud@pobox.com", "id": 7105406, "time": "2013-02-14T21:06:56Z"}, {"text": "Part 1 is broken on the current trunk.", "author": "jsbruner@umich.edu", "id": 7108274, "time": "2013-02-15T16:29:15Z"}, {"text": "Created attachment 714442\nPart 1: Patch\n\nUpdated for current trunk. Carrying over r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7108530, "time": "2013-02-15T17:25:34Z"}, {"text": "Created attachment 714445\nPart 3: Move gGestureSupport to browser-gestureSupport.js\n\nUpdated for current trunk. Carrying over r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7108538, "time": "2013-02-15T17:26:38Z"}, {"text": "Created attachment 714447\nPart 5: Performance modifications\n\nUpdated for current trunk. Carrying over r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7108541, "time": "2013-02-15T17:27:44Z"}, {"text": "Created attachment 718185\nPart 1: Patch\n\nJust a quick update for the current trunk. Carrying the review+ flag.", "author": "jsbruner@umich.edu", "id": 7141672, "time": "2013-02-26T01:24:43Z"}, {"text": "Created attachment 718187\nPart 1: Patch\n\nQuick update for the current trunk. Carrying review+ flag.", "author": "jsbruner@umich.edu", "id": 7141679, "time": "2013-02-26T01:26:25Z"}, {"text": "Whoops. Sorry, Bugzilla went a little crazy on me. :)", "author": "jsbruner@umich.edu", "id": 7141686, "time": "2013-02-26T01:27:16Z"}, {"text": "Comment on attachment 718187\nPart 1: Patch\n\nPlease be careful when updating patches (or ask for help when in doubt), especially when carrying over an r+ flag. The updates to CLOBBER were incorrect in this patch.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7144710, "time": "2013-02-26T17:49:17Z"}, {"text": "Created attachment 718538\nPart 1: Patch\n\nUpdated for current trunk. Carrying over r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7145193, "time": "2013-02-26T19:09:16Z"}, {"text": "Created attachment 720958\nPart 6: Fix assert failure\n\nDuring cancelled swipes, i.e. the user swiped in one direction, then swiped back to stay on the original page, we used to fail the assertion in beginGestureWithEvent because the gesture state hadn't been cleared from the previous swipe. This patch clears the gesture state for this scenario.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7167313, "time": "2013-03-05T00:08:21Z"}, {"text": "Comment on attachment 720958\nPart 6: Fix assert failure\n\nLooks fine to me.", "author": "smichaud@pobox.com", "id": 7170094, "time": "2013-03-05T16:24:17Z"}, {"text": "Created attachment 721784\nPart 1: Patch\n\nUpdated for current trunk. Carrying over r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7174513, "time": "2013-03-06T18:15:05Z"}, {"text": "Created attachment 721785\nPart 7: Clobber\n\nThis was included in the patch 'part 1' before. I've split this out to reduce the number of times we have to update part 1 for the current trunk. Carrying over r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7174523, "time": "2013-03-06T18:17:23Z"}, {"text": "This will need a ui review - I'm happy to do it", "author": "jboriss@mozilla.com", "id": 7176171, "time": "2013-03-07T02:18:16Z"}, {"text": "(In reply to Jennifer Morrow [:Boriss] (Firefox UX) from comment #386)\n> This will need a ui review - I'm happy to do it\nThanks and yes please (I believe UX has looked at this previously... it was at least requested a couple of times verbally in the past). Would you like a try build?\n\nspohl, if Boriss would like a try build can you provide one?", "author": "robert.strong.bugs@gmail.com", "id": 7176177, "time": "2013-03-07T02:21:12Z"}, {"text": "(In reply to Robert Strong [:rstrong] (do not email) from comment #387) \n> spohl, if Boriss would like a try build can you provide one?\n\nSure:\nhttp://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-0d386039a3e2/try-macosx64/firefox-22.0a1.en-US.mac.dmg", "author": "spohl.mozilla.bugs@gmail.com", "id": 7179726, "time": "2013-03-07T20:05:00Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #388)\n> http://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-\n> 0d386039a3e2/try-macosx64/firefox-22.0a1.en-US.mac.dmg\n\nThank you for the test build!\n\nI tried the test build. On my MacBook Air (Mid2012), the swipe animation was very jumpy...  Will we enable this feature by default when we land this patch? I feel it is early in the day from using the test build.\n\nBTW, I think this feature is very good for UX. However, I seem it's better than the swipe animation that the hovering arrow indication like Chromium, because it will not overmuch for rendering processing.)", "author": "saneyuki.s.snyk@gmail.com", "id": 7181177, "time": "2013-03-08T01:28:45Z"}, {"text": "just downloaded the test build and i'm not seeing any animations on my rMBP. Is there something I need to do to enable them?", "author": "swrobel@gmail.com", "id": 7185114, "time": "2013-03-09T02:24:26Z"}, {"text": "(In reply to swrobel from comment #390)\n> just downloaded the test build and i'm not seeing any animations on my rMBP.\n> Is there something I need to do to enable them?\n\nComment 130 may help you.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7185144, "time": "2013-03-09T02:52:00Z"}, {"text": "Created attachment 729665\nMockup: Forward button not appearing correctly in Comment 388 try build\n\n(In reply to Stephen Pohl [:spohl] from comment #388)\n> (In reply to Robert Strong [:rstrong] (do not email) from comment #387) \n> > spohl, if Boriss would like a try build can you provide one?\n> \n> Sure:\n> http://ftp.mozilla.org/pub/mozilla.org/firefox/try-builds/spohl@mozilla.com-\n> 0d386039a3e2/try-macosx64/firefox-22.0a1.en-US.mac.dmg\n\nI've been running this build, and I gotta say I'm seeing a lot of performance issues, particularly while using lots of memory.  Rather than being smooth, I'm getting jerky animations and delays.  If it's not possible to be smooth when a machine's running hot, could we detect when performance will be bad and disable the animation in those cases?\n\nI'm also seeing artifact problems on the back button (see attachment).  Is that being addressed in another bug?", "author": "jboriss@mozilla.com", "id": 7245880, "time": "2013-03-26T18:26:14Z"}, {"text": "Created attachment 729667\nMockup: Forward button not appearing correctly in Comment 388 try build", "author": "jboriss@mozilla.com", "id": 7245909, "time": "2013-03-26T18:29:59Z"}, {"text": "(In reply to Jennifer Morrow [:Boriss] (Firefox UX) from comment #392)\n> I'm also seeing artifact problems on the back button (see attachment).  Is\n> that being addressed in another bug?\n\nI believe that is bug 800443.", "author": "jsbruner@umich.edu", "id": 7245932, "time": "2013-03-26T18:34:44Z"}, {"text": "Created attachment 731981\nPart 1: Patch\n\nUpdated for current trunk.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7263756, "time": "2013-04-01T19:18:56Z"}, {"text": "(In reply to Jennifer Morrow [:Boriss] (Firefox UX) from comment #392)\n> I've been running this build, and I gotta say I'm seeing a lot of\n> performance issues, particularly while using lots of memory.  Rather than\n> being smooth, I'm getting jerky animations and delays.  If it's not possible\n> to be smooth when a machine's running hot, could we detect when performance\n> will be bad and disable the animation in those cases?\n\nPerformance relies heavily on bug 817700, which is still in progress. Maybe the questions to ask here are:\n1. Is the overall experience worse with this change than before?\n2. Is it acceptable to work on performance issues in follow-up bugs?", "author": "spohl.mozilla.bugs@gmail.com", "id": 7263777, "time": "2013-04-01T19:23:50Z"}, {"text": "Created attachment 731988\nPart 3: Move gGestureSupport to browser-gestureSupport.js\n\nUpdated for current trunk.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7263802, "time": "2013-04-01T19:27:41Z"}, {"text": "It was suggested that I land these patches in disabled state, i.e. by setting the pref for the number of snapshots to 0 to avoid constant bitrotting of the patches.\n\nUnless there are objections I will get the patches ready tomorrow. I would also modify the tests to turn on the feature on the platforms that support it.\n\nWe could then turn on the feature as soon as bug 817700 is fixed.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7274677, "time": "2013-04-03T23:50:10Z"}, {"text": "Created attachment 733379\nPart 1: Patch\n\nUpdated for current trunk. Carrying over flags.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7277350, "time": "2013-04-04T16:06:53Z"}, {"text": "Created attachment 733383\nPart 3: Move gGestureSupport to browser-gestureSupport.js\n\nUpdated for current trunk. Carrying over r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7277376, "time": "2013-04-04T16:12:28Z"}, {"text": "Created attachment 733398\nPart 5: Performance modifications\n\nRemoved some trailing white space. Carrying over r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7277516, "time": "2013-04-04T16:34:54Z"}, {"text": "Created attachment 733547\nPart 1: Patch\n\nUpdated for current trunk and rev'd uuid for nsIDOMSimpleGestureEvent. Carrying over r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7278988, "time": "2013-04-04T21:09:34Z"}, {"text": "Created attachment 733552\nPart 8: Disable feature\n\nTemporarily disables the feature (until bug 817700 is fixed and landed).", "author": "spohl.mozilla.bugs@gmail.com", "id": 7279038, "time": "2013-04-04T21:18:39Z"}, {"text": "Created attachment 733554\nPart 8: Disable feature\n\nRemoved unnecessary else clause.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7279061, "time": "2013-04-04T21:24:14Z"}, {"text": "Created attachment 733558\nPart 8: Disable feature\n\nGosh... now removed trailing white space. Sorry about the spam.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7279076, "time": "2013-04-04T21:26:35Z"}, {"text": "Created attachment 733574\nPart 8: Disable feature\n\nAdded missing semicolon. Carrying over r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7279260, "time": "2013-04-04T22:13:50Z"}, {"text": "7d6cde6ea21d added test code for gesture image rotation, which is failing when the patches here are applied:\nhttps://tbpl.mozilla.org/?tree=Try&rev=f4fcd13ea8fa\n\nWorking on resolving the failures now.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7283463, "time": "2013-04-05T20:36:46Z"}, {"text": "Created attachment 734172\nPart 9: Fix rotation gestures\n\nWhile updating the patch for the current trunk in comment 348 I missed the fact that the last argument to initCommandEvent in GS__doCommand had changed from null to aEvent on trunk. This caused rotation gestures to break, since aEvent becomes the sourceEvent of the new event, which is passed to gGestureSupport.rotate (see browser-sets.inc). This wasn't caught earlier since the tests for rotate gestures were only added recently. The tests would try to get the delta property on a null event, which stops execution.\n\nTry run (with all patches applied) is in progress:\nhttps://tbpl.mozilla.org/?tree=Try&rev=323578bb25ab", "author": "spohl.mozilla.bugs@gmail.com", "id": 7284542, "time": "2013-04-06T01:03:09Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #408)\n> Try run (with all patches applied) is in progress:\n> https://tbpl.mozilla.org/?tree=Try&rev=323578bb25ab\n\nAll green.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7284871, "time": "2013-04-06T04:50:42Z"}, {"text": "Created attachment 734196\nPart 8: Disable feature\n\nAdded commit message. Carrying over r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7284874, "time": "2013-04-06T04:54:33Z"}, {"text": "One thing we need to fix either in this bug or in a followup is the occasional brief flash of page A before beginning to draw page B when a swipe from page A to page B completes. This happens, especially on slower connections, probably due to us not clearing the content area until the network connection to page B is completed, committing the navigation to page B.\n\nSafari does not have this problem with its swipe animations.\n\nIdeally, we would start loading page B into the content area immediately when the swipe is committed, but this would require quite an invasive reworking of docshell code I imagine.", "author": "fryn@frankyan.com", "id": 7288494, "time": "2013-04-08T13:01:15Z"}, {"text": "(In reply to Frank Yan (:fryn) from comment #411)\n> One thing we need to fix either in this bug or in a followup is the\n> occasional brief flash of page A before beginning to draw page B when a\n> swipe from page A to page B completes. This happens, especially on slower\n> connections, probably due to us not clearing the content area until the\n> network connection to page B is completed, committing the navigation to page\n> B.\n> \n> Safari does not have this problem with its swipe animations.\n> \n> Ideally, we would start loading page B into the content area immediately\n> when the swipe is committed, but this would require quite an invasive\n> reworking of docshell code I imagine.\n\nIf not, one thing Safari does that we are not doing is an animated flash if sites are taking a while to load. When swiping back, sometimes Safari can tell a site needs to be reloaded longer and will animate the entire view white for some time, until the site is somewhat responsive. This could be an alternative approach that doesn't look so ugly, but does tell the user that a page needs to be reloaded.", "author": "jsbruner@umich.edu", "id": 7288561, "time": "2013-04-08T13:18:32Z"}, {"text": "I really really hope that these patches can finally land. I don't understand where the harm should be if it stays disabled at first. It is so tedious seeing how these patches get updated over and over again and then ... nothing. It would really be nice to have that stuff (together with the new scrollbars and other stuff) in firefox before the 3rd iteration of OS X, where these styles are the \"new\" default look, comes out. I could go on how Mac support seems to have much too low priority but that wouldn't lead anywhere anyway. Sorry for abusing this place with my rant.", "author": "beingalink@googlemail.com", "id": 7288697, "time": "2013-04-08T13:55:17Z"}, {"text": "Created attachment 734660\nPart 7: Clobber\n\nUpdated for current trunk and added commit message. Carrying over r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7289231, "time": "2013-04-08T15:48:54Z"}, {"text": "Created attachment 734662\nPart 8: Disable feature\n\nUpdated commit message. Carrying over r+.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7289235, "time": "2013-04-08T15:49:53Z"}, {"text": "Created attachment 735264\nAll parts (save clobber)\n\nStephen, here are all your patches but one combined into one large patch.  Please check that it doesn't contain any surprises.\n\nIf you have any corrections I'll make them to the combined patch.  Then I'll land it on mozilla-inbound.\n\nI didn't include part 7 (clobber).  That part bitrots every few hours (every time someone updates the CLOBBER file).  So I'll need to update it by hand when I land the rest on mozilla-inbound.\n\nThat part's very simple, so it shouldn't be a problem.", "author": "smichaud@pobox.com", "id": 7295243, "time": "2013-04-09T17:24:18Z"}, {"text": "Comment on attachment 735264\nAll parts (save clobber)\n\nReview of attachment 735264:\n-----------------------------------------------------------------\n\nI folded all the patches on my side and diff'd it with your combined patch. No differences were found. We are good to go.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7295304, "time": "2013-04-09T17:38:44Z"}, {"text": "Mozilla-inbound is currently closed (busted).  I'll wait until it reopens to land.", "author": "smichaud@pobox.com", "id": 7295424, "time": "2013-04-09T18:01:29Z"}, {"text": "Landed on mozilla-inbound:\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/5e4ccad71f40\n\nHurray!\n\nSwipe animation is turned off by default.  To turn it on set browser.snapshots.limit to '5' (or another non-zero value).\n\nSince animation is still off by default, this bug still isn't fixed, exactly.  But let's allow this bug to be marked FIXED when this patch lands on mozilla-central.\n\nFor further discussion of issues with this patch, please open new bugs.  Please also open new bugs for such discussion as has already happened here.", "author": "smichaud@pobox.com", "id": 7295959, "time": "2013-04-09T19:49:56Z"}, {"text": "Please note that by enabling this feature (by setting the snapshot limit to something > 0) bug 770626 will partially regress until the patch for bug 673875 has landed. Although there will not be an infinite loop of onbeforeunload events as in bug 770626, pressing the \"stay on page\" button will fail to tear down the animation overlay.", "author": "spohl.mozilla.bugs@gmail.com", "id": 7296648, "time": "2013-04-09T22:19:09Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/5e4ccad71f40", "author": "emorley@mozilla.com", "id": 7298725, "time": "2013-04-10T12:23:28Z"}, {"text": "Is this already in today's nightly? Setting browser.snapshots.limit to 5 doesn't seem to do anything.", "author": "beingalink@googlemail.com", "id": 7299285, "time": "2013-04-10T14:52:25Z"}, {"text": "(In reply to beingalink from comment #422)\n> Is this already in today's nightly?\nNo. You need to wait tomorrow.", "author": "scoobidiver@netcourrier.com", "id": 7299392, "time": "2013-04-10T15:17:02Z"}, {"text": "(In reply to Scoobidiver from comment #423)\n> (In reply to beingalink from comment #422)\n> > Is this already in today's nightly?\n> No. You need to wait tomorrow.\nThere's a second today's build, 23.0a1/20130410065939, where it's included.", "author": "scoobidiver@netcourrier.com", "id": 7299777, "time": "2013-04-10T16:34:39Z"}, {"text": "PRUint32, eh.", "author": "Ms2ger@gmail.com", "id": 7307879, "time": "2013-04-12T11:30:49Z"}, {"text": "This has been noted in the Aurora 23 release notes:\n\nhttp://www.mozilla.org/en-US/firefox/23.0a2/auroranotes/\n\nIf you would like to make any changes or have questions/concerns please contact me directly.", "author": "lukasblakk+bugs@gmail.com", "id": 7446722, "time": "2013-05-21T18:18:21Z"}, {"text": "Adding this to the sign-off criteria for Firefox 23.0b1.", "author": "anthony.s.hughes@gmail.com", "id": 7544565, "time": "2013-06-17T22:40:37Z"}, {"text": "(In reply to Anthony Hughes, Mozilla QA (:ashughes) from comment #427)\n> Adding this to the sign-off criteria for Firefox 23.0b1.\n\nPlease note that this is currently disabled by default (see bug 860493).", "author": "spohl.mozilla.bugs@gmail.com", "id": 7544909, "time": "2013-06-17T23:49:21Z"}, {"text": "(In reply to Stephen Pohl [:spohl] from comment #428)\n> (In reply to Anthony Hughes, Mozilla QA (:ashughes) from comment #427)\n> > Adding this to the sign-off criteria for Firefox 23.0b1.\n> \n> Please note that this is currently disabled by default (see bug 860493).\n\nLukas, can we update the status/tracking/relnote flags to reflect this? I'm dropping this from my radar for Firefox 23. Please add qawanted if the situation changes and this needs testing.", "author": "anthony.s.hughes@gmail.com", "id": 7545045, "time": "2013-06-18T00:28:45Z"}, {"text": "*** Bug 677714 has been marked as a duplicate of this bug. ***", "author": "mstange@themasta.com", "id": 7572511, "time": "2013-06-25T17:38:14Z"}], "id": 678392, "priority": "--", "cc": ["alex@pointless.one", "andrew@andrewmin.com", "anthony.s.hughes@gmail.com", "anthony@ricaud.me", "asa@mozilla.org", "astravian@gmail.com", "astrolox+bugzilla@gmail.com", "avihpit@yahoo.com", "b56girard@gmail.com", "bugs@junglecode.net", "bugzilla@spray.se", "bugzillawatcher@gmail.com", "bzbarsky@mit.edu", "camaran@gmail.com", "chris.blore@gmail.com", "clee@mozilla.com", "dao+bmo@mozilla.com", "deprecationmail@gmail.com", "djspiewak@gmail.com", "e1857104@rtrtr.com", "ehsan@mozilla.com", "emanuele.alimonda@gmail.com", "felipc@gmail.com", "gandalf@aviary.pl", "gavin.sharp@gmail.com", "ge3k0s@gmail.com", "hawkrives@gmail.com", "hubert+bmo@hubertgajewski.com", "iAbdulElah@gmail.com", "jaws@mozilla.com", "jboriss@mozilla.com", "joe@drew.ca", "johan@johanl.se", "josh@joshmatthews.net", "jsbruner@umich.edu", "justin.lebar+bug@gmail.com", "jypenator@gmail.com", "limi@mozilla.com", "lmedinas@gmail.com", "loganrosen@gmail.com", "ludalex@gmail.com", "lukasblakk+bugs@gmail.com", "madhava@mozilla.com", "marckjackubosky@gmail.com", "masayuki@d-toybox.com", "mbrubeck@mozilla.com", "mcastelluccio@mozilla.com", "mdeboer@mozilla.com", "me@chrisb.xyz", "mehmet.sahin@gmx.net", "mozcbarrett@gmail.com", "mozilla@metasieben.org", "Ms2ger@gmail.com", "mstange@themasta.com", "Nomis101@web.de", "notforyourmail@gmail.com", "pali@pali.sk", "paul@mozilla.com", "philringnalda@gmail.com", "reuben.bmo@gmail.com", "robert.strong.bugs@gmail.com", "roc@ocallahan.org", "saneyuki.s.snyk@gmail.com", "sarentz@mozilla.com", "scoobidiver@netcourrier.com", "sergeyreym@gmail.com", "simo@kivimaki.fi", "smichaud@pobox.com", "spohl.mozilla.bugs@gmail.com", "starfx6464@gmail.com", "swrobel@gmail.com", "thomas@thomasy.tw", "timbugzilla@gmail.com", "tnikkel@gmail.com", "tommybxp@gmail.com", "valentin@tutu.ro", "Virtual@teknik.io", "vulcain@gmx.com", "xan1790@yahoo.com", "zpletan@aol.com"], "cf_crash_signature": "", "version": "Trunk", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_thunderbird_esr60": "---", "cf_platform_rel": "---", "product": "Core", "cf_fx_iteration": "---", "blocks": [511236, 636455, 885978, 668953, 673875, 803022, 817074, 836430, 839549, 860489, 860493, 867629, 917761], "qa_contact": "", "creation_time": "2011-08-11T23:23:49Z", "cf_status_firefox_esr52": "---", "component": "Widget: Cocoa", "assigned_to_detail": {"email": "spohl.mozilla.bugs@gmail.com", "id": 456485, "name": "spohl.mozilla.bugs@gmail.com", "real_name": "Stephen A Pohl [:spohl]"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "---", "cf_status_firefox60": "---", "target_milestone": "mozilla23", "cf_rank": null, "cf_qa_whiteboard": "", "severity": "normal", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "beingalink@googlemail.com", "id": 379864, "name": "beingalink@googlemail.com", "real_name": ""}, "whiteboard": "", "mentors": [], "summary": "[10.7] Add support for swipe animation as in Safari", "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [{"status": "+", "name": "in-testsuite", "modification_date": "2013-02-08T22:07:50Z", "type_id": 37, "creation_date": "2013-02-08T22:07:50Z", "id": 604151, "setter": "spohl.mozilla.bugs@gmail.com"}], "last_change_time": "2018-05-01T17:04:20Z", "assigned_to": "spohl.mozilla.bugs@gmail.com", "is_open": false, "history": [{"changes": [{"removed": "", "field_name": "blocks", "added": "636455"}], "who": "beingalink@googlemail.com", "when": "2011-08-11T23:24:46Z"}, {"changes": [{"removed": "", "field_name": "cf_last_resolved", "added": "2011-08-11 16:25:49"}, {"removed": "UNCONFIRMED", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "cc", "added": "gavin.sharp@gmail.com"}, {"removed": "", "field_name": "resolution", "added": "DUPLICATE"}], "who": "gavin.sharp@gmail.com", "when": "2011-08-11T23:25:49Z"}, {"changes": [{"removed": "RESOLVED", "field_name": "status", "added": "REOPENED"}, {"removed": "DUPLICATE", "field_name": "resolution", "added": ""}, {"removed": "0", "field_name": "is_confirmed", "added": "1"}], "who": "gavin.sharp@gmail.com", "when": "2011-08-11T23:34:38Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "smichaud@pobox.com"}, {"removed": "General", "field_name": "component", "added": "Widget: Cocoa"}, {"removed": "unspecified", "field_name": "version", "added": "Trunk"}, {"removed": "Firefox", "field_name": "product", "added": "Core"}, {"removed": "general@firefox.bugs", "field_name": "qa_contact", "added": "cocoa@widget.bugs"}], "who": "smichaud@pobox.com", "when": "2011-08-11T23:43:59Z"}, {"changes": [{"removed": "[10.7] Support for swipe animation as in Safari", "field_name": "summary", "added": "[10.7] Add support for swipe animation as in Safari"}], "who": "smichaud@pobox.com", "when": "2011-08-11T23:44:51Z"}, {"changes": [{"removed": "REOPENED", "field_name": "status", "added": "NEW"}, {"removed": "", "field_name": "cc", "added": "asa@mozilla.org"}], "who": "asa@mozilla.org", "when": "2011-08-12T00:34:31Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "gandalf@aviary.pl"}], "who": "gandalf@aviary.pl", "when": "2011-08-12T00:42:13Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mstange@themasta.com"}], "who": "mstange@themasta.com", "when": "2011-08-12T08:18:15Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bugzilla@zirro.se"}], "who": "deprecationmail@gmail.com", "when": "2011-08-12T14:56:59Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "simo@kivimaki.fi"}], "who": "simo@kivimaki.fi", "when": "2011-08-12T17:39:28Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mozcbarrett@gmail.com"}], "who": "mozcbarrett@gmail.com", "when": "2011-08-13T23:59:24Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "andrew@andrewmin.com"}], "who": "andrew@andrewmin.com", "when": "2011-08-15T00:25:28Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "hubert@hubertgajewski.com"}], "who": "hubert+bmo@hubertgajewski.com", "when": "2011-08-15T10:12:25Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "uiwanted"}, {"removed": "", "field_name": "cc", "added": "bzbarsky@mit.edu, limi@mozilla.com"}], "who": "mstange@themasta.com", "when": "2011-08-15T10:28:43Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "emanuele.alimonda@gmail.com"}], "who": "emanuele.alimonda@gmail.com", "when": "2011-08-15T13:13:00Z"}, {"changes": [{"removed": "uiwanted", "field_name": "keywords", "added": ""}], "who": "mstange@themasta.com", "when": "2011-08-16T09:07:32Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "668953"}], "who": "mstange@themasta.com", "when": "2011-08-16T09:22:23Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 553283, "added": "1"}], "who": "mstange@themasta.com", "when": "2011-08-16T15:13:31Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bgirard@mozilla.com"}], "who": "b56girard@gmail.com", "when": "2011-08-16T19:05:15Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "anthony@ricaud.me"}], "who": "anthony@ricaud.me", "when": "2011-08-29T17:58:57Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "pali@pali.sk"}], "who": "pali@pali.sk", "when": "2011-09-04T06:06:53Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "astrolox+bugzilla@gmail.com"}], "who": "astrolox+bugzilla@gmail.com", "when": "2011-09-05T21:01:13Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "Nomis101@web.de"}], "who": "Nomis101@web.de", "when": "2011-09-09T10:07:31Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 553482, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 571313, "added": "review?"}, {"removed": "NEW", "field_name": "status", "added": "ASSIGNED"}, {"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "mstange@themasta.com"}], "who": "mstange@themasta.com", "when": "2011-11-02T12:55:30Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?", "attachment_id": 571313, "added": "review?(bugs@pettay.fi)"}], "who": "mstange@themasta.com", "when": "2011-11-02T12:56:19Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 553484, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 571315, "added": "review?(smichaud@pobox.com)"}], "who": "mstange@themasta.com", "when": "2011-11-02T12:59:07Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 553486, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 571317, "added": "review?(gavin.sharp@gmail.com), feedback?(bzbarsky@mit.edu)"}], "who": "mstange@themasta.com", "when": "2011-11-02T13:15:14Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 553487, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 571319, "added": "review?(gavin.sharp@gmail.com)"}], "who": "mstange@themasta.com", "when": "2011-11-02T13:22:16Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "dao@mozilla.com"}], "who": "gavin.sharp@gmail.com", "when": "2011-11-02T16:40:09Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(bugs@pettay.fi)", "attachment_id": 571313, "added": "review+"}], "who": "bugs@pettay.fi", "when": "2011-11-02T18:37:19Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 571313, "added": "1"}], "who": "mstange@themasta.com", "when": "2011-11-02T20:01:20Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "xan1790@yahoo.com"}], "who": "xan1790@yahoo.com", "when": "2011-11-03T04:27:35Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "justin.lebar+bug@gmail.com, roc@ocallahan.org, tnikkel@gmail.com"}], "who": "bzbarsky@mit.edu", "when": "2011-11-03T19:03:44Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(smichaud@pobox.com)", "attachment_id": 571315, "added": "review+"}], "who": "smichaud@pobox.com", "when": "2011-11-07T22:36:30Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jwein@mozilla.com"}], "who": "jaws@mozilla.com", "when": "2011-11-10T19:36:59Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "clee@mozilla.com"}], "who": "clee@mozilla.com", "when": "2011-11-22T18:52:50Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "djspiewak@gmail.com"}], "who": "djspiewak@gmail.com", "when": "2012-01-05T20:32:18Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "vulcain@gmx.com"}], "who": "vulcain@gmx.com", "when": "2012-02-29T08:01:32Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "lexi@lexi.org.uk"}], "who": "lexi@lexi.org.uk", "when": "2012-03-21T00:49:54Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 580525, "added": "1"}], "who": "smichaud@pobox.com", "when": "2012-03-21T22:42:48Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "valentin@tutu.ro"}], "who": "valentin@tutu.ro", "when": "2012-03-23T16:09:49Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(gavin.sharp@gmail.com)", "attachment_id": 571317, "added": ""}], "who": "gavin.sharp@gmail.com", "when": "2012-03-27T01:26:45Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(gavin.sharp@gmail.com)", "attachment_id": 571319, "added": ""}], "who": "gavin.sharp@gmail.com", "when": "2012-03-27T01:26:49Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 608120, "added": "feedback?(fryn@frankyan.com)"}, {"removed": "", "field_name": "cc", "added": "fryn@frankyan.com"}], "who": "gavin.sharp@gmail.com", "when": "2012-03-27T01:26:59Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 608120, "added": "1"}, {"field_name": "flagtypes.name", "removed": "feedback?(fryn@frankyan.com)", "attachment_id": 608120, "added": ""}], "who": "smichaud@pobox.com", "when": "2012-04-24T19:01:18Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 617980, "added": "feedback?(fryn@frankyan.com)"}], "who": "smichaud@pobox.com", "when": "2012-04-24T19:18:25Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mozilla@metasieben.org"}], "who": "mozilla@metasieben.org", "when": "2012-04-25T16:26:35Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "johan@johanl.se"}], "who": "johan@johanl.se", "when": "2012-05-03T15:26:16Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "chris.blore@gmail.com"}], "who": "chris.blore@gmail.com", "when": "2012-05-07T20:54:03Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "feedback?(fryn@frankyan.com)", "attachment_id": 617980, "added": "feedback-"}], "who": "fryn@frankyan.com", "when": "2012-05-10T02:06:40Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bugzillawatcher@gmail.com"}], "who": "bugzillawatcher@gmail.com", "when": "2012-05-17T08:28:55Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mieszkoslusarczyk@gmail.com"}], "who": "mieszkoslusarczyk@gmail.com", "when": "2012-05-21T07:04:22Z"}, {"changes": [{"field_name": "attachments.ispatch", "removed": "0", "attachment_id": 617980, "added": "1"}], "who": "fryn@frankyan.com", "when": "2012-05-23T00:18:14Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 571426, "added": "1"}], "who": "mstange@themasta.com", "when": "2012-05-24T21:12:05Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 571315, "added": "1"}], "who": "mstange@themasta.com", "when": "2012-05-24T21:12:35Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 571317, "added": "1"}, {"field_name": "flagtypes.name", "removed": "feedback?(bzbarsky@mit.edu)", "attachment_id": 571317, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 626958, "added": "review?(fryn@frankyan.com)"}], "who": "mstange@themasta.com", "when": "2012-05-24T21:14:00Z"}, {"changes": [{"field_name": "attachments.ispatch", "removed": "0", "attachment_id": 626957, "added": "1"}], "who": "mstange@themasta.com", "when": "2012-05-24T21:14:24Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 571319, "added": "1"}, {"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 617980, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 626960, "added": "review?(fryn@frankyan.com)"}], "who": "mstange@themasta.com", "when": "2012-05-24T21:14:39Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bugs@junglecode.net"}], "who": "bugs@junglecode.net", "when": "2012-06-29T15:54:25Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "masayuki@d-toybox.com"}], "who": "masayuki@d-toybox.com", "when": "2012-07-05T09:22:17Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "logatronico@gmail.com"}], "who": "loganrosen@gmail.com", "when": "2012-07-08T06:37:49Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "lars.brennicke@gmx.de"}], "who": "e1857104@rtrtr.com", "when": "2012-07-12T18:53:40Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "contact@marcelocarlos.com"}], "who": "contact@marcelocarlos.com", "when": "2012-07-13T11:32:03Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "christo27@live.com"}], "who": "me@chrisb.xyz", "when": "2012-07-31T12:17:11Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "notforyourmail@gmail.com"}], "who": "joe@drew.ca", "when": "2012-08-06T05:11:54Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "joe@drew.ca"}], "who": "joe@drew.ca", "when": "2012-08-06T05:12:30Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(fryn@frankyan.com)", "attachment_id": 626960, "added": "review+"}], "who": "fryn@frankyan.com", "when": "2012-08-09T09:30:45Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(fryn@frankyan.com)", "attachment_id": 626958, "added": "feedback+"}], "who": "fryn@frankyan.com", "when": "2012-08-09T09:40:39Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "astravian@gmail.com"}], "who": "astravian@gmail.com", "when": "2012-08-27T02:01:40Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "hawkrives@gmail.com"}], "who": "hawkrives@gmail.com", "when": "2012-09-12T05:02:57Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "pohl.stephen@gmail.com"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-09-12T05:38:51Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 660348, "added": "feedback?"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-09-12T08:24:51Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 660348, "added": "1"}, {"field_name": "flagtypes.name", "removed": "feedback?", "attachment_id": 660348, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 660354, "added": "feedback?"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-09-12T08:46:29Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "spohl@adobe.com"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-09-13T00:26:36Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "feedback?", "attachment_id": 660354, "added": "feedback+"}], "who": "smichaud@pobox.com", "when": "2012-09-17T16:10:06Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "marckjackubosky@gmail.com"}], "who": "marckjackubosky@gmail.com", "when": "2012-09-18T13:02:13Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "teoli2003@jyp.ch"}], "who": "jypenator@gmail.com", "when": "2012-10-10T09:39:45Z"}, {"changes": [{"removed": "spohl@adobe.com", "field_name": "cc", "added": ""}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-10-11T20:39:36Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "sergeyreym@gmail.com"}], "who": "sergeyreym@gmail.com", "when": "2012-10-14T05:06:02Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 660354, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 671734, "added": "feedback?(smichaud@pobox.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-10-16T06:14:43Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "feedback?(smichaud@pobox.com)", "attachment_id": 671734, "added": "feedback+"}], "who": "smichaud@pobox.com", "when": "2012-10-16T17:03:00Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "n.nethercote@gmail.com"}], "who": "justin.lebar+bug@gmail.com", "when": "2012-10-16T17:19:01Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "cendrizzi@gmail.com"}], "who": "cendrizzi@gmail.com", "when": "2012-10-18T19:06:21Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "josiah@programmer.net"}], "who": "jsbruner@umich.edu", "when": "2012-11-19T15:22:11Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "spohl@mozilla.com"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-11-19T18:29:17Z"}, {"changes": [{"removed": "n.nethercote@gmail.com", "field_name": "cc", "added": ""}], "who": "n.nethercote@gmail.com", "when": "2012-11-27T05:07:23Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 626956, "added": "1"}, {"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 626957, "added": "1"}, {"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 626958, "added": "1"}, {"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 626960, "added": "1"}, {"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 671734, "added": "1"}, {"removed": "mstange@themasta.com", "field_name": "assigned_to", "added": "spohl.mozilla.bugs@gmail.com"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-11-27T19:05:32Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 685725, "added": "1"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-11-29T03:19:36Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bugzilla@spray.se"}], "who": "bugzilla@spray.se", "when": "2012-11-29T14:00:48Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 686407, "added": "1"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-11-29T20:20:32Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "cheba@pointlessone.org"}], "who": "alex@pointless.one", "when": "2012-11-30T15:13:22Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 686741, "added": "1"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-12-01T08:32:06Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 687358, "added": "1"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-12-06T22:15:45Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 689386, "added": "1"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-12-06T22:20:49Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "780362, 817700"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-12-07T19:38:25Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 573552, "added": "1"}, {"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 686076, "added": "1"}, {"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 686414, "added": "1"}, {"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 689388, "added": "1"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-12-07T23:58:27Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 689982, "added": "1"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-12-08T00:19:56Z"}, {"changes": [{"removed": "lexi@lexi.org.uk", "field_name": "cc", "added": ""}], "who": "lexi@lexi.org.uk", "when": "2012-12-08T10:41:39Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "ludalex@gmail.com"}], "who": "ludalex@gmail.com", "when": "2012-12-08T19:45:07Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "BernesB@gmail.com"}], "who": "Virtual@teknik.io", "when": "2012-12-09T12:41:33Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 689992, "added": "1"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-12-10T21:28:15Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 690541, "added": "1"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-12-12T23:11:15Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "iAbdulElah@gmail.com"}], "who": "iAbdulElah@gmail.com", "when": "2012-12-14T19:18:45Z"}, {"changes": [{"removed": "cendrizzi@gmail.com", "field_name": "cc", "added": ""}], "who": "cendrizzi@gmail.com", "when": "2012-12-14T21:38:19Z"}, {"changes": [{"removed": "mieszkoslusarczyk@gmail.com", "field_name": "cc", "added": ""}], "who": "mieszkoslusarczyk@gmail.com", "when": "2012-12-14T22:15:23Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "paul@mozilla.com"}], "who": "paul@mozilla.com", "when": "2012-12-17T20:54:33Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 691550, "added": "1"}, {"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 691893, "added": "1"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-12-19T08:06:47Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "josh@joshmatthews.net"}], "who": "josh@joshmatthews.net", "when": "2012-12-20T16:40:34Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 694540, "added": "feedback?(smichaud@pobox.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-12-20T21:12:12Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "feedback?(smichaud@pobox.com)", "attachment_id": 694540, "added": "feedback+"}], "who": "smichaud@pobox.com", "when": "2012-12-20T21:38:54Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 694540, "added": "1"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-12-21T09:01:41Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "camaran@gmail.com"}], "who": "camaran@gmail.com", "when": "2012-12-21T11:14:28Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 694745, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 694922, "added": "review?(smichaud@pobox.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-12-21T19:06:48Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(smichaud@pobox.com)", "attachment_id": 694922, "added": "review+"}], "who": "smichaud@pobox.com", "when": "2012-12-21T23:21:27Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 693784, "added": "1"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-12-22T01:01:01Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 694922, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 695054, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-12-22T01:04:01Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 695053, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 696097, "added": "review?(smichaud@pobox.com), feedback?(mstange@themasta.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-12-27T19:37:42Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 695054, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 696099, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-12-27T19:38:57Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 696097, "added": "feedback?(madhava@mozilla.com)"}, {"removed": "", "field_name": "cc", "added": "madhava@mozilla.com"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2012-12-27T22:53:45Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 696097, "added": "1"}, {"field_name": "flagtypes.name", "removed": "review?(smichaud@pobox.com), feedback?(mstange@themasta.com), feedback?(madhava@mozilla.com)", "attachment_id": 696097, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 696830, "added": "review?(smichaud@pobox.com), feedback?(mstange@themasta.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-01T00:38:05Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 696830, "added": "review?(madhava@mozilla.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-01T00:39:28Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 696438, "added": "1"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-01T00:42:59Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "timbugzilla@gmail.com"}], "who": "timbugzilla@gmail.com", "when": "2013-01-02T20:30:24Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 696830, "added": "1"}, {"field_name": "flagtypes.name", "removed": "review?(smichaud@pobox.com), review?(madhava@mozilla.com), feedback?(mstange@themasta.com)", "attachment_id": 696830, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 697191, "added": "review?(smichaud@pobox.com), feedback?(mstange@themasta.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-02T21:48:43Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 697191, "added": "feedback?(madhava@mozilla.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-02T21:49:21Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "817074"}], "who": "jsbruner@umich.edu", "when": "2013-01-03T16:51:48Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 696831, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 697507, "added": "feedback?(smichaud@pobox.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-03T17:36:44Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 697191, "added": "1"}, {"field_name": "flagtypes.name", "removed": "review?(smichaud@pobox.com), feedback?(mstange@themasta.com), feedback?(madhava@mozilla.com)", "attachment_id": 697191, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 697633, "added": "review?(smichaud@pobox.com), feedback?(mstange@themasta.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-03T21:33:43Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 697633, "added": "feedback?(madhava@mozilla.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-03T21:34:51Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "803022"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-09T23:42:36Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 696099, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 702506, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-15T21:51:47Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "673875"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-17T01:03:45Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(smichaud@pobox.com)", "attachment_id": 697633, "added": "review+"}], "who": "smichaud@pobox.com", "when": "2013-01-18T22:18:53Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 697633, "added": "1"}, {"field_name": "flagtypes.name", "removed": "feedback?(mstange@themasta.com), feedback?(madhava@mozilla.com)", "attachment_id": 697633, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 704990, "added": "review?(gavin.sharp@gmail.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-22T18:55:21Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 705002, "added": "review?(smichaud@pobox.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-22T19:00:56Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(smichaud@pobox.com)", "attachment_id": 705002, "added": "review+"}], "who": "smichaud@pobox.com", "when": "2013-01-22T19:25:57Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "reuben.bmo@gmail.com"}], "who": "reuben.bmo@gmail.com", "when": "2013-01-22T19:29:53Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "feedback?(smichaud@pobox.com)", "attachment_id": 697507, "added": "review?(smichaud@pobox.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-22T19:45:39Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 702506, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 705497, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-23T20:23:36Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(gavin.sharp@gmail.com)", "attachment_id": 704990, "added": ""}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-24T17:05:40Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(smichaud@pobox.com)", "attachment_id": 697507, "added": ""}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-25T19:57:03Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 704990, "added": "1"}, {"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 705002, "added": "1"}, {"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 705932, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 706601, "added": "review?(felipc@gmail.com)"}, {"removed": "", "field_name": "cc", "added": "felipc@gmail.com"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-25T22:31:24Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 705497, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 706652, "added": "review?(smichaud@pobox.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-26T00:08:48Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 697507, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 706675, "added": "review?(felipc@gmail.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-26T00:50:13Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 706601, "added": "1"}, {"field_name": "flagtypes.name", "removed": "review?(felipc@gmail.com)", "attachment_id": 706601, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 706687, "added": "review?(felipc@gmail.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-26T01:12:54Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 706687, "added": "1"}, {"field_name": "flagtypes.name", "removed": "review?(felipc@gmail.com)", "attachment_id": 706687, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 706721, "added": "review?(felipc@gmail.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-26T04:00:45Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 706652, "added": "1"}, {"field_name": "flagtypes.name", "removed": "review?(smichaud@pobox.com)", "attachment_id": 706652, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 707178, "added": "review?(smichaud@pobox.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-28T18:30:34Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 706721, "added": "1"}, {"field_name": "flagtypes.name", "removed": "review?(felipc@gmail.com)", "attachment_id": 706721, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 708191, "added": "review?(felipc@gmail.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-30T17:47:22Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "836430"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-01-30T20:06:39Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(smichaud@pobox.com)", "attachment_id": 707178, "added": "review+"}], "who": "smichaud@pobox.com", "when": "2013-01-31T20:50:52Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 708191, "added": "1"}, {"field_name": "flagtypes.name", "removed": "review?(felipc@gmail.com)", "attachment_id": 708191, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 709101, "added": "review?(felipc@gmail.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-01T17:54:54Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 709101, "added": "1"}, {"field_name": "flagtypes.name", "removed": "review?(felipc@gmail.com)", "attachment_id": 709101, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 709297, "added": "review?(felipc@gmail.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-02T00:57:51Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 709297, "added": "1"}, {"field_name": "flagtypes.name", "removed": "review?(felipc@gmail.com)", "attachment_id": 709297, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 709812, "added": "review?(felipc@gmail.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-04T19:30:32Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 706675, "added": "1"}, {"field_name": "flagtypes.name", "removed": "review?(felipc@gmail.com)", "attachment_id": 706675, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 710422, "added": "review?(felipc@gmail.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-05T23:54:03Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(felipc@gmail.com)", "attachment_id": 709812, "added": "feedback+"}], "who": "felipc@gmail.com", "when": "2013-02-06T22:42:54Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 709812, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 711456, "added": "review?(felipc@gmail.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-07T20:16:04Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 707178, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 711461, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-07T20:28:36Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 711463, "added": "review?(felipc@gmail.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-07T20:34:58Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(felipc@gmail.com)", "attachment_id": 711463, "added": "review+"}], "who": "felipc@gmail.com", "when": "2013-02-07T22:21:39Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 711456, "added": "1"}, {"field_name": "flagtypes.name", "removed": "review?(felipc@gmail.com)", "attachment_id": 711456, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 711566, "added": "review?(felipc@gmail.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-07T23:34:36Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 710422, "added": "1"}, {"field_name": "flagtypes.name", "removed": "review?(felipc@gmail.com)", "attachment_id": 710422, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 711567, "added": "review?(felipc@gmail.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-07T23:36:18Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(felipc@gmail.com)", "attachment_id": 711566, "added": "review+"}], "who": "felipc@gmail.com", "when": "2013-02-07T23:40:19Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(felipc@gmail.com)", "attachment_id": 711567, "added": "review+"}], "who": "felipc@gmail.com", "when": "2013-02-07T23:43:40Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 711567, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 711581, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-07T23:57:37Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "saneyuki.s.snyk@gmail.com"}], "who": "saneyuki.s.snyk@gmail.com", "when": "2013-02-08T09:54:17Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 711566, "added": "feedback-"}], "who": "dao+bmo@mozilla.com", "when": "2013-02-08T11:35:20Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 711566, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 711877, "added": "review+, feedback-"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-08T17:37:20Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "839549"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-08T17:42:30Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 711463, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 711896, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-08T18:23:57Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "in-testsuite+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-08T22:07:50Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "robert.bugzilla@gmail.com"}], "who": "robert.strong.bugs@gmail.com", "when": "2013-02-09T01:17:10Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "philringnalda@gmail.com"}], "who": "philringnalda@gmail.com", "when": "2013-02-09T03:19:28Z"}, {"changes": [{"field_name": "attachments.description", "removed": "Patch", "attachment_id": 711877, "added": "Part 1: Patch"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-13T00:04:02Z"}, {"changes": [{"field_name": "attachments.description", "removed": "Patch for availability check", "attachment_id": 711461, "added": "Part 2: Patch for availability check"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-13T00:04:37Z"}, {"changes": [{"field_name": "attachments.description", "removed": "Move gGestureSupport to browser-gestureSupport.js", "attachment_id": 711896, "added": "Part 3: Move gGestureSupport to browser-gestureSupport.js"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-13T00:05:07Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 711877, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 713190, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-13T00:54:47Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 714004, "added": "review?(smichaud@pobox.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-14T19:14:39Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(smichaud@pobox.com)", "attachment_id": 714004, "added": "review+"}], "who": "smichaud@pobox.com", "when": "2013-02-14T21:06:56Z"}, {"changes": [{"field_name": "attachments.description", "removed": "Tests", "attachment_id": 711581, "added": "Part 4: Tests"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-14T21:43:04Z"}, {"changes": [{"field_name": "attachments.description", "removed": "Part 4: Performance modifications", "attachment_id": 714004, "added": "Part 5: Performance modifications"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-14T21:43:36Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 713190, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 714442, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-15T17:25:34Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 711896, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 714445, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-15T17:26:38Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 714004, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 714447, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-15T17:27:44Z"}, {"changes": [{"field_name": "attachments.ispatch", "removed": "0", "attachment_id": 714445, "added": "1"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-15T17:28:17Z"}, {"changes": [{"field_name": "attachments.ispatch", "removed": "0", "attachment_id": 714447, "added": "1"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-15T17:28:56Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 714442, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 718185, "added": "review+"}], "who": "jsbruner@umich.edu", "when": "2013-02-26T01:24:43Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 718185, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 718187, "added": "review+"}], "who": "jsbruner@umich.edu", "when": "2013-02-26T01:26:25Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "1", "attachment_id": 714442, "added": "0"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-26T17:47:08Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 718187, "added": "1"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-26T17:49:17Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 714442, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 718538, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-02-26T19:09:16Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "ehsan@mozilla.com"}], "who": "ehsan@mozilla.com", "when": "2013-02-27T18:03:12Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 720958, "added": "review?(smichaud@pobox.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-03-05T00:08:21Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(smichaud@pobox.com)", "attachment_id": 720958, "added": "review+"}], "who": "smichaud@pobox.com", "when": "2013-03-05T16:24:17Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 718538, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 721784, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-03-06T18:15:05Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 721785, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-03-06T18:17:23Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mar.castelluccio@studenti.unina.it"}], "who": "mcastelluccio@mozilla.com", "when": "2013-03-07T08:46:05Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 721784, "added": "ui-review?(jboriss@mozilla.com)"}, {"removed": "", "field_name": "cc", "added": "jboriss@mozilla.com"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-03-07T22:08:42Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "ge3k0s@gmail.com"}], "who": "ge3k0s@gmail.com", "when": "2013-03-08T11:06:31Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "swrobel@gmail.com"}], "who": "swrobel@gmail.com", "when": "2013-03-09T02:24:26Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "zpletan@aol.com"}], "who": "zpletan@aol.com", "when": "2013-03-25T13:17:09Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mbrubeck@mozilla.com"}], "who": "mbrubeck@mozilla.com", "when": "2013-03-26T18:07:13Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 729665, "added": "1"}], "who": "jboriss@mozilla.com", "when": "2013-03-26T18:29:59Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mdeboer@mozilla.com"}], "who": "mdeboer@mozilla.com", "when": "2013-03-27T10:21:51Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "800443"}], "who": "jboriss@mozilla.com", "when": "2013-03-28T23:14:45Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 721784, "added": "1"}, {"field_name": "flagtypes.name", "removed": "ui-review?(jboriss@mozilla.com)", "attachment_id": 721784, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 731981, "added": "review+, ui-review?(jboriss@mozilla.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-01T19:18:56Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 714445, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 731988, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-01T19:27:41Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "starfx6464@gmail.com"}], "who": "starfx6464@gmail.com", "when": "2013-04-02T18:33:02Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 731981, "added": "1"}, {"field_name": "flagtypes.name", "removed": "ui-review?(jboriss@mozilla.com)", "attachment_id": 731981, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 733379, "added": "review+, ui-review?(jboriss@mozilla.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-04T16:06:53Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 731988, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 733383, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-04T16:12:28Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 714447, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 733398, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-04T16:34:54Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 733379, "added": "1"}, {"field_name": "flagtypes.name", "removed": "ui-review?(jboriss@mozilla.com)", "attachment_id": 733379, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 733547, "added": "review+, ui-review?(jboriss@mozilla.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-04T21:09:34Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 733552, "added": "review?(smichaud@pobox.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-04T21:18:39Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 733552, "added": "1"}, {"field_name": "flagtypes.name", "removed": "review?(smichaud@pobox.com)", "attachment_id": 733552, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 733554, "added": "review?(smichaud@pobox.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-04T21:24:14Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 733554, "added": "1"}, {"field_name": "flagtypes.name", "removed": "review?(smichaud@pobox.com)", "attachment_id": 733554, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 733558, "added": "review?(smichaud@pobox.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-04T21:26:35Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(smichaud@pobox.com)", "attachment_id": 733558, "added": "review+"}], "who": "smichaud@pobox.com", "when": "2013-04-04T22:05:22Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 733558, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 733574, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-04T22:13:50Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "511236"}], "who": "mbrubeck@mozilla.com", "when": "2013-04-05T15:27:37Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 734172, "added": "review?(smichaud@pobox.com)"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-06T01:03:09Z"}, {"changes": [{"field_name": "attachments.description", "removed": "Part 8: Fix rotation gestures", "attachment_id": 734172, "added": "Part 9: Fix rotation gestures"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-06T01:03:47Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 733574, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 734196, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-06T04:54:33Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(smichaud@pobox.com)", "attachment_id": 734172, "added": "review+"}], "who": "jaws@mozilla.com", "when": "2013-04-07T16:29:21Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 721785, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 734660, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-08T15:48:54Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 734196, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 734662, "added": "review+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-08T15:49:53Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 735264, "added": "feedback?(spohl.mozilla.bugs@gmail.com)"}], "who": "smichaud@pobox.com", "when": "2013-04-09T17:24:18Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "feedback?(spohl.mozilla.bugs@gmail.com)", "attachment_id": 735264, "added": "feedback+"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-09T17:38:44Z"}, {"changes": [{"removed": "ASSIGNED", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla23"}, {"removed": "2011-08-11 16:25:49", "field_name": "cf_last_resolved", "added": "2013-04-10 05:23:28"}], "who": "emorley@mozilla.com", "when": "2013-04-10T12:23:28Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "scoobidiver@netcourrier.com"}], "who": "scoobidiver@netcourrier.com", "when": "2013-04-10T15:17:02Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "860489"}], "who": "beingalink@googlemail.com", "when": "2013-04-10T21:43:50Z"}, {"changes": [{"removed": "860489", "field_name": "blocks", "added": ""}, {"removed": "", "field_name": "depends_on", "added": "860489"}], "who": "smichaud@pobox.com", "when": "2013-04-10T21:47:02Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "860489"}, {"removed": "860489", "field_name": "depends_on", "added": ""}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-10T21:49:42Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "860493"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-04-10T22:02:04Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "860779"}], "who": "smichaud@pobox.com", "when": "2013-04-11T15:50:44Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "Ms2ger@gmail.com"}], "who": "Ms2ger@gmail.com", "when": "2013-04-12T11:30:49Z"}, {"changes": [{"removed": "contact@marcelocarlos.com", "field_name": "cc", "added": ""}], "who": "contact@marcelocarlos.com", "when": "2013-04-12T16:21:37Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "867629"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-05-01T16:37:03Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "lsblakk@mozilla.com"}, {"removed": "---", "field_name": "cf_tracking_firefox_relnote", "added": "23+"}], "who": "lukasblakk+bugs@gmail.com", "when": "2013-05-16T04:56:14Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "lmedinas@gmail.com"}], "who": "lmedinas@gmail.com", "when": "2013-05-16T09:11:35Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "sarentz@mozilla.com"}], "who": "sarentz@mozilla.com", "when": "2013-05-29T15:24:49Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "verifyme"}, {"removed": "", "field_name": "cc", "added": "anthony.s.hughes@gmail.com"}], "who": "anthony.s.hughes@gmail.com", "when": "2013-06-17T22:40:37Z"}, {"changes": [{"removed": "verifyme", "field_name": "keywords", "added": ""}], "who": "anthony.s.hughes@gmail.com", "when": "2013-06-18T00:28:45Z"}, {"changes": [{"removed": "23+", "field_name": "cf_tracking_firefox_relnote", "added": "---"}], "who": "lukasblakk+bugs@gmail.com", "when": "2013-06-21T18:57:19Z"}, {"changes": [{"removed": "fyan@mozilla.com", "field_name": "cc", "added": ""}], "who": "fryn@frankyan.com", "when": "2013-06-21T20:47:00Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "885978"}], "who": "reuben.bmo@gmail.com", "when": "2013-06-22T06:27:23Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "tommybxp@gmail.com"}], "who": "mstange@themasta.com", "when": "2013-06-25T17:38:14Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "917761"}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2013-09-18T12:26:46Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "thomas@thomasy.tw"}], "who": "thomas@thomasy.tw", "when": "2013-11-10T14:27:16Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "avihpit@yahoo.com"}], "who": "avihpit@yahoo.com", "when": "2013-11-27T22:48:32Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1382560"}], "who": "bugs@junglecode.net", "when": "2017-07-20T08:08:15Z"}, {"changes": [{"removed": "1382560", "field_name": "blocks", "added": ""}], "who": "bugs@junglecode.net", "when": "2017-07-20T08:11:15Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mehmet.sahin@gmx.net"}], "who": "mehmet.sahin@gmx.net", "when": "2017-12-03T14:08:28Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "ui-review?(jboriss@mozilla.com)", "attachment_id": 733547, "added": ""}], "who": "spohl.mozilla.bugs@gmail.com", "when": "2018-05-01T17:04:20Z"}], "resolution": "FIXED", "op_sys": "Mac OS X", "cf_fx_points": "---", "cf_blocking_fennec": "---"}