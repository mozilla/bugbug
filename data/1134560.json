{"cf_status_firefox38": "fixed", "cf_tracking_thunderbird_esr52": "---", "cf_tracking_firefox60": "---", "attachments": [{"creator": "nils@vulndev.org", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "text/html", "id": 8566442}, {"creator": "nils@vulndev.org", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "text/plain", "id": 8566443}], "classification": "Components", "cf_status_firefox39": "fixed", "mentors_detail": [], "depends_on": [1134561], "cf_status_b2g_2_0m": "unaffected", "cf_has_str": "---", "cf_status_firefox36": "wontfix", "cf_status_firefox37": "fixed", "cf_user_story": "", "history": [{"changes": [{"removed": "", "field_name": "blocks", "added": "1134280"}], "who": "gijskruitbosch+bugs@gmail.com", "when": "2015-02-19T10:23:32Z"}, {"changes": [{"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "longsonr@gmail.com"}], "who": "longsonr@gmail.com", "when": "2015-02-19T11:48:34Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1134561"}], "who": "longsonr@gmail.com", "when": "2015-02-19T12:22:01Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "abillings@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "sec-bounty?"}], "who": "abillings@mozilla.com", "when": "2015-02-19T18:29:15Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "sec-critical"}, {"removed": "", "field_name": "cc", "added": "continuation@gmail.com"}], "who": "continuation@gmail.com", "when": "2015-02-21T15:53:20Z"}, {"changes": [{"removed": "---", "field_name": "cf_status_firefox36", "added": "wontfix"}, {"removed": "---", "field_name": "cf_tracking_firefox37", "added": "+"}, {"removed": "---", "field_name": "cf_status_firefox37", "added": "affected"}, {"removed": "---", "field_name": "cf_tracking_firefox38", "added": "+"}, {"removed": "---", "field_name": "cf_status_firefox38", "added": "affected"}, {"removed": "---", "field_name": "cf_tracking_firefox39", "added": "+"}, {"removed": "---", "field_name": "cf_status_firefox39", "added": "affected"}, {"removed": "---", "field_name": "cf_status_firefox_esr31", "added": "unaffected"}], "who": "abillings@mozilla.com", "when": "2015-02-25T18:12:32Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2015-03-10 16:01:12"}], "who": "continuation@gmail.com", "when": "2015-03-10T23:01:12Z"}, {"changes": [{"removed": "affected", "field_name": "cf_status_firefox39", "added": "fixed"}], "who": "continuation@gmail.com", "when": "2015-03-10T23:01:23Z"}, {"changes": [{"removed": "affected", "field_name": "cf_status_firefox37", "added": "fixed"}, {"removed": "affected", "field_name": "cf_status_firefox38", "added": "fixed"}, {"removed": "---", "field_name": "cf_status_b2g_1_4", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_b2g_2_0", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_b2g_2_0m", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_b2g_2_1", "added": "disabled"}, {"removed": "---", "field_name": "cf_status_b2g_2_1_s", "added": "disabled"}, {"removed": "---", "field_name": "cf_status_b2g_2_2", "added": "disabled"}, {"removed": "---", "field_name": "cf_status_b2g_master", "added": "fixed"}], "who": "ryanvm@gmail.com", "when": "2015-03-11T19:20:19Z"}, {"changes": [{"removed": "sec-bounty?", "field_name": "flagtypes.name", "added": "sec-bounty+"}], "who": "abillings@mozilla.com", "when": "2015-03-16T20:13:09Z"}, {"changes": [{"removed": "", "field_name": "whiteboard", "added": "[adv-main37+]"}], "who": "abillings@mozilla.com", "when": "2015-03-25T00:29:30Z"}, {"changes": [{"removed": "", "field_name": "alias", "added": "CVE-2015-0804"}], "who": "abillings@mozilla.com", "when": "2015-03-25T17:08:34Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mark@wolfbeast.com"}], "who": "abillings@mozilla.com", "when": "2015-04-07T17:00:13Z"}, {"changes": [{"removed": "core-security", "field_name": "groups", "added": "core-security-release"}], "who": "automation@bmo.tld", "when": "2015-09-02T06:59:34Z"}, {"changes": [{"removed": "core-security-release", "field_name": "groups", "added": ""}], "who": "dveditz@mozilla.com", "when": "2016-07-02T17:34:18Z"}], "cf_tracking_firefox_relnote": "---", "platform": "x86_64", "cf_status_firefox58": "---", "cf_status_firefox59": "---", "keywords": ["sec-critical"], "summary": "Type confusion in HTMLSourceElement::BindToTree", "cf_last_resolved": "2015-03-10T23:01:12Z", "cf_status_b2g_master": "fixed", "votes": 0, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 3, "comments": [{"text": "Created attachment 8566442\ntestcase\n\nWhen binding a <source> element to a tree the functions checks for any siblings of the type <img>. It fails to validate the namespace and only checks for the tag name:\n\n  if (aParent && aParent->IsNodeOfType(nsINode::eMEDIA)) {\n    HTMLMediaElement* media = static_cast<HTMLMediaElement*>(aParent);\n    media->NotifyAddedSource();\n  } else if (aParent && aParent->Tag() == nsGkAtoms::picture) {\n    // Find any img siblings after this <source> and notify them\n    nsCOMPtr<nsINode> sibling = AsContent();\n    while ( (sibling = sibling->GetNextSibling()) ) {\n      if (sibling->Tag() == nsGkAtoms::img) {\n        HTMLImageElement *img = static_cast<HTMLImageElement*>(sibling.get());\n        img->PictureSourceAdded(AsContent());\n      }\n    }\n  }\n\n  This can result in a type confusion. See attached testcase which demonstrates the issue. ASan detects this issue as a use-after-free (output attached). This vulnerability can also be triggered on the stable release version of Firefox without <picture> being enabled as the check in the code only validates the tag name. The testcase on crashes on Windows accessing on mapped memory during garbage collection.", "author": "nils@vulndev.org", "id": 9934972, "time": "2015-02-19T10:07:36Z"}, {"text": "Created attachment 8566443\nasan.txt", "author": "nils@vulndev.org", "id": 9934973, "time": "2015-02-19T10:07:58Z"}, {"text": "patch in bug 1134561 fixes this too.", "author": "longsonr@gmail.com", "id": 9935183, "time": "2015-02-19T12:22:01Z"}], "id": 1134560, "priority": "--", "cc": ["abillings@mozilla.com", "continuation@gmail.com", "mark@wolfbeast.com"], "cf_crash_signature": "", "version": "unspecified", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_firefox59": "---", "cf_status_b2g_2_2": "disabled", "last_change_time": "2016-07-02T17:34:18Z", "status": "RESOLVED", "product": "Core", "cf_fx_iteration": "---", "blocks": [1134280], "qa_contact": "", "cf_tracking_firefox39": "+", "cf_tracking_firefox38": "+", "cf_tracking_firefox37": "+", "creation_time": "2015-02-19T10:07:36Z", "cf_status_firefox_esr52": "---", "component": "DOM: Core & HTML", "assigned_to_detail": {"email": "longsonr@gmail.com", "id": 218550, "name": "longsonr@gmail.com", "real_name": "Robert Longson [:longsonr]"}, "cf_status_firefox_esr31": "unaffected", "groups": [], "cf_status_firefox60": "---", "cf_status_b2g_2_1_s": "disabled", "target_milestone": "---", "is_cc_accessible": true, "cf_rank": null, "cf_status_thunderbird_esr52": "---", "cf_status_b2g_1_4": "unaffected", "url": "", "resolution": "FIXED", "creator_detail": {"email": "nils@vulndev.org", "id": 344130, "name": "nils@vulndev.org", "real_name": "Nils"}, "whiteboard": "[adv-main37+]", "cf_status_b2g_2_1": "disabled", "cf_status_b2g_2_0": "unaffected", "cc_detail": [{"email": "abillings@mozilla.com", "id": 280903, "name": "abillings@mozilla.com", "real_name": "Al Billings [:abillings]"}, {"email": "continuation@gmail.com", "id": 406194, "name": "continuation@gmail.com", "real_name": "Andrew McCreight [:mccr8]"}, {"email": "mark@wolfbeast.com", "id": 364942, "name": "mark@wolfbeast.com", "real_name": "Mark Straver"}], "cf_platform_rel": "---", "alias": "CVE-2015-0804", "dupe_of": null, "flags": [{"status": "+", "name": "sec-bounty", "modification_date": "2015-03-16T20:13:09Z", "type_id": 803, "creation_date": "2015-02-19T18:29:15Z", "id": 1103645, "setter": "abillings@mozilla.com"}], "cf_tracking_firefox58": "---", "assigned_to": "longsonr@gmail.com", "is_open": false, "mentors": [], "creator": "nils@vulndev.org", "op_sys": "Linux", "cf_fx_points": "---", "cf_blocking_fennec": "---"}