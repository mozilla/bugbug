{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "attachments": [{"creator": "jcoppeard@mozilla.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2016-03-07T20:38:47Z", "type_id": 4, "creation_date": "2016-03-07T10:45:02Z", "id": 1354916, "setter": "jdemooij@mozilla.com"}], "content_type": "text/plain", "id": 8727347}], "classification": "Components", "creator": "choller@mozilla.com", "cc": ["choller@mozilla.com", "fuzzing@mozilla.com", "jcoppeard@mozilla.com", "jdemooij@mozilla.com", "jruderman@gmail.com", "nth10sd@gmail.com", "rkothari@mozilla.com"], "depends_on": [], "creation_time": "2016-03-03T01:37:53Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "x86_64", "cf_status_firefox58": "---", "cf_status_firefox59": "---", "keywords": ["crash", "regression", "testcase"], "summary": "Crash [@ EncodeLatin1] with OOM", "id": 1253124, "assigned_to_detail": {"email": "jcoppeard@mozilla.com", "id": 443194, "name": "jcoppeard@mozilla.com", "real_name": "Jon Coppeard (:jonco) (PTO until 13th March)"}, "severity": "critical", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "assigned_to": "jcoppeard@mozilla.com", "comment_count": 12, "comments": [{"text": "The following testcase crashes on mozilla-central revision e15383656900 (build with --enable-optimize --enable-posix-nspr-emulation --enable-valgrind --enable-gczeal --disable-tests --enable-debug, run with --fuzzing-safe --thread-count=2):\n\nfor (lfLocal in this)\n  toPrimitive = Date.prototype[Symbol.toPrimitive];\n  assertThrowsInstanceOf(() =>  0);\n  obj = {};\n  oomAfterAllocations(10);\n  assertThrowsInstanceOf(() => toPrimitive.call(obj, \"boolean\"));\nfunction assertThrowsInstanceOf(f) {\n  f();\n}\n\n\n\nBacktrace:\n\nProgram received signal SIGSEGV, Segmentation fault.\nEncodeLatin1 (cx=cx@entry=0x7ffff6907800, str=str@entry=0x0) at js/src/jsapi.cpp:5059\n#0  EncodeLatin1 (cx=cx@entry=0x7ffff6907800, str=str@entry=0x0) at js/src/jsapi.cpp:5059\n#1  0x00000000008b44f6 in JS_EncodeString (cx=cx@entry=0x7ffff6907800, str=0x0) at js/src/jsapi.cpp:5085\n#2  0x00000000008f9b0b in encodeLatin1 (this=<optimized out>, str=<optimized out>, cx=<optimized out>) at js/src/jsapi.h:4626\n#3  js::ValueToSourceForError (cx=cx@entry=0x7ffff6907800, val=..., bytes=...) at js/src/jsexn.cpp:1059\n#4  0x00000000008b9915 in JS::GetFirstArgumentAsTypeHint (cx=cx@entry=0x7ffff6907800, args=..., result=result@entry=0x7fffffffaf40) at js/src/jsapi.cpp:1690\n#5  0x00000000008f3571 in date_toPrimitive (cx=0x7ffff6907800, argc=1, vp=0x7ffff45b1198) at js/src/jsdate.cpp:2999\n#6  0x0000000000ac0722 in js::CallJSNative (cx=0x7ffff6907800, native=0x8f34f0 <date_toPrimitive(JSContext*, unsigned int, JS::Value*)>, args=...) at js/src/jscntxtinlines.h:235\n#7  0x0000000000ab9a71 in js::Invoke (cx=cx@entry=0x7ffff6907800, args=..., construct=construct@entry=js::NO_CONSTRUCT) at js/src/vm/Interpreter.cpp:478\n#8  0x00000000008fa49b in js::fun_call (cx=0x7ffff6907800, argc=<optimized out>, vp=0x7ffff45b1198) at js/src/jsfun.cpp:1205\n#9  0x0000000000ac0722 in js::CallJSNative (cx=0x7ffff6907800, native=0x8fa3f0 <js::fun_call(JSContext*, unsigned int, JS::Value*)>, args=...) at js/src/jscntxtinlines.h:235\n[...]\n#41 0x0000000000000000 in ?? ()\nrax\t0x7ffff695d000\t140737330401280\nrbx\t0x7ffff6907800\t140737330051072\nrcx\t0x7ffff7dd5320\t140737351865120\nrdx\t0x7ffff7fdfad0\t140737354005200\nrsi\t0x0\t0\nrdi\t0x7ffff6907800\t140737330051072\nrbp\t0x7fffffffad00\t140737488334080\nrsp\t0x7fffffffac30\t140737488333872\nr8\t0x14\t20\nr9\t0x7ffff6a002f8\t140737331069688\nr10\t0x1\t1\nr11\t0x2\t2\nr12\t0x7fffffffad10\t140737488334096\nr13\t0x7ffff6907800\t140737330051072\nr14\t0x0\t0\nr15\t0x7ffff45b11a8\t140737292997032\nrip\t0x8b425a <EncodeLatin1(js::ExclusiveContext*, JSString*)+26>\n=> 0x8b425a <EncodeLatin1(js::ExclusiveContext*, JSString*)+26>:\ttestb  $0x3f,(%rsi)\n   0x8b425d <EncodeLatin1(js::ExclusiveContext*, JSString*)+29>:\tjne    0x8b4368 <EncodeLatin1(js::ExclusiveContext*, JSString*)+296>", "author": "choller@mozilla.com", "id": 11213540, "time": "2016-03-03T01:37:53Z"}, {"text": "JSBugMon: Bisection requested, result:\nDue to skipped revisions, the first bad revision could be any of:\nchangeset:   https://hg.mozilla.org/mozilla-central/rev/a0dd5a83ba36\nuser:        Jan de Mooij\ndate:        Thu Jul 24 11:56:43 2014 +0200\nsummary:     Bug 1031529 part 2 - Remove JS_THREADSAFE #ifdefs everywhere. r=bhackett\n\nchangeset:   https://hg.mozilla.org/mozilla-central/rev/6426fef52f51\nuser:        Jan de Mooij\ndate:        Thu Jul 24 11:56:45 2014 +0200\nsummary:     Bug 1031529 part 3 - Step defining JS_THREADSAFE, remove --disable-threadsafe. r=glandium\n\nThis iteration took 141.402 seconds to run.", "author": "fuzzing@mozilla.com", "id": 11213748, "time": "2016-03-03T03:14:56Z"}, {"text": "This regression window is probably not accurate as it should probably hail from prior to that.\n\nSetting needinfo? from Jon for this OOM bug as a fallback.", "author": "nth10sd@gmail.com", "id": 11213766, "time": "2016-03-03T03:23:39Z"}, {"text": "Created attachment 8727347\nbug1253124-source-oom\n\nPatch to check returned pointers in a couple of places.", "author": "jcoppeard@mozilla.com", "id": 11223426, "time": "2016-03-07T10:45:02Z"}, {"text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/7e3fc275d763", "author": "pulsebot@bots.tld", "id": 11227006, "time": "2016-03-08T10:16:31Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/7e3fc275d763", "author": "kwierso@gmail.com", "id": 11230040, "time": "2016-03-09T00:06:58Z"}, {"text": "Decoder, could you please verify this issue is fixed as expected on a latest Nightly build? Thanks!", "author": "rkothari@mozilla.com", "id": 11286025, "time": "2016-03-29T20:45:17Z"}, {"text": "Hi Jonco, Jandem: Should we consider uplifting this to Aurora47? Is it low risk enough to do that?", "author": "rkothari@mozilla.com", "id": 11286031, "time": "2016-03-29T20:46:05Z"}, {"text": "Just noticed the whiteboard tag, removing NI as the verification ought to happen automatically.", "author": "rkothari@mozilla.com", "id": 11286041, "time": "2016-03-29T20:48:26Z"}, {"text": "(In reply to Ritu Kothari (:ritu) from comment #7)\nYes, let's do it.", "author": "jcoppeard@mozilla.com", "id": 11290328, "time": "2016-03-31T10:04:21Z"}, {"text": "(In reply to Jon Coppeard (:jonco) from comment #9)\nAlthough TBH, there's not that likely that this will be hit in practice.  Did you have a particular reason for wanting to uplift this?", "author": "jcoppeard@mozilla.com", "id": 11290334, "time": "2016-03-31T10:08:21Z"}, {"text": "(In reply to Jon Coppeard (:jonco) from comment #10)\n> (In reply to Jon Coppeard (:jonco) from comment #9)\n> Although TBH, there's not that likely that this will be hit in practice. \n> Did you have a particular reason for wanting to uplift this?\n\nMainly since it was tagged as a crash. But if the likelihood of hitting this crash is very low and the risk associated with the fix is medium/high, we can just let it right the trains. It seems to me like you are leaning towards doing that and it sounds like a good idea to me.", "author": "rkothari@mozilla.com", "id": 11292043, "time": "2016-03-31T20:34:09Z"}], "cf_last_resolved": "2016-03-09T00:06:58Z", "priority": "--", "mentors_detail": [], "cf_crash_signature": "[@ EncodeLatin1]", "version": "Trunk", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox59": "---", "last_change_time": "2016-03-31T20:34:44Z", "cf_platform_rel": "---", "product": "Core", "cf_status_firefox_esr52": "---", "blocks": [676763, 912928], "qa_contact": "", "see_also": [], "cf_fx_iteration": "---", "component": "JavaScript Engine", "votes": 0, "groups": [], "cf_status_firefox60": "---", "target_milestone": "mozilla48", "cf_status_firefox47": "wontfix", "cf_status_thunderbird_esr52": "---", "url": "", "creator_detail": {"email": "choller@mozilla.com", "id": 395101, "name": "choller@mozilla.com", "real_name": "Christian Holler (:decoder)"}, "whiteboard": "[jsbugmon:update]", "mentors": [], "cc_detail": [{"email": "choller@mozilla.com", "id": 395101, "name": "choller@mozilla.com", "real_name": "Christian Holler (:decoder)"}, {"email": "fuzzing@mozilla.com", "id": 469204, "name": "fuzzing@mozilla.com", "real_name": "Fuzzing Team"}, {"email": "jcoppeard@mozilla.com", "id": 443194, "name": "jcoppeard@mozilla.com", "real_name": "Jon Coppeard (:jonco) (PTO until 13th March)"}, {"email": "jdemooij@mozilla.com", "id": 375297, "name": "jdemooij@mozilla.com", "real_name": "Jan de Mooij [:jandem] (PTO Mar 8)"}, {"email": "jruderman@gmail.com", "id": 11608, "name": "jruderman@gmail.com", "real_name": "Jesse Ruderman"}, {"email": "nth10sd@gmail.com", "id": 132034, "name": "nth10sd@gmail.com", "real_name": "Gary Kwong [:gkw] [:nth10sd]"}, {"email": "rkothari@mozilla.com", "id": 538805, "name": "rkothari@mozilla.com", "real_name": "Ritu Kothari (:ritu)"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "cf_tracking_firefox58": "---", "cf_rank": null, "is_open": false, "cf_qa_whiteboard": "", "history": [{"changes": [{"removed": "[jsbugmon:update,bisect]", "field_name": "whiteboard", "added": "[jsbugmon:update]"}], "who": "fuzzing@mozilla.com", "when": "2016-03-03T03:14:55Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jcoppeard@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(jcoppeard@mozilla.com)"}], "who": "nth10sd@gmail.com", "when": "2016-03-03T03:23:39Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jdemooij@mozilla.com"}, {"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "jcoppeard@mozilla.com"}, {"removed": "needinfo?(jcoppeard@mozilla.com)", "field_name": "flagtypes.name", "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8727347, "added": "review?(jdemooij@mozilla.com)"}], "who": "jcoppeard@mozilla.com", "when": "2016-03-07T10:45:02Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(jdemooij@mozilla.com)", "attachment_id": 8727347, "added": "review+"}], "who": "jdemooij@mozilla.com", "when": "2016-03-07T20:38:47Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla48"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2016-03-08 16:06:58"}, {"removed": "---", "field_name": "cf_status_firefox48", "added": "fixed"}], "who": "kwierso@gmail.com", "when": "2016-03-09T00:06:58Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "rkothari@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(choller@mozilla.com)"}], "who": "rkothari@mozilla.com", "when": "2016-03-29T20:45:17Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(jcoppeard@mozilla.com), needinfo?(jdemooij@mozilla.com)"}], "who": "rkothari@mozilla.com", "when": "2016-03-29T20:46:05Z"}, {"changes": [{"removed": "needinfo?(choller@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "rkothari@mozilla.com", "when": "2016-03-29T20:48:26Z"}, {"changes": [{"removed": "needinfo?(jcoppeard@mozilla.com), needinfo?(jdemooij@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "jcoppeard@mozilla.com", "when": "2016-03-31T10:04:21Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(rkothari@mozilla.com)"}], "who": "jcoppeard@mozilla.com", "when": "2016-03-31T10:08:21Z"}, {"changes": [{"removed": "needinfo?(rkothari@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "rkothari@mozilla.com", "when": "2016-03-31T20:34:09Z"}, {"changes": [{"removed": "affected", "field_name": "cf_status_firefox47", "added": "wontfix"}], "who": "rkothari@mozilla.com", "when": "2016-03-31T20:34:44Z"}], "resolution": "FIXED", "op_sys": "Linux", "cf_fx_points": "---", "cf_blocking_fennec": "---"}