{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "cf_tracking_firefox62": "---", "creator": "jib@mozilla.com", "mentors_detail": [], "depends_on": [1335005, 1436104, 1226448, 1281866, 1287378, 1287854, 1288338, 1290866, 1308605, 1341409], "cf_status_firefox_esr60": "---", "cf_user_story": "", "cf_backlog": "webrtc/webaudio+", "cf_tracking_firefox_relnote": "---", "platform": "All", "keywords": ["dev-doc-complete", "DevAdvocacy"], "summary": "Implement MediaStreamTrack.getConstraints() + getSettings()", "cf_last_resolved": "2016-07-19T14:25:42Z", "attachments": [{"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2016-06-20T09:18:18Z", "type_id": 4, "creation_date": "2016-06-20T09:18:18Z", "id": 1411283, "setter": "bugs@pettay.fi"}], "content_type": "text/x-review-board-request", "id": 8689889}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2015-11-20T06:44:44Z", "type_id": 4, "creation_date": "2015-11-20T03:43:18Z", "id": 1296331, "setter": "rjesup@jesup.org"}], "content_type": "text/x-review-board-request", "id": 8689890}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2015-11-20T22:15:26Z", "type_id": 4, "creation_date": "2015-11-20T03:43:21Z", "id": 1296332, "setter": "rjesup@jesup.org"}], "content_type": "text/x-review-board-request", "id": 8689891}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "text/x-review-board-request", "id": 8694859}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "text/x-review-board-request", "id": 8761183}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "text/x-review-board-request", "id": 8761184}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "text/x-review-board-request", "id": 8761185}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2016-07-14T21:26:01Z", "type_id": 4, "creation_date": "2016-07-14T21:26:01Z", "id": 1423873, "setter": "rjesup@jesup.org"}], "content_type": "text/x-review-board-request", "id": 8761186}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "text/x-review-board-request", "id": 8761187}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "text/x-review-board-request", "id": 8761188}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2016-06-23T08:44:01Z", "type_id": 4, "creation_date": "2016-06-23T04:59:34Z", "id": 1412926, "setter": "padenot@mozilla.com"}], "content_type": "text/x-review-board-request", "id": 8763464}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2016-07-06T12:16:11Z", "type_id": 4, "creation_date": "2016-07-05T19:25:40Z", "id": 1418765, "setter": "padenot@mozilla.com"}], "content_type": "text/x-review-board-request", "id": 8763465}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2016-06-23T11:52:12Z", "type_id": 4, "creation_date": "2016-06-23T04:59:34Z", "id": 1412928, "setter": "padenot@mozilla.com"}], "content_type": "text/x-review-board-request", "id": 8763466}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2016-06-23T09:12:00Z", "type_id": 4, "creation_date": "2016-06-23T04:59:34Z", "id": 1412929, "setter": "padenot@mozilla.com"}], "content_type": "text/x-review-board-request", "id": 8763467}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2016-07-05T09:19:28Z", "type_id": 4, "creation_date": "2016-07-04T14:04:19Z", "id": 1418016, "setter": "padenot@mozilla.com"}], "content_type": "text/x-review-board-request", "id": 8763468}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "text/x-review-board-request", "id": 8763469}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "text/x-review-board-request", "id": 8763470}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "text/x-review-board-request", "id": 8763471}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2016-07-05T09:18:32Z", "type_id": 4, "creation_date": "2016-07-04T14:04:19Z", "id": 1418014, "setter": "padenot@mozilla.com"}], "content_type": "text/x-review-board-request", "id": 8767669}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2016-07-14T20:09:50Z", "type_id": 4, "creation_date": "2016-07-07T19:13:48Z", "id": 1420177, "setter": "rjesup@jesup.org"}], "content_type": "text/x-review-board-request", "id": 8768892}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2016-07-14T20:04:58Z", "type_id": 4, "creation_date": "2016-07-07T19:13:48Z", "id": 1420178, "setter": "rjesup@jesup.org"}], "content_type": "text/x-review-board-request", "id": 8768893}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2016-07-14T20:59:31Z", "type_id": 4, "creation_date": "2016-07-07T19:13:48Z", "id": 1420179, "setter": "rjesup@jesup.org"}], "content_type": "text/x-review-board-request", "id": 8768894}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2016-07-18T16:24:40Z", "type_id": 4, "creation_date": "2016-07-18T12:32:52Z", "id": 1425046, "setter": "rjesup@jesup.org"}], "content_type": "text/x-review-board-request", "id": 8771954}, {"creator": "jib@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2016-07-18T16:25:20Z", "type_id": 4, "creation_date": "2016-07-18T12:32:52Z", "id": 1425047, "setter": "rjesup@jesup.org"}], "content_type": "text/x-review-board-request", "id": 8771955}], "votes": 0, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 227, "comments": [{"text": "", "author": "jib@mozilla.com", "id": 10826507, "time": "2015-10-10T00:58:50Z"}, {"text": "Great, I was just going to file this bug because I want to know the size of the video for a demo I'm building without having to create a <video> element, assigning the stream src, and waiting for metadata to load on the video to get the dimensions. Having the capabilities available from the beginning makes the code *way* more readable.", "author": "spenades@mozilla.com", "id": 10922727, "time": "2015-11-11T10:59:56Z"}, {"text": "Created attachment 8689889\nBug 1213517 - add webidl for track.getConstraints() and track.getSettings().\n\nBug 1213517 - add webidl for track.getConstraints() and track.getSettings().", "author": "jib@mozilla.com", "id": 10949978, "time": "2015-11-20T03:43:16Z"}, {"text": "Created attachment 8689890\nBug 1213517 - split off MediaTaskUtils.h from MediaUtils.h to shed dependencies.\n\nBug 1213517 - split off MediaTaskUtils.h from MediaUtils.h to shed dependencies.", "author": "jib@mozilla.com", "id": 10949979, "time": "2015-11-20T03:43:18Z"}, {"text": "Created attachment 8689891\nBug 1213517 - make track.applyConstraints() store constraints on success.\n\nBug 1213517 - make track.applyConstraints() store constraints on success.", "author": "jib@mozilla.com", "id": 10949980, "time": "2015-11-20T03:43:21Z"}, {"text": "This fiddle shows getConstraints() working. getSettings() is next.\n\nNote that the bloated dictionary output is a result of bug 1226475.", "author": "jib@mozilla.com", "id": 10950015, "time": "2015-11-20T03:58:30Z"}, {"text": "Comment on attachment 8689890\nBug 1213517 - split off MediaTaskUtils.h from MediaUtils.h to shed dependencies.\n\nhttps://reviewboard.mozilla.org/r/25737/#review23171", "author": "rjesup@jesup.org", "id": 10950249, "time": "2015-11-20T06:44:44Z"}, {"text": "Comment on attachment 8689889\nBug 1213517 - add webidl for track.getConstraints() and track.getSettings().\n\nI need some explanation here why we have only subset of the properties from the spec, and do we really need those mozilla specific extensions?\nAnd also, why do we need both MediaTrackConstraintSet and MediaTrackSettings which are pretty much the same?\n(I think MediaTrackConstraintSet is functionally superset of MediaTrackSettings)", "author": "bugs@pettay.fi", "id": 10951011, "time": "2015-11-20T13:29:11Z"}, {"text": "(In reply to Olli Pettay [:smaug] from comment #7)\n> I need some explanation here why we have only subset of the properties from\n> the spec,\n\nConstraints come with a discovery mechanism in the form of getSupportedConstraints() [1] which lets us add constraints as we implement them.\n\nThat said, I'm also not a fan of adding dictionary (skeleton) members before they're implemented. I did that by accident with getStats last year and it just seems to confuse people into thinking functionality is present when it isn't, leading to confusion, and comments like Bug 1225723 comment 0.\n\n> and do we really need those mozilla specific extensions?\n\nYes, ask the Hello team. They're in use by our screen sharing code.\n\n> And also, why do we need both MediaTrackConstraintSet and MediaTrackSettings\n> which are pretty much the same?\n> (I think MediaTrackConstraintSet is functionally superset of MediaTrackSettings)\n\nI 100% agree with you, but I lost that fight with the mediacapture spec editors back in March, and now we're past last-call. If you can make a better argument than I could [2] then by all means I encourage you to go ahead.\n\n[1] http://w3c.github.io/mediacapture-main/getusermedia.html#widl-MediaDevices-getSupportedConstraints-MediaTrackSupportedConstraints\n\n[2] https://github.com/w3c/mediacapture-main/pull/143#issuecomment-82554486", "author": "jib@mozilla.com", "id": 10951725, "time": "2015-11-20T17:11:51Z"}, {"text": "Comment on attachment 8689891\nBug 1213517 - make track.applyConstraints() store constraints on success.\n\nhttps://reviewboard.mozilla.org/r/25739/#review23223\n\n::: dom/media/MediaStreamTrack.cpp:142\n(Diff revision 1)\n> +  RefPtr<MediaStreamTrack> that = this;\n\nPerhaps add a comment or two about what's happening and why they need to be on a specific thread, etc", "author": "rjesup@jesup.org", "id": 10952697, "time": "2015-11-20T22:15:26Z"}, {"text": "Comment on attachment 8689891\nBug 1213517 - make track.applyConstraints() store constraints on success.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25739/diff/1-2/", "author": "jib@mozilla.com", "id": 10982470, "time": "2015-12-02T18:57:55Z"}, {"text": "Created attachment 8694859\nBug 1213517 - make getUserMedia store initial constraints on resulting tracks.\n\nBug 1213517 - make getUserMedia store initial constraints on resulting tracks.", "author": "jib@mozilla.com", "id": 10982471, "time": "2015-12-02T18:57:57Z"}, {"text": "Comment on attachment 8694859\nBug 1213517 - make getUserMedia store initial constraints on resulting tracks.\n\nhttps://reviewboard.mozilla.org/r/26905/#review24337", "author": "rjesup@jesup.org", "id": 10982978, "time": "2015-12-02T21:26:48Z"}, {"text": "Comment on attachment 8689889\nBug 1213517 - add webidl for track.getConstraints() and track.getSettings().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25735/diff/1-2/", "author": "jib@mozilla.com", "id": 11343012, "time": "2016-04-20T23:36:55Z"}, {"text": "Comment on attachment 8689890\nBug 1213517 - split off MediaTaskUtils.h from MediaUtils.h to shed dependencies.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25737/diff/1-2/", "author": "jib@mozilla.com", "id": 11343013, "time": "2016-04-20T23:36:55Z"}, {"text": "Comment on attachment 8689891\nBug 1213517 - make track.applyConstraints() store constraints on success.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25739/diff/2-3/", "author": "jib@mozilla.com", "id": 11343014, "time": "2016-04-20T23:36:55Z"}, {"text": "Comment on attachment 8694859\nBug 1213517 - make getUserMedia store initial constraints on resulting tracks.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/26905/diff/1-2/", "author": "jib@mozilla.com", "id": 11343015, "time": "2016-04-20T23:36:55Z"}, {"text": "Comment on attachment 8689889\nBug 1213517 - add webidl for track.getConstraints() and track.getSettings().\n\nJust a rebase. Carrying forward r=smaug.", "author": "jib@mozilla.com", "id": 11343022, "time": "2016-04-20T23:37:54Z"}, {"text": "Created attachment 8761183\nBug 1213517 - Introduce AllocationHandle to MediaEngine::Allocate().\n\nReview commit: https://reviewboard.mozilla.org/r/58490/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/58490/", "author": "jib@mozilla.com", "id": 11472186, "time": "2016-06-08T12:40:02Z"}, {"text": "Created attachment 8761184\nBug 1213517 - Normalize all the constraints internally, not just some.\n\nReview commit: https://reviewboard.mozilla.org/r/58492/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/58492/", "author": "jib@mozilla.com", "id": 11472187, "time": "2016-06-08T12:40:02Z"}, {"text": "Created attachment 8761185\nBug 1213517 - Add an un-flattened NormalizedConstraints type for downstream use.\n\nReview commit: https://reviewboard.mozilla.org/r/58494/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/58494/", "author": "jib@mozilla.com", "id": 11472188, "time": "2016-06-08T12:40:02Z"}, {"text": "Created attachment 8761186\nBug 1213517 - Use NormalizedConstraints in low-level code.\n\nReview commit: https://reviewboard.mozilla.org/r/58496/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/58496/", "author": "jib@mozilla.com", "id": 11472189, "time": "2016-06-08T12:40:02Z"}, {"text": "Created attachment 8761187\nBug 1213517 - Add a way to merge multiple NormalizedConstraints.\n\nReview commit: https://reviewboard.mozilla.org/r/58498/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/58498/", "author": "jib@mozilla.com", "id": 11472190, "time": "2016-06-08T12:40:02Z"}, {"text": "Created attachment 8761188\nBug 1213517 - Consider competing constraints in getUserMedia+applyConstraints.\n\nReview commit: https://reviewboard.mozilla.org/r/58500/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/58500/", "author": "jib@mozilla.com", "id": 11472191, "time": "2016-06-08T12:40:02Z"}, {"text": "Comment on attachment 8689889\nBug 1213517 - add webidl for track.getConstraints() and track.getSettings().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25735/diff/2-3/", "author": "jib@mozilla.com", "id": 11472192, "time": "2016-06-08T12:40:02Z"}, {"text": "Comment on attachment 8689890\nBug 1213517 - split off MediaTaskUtils.h from MediaUtils.h to shed dependencies.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25737/diff/2-3/", "author": "jib@mozilla.com", "id": 11472193, "time": "2016-06-08T12:40:02Z"}, {"text": "Comment on attachment 8689891\nBug 1213517 - make track.applyConstraints() store constraints on success.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25739/diff/3-4/", "author": "jib@mozilla.com", "id": 11472194, "time": "2016-06-08T12:40:02Z"}, {"text": "Comment on attachment 8694859\nBug 1213517 - make getUserMedia store initial constraints on resulting tracks.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/26905/diff/2-3/", "author": "jib@mozilla.com", "id": 11472195, "time": "2016-06-08T12:40:02Z"}, {"text": "Carrying forward r=smaug (who set flag in bugzilla instead of mozReview).\n\nFirst four patches are unchanged (though heavily rebased).\n\nI got concurrent camera access with constraints to a point where I thought I'd start the review process (I can launch URL fiddle in multiple tabs and have camera accommodate multiple requests as best it can). \n\nMore patches are coming, as I still need to get settings to the main thread, and I have a RefPtr bug with BaseAllocationHandle somewhere (bonus if caught in review ;)\n\nI also need to extend this to mics and screensharing (probably move some code).\n\nTests depend on bug 1088621.", "author": "jib@mozilla.com", "id": 11472214, "time": "2016-06-08T12:48:46Z"}, {"text": "Comment on attachment 8761183\nBug 1213517 - Introduce AllocationHandle to MediaEngine::Allocate().\n\nhttps://reviewboard.mozilla.org/r/58490/#review55380", "author": "rjesup@jesup.org", "id": 11472371, "time": "2016-06-08T13:52:22Z"}, {"text": "Comment on attachment 8761184\nBug 1213517 - Normalize all the constraints internally, not just some.\n\nhttps://reviewboard.mozilla.org/r/58492/#review55384", "author": "rjesup@jesup.org", "id": 11472393, "time": "2016-06-08T13:59:09Z"}, {"text": "Comment on attachment 8761185\nBug 1213517 - Add an un-flattened NormalizedConstraints type for downstream use.\n\nhttps://reviewboard.mozilla.org/r/58494/#review55386\n\n::: dom/media/webrtc/MediaEngineRemoteVideoSource.cpp:451\n(Diff revision 1)\n> -      mCapability.width = ((c.mWidth.mIdeal.WasPassed() ?\n> -        c.mWidth.mIdeal.Value() : 0) & 0xffff) << 16 | (c.mWidth.mMax & 0xffff);\n> -      mCapability.height = ((c.mHeight.mIdeal.WasPassed() ?\n> -        c.mHeight.mIdeal.Value() : 0) & 0xffff) << 16 | (c.mHeight.mMax & 0xffff);\n> +      mCapability.width = (c.mWidth.mIdeal.valueOr(0) & 0xffff) << 16 |\n> +                          (c.mWidth.mMax & 0xffff);\n> +      mCapability.height = (c.mHeight.mIdeal.valueOr(0) & 0xffff) << 16 |\n> +                           (c.mHeight.mMax & 0xffff);\n\nPerhaps a comment about how ideal/max are being encoded into mCapability, since it's non-obvious.  Is there a reason we're not using two 16-bit members? (I realize this was existing usage)", "author": "rjesup@jesup.org", "id": 11472414, "time": "2016-06-08T14:03:28Z"}, {"text": "Thanks!\n\n(In reply to Randell Jesup [:jesup] from comment #31)\n> > +      mCapability.height = (c.mHeight.mIdeal.valueOr(0) & 0xffff) << 16 |\n> > +                           (c.mHeight.mMax & 0xffff);\n> \n> Perhaps a comment about how ideal/max are being encoded into mCapability,\n> since it's non-obvious.  Is there a reason we're not using two 16-bit\n> members? (I realize this was existing usage)\n\nmCapability is used by all devices, whereas this was a hack to a problem unique to screen-sharing, that didn't generalize. See bug 1211656 comment 17.", "author": "jib@mozilla.com", "id": 11473289, "time": "2016-06-08T17:51:54Z"}, {"text": "> mCapability is used by all devices, whereas this was a hack to a problem\n> unique to screen-sharing, that didn't generalize. See bug 1211656 comment 17.\n\nOk.  Sounds worth a 1-liner comment in the code.", "author": "rjesup@jesup.org", "id": 11475837, "time": "2016-06-09T15:43:13Z"}, {"text": "Added, just holding off on refresh for more reviews (need to reset smaug's r+ each time).", "author": "jib@mozilla.com", "id": 11476555, "time": "2016-06-09T19:08:14Z"}, {"text": "Comment on attachment 8761187\nBug 1213517 - Add a way to merge multiple NormalizedConstraints.\n\nhttps://reviewboard.mozilla.org/r/58498/#review55790", "author": "rjesup@jesup.org", "id": 11476989, "time": "2016-06-09T21:45:47Z"}, {"text": "Comment on attachment 8761188\nBug 1213517 - Consider competing constraints in getUserMedia+applyConstraints.\n\nhttps://reviewboard.mozilla.org/r/58500/#review55794", "author": "rjesup@jesup.org", "id": 11476992, "time": "2016-06-09T21:47:18Z"}, {"text": "Comment on attachment 8761186\nBug 1213517 - Use NormalizedConstraints in low-level code.\n\nhttps://reviewboard.mozilla.org/r/58496/#review55796\n\nVery close\n\n::: dom/media/webrtc/MediaEngineCameraVideoSource.cpp:119\n(Diff revision 1)\n>    }\n>  \n>    bool first = true;\n>    for (const MediaTrackConstraintSet* cs : aConstraintSets) {\n>      for (size_t i = 0; i < candidateSet.Length();  ) {\n> +      NormalizedConstraintSet ns(*cs, !first); // XXX: optimize\n\nBug?  how important is optimizing; perhaps a longer comment if not a bug?\n\n::: dom/media/webrtc/MediaEngineRemoteVideoSource.cpp:278\n(Diff revision 1)\n>    if (!mInitDone) {\n>      LOG((\"Init not done\"));\n>      return NS_ERROR_FAILURE;\n>    }\n> -  if (!ChooseCapability(aConstraints, aPrefs, aDeviceId)) {\n> +  MOZ_ASSERT(aHandle);\n> +  RefPtr<AllocationHandle> handle = static_cast<AllocationHandle*>(aHandle);\n\nSo this was passed as a raw ptr....  you take a ref to it here (but not using the type passed in), and then release the ref.  If it was a 0-refcount (new BaseAllocationHandle) object, boom (it's freed).  Why store it in a RefPtr here?  Either pass it in as a RefPtr<>&, or as a raw ptr and don't ref it.  Since this is a shared interface, but they have very different uses here, either remove the param (and make it implicit) or use a raw ptr and don't ref it, I think\n\n::: dom/media/webrtc/MediaEngineTabVideoSource.cpp:151\n(Diff revision 1)\n>    // It has no well-defined behavior in advanced, so ignore it there.\n>  \n>    mWindowId = aConstraints.mBrowserWindow.WasPassed() ?\n>                aConstraints.mBrowserWindow.Value() : -1;\n>    aOutHandle = nullptr;\n> -  return Restart(aConstraints, aPrefs, aDeviceId);\n> +  return Restart(nullptr, aConstraints, aPrefs, aDeviceId);\n\nRestart() has a MOZ_ASSERT that aHandle is not null in RemoteVideoSource, but here we assert it *IS* null.  This is odd.\n\n::: dom/media/webrtc/MediaEngineWebRTCAudio.cpp:271\n(Diff revision 1)\n> -MediaEngineWebRTCMicrophoneSource::Restart(const dom::MediaTrackConstraints& aConstraints,\n> +MediaEngineWebRTCMicrophoneSource::Restart(BaseAllocationHandle* aHandle,\n> +                                           const dom::MediaTrackConstraints& aConstraints,\n>                                             const MediaEnginePrefs &aPrefs,\n>                                             const nsString& aDeviceId)\n>  {\n> +  MOZ_ASSERT(!aHandle);\n\nditto\n\n::: dom/media/webrtc/MediaEngineWebRTCAudio.cpp:852\n(Diff revision 1)\n> +    BaseAllocationHandle* aHandle,\n>      const dom::MediaTrackConstraints& aConstraints,\n>      const MediaEnginePrefs &aPrefs,\n>      const nsString& aDeviceId)\n>  {\n> +  MOZ_ASSERT(!aHandle);\n\nditto\n\n::: dom/media/webrtc/MediaTrackConstraints.cpp:222\n(Diff revision 1)\n>  MediaConstraintsHelper::GetMinimumFitnessDistance(\n>      const dom::MediaTrackConstraintSet &aConstraints,\n>      bool aAdvanced,\n>      const nsString& aDeviceId)\n>  {\n> -  uint64_t distance =\n> +  NormalizedConstraintSet ns(aConstraints, aAdvanced); // XXX\n\nXXX what?", "author": "rjesup@jesup.org", "id": 11477047, "time": "2016-06-09T22:19:16Z"}, {"text": "https://reviewboard.mozilla.org/r/58496/#review55796\n\n> Restart() has a MOZ_ASSERT that aHandle is not null in RemoteVideoSource, but here we assert it *IS* null.  This is odd.\n\nBecause Allocate returns a null handle for TabVideoSource. I've only implemented contraints-averaging through allocationHandles for cameras so far. I should add them to microphones as well, but it's unclear if this generalizes to e.g tab sharing which I'm not sure is a singular shared resource (though it may be implemented as one).", "author": "jib@mozilla.com", "id": 11483462, "time": "2016-06-14T16:41:24Z"}, {"text": "Created attachment 8763464\nBug 1213517 - Consider competing required constraints with OverconstrainedError.\n\nReview commit: https://reviewboard.mozilla.org/r/59652/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/59652/", "author": "jib@mozilla.com", "id": 11489589, "time": "2016-06-20T07:22:33Z"}, {"text": "Created attachment 8763465\nBug 1213517 - Report correct constraint in OverconstrainedError when constraints conflict directly.\n\nReview commit: https://reviewboard.mozilla.org/r/59654/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/59654/", "author": "jib@mozilla.com", "id": 11489590, "time": "2016-06-20T07:22:33Z"}, {"text": "Created attachment 8763466\nBug 1213517 - Normalize even more of the constraints code.\n\nReview commit: https://reviewboard.mozilla.org/r/59656/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/59656/", "author": "jib@mozilla.com", "id": 11489591, "time": "2016-06-20T07:22:33Z"}, {"text": "Created attachment 8763467\nBug 1213517 - Lift correct constraint out of lower-level code for OverconstrainedError.\n\nReview commit: https://reviewboard.mozilla.org/r/59658/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/59658/", "author": "jib@mozilla.com", "id": 11489592, "time": "2016-06-20T07:22:33Z"}, {"text": "Created attachment 8763468\nBug 1213517 - Only restart camera if net settings actually change.\n\nReview commit: https://reviewboard.mozilla.org/r/59660/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/59660/", "author": "jib@mozilla.com", "id": 11489593, "time": "2016-06-20T07:22:33Z"}, {"text": "Created attachment 8763469\nBug 1213517 - Consolidate camera Allocate's and Restart's constraints logic.\n\nReview commit: https://reviewboard.mozilla.org/r/59662/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/59662/", "author": "jib@mozilla.com", "id": 11489594, "time": "2016-06-20T07:22:33Z"}, {"text": "Created attachment 8763470\nBug 1213517 - Let cam access in competing tabs get closer to their ideals when a tab closes.\n\nReview commit: https://reviewboard.mozilla.org/r/59664/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/59664/", "author": "jib@mozilla.com", "id": 11489595, "time": "2016-06-20T07:22:33Z"}, {"text": "Created attachment 8763471\nBug 1213517 - Wire up getSettings().\n\nReview commit: https://reviewboard.mozilla.org/r/59666/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/59666/", "author": "jib@mozilla.com", "id": 11489596, "time": "2016-06-20T07:22:33Z"}, {"text": "Comment on attachment 8761183\nBug 1213517 - Introduce AllocationHandle to MediaEngine::Allocate().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58490/diff/1-2/", "author": "jib@mozilla.com", "id": 11489597, "time": "2016-06-20T07:22:33Z"}, {"text": "Comment on attachment 8761184\nBug 1213517 - Normalize all the constraints internally, not just some.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58492/diff/1-2/", "author": "jib@mozilla.com", "id": 11489598, "time": "2016-06-20T07:22:33Z"}, {"text": "Comment on attachment 8761185\nBug 1213517 - Add an un-flattened NormalizedConstraints type for downstream use.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58494/diff/1-2/", "author": "jib@mozilla.com", "id": 11489599, "time": "2016-06-20T07:22:33Z"}, {"text": "Comment on attachment 8761186\nBug 1213517 - Use NormalizedConstraints in low-level code.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58496/diff/1-2/", "author": "jib@mozilla.com", "id": 11489600, "time": "2016-06-20T07:22:33Z"}, {"text": "Comment on attachment 8761187\nBug 1213517 - Add a way to merge multiple NormalizedConstraints.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58498/diff/1-2/", "author": "jib@mozilla.com", "id": 11489601, "time": "2016-06-20T07:22:33Z"}, {"text": "Comment on attachment 8761188\nBug 1213517 - Consider competing constraints in getUserMedia+applyConstraints.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58500/diff/1-2/", "author": "jib@mozilla.com", "id": 11489602, "time": "2016-06-20T07:22:33Z"}, {"text": "Comment on attachment 8761183\nBug 1213517 - Introduce AllocationHandle to MediaEngine::Allocate().\n\nManually carrying forward r=jesup (see bug 1280858).", "author": "jib@mozilla.com", "id": 11489625, "time": "2016-06-20T08:10:01Z"}, {"text": "Works. Still need to make it work for audio, and then tackle bug 1088621 to test this stuff.\n\nLooking for reviewer victims.", "author": "jib@mozilla.com", "id": 11489632, "time": "2016-06-20T08:14:41Z"}, {"text": "Ollie, you already reviewed this (above comment 9), but could you do me a favor and also hit \"Ship it!\" for that patch [1] from within MozReview? This'll stop spamming you each update, and hopefully enable autoland at the end. Thanks!\n\n[1] https://bugzilla.mozilla.org/attachment.cgi?id=8689889", "author": "jib@mozilla.com", "id": 11489647, "time": "2016-06-20T08:30:09Z"}, {"text": "Comment on attachment 8689889\nBug 1213517 - add webidl for track.getConstraints() and track.getSettings().\n\nhttps://reviewboard.mozilla.org/r/25735/#review56702\n\nI still wonder why we need to add those mozilla specific stuff. Does Hello actually need them for some new functionality? \n\nIs there a bug to sort out the Hello specific properties? If not, could you file it. We should try hard to get rid of mozilla specific properties here, or get them all to some specification.", "author": "bugs@pettay.fi", "id": 11489692, "time": "2016-06-20T09:18:18Z"}, {"text": "https://reviewboard.mozilla.org/r/25735/#review56702\n\ngetSettings() lets sites see the results of constraints they set. It would be weird to not implement it for all constraints we support (a constraints by definition exists in MediaTrackConstraints, MediaTrackSettings and MediaTrackCapabilities (bug 1179084).\n\nHello already uses these constraints, and may now use getSettings() to improve and/or debug their code better.\n\nBot us and Google have our own screensharing APIs atm unfortunately. As to standarizing them, the screensharing spec seems to have stalled, so we or someone needs to breathe life into it again, I think is the first step.", "author": "jib@mozilla.com", "id": 11490939, "time": "2016-06-20T19:25:39Z"}, {"text": "Comment on attachment 8694859\nBug 1213517 - make getUserMedia store initial constraints on resulting tracks.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/26905/diff/3-4/", "author": "jib@mozilla.com", "id": 11496807, "time": "2016-06-23T04:59:34Z"}, {"text": "Comment on attachment 8761183\nBug 1213517 - Introduce AllocationHandle to MediaEngine::Allocate().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58490/diff/2-3/", "author": "jib@mozilla.com", "id": 11496808, "time": "2016-06-23T04:59:34Z"}, {"text": "Comment on attachment 8761184\nBug 1213517 - Normalize all the constraints internally, not just some.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58492/diff/2-3/", "author": "jib@mozilla.com", "id": 11496809, "time": "2016-06-23T04:59:34Z"}, {"text": "Comment on attachment 8761185\nBug 1213517 - Add an un-flattened NormalizedConstraints type for downstream use.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58494/diff/2-3/", "author": "jib@mozilla.com", "id": 11496810, "time": "2016-06-23T04:59:34Z"}, {"text": "Comment on attachment 8761186\nBug 1213517 - Use NormalizedConstraints in low-level code.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58496/diff/2-3/", "author": "jib@mozilla.com", "id": 11496811, "time": "2016-06-23T04:59:34Z"}, {"text": "Comment on attachment 8761187\nBug 1213517 - Add a way to merge multiple NormalizedConstraints.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58498/diff/2-3/", "author": "jib@mozilla.com", "id": 11496812, "time": "2016-06-23T04:59:34Z"}, {"text": "Comment on attachment 8761188\nBug 1213517 - Consider competing constraints in getUserMedia+applyConstraints.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58500/diff/2-3/", "author": "jib@mozilla.com", "id": 11496813, "time": "2016-06-23T04:59:34Z"}, {"text": "Comment on attachment 8763464\nBug 1213517 - Consider competing required constraints with OverconstrainedError.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59652/diff/1-2/", "author": "jib@mozilla.com", "id": 11496814, "time": "2016-06-23T04:59:34Z"}, {"text": "Comment on attachment 8763465\nBug 1213517 - Report correct constraint in OverconstrainedError when constraints conflict directly.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59654/diff/1-2/", "author": "jib@mozilla.com", "id": 11496815, "time": "2016-06-23T04:59:34Z"}, {"text": "Comment on attachment 8763466\nBug 1213517 - Normalize even more of the constraints code.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59656/diff/1-2/", "author": "jib@mozilla.com", "id": 11496816, "time": "2016-06-23T04:59:34Z"}, {"text": "Comment on attachment 8763467\nBug 1213517 - Lift correct constraint out of lower-level code for OverconstrainedError.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59658/diff/1-2/", "author": "jib@mozilla.com", "id": 11496817, "time": "2016-06-23T04:59:34Z"}, {"text": "Comment on attachment 8763468\nBug 1213517 - Only restart camera if net settings actually change.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59660/diff/1-2/", "author": "jib@mozilla.com", "id": 11496818, "time": "2016-06-23T04:59:34Z"}, {"text": "Comment on attachment 8763469\nBug 1213517 - Consolidate camera Allocate's and Restart's constraints logic.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59662/diff/1-2/", "author": "jib@mozilla.com", "id": 11496819, "time": "2016-06-23T04:59:34Z"}, {"text": "Comment on attachment 8763470\nBug 1213517 - Let cam access in competing tabs get closer to their ideals when a tab closes.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59664/diff/1-2/", "author": "jib@mozilla.com", "id": 11496820, "time": "2016-06-23T04:59:34Z"}, {"text": "Comment on attachment 8763471\nBug 1213517 - Wire up getSettings().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59666/diff/1-2/", "author": "jib@mozilla.com", "id": 11496821, "time": "2016-06-23T04:59:34Z"}, {"text": "Comment on attachment 8694859\nBug 1213517 - make getUserMedia store initial constraints on resulting tracks.\n\nManually carrying forward r=jesup (see bug 1280858).", "author": "jib@mozilla.com", "id": 11496828, "time": "2016-06-23T05:03:17Z"}, {"text": "Are there tests for this ?", "author": "padenot@mozilla.com", "id": 11497047, "time": "2016-06-23T08:28:21Z"}, {"text": "Comment on attachment 8763464\nBug 1213517 - Consider competing required constraints with OverconstrainedError.\n\nhttps://reviewboard.mozilla.org/r/59652/#review57210\n\n<p>This is also changing the error that is sent back to content. Looking at github, this is issue #170, PR #188, would be good to split this part off and note the spec changes in the commit message.</p>\n\n::: dom/media/MediaManager.cpp:1188\n(Diff revision 2)\n>  \n>      if (mAudioDevice) {\n> -      rv = mAudioDevice->Allocate(GetInvariant(mConstraints.mAudio),\n> -                                  mPrefs, mOrigin);\n> +      auto& constraints = GetInvariant(mConstraints.mAudio);\n> +      rv = mAudioDevice->Allocate(constraints, mPrefs, mOrigin);\n>        if (NS_FAILED(rv)) {\n> -        LOG((\"Failed to allocate audiosource %d\",rv));\n> +        errorMsg = \"Failed to allocate audiosource\";\n\nAre those supposed to be localizable ?", "author": "padenot@mozilla.com", "id": 11497087, "time": "2016-06-23T08:44:01Z"}, {"text": "Comment on attachment 8763465\nBug 1213517 - Report correct constraint in OverconstrainedError when constraints conflict directly.\n\nhttps://reviewboard.mozilla.org/r/59654/#review57198\n\n::: dom/media/webrtc/MediaTrackConstraints.h:184\n(Diff revision 2)\n>    explicit NormalizedConstraints(const dom::MediaTrackConstraints& aOther);\n>    explicit NormalizedConstraints(\n>        const nsTArray<const NormalizedConstraints*>& aOthers);\n>  \n>    nsTArray<NormalizedConstraintSet> mAdvanced;\n> -  bool mOverconstrained;\n> +  const char* mBadConstraint;\n\nBare pointers make me nervous, but I don't suppose we have a way of ensuring this is always pointing to a literal string?\n\n::: dom/media/webrtc/MediaTrackConstraints.cpp:292\n(Diff revision 2)\n> +    if (!mMozNoiseSuppression.Merge(set.mMozNoiseSuppression)) {\n> +      mBadConstraint = \"mozNoiseSuppression\";\n> +      return;\n> +    }\n> +    if (!mMozAutoGainControl.Merge(set.mMozAutoGainControl)) {\n> +      mBadConstraint = \"mozAutoGainControl\";\n\nDon't we need to use `NS_LITERAL_STRING` here ?\n\n::: dom/media/webrtc/MediaTrackConstraints.cpp:293\n(Diff revision 2)\n> +      mBadConstraint = \"mozNoiseSuppression\";\n> +      return;\n> +    }\n> +    if (!mMozAutoGainControl.Merge(set.mMozAutoGainControl)) {\n> +      mBadConstraint = \"mozAutoGainControl\";\n>        return;\n\nI'd be happier is this would be written by a macro or something.", "author": "padenot@mozilla.com", "id": 11497101, "time": "2016-06-23T08:47:00Z"}, {"text": "Comment on attachment 8763467\nBug 1213517 - Lift correct constraint out of lower-level code for OverconstrainedError.\n\nhttps://reviewboard.mozilla.org/r/59658/#review57214\n\nMaybe the renaming and the consts could have been put in another patch.\n\nCan you add a comment about going from the Engine level to the Device level to get the bad constraint, and why the logic is at the device level in the first place?", "author": "padenot@mozilla.com", "id": 11497163, "time": "2016-06-23T09:12:01Z"}, {"text": "Comment on attachment 8763468\nBug 1213517 - Only restart camera if net settings actually change.\n\nhttps://reviewboard.mozilla.org/r/59660/#review57216\n\n::: dom/media/webrtc/MediaEngineCameraVideoSource.cpp:411\n(Diff revision 2)\n> +};\n> +\n> +bool operator != (const webrtc::CaptureCapability& a,\n> +                  const webrtc::CaptureCapability& b)\n> +{\n> +  return !operator == (a, b);\n\nWould simply !(a == b) work ?\n\n::: dom/media/webrtc/MediaEngineRemoteVideoSource.h:126\n(Diff revision 2)\n>    void Init();\n>    size_t NumCapabilities() const override;\n>    void GetCapability(size_t aIndex, webrtc::CaptureCapability& aOut) const override;\n>  \n> +  nsresult\n> +  UpdateLive(AllocationHandle* aOldHandle,\n\nComment here. In particular, mention that aOldHandle can be `nullptr` if we are calling it for the first time.\n\n::: dom/media/webrtc/MediaEngineRemoteVideoSource.h:136\n(Diff revision 2)\n> +\n>    dom::MediaSourceEnum mMediaSource; // source of media (camera | application | screen)\n>    mozilla::camera::CaptureEngine mCapEngine;\n>  \n>    nsTArray<RefPtr<AllocationHandle>> mRegisteredHandles;\n> +  webrtc::CaptureCapability mLastCapability;\n\nComment here.\n\n::: dom/media/webrtc/MediaEngineRemoteVideoSource.cpp:344\n(Diff revision 2)\n> -    LOG((\"StartCapture failed\"));\n> +      LOG((\"StartCapture failed\"));\n> -    return NS_ERROR_FAILURE;\n> +      return NS_ERROR_FAILURE;\n> -  }\n> +    }\n> -  handle->mConstraints = temp->mConstraints;\n> +    mLastCapability = mCapability;\n> +  }\n> +  aOldHandle->mConstraints = aNewHandle->mConstraints;\n\nWhat if `aOldHandle` is `nullptr` here? If this cannot happend, maybe we could put in an assert with a message.", "author": "padenot@mozilla.com", "id": 11497215, "time": "2016-06-23T09:33:20Z"}, {"text": "Comment on attachment 8763469\nBug 1213517 - Consolidate camera Allocate's and Restart's constraints logic.\n\nhttps://reviewboard.mozilla.org/r/59662/#review57218\n\n::: dom/media/webrtc/MediaEngineRemoteVideoSource.h:74\n(Diff revision 2)\n>    // MediaEngineCameraVideoSource\n>    MediaEngineRemoteVideoSource(int aIndex, mozilla::camera::CaptureEngine aCapEngine,\n>                                 dom::MediaSourceEnum aMediaSource,\n>                                 const char* aMonitorName = \"RemoteVideo.Monitor\");\n>  \n>    class AllocationHandle : public BaseAllocationHandle\n\nThis is not simply an \"Allocation Handle\" anymore, it's keeping more state and has become more specific.\n\n::: dom/media/webrtc/MediaEngineRemoteVideoSource.cpp:119\n(Diff revision 2)\n> -  if (netConstraints.mBadConstraint) {\n> -    *aOutBadConstraint = netConstraints.mBadConstraint;\n> -    return NS_ERROR_NOT_AVAILABLE;\n> -  }\n>  \n> -  if (!ChooseCapability(netConstraints, aPrefs, aDeviceId)) {\n> +  nsresult rv = Update(nullptr, handle, aPrefs, aDeviceId, aOutBadConstraint);\n\nI don't like nullptr at call sites too much, it's hard to know what the param would normally be.\n\nI think we should make a function that wraps `Update`, and that curries the first argument, with a meaningful name.", "author": "padenot@mozilla.com", "id": 11497246, "time": "2016-06-23T09:41:17Z"}, {"text": "Comment on attachment 8763470\nBug 1213517 - Let cam access in competing tabs get closer to their ideals when a tab closes.\n\nhttps://reviewboard.mozilla.org/r/59664/#review57220\n\n::: dom/media/webrtc/MediaEngineRemoteVideoSource.cpp:180\n(Diff revision 2)\n> +    MOZ_ASSERT(mRegisteredHandles.Length());\n> +    if (!mInShutdown) {\n> +      // Whenever constraints are removed, other parties may get closer to ideal.\n> +      auto& first = mRegisteredHandles[0];\n> +      const char* badConstraint = nullptr;\n> +      return Update(nullptr, nullptr,\n\nSame deal, we should have a descriptive name here.", "author": "padenot@mozilla.com", "id": 11497249, "time": "2016-06-23T09:42:56Z"}, {"text": "Comment on attachment 8763471\nBug 1213517 - Wire up getSettings().\n\nhttps://reviewboard.mozilla.org/r/59666/#review57206\n\n::: dom/media/MediaStreamTrack.h:140\n(Diff revision 2)\n>                     const dom::MediaTrackConstraints& aConstraints);\n>  \n>    /**\n> +   * Same for GetSettings (no-op).\n> +   */\n> +\n\nnit: stray new line.\n\n::: dom/media/webrtc/MediaEngine.h:200\n(Diff revision 2)\n>  \n>    virtual uint32_t GetBestFitnessDistance(\n>        const nsTArray<const NormalizedConstraintSet*>& aConstraintSets,\n>        const nsString& aDeviceId) const = 0;\n>  \n> +  // Main-thread only.\n\nAssert it.", "author": "padenot@mozilla.com", "id": 11497267, "time": "2016-06-23T09:48:44Z"}, {"text": "Comment on attachment 8763466\nBug 1213517 - Normalize even more of the constraints code.\n\nhttps://reviewboard.mozilla.org/r/59656/#review57202\n\n::: dom/media/webrtc/MediaEngineCameraVideoSource.cpp:271\n(Diff revision 2)\n>      }\n>      if (!candidateSet.Length()) {\n>        candidateSet.AppendElements(Move(rejects));\n>      }\n>    }\n> -  if (!candidateSet.Length()) {\n> +  MOZ_ASSERT(candidateSet.Length());\n\nDocument this invariant with a message.", "author": "padenot@mozilla.com", "id": 11497423, "time": "2016-06-23T11:52:12Z"}, {"text": "This patch set would benefit from more splitting between functional changes and cleanups, and from more comments and descriptive commit messages, I think.", "author": "padenot@mozilla.com", "id": 11497689, "time": "2016-06-23T13:11:01Z"}, {"text": "Thanks!\n\n(In reply to Paul Adenot (:padenot) from comment #74)\n> Are there tests for this ?\n\nAs I mentioned in comment 28 I need to do bug 1088621 next before we can write tree tests. Even then, those tests will be testing the default (fake) device rather than actual devices.\n\nSo I've manually tested getSettings() and cross-tab ideal averaging on real devices (Logitech 930e on OSX, and soon on Win10 and Android when I get a chance), using the URL fiddle in multiple tabs.\n\nI've also tested conflicting required constraints using these in different tabs:\n\n - gum test conflict max 320  https://jsfiddle.net/mxkpaq7z/\n - gum test conflict min 640  https://jsfiddle.net/1w209kg7/\n\nI also still need to extend this to mics and screensharing, which I'll do asap, though I'd love to land the camera side soon, to avoid the patch set growing much larger, as it is starting to become a pain.\n\nI am committed to getting it all in this cycle.", "author": "jib@mozilla.com", "id": 11498649, "time": "2016-06-23T17:42:12Z"}, {"text": "https://reviewboard.mozilla.org/r/59652/#review57210\n\nFiled bug 1281866.\n\n> Are those supposed to be localizable ?\n\nNo, neither log messages nor DOM errors are localized (Bz says we do not want web-exposed behavior to differ by locale).", "author": "jib@mozilla.com", "id": 11498924, "time": "2016-06-23T18:15:13Z"}, {"text": "https://reviewboard.mozilla.org/r/59654/#review57198\n\n> Bare pointers make me nervous, but I don't suppose we have a way of ensuring this is always pointing to a literal string?\n\nUnfortunately, no. A const char array reference would require a fixed size (worse issues), whereas an enum would need mappings to string somewhere, which would be another thing to update every time someone adds a new constraint, something I want to avoid as much as possible.\n\nIf it helps, this is an existing pattern: https://dxr.mozilla.org/mozilla-central/search?q=badConstraint\n\n> Don't we need to use `NS_LITERAL_STRING` here ?\n\nNo, mBadConstraint is a const char*, not an nsString.\n\n> I'd be happier is this would be written by a macro or something.\n\nMacros make me sad. Let me see if I can condense it another way.", "author": "jib@mozilla.com", "id": 11499026, "time": "2016-06-23T18:52:58Z"}, {"text": "https://reviewboard.mozilla.org/r/59654/#review57198\n\n> Macros make me sad. Let me see if I can condense it another way.\n\nOK so I took a big detour on this. As a goal, I wanted there to be just one place one needs to update to add new constraints, and have the constraints algorithm automatically work for it.\n\nThe resulting patch is a bit sick, but uses no macros, so I put it in the win column. Hopefully you do as well. :)\n\nI also spent time tracking down unrelated leaks and a crash, which is reflected by updates to some of the earlier patches.", "author": "jib@mozilla.com", "id": 11521058, "time": "2016-07-04T13:39:08Z"}, {"text": "Created attachment 8767669\nBug 1213517 - optimize for maintenance of constraints (member pointer approach).\n\nReview commit: https://reviewboard.mozilla.org/r/62102/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/62102/", "author": "jib@mozilla.com", "id": 11521123, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8689889\nBug 1213517 - add webidl for track.getConstraints() and track.getSettings().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25735/diff/3-4/", "author": "jib@mozilla.com", "id": 11521124, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8689890\nBug 1213517 - split off MediaTaskUtils.h from MediaUtils.h to shed dependencies.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25737/diff/3-4/", "author": "jib@mozilla.com", "id": 11521125, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8689891\nBug 1213517 - make track.applyConstraints() store constraints on success.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25739/diff/4-5/", "author": "jib@mozilla.com", "id": 11521126, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8694859\nBug 1213517 - make getUserMedia store initial constraints on resulting tracks.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/26905/diff/4-5/", "author": "jib@mozilla.com", "id": 11521127, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8761183\nBug 1213517 - Introduce AllocationHandle to MediaEngine::Allocate().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58490/diff/3-4/", "author": "jib@mozilla.com", "id": 11521128, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8761184\nBug 1213517 - Normalize all the constraints internally, not just some.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58492/diff/3-4/", "author": "jib@mozilla.com", "id": 11521129, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8761185\nBug 1213517 - Add an un-flattened NormalizedConstraints type for downstream use.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58494/diff/3-4/", "author": "jib@mozilla.com", "id": 11521130, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8761186\nBug 1213517 - Use NormalizedConstraints in low-level code.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58496/diff/3-4/", "author": "jib@mozilla.com", "id": 11521131, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8761187\nBug 1213517 - Add a way to merge multiple NormalizedConstraints.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58498/diff/3-4/", "author": "jib@mozilla.com", "id": 11521132, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8761188\nBug 1213517 - Consider competing constraints in getUserMedia+applyConstraints.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58500/diff/3-4/", "author": "jib@mozilla.com", "id": 11521133, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8763464\nBug 1213517 - Consider competing required constraints with OverconstrainedError.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59652/diff/2-3/", "author": "jib@mozilla.com", "id": 11521134, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8763465\nBug 1213517 - Report correct constraint in OverconstrainedError when constraints conflict directly.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59654/diff/2-3/", "author": "jib@mozilla.com", "id": 11521135, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8763466\nBug 1213517 - Normalize even more of the constraints code.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59656/diff/2-3/", "author": "jib@mozilla.com", "id": 11521136, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8763467\nBug 1213517 - Lift correct constraint out of lower-level code for OverconstrainedError.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59658/diff/2-3/", "author": "jib@mozilla.com", "id": 11521137, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8763468\nBug 1213517 - Only restart camera if net settings actually change.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59660/diff/2-3/", "author": "jib@mozilla.com", "id": 11521138, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8763469\nBug 1213517 - Consolidate camera Allocate's and Restart's constraints logic.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59662/diff/2-3/", "author": "jib@mozilla.com", "id": 11521139, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8763470\nBug 1213517 - Let cam access in competing tabs get closer to their ideals when a tab closes.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59664/diff/2-3/", "author": "jib@mozilla.com", "id": 11521140, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8763471\nBug 1213517 - Wire up getSettings().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59666/diff/2-3/", "author": "jib@mozilla.com", "id": 11521141, "time": "2016-07-04T14:04:19Z"}, {"text": "Comment on attachment 8763465\nBug 1213517 - Report correct constraint in OverconstrainedError when constraints conflict directly.\n\nhttps://reviewboard.mozilla.org/r/59654/#review59036\n\n::: dom/media/webrtc/MediaTrackConstraints.h:134\n(Diff revisions 1 - 3)\n>          return false;\n>        }\n>        Intersect(aOther);\n>  \n>        for (auto& entry : aOther.mIdeal) {\n> -        if (!mIdeal.Contains(entry)) {\n> +        if (mIdeal.find(entry) == mIdeal.end()) {\n\nThis is now a set, you can just insert without checking if the element is present, it's going to deduplicate automatically.\n\nAlso, https://www.sgi.com/tech/stl/set_union.html\n\n::: dom/media/webrtc/MediaTrackConstraints.cpp:219\n(Diff revisions 1 - 3)\n> -  if (!aOther.mExact.Length()) {\n> +  if (!aOther.mExact.size()) {\n>      return;\n>    }\n>    for (auto& entry : mExact) {\n> -    if (!aOther.mExact.Contains(entry)) {\n> -      mExact.RemoveElement(entry);\n> +    if (aOther.mExact.find(entry) == aOther.mExact.end()) {\n> +      mExact.erase(entry);\n\nBecause those are `std::set`, intersection is already implemented for you.\n\nhttps://www.sgi.com/tech/stl/set_intersection.html", "author": "padenot@mozilla.com", "id": 11522720, "time": "2016-07-05T09:06:52Z"}, {"text": "Comment on attachment 8767669\nBug 1213517 - optimize for maintenance of constraints (member pointer approach).\n\nhttps://reviewboard.mozilla.org/r/62102/#review59040", "author": "padenot@mozilla.com", "id": 11522771, "time": "2016-07-05T09:18:32Z"}, {"text": "Comment on attachment 8763468\nBug 1213517 - Only restart camera if net settings actually change.\n\nhttps://reviewboard.mozilla.org/r/59660/#review59042", "author": "padenot@mozilla.com", "id": 11522774, "time": "2016-07-05T09:19:29Z"}, {"text": "Comment on attachment 8763469\nBug 1213517 - Consolidate camera Allocate's and Restart's constraints logic.\n\nhttps://reviewboard.mozilla.org/r/59662/#review59044", "author": "padenot@mozilla.com", "id": 11522796, "time": "2016-07-05T09:29:46Z"}, {"text": "Comment on attachment 8763470\nBug 1213517 - Let cam access in competing tabs get closer to their ideals when a tab closes.\n\nhttps://reviewboard.mozilla.org/r/59664/#review59048", "author": "padenot@mozilla.com", "id": 11522800, "time": "2016-07-05T09:30:54Z"}, {"text": "Comment on attachment 8763465\nBug 1213517 - Report correct constraint in OverconstrainedError when constraints conflict directly.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59654/diff/3-4/", "author": "jib@mozilla.com", "id": 11524529, "time": "2016-07-05T19:25:40Z"}, {"text": "Comment on attachment 8767669\nBug 1213517 - optimize for maintenance of constraints (member pointer approach).\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/62102/diff/1-2/", "author": "jib@mozilla.com", "id": 11524530, "time": "2016-07-05T19:25:40Z"}, {"text": "Comment on attachment 8763466\nBug 1213517 - Normalize even more of the constraints code.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59656/diff/3-4/", "author": "jib@mozilla.com", "id": 11524531, "time": "2016-07-05T19:25:40Z"}, {"text": "Comment on attachment 8763467\nBug 1213517 - Lift correct constraint out of lower-level code for OverconstrainedError.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59658/diff/3-4/", "author": "jib@mozilla.com", "id": 11524532, "time": "2016-07-05T19:25:40Z"}, {"text": "Comment on attachment 8763468\nBug 1213517 - Only restart camera if net settings actually change.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59660/diff/3-4/", "author": "jib@mozilla.com", "id": 11524533, "time": "2016-07-05T19:25:40Z"}, {"text": "Comment on attachment 8763469\nBug 1213517 - Consolidate camera Allocate's and Restart's constraints logic.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59662/diff/3-4/", "author": "jib@mozilla.com", "id": 11524534, "time": "2016-07-05T19:25:40Z"}, {"text": "Comment on attachment 8763470\nBug 1213517 - Let cam access in competing tabs get closer to their ideals when a tab closes.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59664/diff/3-4/", "author": "jib@mozilla.com", "id": 11524535, "time": "2016-07-05T19:25:40Z"}, {"text": "Comment on attachment 8763471\nBug 1213517 - Wire up getSettings().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59666/diff/3-4/", "author": "jib@mozilla.com", "id": 11524536, "time": "2016-07-05T19:25:40Z"}, {"text": "Weird,\n\ncomment 112 through comment 115 all show the same change, while comment 116 through comment 119 are duds.", "author": "jib@mozilla.com", "id": 11524566, "time": "2016-07-05T19:33:30Z"}, {"text": "Comment on attachment 8763465\nBug 1213517 - Report correct constraint in OverconstrainedError when constraints conflict directly.\n\nhttps://reviewboard.mozilla.org/r/59654/#review59352", "author": "padenot@mozilla.com", "id": 11527063, "time": "2016-07-06T12:16:11Z"}, {"text": "https://reviewboard.mozilla.org/r/58496/#review55796\n\n> ditto\n\nGoing to add microphone in a follow-up bug.\n\n> ditto\n\nGoing to add microphone in a follow-up bug.", "author": "jib@mozilla.com", "id": 11531583, "time": "2016-07-07T18:28:33Z"}, {"text": "Created attachment 8768892\nBug 1213517 - Make applyConstraints() and getSettings() do nothing after stop and shutdown.\n\nReview commit: https://reviewboard.mozilla.org/r/62894/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/62894/", "author": "jib@mozilla.com", "id": 11531737, "time": "2016-07-07T19:13:48Z"}, {"text": "Created attachment 8768893\nBug 1213517 - Clamp competing ideal values before considering them to avoid outliers distorting result.\n\nReview commit: https://reviewboard.mozilla.org/r/62896/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/62896/", "author": "jib@mozilla.com", "id": 11531738, "time": "2016-07-07T19:13:48Z"}, {"text": "Created attachment 8768894\nBug 1213517 - Take highest ideal value from competing width, height and frameRate.\n\nReview commit: https://reviewboard.mozilla.org/r/62898/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/62898/", "author": "jib@mozilla.com", "id": 11531739, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8689889\nBug 1213517 - add webidl for track.getConstraints() and track.getSettings().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25735/diff/4-5/", "author": "jib@mozilla.com", "id": 11531740, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8689890\nBug 1213517 - split off MediaTaskUtils.h from MediaUtils.h to shed dependencies.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25737/diff/4-5/", "author": "jib@mozilla.com", "id": 11531741, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8689891\nBug 1213517 - make track.applyConstraints() store constraints on success.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25739/diff/5-6/", "author": "jib@mozilla.com", "id": 11531742, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8694859\nBug 1213517 - make getUserMedia store initial constraints on resulting tracks.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/26905/diff/5-6/", "author": "jib@mozilla.com", "id": 11531743, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8761183\nBug 1213517 - Introduce AllocationHandle to MediaEngine::Allocate().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58490/diff/4-5/", "author": "jib@mozilla.com", "id": 11531744, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8761184\nBug 1213517 - Normalize all the constraints internally, not just some.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58492/diff/4-5/", "author": "jib@mozilla.com", "id": 11531745, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8761185\nBug 1213517 - Add an un-flattened NormalizedConstraints type for downstream use.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58494/diff/4-5/", "author": "jib@mozilla.com", "id": 11531746, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8761186\nBug 1213517 - Use NormalizedConstraints in low-level code.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58496/diff/4-5/", "author": "jib@mozilla.com", "id": 11531747, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8761187\nBug 1213517 - Add a way to merge multiple NormalizedConstraints.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58498/diff/4-5/", "author": "jib@mozilla.com", "id": 11531748, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8761188\nBug 1213517 - Consider competing constraints in getUserMedia+applyConstraints.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58500/diff/4-5/", "author": "jib@mozilla.com", "id": 11531749, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8763464\nBug 1213517 - Consider competing required constraints with OverconstrainedError.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59652/diff/3-4/", "author": "jib@mozilla.com", "id": 11531750, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8763465\nBug 1213517 - Report correct constraint in OverconstrainedError when constraints conflict directly.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59654/diff/4-5/", "author": "jib@mozilla.com", "id": 11531751, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8767669\nBug 1213517 - optimize for maintenance of constraints (member pointer approach).\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/62102/diff/2-3/", "author": "jib@mozilla.com", "id": 11531752, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8763466\nBug 1213517 - Normalize even more of the constraints code.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59656/diff/4-5/", "author": "jib@mozilla.com", "id": 11531753, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8763467\nBug 1213517 - Lift correct constraint out of lower-level code for OverconstrainedError.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59658/diff/4-5/", "author": "jib@mozilla.com", "id": 11531754, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8763468\nBug 1213517 - Only restart camera if net settings actually change.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59660/diff/4-5/", "author": "jib@mozilla.com", "id": 11531755, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8763469\nBug 1213517 - Consolidate camera Allocate's and Restart's constraints logic.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59662/diff/4-5/", "author": "jib@mozilla.com", "id": 11531756, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8763470\nBug 1213517 - Let cam access in competing tabs get closer to their ideals when a tab closes.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59664/diff/4-5/", "author": "jib@mozilla.com", "id": 11531757, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8763471\nBug 1213517 - Wire up getSettings().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59666/diff/4-5/", "author": "jib@mozilla.com", "id": 11531758, "time": "2016-07-07T19:13:48Z"}, {"text": "Comment on attachment 8763469\nBug 1213517 - Consolidate camera Allocate's and Restart's constraints logic.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59662/diff/5-6/", "author": "jib@mozilla.com", "id": 11531761, "time": "2016-07-07T19:14:13Z"}, {"text": "Comment on attachment 8763470\nBug 1213517 - Let cam access in competing tabs get closer to their ideals when a tab closes.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59664/diff/5-6/", "author": "jib@mozilla.com", "id": 11531762, "time": "2016-07-07T19:14:13Z"}, {"text": "Comment on attachment 8763471\nBug 1213517 - Wire up getSettings().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59666/diff/5-6/", "author": "jib@mozilla.com", "id": 11531763, "time": "2016-07-07T19:14:13Z"}, {"text": "Comment on attachment 8768892\nBug 1213517 - Make applyConstraints() and getSettings() do nothing after stop and shutdown.\n\nReview commit: https://reviewboard.mozilla.org/r/62894/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/62894/", "author": "jib@mozilla.com", "id": 11531764, "time": "2016-07-07T19:14:13Z"}, {"text": "Comment on attachment 8768893\nBug 1213517 - Clamp competing ideal values before considering them to avoid outliers distorting result.\n\nReview commit: https://reviewboard.mozilla.org/r/62896/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/62896/", "author": "jib@mozilla.com", "id": 11531765, "time": "2016-07-07T19:14:13Z"}, {"text": "Comment on attachment 8768894\nBug 1213517 - Take highest ideal value from competing width, height and frameRate.\n\nReview commit: https://reviewboard.mozilla.org/r/62898/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/62898/", "author": "jib@mozilla.com", "id": 11531766, "time": "2016-07-07T19:14:13Z"}, {"text": "Gah! All this moz review noise! I just rebased the patches, and forgot one r? so it spammed twice. :(", "author": "jib@mozilla.com", "id": 11531771, "time": "2016-07-07T19:15:41Z"}, {"text": "Comment on attachment 8768894\nBug 1213517 - Take highest ideal value from competing width, height and frameRate.\n\nOK so the last patch, \"Take highest ideal value from competing width, height and frameRate\", has the behavior several of us argued they wanted instead of taking the average of competing ideal values.\n\nThat said, I don't like it much, as it causes some surprising results on my Logitech C910 in not-entirely edge cases, like this one:\n\n  1. Open https://jsfiddle.net/7udgdbbu/ in two tabs, and allow camera in both.\n  2. In tab B, click [640] button to get 640x480.\n\n  Expected result: 640x480x30\n  Actual result: 1024x576x10\n\nThis isn't a bug, but a result of the opening constraints in this JS fiddle specifying frameRate: 10, and the others not:\n\n  Tab A has { width: 160, height: 120, frameRate: 10 }\n  Tab B has { width: 640, height: 480 }\n\nproducing:  { width: 640, height: 480, frameRate: 10 }\n\nwhich, incidentally even today, yields 1024x576x10 on my Logitech C910, due to the spec's fitness distance algorithm:\n\n> D/MediaManager Constraints: width: { min: -2147483647, max: 2147483647, ideal: 640 }\n> D/MediaManager              height: { min: -2147483647, max: 2147483647, ideal: 480 }\n> D/MediaManager              frameRate: { min: -inf, max: inf, ideal: 10.000000 }\n> D/MediaManager Capability:  160 x  120 x 30 maxFps, MJPEG, Unknown codec. Distance = 2166\n> D/MediaManager Capability:  176 x  144 x 30 maxFps, MJPEG, Unknown codec. Distance = 2091\n> D/MediaManager Capability:  320 x  176 x 30 maxFps, MJPEG, Unknown codec. Distance = 1799\n> D/MediaManager Capability:  320 x  240 x 60 maxFps, MJPEG, Unknown codec. Distance = 1833\n> D/MediaManager Capability:  352 x  288 x 30 maxFps, MJPEG, Unknown codec. Distance = 1516\n> D/MediaManager Capability:  432 x  240 x 30 maxFps, MJPEG, Unknown codec. Distance = 1491\n> D/MediaManager Capability:  544 x  288 x 30 maxFps, MJPEG, Unknown codec. Distance = 1216\n> D/MediaManager Capability:  640 x  480 x 60 maxFps, MJPEG, Unknown codec. Distance = 833\n> D/MediaManager Capability:  752 x  416 x 30 maxFps, MJPEG, Unknown codec. Distance = 947\n> D/MediaManager Capability:  800 x  448 x 30 maxFps, MJPEG, Unknown codec. Distance = 932\n> D/MediaManager Capability:  864 x  480 x 30 maxFps, MJPEG, Unknown codec. Distance = 925\n> D/MediaManager Capability:  800 x  600 x 30 maxFps, MJPEG, Unknown codec. Distance = 1066\n> D/MediaManager Capability:  960 x  544 x 30 maxFps, MJPEG, Unknown codec. Distance = 1116\n> D/MediaManager Capability: 1024 x  576 x 30 maxFps, MJPEG, Unknown codec. Distance = 1207\n> D/MediaManager Capability:  960 x  720 x 30 maxFps, MJPEG, Unknown codec. Distance = 1332\n> D/MediaManager Capability: 1184 x  656 x 30 maxFps, MJPEG, Unknown codec. Distance = 1393\n> D/MediaManager Capability: 1280 x  720 x 30 maxFps, MJPEG, Unknown codec. Distance = 1499\n> D/MediaManager Capability: 1392 x  768 x 15 maxFps, MJPEG, Unknown codec. Distance = 1248\n> D/MediaManager Capability: 1280 x  960 x 15 maxFps, MJPEG, Unknown codec. Distance = 1333\n> D/MediaManager Capability: 1504 x  832 x 15 maxFps, MJPEG, Unknown codec. Distance = 1330\n> D/MediaManager Capability: 1600 x  896 x 15 maxFps, MJPEG, Unknown codec. Distance = 1397\n> D/MediaManager Capability: 1712 x  960 x 15 maxFps, MJPEG, Unknown codec. Distance = 1459\n> D/MediaManager Capability: 1792 x 1008 x 15 maxFps, MJPEG, Unknown codec. Distance = 1498\n> D/MediaManager Capability: 1600 x 1200 x 15 maxFps, MJPEG, Unknown codec. Distance = 1533\n> D/MediaManager Capability: 1920 x 1080 x 30 maxFps, MJPEG, Unknown codec. Distance = 1887\n> D/MediaManager Capability: 2048 x 1536 x 15 maxFps, MJPEG, Unknown codec. Distance = 1707\n> D/MediaManager Capability: 2592 x 1944 x 10 maxFps, MJPEG, Unknown codec. Distance = 1506\n> D/MediaManager Capability:  160 x  120 x 30 maxFps, YUY2, Unknown codec. Distance = 2166\n> D/MediaManager Capability:  176 x  144 x 30 maxFps, YUY2, Unknown codec. Distance = 2091\n> D/MediaManager Capability:  320 x  176 x 30 maxFps, YUY2, Unknown codec. Distance = 1799\n> D/MediaManager Capability:  320 x  240 x 30 maxFps, YUY2, Unknown codec. Distance = 1666\n> D/MediaManager Capability:  352 x  288 x 30 maxFps, YUY2, Unknown codec. Distance = 1516\n> D/MediaManager Capability:  432 x  240 x 30 maxFps, YUY2, Unknown codec. Distance = 1491\n> D/MediaManager Capability:  544 x  288 x 30 maxFps, YUY2, Unknown codec. Distance = 1216\n> D/MediaManager Capability:  640 x  480 x 30 maxFps, YUY2, Unknown codec. Distance = 666\n> D/MediaManager Capability:  752 x  416 x 24 maxFps, YUY2, Unknown codec. Distance = 864\n> D/MediaManager Capability:  800 x  448 x 24 maxFps, YUY2, Unknown codec. Distance = 849\n> D/MediaManager Capability:  864 x  480 x 20 maxFps, YUY2, Unknown codec. Distance = 759\n> D/MediaManager Capability:  800 x  600 x 20 maxFps, YUY2, Unknown codec. Distance = 900\n> D/MediaManager Capability:  960 x  544 x 20 maxFps, YUY2, Unknown codec. Distance = 950\n> D/MediaManager Capability: 1024 x  576 x 10 maxFps, YUY2, Unknown codec. Distance = 541\n> D/MediaManager Capability:  960 x  720 x 15 maxFps, YUY2, Unknown codec. Distance = 999\n> D/MediaManager Capability: 1184 x  656 x 10 maxFps, YUY2, Unknown codec. Distance = 727\n> D/MediaManager Chosen capability: 1024 x  576 x 10 maxFps, YUY2, Unknown codec. Distance = 541\n\nQuite surprising, given that none of the two tabs would have gone that high up on their own!\n\nI predict this is going to happen a lot, because\n\n  A) lower (max?) frame rates seem to typically exist for higher resolutions, and\n  B) the frameRate constraint seems to be used mostly to reduce frame rate (since default is 30)\n\nI argue this is less likely to happen with averaging, since it wont hit the highest resolutions where frame rates interfere, and would also be less surprising, since averaging is an understandable implementation of compromise, whereas the above edge-pushing behavior is not.\n\nI think this is an inherent flaw in the \"Take highest ideal value\" algorithm, so I vote for averaging.", "author": "jib@mozilla.com", "id": 11531774, "time": "2016-07-07T19:16:23Z"}, {"text": "Alternative: unspecified framerate could internally be represented as ideal: 30, since that's what everyone's code assumes.  Alternatively (though still surprising to users) would be to consider any framerate which we can decimate down to the requested rate to be an \"exact\" match, and add a small amount of code to decimate it.  Thus you're get { 640, 480, 10 } -> 640x480@30 decimated to 10.  With a small amount of additional smarts we could decimate only the stream that asked for 10.  \n\nNote that for decimation we'd want to stick to integer decimation values to avoid jerky framerates i.e. 30 can yield 15, 10, 6, 5, 3, 2 and 1, but not 20.  (you could include /4 -> 7.5fps, /7 -> 4.28..., /8 -> 3.75, etc).  Decimation is pretty trivial to implement.\n\nAlso: 640x480@30 as a mode from the camera *lies*.  With most cameras, it's *max* 30, but the actual framerate will vary as the lighting changes, even down to 5fps.  So taking framerates in the returned data too seriously is a mistake.  :-(\n\nProbably the best (without per-track scaling) is take the highest framerate (with unspecified = 30), then decimate for any track where the ideal is lower.  Note that the decimation has to be dynamic, not 1 of N, because the input rate isn't actually the requested rate.  There's code in webrtc.org to monitor and decimate framerates we can use and/or copy.", "author": "rjesup@jesup.org", "id": 11546282, "time": "2016-07-13T20:28:40Z"}, {"text": "Comment on attachment 8768892\nBug 1213517 - Make applyConstraints() and getSettings() do nothing after stop and shutdown.\n\nmanually r+ since RB gives 500 Server Error trying to finish the review", "author": "rjesup@jesup.org", "id": 11546286, "time": "2016-07-13T20:30:14Z"}, {"text": "Comment on attachment 8768894\nBug 1213517 - Take highest ideal value from competing width, height and frameRate.\n\nr+.  However, please note my comments in the bug; I think we should set unspecified framerate to 30, and probably consider a separate patch/bug to decimate framerates when lower is requested.", "author": "rjesup@jesup.org", "id": 11546304, "time": "2016-07-13T20:36:49Z"}, {"text": "Comment on attachment 8689889\nBug 1213517 - add webidl for track.getConstraints() and track.getSettings().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25735/diff/5-6/", "author": "jib@mozilla.com", "id": 11549152, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8689890\nBug 1213517 - split off MediaTaskUtils.h from MediaUtils.h to shed dependencies.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25737/diff/5-6/", "author": "jib@mozilla.com", "id": 11549153, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8689891\nBug 1213517 - make track.applyConstraints() store constraints on success.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25739/diff/6-7/", "author": "jib@mozilla.com", "id": 11549154, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8694859\nBug 1213517 - make getUserMedia store initial constraints on resulting tracks.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/26905/diff/6-7/", "author": "jib@mozilla.com", "id": 11549155, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8761183\nBug 1213517 - Introduce AllocationHandle to MediaEngine::Allocate().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58490/diff/5-6/", "author": "jib@mozilla.com", "id": 11549156, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8761184\nBug 1213517 - Normalize all the constraints internally, not just some.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58492/diff/5-6/", "author": "jib@mozilla.com", "id": 11549157, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8761185\nBug 1213517 - Add an un-flattened NormalizedConstraints type for downstream use.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58494/diff/5-6/", "author": "jib@mozilla.com", "id": 11549158, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8761186\nBug 1213517 - Use NormalizedConstraints in low-level code.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58496/diff/5-6/", "author": "jib@mozilla.com", "id": 11549159, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8761187\nBug 1213517 - Add a way to merge multiple NormalizedConstraints.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58498/diff/5-6/", "author": "jib@mozilla.com", "id": 11549160, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8761188\nBug 1213517 - Consider competing constraints in getUserMedia+applyConstraints.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58500/diff/5-6/", "author": "jib@mozilla.com", "id": 11549161, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8763464\nBug 1213517 - Consider competing required constraints with OverconstrainedError.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59652/diff/4-5/", "author": "jib@mozilla.com", "id": 11549162, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8763465\nBug 1213517 - Report correct constraint in OverconstrainedError when constraints conflict directly.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59654/diff/5-6/", "author": "jib@mozilla.com", "id": 11549163, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8767669\nBug 1213517 - optimize for maintenance of constraints (member pointer approach).\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/62102/diff/3-4/", "author": "jib@mozilla.com", "id": 11549164, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8763466\nBug 1213517 - Normalize even more of the constraints code.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59656/diff/5-6/", "author": "jib@mozilla.com", "id": 11549165, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8763467\nBug 1213517 - Lift correct constraint out of lower-level code for OverconstrainedError.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59658/diff/5-6/", "author": "jib@mozilla.com", "id": 11549166, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8763468\nBug 1213517 - Only restart camera if net settings actually change.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59660/diff/5-6/", "author": "jib@mozilla.com", "id": 11549167, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8763469\nBug 1213517 - Consolidate camera Allocate's and Restart's constraints logic.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59662/diff/5-6/", "author": "jib@mozilla.com", "id": 11549168, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8763470\nBug 1213517 - Let cam access in competing tabs get closer to their ideals when a tab closes.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59664/diff/5-6/", "author": "jib@mozilla.com", "id": 11549169, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8763471\nBug 1213517 - Wire up getSettings().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59666/diff/5-6/", "author": "jib@mozilla.com", "id": 11549170, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8768892\nBug 1213517 - Make applyConstraints() and getSettings() do nothing after stop and shutdown.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/62894/diff/1-2/", "author": "jib@mozilla.com", "id": 11549171, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8768893\nBug 1213517 - Clamp competing ideal values before considering them to avoid outliers distorting result.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/62896/diff/1-2/", "author": "jib@mozilla.com", "id": 11549172, "time": "2016-07-14T19:53:55Z"}, {"text": "Comment on attachment 8768894\nBug 1213517 - Take highest ideal value from competing width, height and frameRate.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/62898/diff/1-2/", "author": "jib@mozilla.com", "id": 11549173, "time": "2016-07-14T19:53:55Z"}, {"text": "*** Bug 1213397 has been marked as a duplicate of this bug. ***", "author": "jib@mozilla.com", "id": 11549190, "time": "2016-07-14T20:01:37Z"}, {"text": "Comment on attachment 8768893\nBug 1213517 - Clamp competing ideal values before considering them to avoid outliers distorting result.\n\nhttps://reviewboard.mozilla.org/r/62896/#review61082\n\n::: dom/media/webrtc/MediaTrackConstraints.h:99\n(Diff revision 1)\n>        }\n>        Intersect(aOther);\n>  \n>        if (aOther.mIdeal.isSome()) {\n> +        // Ideal values, as stored, may be outside their min max range, so use\n> +        // clamped values in averaging, to avoid extreme outliers skewing results.", "author": "rjesup@jesup.org", "id": 11549201, "time": "2016-07-14T20:04:58Z"}, {"text": "Comment on attachment 8768892\nBug 1213517 - Make applyConstraints() and getSettings() do nothing after stop and shutdown.\n\nhttps://reviewboard.mozilla.org/r/62894/#review61080", "author": "rjesup@jesup.org", "id": 11549212, "time": "2016-07-14T20:09:50Z"}, {"text": "Another painful rebase (need to get this landed). The only real change here is comment 177.\n\nRandell, if you could try r+ from mozReview again, I would appreciate it, as I otherwise wont be able to autoland.\n\n(In reply to Randell Jesup [:jesup] from comment #155)\n> Comment on attachment 8768894\n> Bug 1213517 - Take highest ideal value from competing width, height and\n> frameRate.\n> \n> r+.  However, please note my comments in the bug; I think we should set\n> unspecified framerate to 30, and probably consider a separate patch/bug to\n> decimate framerates when lower is requested.\n\nI added code to consider unspecified framerate as 30 fps, as you suggested, and filed Bug 1286945 as a follow-up.", "author": "jib@mozilla.com", "id": 11549216, "time": "2016-07-14T20:10:57Z"}, {"text": "Comment on attachment 8768894\nBug 1213517 - Take highest ideal value from competing width, height and frameRate.\n\nhttps://reviewboard.mozilla.org/r/62898/#review61358", "author": "rjesup@jesup.org", "id": 11549337, "time": "2016-07-14T20:59:31Z"}, {"text": "Thanks! Mind re-r+-ing comment 163? Then I can autoland (once inbound re-opens).", "author": "jib@mozilla.com", "id": 11549385, "time": "2016-07-14T21:18:11Z"}, {"text": "Comment on attachment 8761186\nBug 1213517 - Use NormalizedConstraints in low-level code.\n\nhttps://reviewboard.mozilla.org/r/58496/#review61362\n\nhard to really see the changes since reviewboard includes merged changes from the master... but looks good", "author": "rjesup@jesup.org", "id": 11549405, "time": "2016-07-14T21:24:33Z"}, {"text": "Comment on attachment 8761186\nBug 1213517 - Use NormalizedConstraints in low-level code.\n\nhttps://reviewboard.mozilla.org/r/58496/#review61364", "author": "rjesup@jesup.org", "id": 11549411, "time": "2016-07-14T21:26:01Z"}, {"text": "Comment on attachment 8689889\nBug 1213517 - add webidl for track.getConstraints() and track.getSettings().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25735/diff/6-7/", "author": "jib@mozilla.com", "id": 11553381, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8689890\nBug 1213517 - split off MediaTaskUtils.h from MediaUtils.h to shed dependencies.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25737/diff/6-7/", "author": "jib@mozilla.com", "id": 11553382, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8689891\nBug 1213517 - make track.applyConstraints() store constraints on success.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/25739/diff/7-8/", "author": "jib@mozilla.com", "id": 11553383, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8694859\nBug 1213517 - make getUserMedia store initial constraints on resulting tracks.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/26905/diff/7-8/", "author": "jib@mozilla.com", "id": 11553384, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8761183\nBug 1213517 - Introduce AllocationHandle to MediaEngine::Allocate().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58490/diff/6-7/", "author": "jib@mozilla.com", "id": 11553385, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8761184\nBug 1213517 - Normalize all the constraints internally, not just some.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58492/diff/6-7/", "author": "jib@mozilla.com", "id": 11553386, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8761185\nBug 1213517 - Add an un-flattened NormalizedConstraints type for downstream use.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58494/diff/6-7/", "author": "jib@mozilla.com", "id": 11553387, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8761186\nBug 1213517 - Use NormalizedConstraints in low-level code.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58496/diff/6-7/", "author": "jib@mozilla.com", "id": 11553388, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8761187\nBug 1213517 - Add a way to merge multiple NormalizedConstraints.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58498/diff/6-7/", "author": "jib@mozilla.com", "id": 11553389, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8761188\nBug 1213517 - Consider competing constraints in getUserMedia+applyConstraints.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/58500/diff/6-7/", "author": "jib@mozilla.com", "id": 11553390, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8763464\nBug 1213517 - Consider competing required constraints with OverconstrainedError.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59652/diff/5-6/", "author": "jib@mozilla.com", "id": 11553391, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8763465\nBug 1213517 - Report correct constraint in OverconstrainedError when constraints conflict directly.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59654/diff/6-7/", "author": "jib@mozilla.com", "id": 11553392, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8767669\nBug 1213517 - optimize for maintenance of constraints (member pointer approach).\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/62102/diff/4-5/", "author": "jib@mozilla.com", "id": 11553393, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8763466\nBug 1213517 - Normalize even more of the constraints code.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59656/diff/6-7/", "author": "jib@mozilla.com", "id": 11553394, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8763467\nBug 1213517 - Lift correct constraint out of lower-level code for OverconstrainedError.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59658/diff/6-7/", "author": "jib@mozilla.com", "id": 11553395, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8763468\nBug 1213517 - Only restart camera if net settings actually change.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59660/diff/6-7/", "author": "jib@mozilla.com", "id": 11553396, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8763469\nBug 1213517 - Consolidate camera Allocate's and Restart's constraints logic.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59662/diff/6-7/", "author": "jib@mozilla.com", "id": 11553397, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8763470\nBug 1213517 - Let cam access in competing tabs get closer to their ideals when a tab closes.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59664/diff/6-7/", "author": "jib@mozilla.com", "id": 11553398, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8763471\nBug 1213517 - Wire up getSettings().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/59666/diff/6-7/", "author": "jib@mozilla.com", "id": 11553399, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8768892\nBug 1213517 - Make applyConstraints() and getSettings() do nothing after stop and shutdown.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/62894/diff/2-3/", "author": "jib@mozilla.com", "id": 11553400, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8768893\nBug 1213517 - Clamp competing ideal values before considering them to avoid outliers distorting result.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/62896/diff/2-3/", "author": "jib@mozilla.com", "id": 11553401, "time": "2016-07-17T21:03:59Z"}, {"text": "Comment on attachment 8768894\nBug 1213517 - Take highest ideal value from competing width, height and frameRate.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/62898/diff/2-3/", "author": "jib@mozilla.com", "id": 11553402, "time": "2016-07-17T21:03:59Z"}, {"text": "Rebased.", "author": "jib@mozilla.com", "id": 11553403, "time": "2016-07-17T21:05:12Z"}, {"text": "Pushed by jbruaroey@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/f22693a94979\nadd webidl for track.getConstraints() and track.getSettings(). r=smaug\nhttps://hg.mozilla.org/integration/autoland/rev/3764e2fac765\nsplit off MediaTaskUtils.h from MediaUtils.h to shed dependencies. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/015cb0829df5\nmake track.applyConstraints() store constraints on success. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/0fc93ec9ccd7\nmake getUserMedia store initial constraints on resulting tracks. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/6ed917c7d94d\nIntroduce AllocationHandle to MediaEngine::Allocate(). r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/6ee4fac755f4\nNormalize all the constraints internally, not just some. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/e6ac385fd969\nAdd an un-flattened NormalizedConstraints type for downstream use. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/05b370d75989\nUse NormalizedConstraints in low-level code. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/9701bb4384d8\nAdd a way to merge multiple NormalizedConstraints. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/6f025025d259\nConsider competing constraints in getUserMedia+applyConstraints. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/c0c0d3eb6dc9\nConsider competing required constraints with OverconstrainedError. r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/e4829b553f9e\nReport correct constraint in OverconstrainedError when constraints conflict directly. r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/97cfe28779d9\noptimize for maintenance of constraints (member pointer approach). r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/85832c026282\nNormalize even more of the constraints code. r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/abf811706099\nLift correct constraint out of lower-level code for OverconstrainedError. r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/697fac643b8e\nOnly restart camera if net settings actually change. r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/70f85193f925\nConsolidate camera Allocate's and Restart's constraints logic. r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/77b16f74919f\nLet cam access in competing tabs get closer to their ideals when a tab closes. r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/eca5b39db393\nWire up getSettings(). r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/97d42349adb9\nMake applyConstraints() and getSettings() do nothing after stop and shutdown. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/6f3e405706ef\nClamp competing ideal values before considering them to avoid outliers distorting result. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/93b1deb435f2\nTake highest ideal value from competing width, height and frameRate. r=jesup", "author": "pulsebot@bots.tld", "id": 11553405, "time": "2016-07-17T21:09:08Z"}, {"text": "hi jib, do you have any idea what made the bustage after this push of autoland? e.g.\nhttps://treeherder.mozilla.org/logviewer.html#?job_id=638206&repo=autoland#L5431", "author": "ihsiao@mozilla.com", "id": 11553982, "time": "2016-07-18T03:22:22Z"}, {"text": "My fault for doing a conservative try run. :( This patch set is tripping up static analysis in two places.\n\nI have two fixes for this in bug 1287378, which should take care of the problem if it hasn't been backed out yet.", "author": "jib@mozilla.com", "id": 11554240, "time": "2016-07-18T07:29:37Z"}, {"text": "Backout by ihsiao@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/5890c3d8ac67\nBacked out changeset 93b1deb435f2 for Static Checking Build bustage\nhttps://hg.mozilla.org/integration/autoland/rev/a2b508faaa89\nBacked out changeset 6f3e405706ef \nhttps://hg.mozilla.org/integration/autoland/rev/b97a43e6a167\nBacked out changeset 97d42349adb9 \nhttps://hg.mozilla.org/integration/autoland/rev/391b528627d5\nBacked out changeset eca5b39db393 \nhttps://hg.mozilla.org/integration/autoland/rev/e7455e8591c1\nBacked out changeset 77b16f74919f \nhttps://hg.mozilla.org/integration/autoland/rev/ca6e59681605\nBacked out changeset 70f85193f925 \nhttps://hg.mozilla.org/integration/autoland/rev/cee5abc65e94\nBacked out changeset 697fac643b8e \nhttps://hg.mozilla.org/integration/autoland/rev/0067bcf60359\nBacked out changeset abf811706099 \nhttps://hg.mozilla.org/integration/autoland/rev/91beab01e785\nBacked out changeset 85832c026282 \nhttps://hg.mozilla.org/integration/autoland/rev/1adb5905697d\nBacked out changeset 97cfe28779d9 \nhttps://hg.mozilla.org/integration/autoland/rev/75e965332b72\nBacked out changeset e4829b553f9e \nhttps://hg.mozilla.org/integration/autoland/rev/f925108ff4d3\nBacked out changeset c0c0d3eb6dc9 \nhttps://hg.mozilla.org/integration/autoland/rev/4e9cca9e0124\nBacked out changeset 6f025025d259 \nhttps://hg.mozilla.org/integration/autoland/rev/aa39f9c1df60\nBacked out changeset 9701bb4384d8 \nhttps://hg.mozilla.org/integration/autoland/rev/41fa5df5762f\nBacked out changeset 05b370d75989 \nhttps://hg.mozilla.org/integration/autoland/rev/c9f03cb41197\nBacked out changeset e6ac385fd969 \nhttps://hg.mozilla.org/integration/autoland/rev/ebe5efee4d5e\nBacked out changeset 6ee4fac755f4 \nhttps://hg.mozilla.org/integration/autoland/rev/d4b46fc0c418\nBacked out changeset 6ed917c7d94d \nhttps://hg.mozilla.org/integration/autoland/rev/97bad3c58567\nBacked out changeset 0fc93ec9ccd7 \nhttps://hg.mozilla.org/integration/autoland/rev/d40be578a737\nBacked out changeset 015cb0829df5 \nhttps://hg.mozilla.org/integration/autoland/rev/c292ec33315d\nBacked out changeset 3764e2fac765 \nhttps://hg.mozilla.org/integration/autoland/rev/d2021311169e\nBacked out changeset f22693a94979", "author": "pulsebot@bots.tld", "id": 11554277, "time": "2016-07-18T08:00:23Z"}, {"text": "oh...sorry! I didn't see your comment, so had backed out your changesets...:(", "author": "ihsiao@mozilla.com", "id": 11554283, "time": "2016-07-18T08:05:32Z"}, {"text": "Created attachment 8771954\nBug 1213517 - Fix static analysis for bug 1213517 landing: make constructor explicit.\n\nReview commit: https://reviewboard.mozilla.org/r/64916/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/64916/", "author": "jib@mozilla.com", "id": 11554783, "time": "2016-07-18T12:32:52Z"}, {"text": "Created attachment 8771955\nBug 1213517 - Fix static analysis for bug 1213517 landing: Avoid non-memmovable nsTArray<NormalizedConstraintSet>.\n\nReview commit: https://reviewboard.mozilla.org/r/64918/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/64918/", "author": "jib@mozilla.com", "id": 11554784, "time": "2016-07-18T12:32:52Z"}, {"text": "*** Bug 1287378 has been marked as a duplicate of this bug. ***", "author": "jib@mozilla.com", "id": 11554786, "time": "2016-07-18T12:33:27Z"}, {"text": "Comment on attachment 8771954\nBug 1213517 - Fix static analysis for bug 1213517 landing: make constructor explicit.\n\nhttps://reviewboard.mozilla.org/r/64916/#review61942", "author": "rjesup@jesup.org", "id": 11555548, "time": "2016-07-18T16:24:40Z"}, {"text": "Comment on attachment 8771955\nBug 1213517 - Fix static analysis for bug 1213517 landing: Avoid non-memmovable nsTArray<NormalizedConstraintSet>.\n\nhttps://reviewboard.mozilla.org/r/64918/#review61948", "author": "rjesup@jesup.org", "id": 11555554, "time": "2016-07-18T16:25:21Z"}, {"text": "Pushed by jbruaroey@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/5f0e605aeb4f\nadd webidl for track.getConstraints() and track.getSettings(). r=smaug\nhttps://hg.mozilla.org/integration/autoland/rev/2e20119e43d4\nsplit off MediaTaskUtils.h from MediaUtils.h to shed dependencies. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/02335d85ca40\nmake track.applyConstraints() store constraints on success. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/4df85217957d\nmake getUserMedia store initial constraints on resulting tracks. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/87361f380664\nIntroduce AllocationHandle to MediaEngine::Allocate(). r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/cadeeb107695\nNormalize all the constraints internally, not just some. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/84fb1be97595\nAdd an un-flattened NormalizedConstraints type for downstream use. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/c613c94abee0\nUse NormalizedConstraints in low-level code. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/cfc68e9868d9\nAdd a way to merge multiple NormalizedConstraints. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/dbf1866063ce\nConsider competing constraints in getUserMedia+applyConstraints. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/de8a576b136d\nConsider competing required constraints with OverconstrainedError. r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/7be03e7ea909\nReport correct constraint in OverconstrainedError when constraints conflict directly. r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/c83da3566e98\noptimize for maintenance of constraints (member pointer approach). r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/e202052952d5\nNormalize even more of the constraints code. r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/3110045d432e\nLift correct constraint out of lower-level code for OverconstrainedError. r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/2a924630566f\nOnly restart camera if net settings actually change. r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/62c5705fc282\nConsolidate camera Allocate's and Restart's constraints logic. r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/bf9c34d7ecdf\nLet cam access in competing tabs get closer to their ideals when a tab closes. r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/80cae085c9a5\nWire up getSettings(). r=padenot\nhttps://hg.mozilla.org/integration/autoland/rev/5eb669a837c9\nMake applyConstraints() and getSettings() do nothing after stop and shutdown. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/e08e367db0f1\nClamp competing ideal values before considering them to avoid outliers distorting result. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/de5e58e85231\nTake highest ideal value from competing width, height and frameRate. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/2c32d3cb63d8\nFix static analysis for bug 1213517 landing: make constructor explicit. r=jesup\nhttps://hg.mozilla.org/integration/autoland/rev/de179cfc917a\nFix static analysis for bug 1213517 landing: Avoid non-memmovable nsTArray<NormalizedConstraintSet>. r=jesup", "author": "pulsebot@bots.tld", "id": 11555587, "time": "2016-07-18T16:32:56Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/5f0e605aeb4f\nhttps://hg.mozilla.org/mozilla-central/rev/2e20119e43d4\nhttps://hg.mozilla.org/mozilla-central/rev/02335d85ca40\nhttps://hg.mozilla.org/mozilla-central/rev/4df85217957d\nhttps://hg.mozilla.org/mozilla-central/rev/87361f380664\nhttps://hg.mozilla.org/mozilla-central/rev/cadeeb107695\nhttps://hg.mozilla.org/mozilla-central/rev/84fb1be97595\nhttps://hg.mozilla.org/mozilla-central/rev/c613c94abee0\nhttps://hg.mozilla.org/mozilla-central/rev/cfc68e9868d9\nhttps://hg.mozilla.org/mozilla-central/rev/dbf1866063ce\nhttps://hg.mozilla.org/mozilla-central/rev/de8a576b136d\nhttps://hg.mozilla.org/mozilla-central/rev/7be03e7ea909\nhttps://hg.mozilla.org/mozilla-central/rev/c83da3566e98\nhttps://hg.mozilla.org/mozilla-central/rev/e202052952d5\nhttps://hg.mozilla.org/mozilla-central/rev/3110045d432e\nhttps://hg.mozilla.org/mozilla-central/rev/2a924630566f\nhttps://hg.mozilla.org/mozilla-central/rev/62c5705fc282\nhttps://hg.mozilla.org/mozilla-central/rev/bf9c34d7ecdf\nhttps://hg.mozilla.org/mozilla-central/rev/80cae085c9a5\nhttps://hg.mozilla.org/mozilla-central/rev/5eb669a837c9\nhttps://hg.mozilla.org/mozilla-central/rev/e08e367db0f1\nhttps://hg.mozilla.org/mozilla-central/rev/de5e58e85231\nhttps://hg.mozilla.org/mozilla-central/rev/2c32d3cb63d8\nhttps://hg.mozilla.org/mozilla-central/rev/de179cfc917a", "author": "cbook@mozilla.com", "id": 11558537, "time": "2016-07-19T14:25:42Z"}, {"text": "New pages:\n\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackSupportedConstraints\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackSettings\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaStreamTrack/applyConstraints\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaStreamTrack/getCapabilities (not part of this bug; drafted by mistake but it should be reasonably useful)\n\nHeavily updated so almost new:\n\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaStreamTrack/getConstraints\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaStreamTrack/getSettings\n\nUpdated pages:\n\nhttps://developer.mozilla.org/en-US/docs/Web/API/Media_Streams_API\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaStream\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaStreamTrack\nhttps://developer.mozilla.org/en-US/Firefox/Releases/50\n\nThere\u2019s still work to do here:\n\nThe docs of MediaTrackConstraints are very incomplete; I need to write out how each constraint is written, and so forth.\n\nThe pages detailing each individual property are not written yet. The summaries, however, should be a good start for most people. I will work on the detail pages very soon.\n\nAnd I need to finish writing the guide material about how to work with constrainable properties in the main Media Capture and Streams page.\n\nSo I\u2019m leaving this doc-needed for the moment; but I wanted to note progress while I work on another doc bug for a bit.", "author": "eshepherd@mozilla.com", "id": 11693425, "time": "2016-09-07T22:21:20Z"}, {"text": "The guide content about how to work with constraints is about 75% done now. I\u2019m taking a time-out from finishing this to get some work done on DOM and other general API doc updates. I\u2019ll be back to this soon; ideally by mid-to-late next week.", "author": "eshepherd@mozilla.com", "id": 11699691, "time": "2016-09-09T20:23:57Z"}, {"text": "Documentation added:\n\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getSupportedConstraints\nAll of the subpages of https://developer.mozilla.org/en-US/docs/Web/API/MediaTrackSupportedConstraints\n\nUpdated:\n\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaDevices\n\nGuide work resumes tomorrow.", "author": "eshepherd@mozilla.com", "id": 11748871, "time": "2016-09-30T00:42:13Z"}, {"text": "I\u2019ve now documented into our reference the types used to build constraints:\n\nhttps://developer.mozilla.org/en-US/docs/Web/API/LongRange\nhttps://developer.mozilla.org/en-US/docs/Web/API/ConstrainLong\nhttps://developer.mozilla.org/en-US/docs/Web/API/DoubleRange\nhttps://developer.mozilla.org/en-US/docs/Web/API/ConstrainDouble\nhttps://developer.mozilla.org/en-US/docs/Web/API/ConstrainDOMString\nhttps://developer.mozilla.org/en-US/docs/Web/API/ConstrainBoolean\n\nI think I\u2019m back into guide material next. There\u2019s more reference to do yet, with the properties of MediaTrackConstraints and MediaTrackSettings still needing to be fully documented, but I think getting the guide material finished up will be the next key step.", "author": "eshepherd@mozilla.com", "id": 11758690, "time": "2016-10-04T15:24:09Z"}, {"text": "Discovered some more stuff missing and added:\n\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaStreamConstraints\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaStreamConstraints/video\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaStreamConstraints/audio", "author": "eshepherd@mozilla.com", "id": 11796035, "time": "2016-10-18T22:56:57Z"}, {"text": "Fixed assorted little things here and there, including improving descriptions of many things, updating some out-of-date names here and there, and added the following pages to the docs:\n\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints/width\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints/height\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints/channelCount\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints/sampleRate\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints/sampleSize\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints/echoCancellation\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints/facingMode\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints/deviceId\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints/groupId\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints/aspectRatio\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints/frameRate\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints/volume\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints/latency\n\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackSettings/echoCancellation\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackSettings/channelCount\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackSettings/sampleRate\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackSettings/sampleSize\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackSettings/height\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackSettings/width\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackSettings/volume\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackSettings/latency\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackSettings/aspectRatio\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackSettings/frameRate\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackSettings/facingMode\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackSettings/groupId\nhttps://developer.mozilla.org/en-US/docs/Web/API/MediaTrackSettings/deviceId\n\nWith that, and a few just-completed tweaks to other pages previously done, I am putting these docs to bed. Please let me know if there are any errors. Ideally, eventually we will have some more in-place examples rather than generally linking to the one large example, but that will do for now.", "author": "eshepherd@mozilla.com", "id": 11799900, "time": "2016-10-20T02:42:51Z"}], "id": 1213517, "priority": "P1", "cc": ["bugs@pettay.fi", "eshepherd@mozilla.com", "ihsiao@mozilla.com", "jchaulk@mozilla.com", "mreavy@mozilla.com", "padenot@mozilla.com", "rjesup@jesup.org", "spenades@mozilla.com"], "cf_crash_signature": "", "version": "Trunk", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": ["https://bugzilla.mozilla.org/show_bug.cgi?id=1281866"], "cf_tracking_thunderbird_esr60": "---", "cf_platform_rel": "?", "product": "Core", "cf_fx_iteration": "---", "blocks": [910249, 1286945, 1433480, 1286096], "qa_contact": "", "creation_time": "2015-10-10T00:58:50Z", "cf_status_firefox_esr52": "---", "component": "WebRTC: Audio/Video", "assigned_to_detail": {"email": "jib@mozilla.com", "id": 456498, "name": "jib@mozilla.com", "real_name": "Jan-Ivar Bruaroey [:jib] (needinfo? me)"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "---", "cf_status_firefox60": "---", "cf_status_firefox43": "---", "cf_status_firefox42": "---", "target_milestone": "mozilla50", "cf_rank": "18", "cf_qa_whiteboard": "", "severity": "normal", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "https://jsfiddle.net/7udgdbbu/", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "jib@mozilla.com", "id": 456498, "name": "jib@mozilla.com", "real_name": "Jan-Ivar Bruaroey [:jib] (needinfo? me)"}, "whiteboard": "[DevRel:P2]", "mentors": [], "cc_detail": [{"email": "bugs@pettay.fi", "id": 39966, "name": "bugs@pettay.fi", "real_name": "Olli Pettay [:smaug]"}, {"email": "eshepherd@mozilla.com", "id": 241123, "name": "eshepherd@mozilla.com", "real_name": "Eric Shepherd [:sheppy]"}, {"email": "ihsiao@mozilla.com", "id": 549581, "name": "ihsiao@mozilla.com", "real_name": "Iris Hsiao [:ihsiao]"}, {"email": "jchaulk@mozilla.com", "id": 499318, "name": "jchaulk@mozilla.com", "real_name": "Jenn Chaulk (:jchaulk)"}, {"email": "mreavy@mozilla.com", "id": 74434, "name": "mreavy@mozilla.com", "real_name": "Maire Reavy [:mreavy] Plz needinfo?"}, {"email": "padenot@mozilla.com", "id": 404637, "name": "padenot@mozilla.com", "real_name": "Paul Adenot (:padenot)"}, {"email": "rjesup@jesup.org", "id": 11539, "name": "rjesup@jesup.org", "real_name": "Randell Jesup [:jesup]"}, {"email": "spenades@mozilla.com", "id": 175373, "name": "spenades@mozilla.com", "real_name": "Soledad Penades [:sole] [:spenades]"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-02-06T17:46:24Z", "assigned_to": "jib@mozilla.com", "is_open": false, "history": [{"changes": [{"removed": "", "field_name": "cf_rank", "added": "21"}, {"removed": "--", "field_name": "priority", "added": "P2"}, {"removed": "", "field_name": "cc", "added": "mreavy@mozilla.com"}, {"removed": "---", "field_name": "cf_backlog", "added": "webrtc/webaudio+"}], "who": "mreavy@mozilla.com", "when": "2015-10-12T16:07:03Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "dev-doc-needed"}], "who": "eshepherd@mozilla.com", "when": "2015-11-07T06:33:34Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "DevAdvocacy"}, {"removed": "", "field_name": "cc", "added": "sole@mozilla.com"}], "who": "spenades@mozilla.com", "when": "2015-11-11T10:59:56Z"}, {"changes": [{"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "jib@mozilla.com"}], "who": "jib@mozilla.com", "when": "2015-11-11T15:29:17Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1226448"}], "who": "jib@mozilla.com", "when": "2015-11-20T01:13:16Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8689889, "added": "review?(bugs@pettay.fi)"}, {"removed": "", "field_name": "cc", "added": "bugs@pettay.fi"}], "who": "jib@mozilla.com", "when": "2015-11-20T03:43:16Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8689890, "added": "review?(rjesup@jesup.org)"}, {"removed": "", "field_name": "cc", "added": "rjesup@jesup.org"}], "who": "jib@mozilla.com", "when": "2015-11-20T03:43:18Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8689891, "added": "review?(rjesup@jesup.org)"}], "who": "jib@mozilla.com", "when": "2015-11-20T03:43:21Z"}, {"changes": [{"removed": "", "field_name": "url", "added": "https://jsfiddle.net/7udgdbbu/"}], "who": "jib@mozilla.com", "when": "2015-11-20T03:58:30Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8689890, "added": "review+"}], "who": "rjesup@jesup.org", "when": "2015-11-20T06:44:44Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(bugs@pettay.fi)", "attachment_id": 8689889, "added": "review+"}], "who": "bugs@pettay.fi", "when": "2015-11-20T17:27:16Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8689891, "added": "review+"}], "who": "rjesup@jesup.org", "when": "2015-11-20T22:15:26Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8694859, "added": "review?(rjesup@jesup.org)"}], "who": "jib@mozilla.com", "when": "2015-12-02T18:57:57Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8694859, "added": "review+"}], "who": "rjesup@jesup.org", "when": "2015-12-02T21:26:48Z"}, {"changes": [{"removed": "21", "field_name": "cf_rank", "added": "18"}, {"removed": "P2", "field_name": "priority", "added": "P1"}], "who": "jib@mozilla.com", "when": "2016-03-03T20:13:30Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8689889, "added": "review?(bugs@pettay.fi)"}], "who": "jib@mozilla.com", "when": "2016-04-20T23:36:55Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(bugs@pettay.fi)", "attachment_id": 8689889, "added": "review+"}], "who": "jib@mozilla.com", "when": "2016-04-20T23:37:54Z"}, {"changes": [{"removed": "", "field_name": "whiteboard", "added": "[DevRel:P2]"}], "who": "dan.callahan@gmail.com", "when": "2016-05-06T13:23:57Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761183, "added": "review?(rjesup@jesup.org)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761184, "added": "review?(rjesup@jesup.org)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761185, "added": "review?(rjesup@jesup.org)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761186, "added": "review?(rjesup@jesup.org)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761187, "added": "review?(rjesup@jesup.org)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761188, "added": "review?(rjesup@jesup.org)"}, {"field_name": "attachments.description", "removed": "MozReview Request: Bug 1213517 - add webidl for track.getConstraints() and track.getSettings().", "attachment_id": 8689889, "added": "Bug 1213517 - add webidl for track.getConstraints() and track.getSettings()."}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8689889, "added": "review?(bugs@pettay.fi)"}, {"field_name": "attachments.description", "removed": "MozReview Request: Bug 1213517 - split off MediaTaskUtils.h from MediaUtils.h to shed dependencies.", "attachment_id": 8689890, "added": "Bug 1213517 - split off MediaTaskUtils.h from MediaUtils.h to shed dependencies."}, {"field_name": "attachments.description", "removed": "MozReview Request: Bug 1213517 - make track.applyConstraints() store constraints on success.", "attachment_id": 8689891, "added": "Bug 1213517 - make track.applyConstraints() store constraints on success."}, {"field_name": "attachments.description", "removed": "MozReview Request: Bug 1213517 - make getUserMedia store initial constraints on resulting tracks.", "attachment_id": 8694859, "added": "Bug 1213517 - make getUserMedia store initial constraints on resulting tracks."}], "who": "jib@mozilla.com", "when": "2016-06-08T12:40:02Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1088621"}], "who": "jib@mozilla.com", "when": "2016-06-08T12:48:46Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8761183, "added": "review+"}], "who": "rjesup@jesup.org", "when": "2016-06-08T13:52:22Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8761184, "added": "review+"}], "who": "rjesup@jesup.org", "when": "2016-06-08T13:59:08Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8761185, "added": "review+"}], "who": "rjesup@jesup.org", "when": "2016-06-08T14:03:28Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(bugs@pettay.fi)", "attachment_id": 8689889, "added": "review+"}], "who": "jib@mozilla.com", "when": "2016-06-08T14:19:11Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8761187, "added": "review+"}], "who": "rjesup@jesup.org", "when": "2016-06-09T21:45:46Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8761188, "added": "review+"}], "who": "rjesup@jesup.org", "when": "2016-06-09T21:47:18Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8761186, "added": ""}], "who": "rjesup@jesup.org", "when": "2016-06-09T22:19:16Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jchaulk@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "platform-rel?"}], "who": "jchaulk@mozilla.com", "when": "2016-06-15T14:33:50Z"}, {"changes": [{"removed": "---", "field_name": "cf_platform_rel", "added": "?"}], "who": "jchaulk@mozilla.com", "when": "2016-06-15T15:30:28Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8761183, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8761184, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8761185, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8761187, "added": ""}, {"field_name": "attachments.description", "removed": "Consider competing constraints in getUserMedia+applyConstraints.", "attachment_id": 8761188, "added": "Bug 1213517 - Consider competing constraints in getUserMedia+applyConstraints."}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8761188, "added": ""}], "who": "jib@mozilla.com", "when": "2016-06-20T07:22:33Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761183, "added": "review+"}], "who": "jib@mozilla.com", "when": "2016-06-20T08:10:01Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761184, "added": "review+"}], "who": "jib@mozilla.com", "when": "2016-06-20T08:10:28Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761185, "added": "review+"}], "who": "jib@mozilla.com", "when": "2016-06-20T08:10:57Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761186, "added": "review+"}], "who": "jib@mozilla.com", "when": "2016-06-20T08:11:16Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761187, "added": "review+"}], "who": "jib@mozilla.com", "when": "2016-06-20T08:11:35Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761188, "added": "review+"}], "who": "jib@mozilla.com", "when": "2016-06-20T08:11:53Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(bugs@pettay.fi)"}], "who": "jib@mozilla.com", "when": "2016-06-20T08:30:09Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8689889, "added": "review+"}], "who": "bugs@pettay.fi", "when": "2016-06-20T09:18:18Z"}, {"changes": [{"removed": "needinfo?(bugs@pettay.fi)", "field_name": "flagtypes.name", "added": ""}], "who": "bugs@pettay.fi", "when": "2016-06-20T09:18:44Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8694859, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8761183, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8761184, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8761185, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8761186, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8761187, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8761188, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8763464, "added": "review?(padenot@mozilla.com)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8763465, "added": "review?(padenot@mozilla.com)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8763466, "added": "review?(padenot@mozilla.com)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8763467, "added": "review?(padenot@mozilla.com)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8763468, "added": "review?(padenot@mozilla.com)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8763469, "added": "review?(padenot@mozilla.com)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8763470, "added": "review?(padenot@mozilla.com)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8763471, "added": "review?(padenot@mozilla.com)"}, {"removed": "", "field_name": "cc", "added": "padenot@mozilla.com"}], "who": "jib@mozilla.com", "when": "2016-06-23T04:59:34Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8694859, "added": "review+"}], "who": "jib@mozilla.com", "when": "2016-06-23T05:03:17Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761183, "added": "review+"}], "who": "jib@mozilla.com", "when": "2016-06-23T05:03:41Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761184, "added": "review+"}], "who": "jib@mozilla.com", "when": "2016-06-23T05:03:57Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761185, "added": "review+"}], "who": "jib@mozilla.com", "when": "2016-06-23T05:04:15Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761186, "added": "review+"}], "who": "jib@mozilla.com", "when": "2016-06-23T05:04:35Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761187, "added": "review+"}], "who": "jib@mozilla.com", "when": "2016-06-23T05:04:56Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761188, "added": "review+"}], "who": "jib@mozilla.com", "when": "2016-06-23T05:05:15Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(jib@mozilla.com)"}], "who": "padenot@mozilla.com", "when": "2016-06-23T08:28:21Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(padenot@mozilla.com)", "attachment_id": 8763464, "added": "review+"}], "who": "padenot@mozilla.com", "when": "2016-06-23T08:44:01Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(padenot@mozilla.com)", "attachment_id": 8763465, "added": ""}], "who": "padenot@mozilla.com", "when": "2016-06-23T08:46:59Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(padenot@mozilla.com)", "attachment_id": 8763467, "added": "review+"}], "who": "padenot@mozilla.com", "when": "2016-06-23T09:12:00Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(padenot@mozilla.com)", "attachment_id": 8763468, "added": ""}], "who": "padenot@mozilla.com", "when": "2016-06-23T09:33:20Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(padenot@mozilla.com)", "attachment_id": 8763469, "added": ""}], "who": "padenot@mozilla.com", "when": "2016-06-23T09:41:17Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(padenot@mozilla.com)", "attachment_id": 8763470, "added": ""}], "who": "padenot@mozilla.com", "when": "2016-06-23T09:42:56Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(padenot@mozilla.com)", "attachment_id": 8763471, "added": "review+"}], "who": "padenot@mozilla.com", "when": "2016-06-23T09:48:44Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(padenot@mozilla.com)", "attachment_id": 8763466, "added": "review+"}], "who": "padenot@mozilla.com", "when": "2016-06-23T11:52:12Z"}, {"changes": [{"removed": "needinfo?(jib@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "jib@mozilla.com", "when": "2016-06-23T17:42:12Z"}, {"changes": [{"removed": "", "field_name": "see_also", "added": "https://bugzilla.mozilla.org/show_bug.cgi?id=1281866"}], "who": "jib@mozilla.com", "when": "2016-06-23T17:51:38Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1281866"}], "who": "jib@mozilla.com", "when": "2016-06-23T18:14:16Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "eshepherd@mozilla.com"}], "who": "eshepherd@mozilla.com", "when": "2016-06-28T17:49:56Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8767669, "added": "review?(padenot@mozilla.com)"}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8689889, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8694859, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8761183, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8761184, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8761185, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8761186, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8761187, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8761188, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8763465, "added": "review?(padenot@mozilla.com)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8763468, "added": "review?(padenot@mozilla.com)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8763469, "added": "review?(padenot@mozilla.com)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8763470, "added": "review?(padenot@mozilla.com)"}], "who": "jib@mozilla.com", "when": "2016-07-04T14:04:19Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(padenot@mozilla.com)", "attachment_id": 8763465, "added": ""}], "who": "padenot@mozilla.com", "when": "2016-07-05T09:06:51Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(padenot@mozilla.com)", "attachment_id": 8767669, "added": "review+"}], "who": "padenot@mozilla.com", "when": "2016-07-05T09:18:32Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(padenot@mozilla.com)", "attachment_id": 8763468, "added": "review+"}], "who": "padenot@mozilla.com", "when": "2016-07-05T09:19:28Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(padenot@mozilla.com)", "attachment_id": 8763469, "added": "review+"}], "who": "padenot@mozilla.com", "when": "2016-07-05T09:29:45Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(padenot@mozilla.com)", "attachment_id": 8763470, "added": "review+"}], "who": "padenot@mozilla.com", "when": "2016-07-05T09:30:54Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8763465, "added": "review?(padenot@mozilla.com)"}], "who": "jib@mozilla.com", "when": "2016-07-05T19:25:40Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(padenot@mozilla.com)", "attachment_id": 8763465, "added": "review+"}], "who": "padenot@mozilla.com", "when": "2016-07-06T12:16:11Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8768892, "added": "review?(rjesup@jesup.org)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8768893, "added": "review?(rjesup@jesup.org)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8768894, "added": "review?(rjesup@jesup.org)"}], "who": "jib@mozilla.com", "when": "2016-07-07T19:13:48Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8763469, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8763470, "added": ""}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8763471, "added": ""}], "who": "jib@mozilla.com", "when": "2016-07-07T19:14:13Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1286096"}], "who": "jib@mozilla.com", "when": "2016-07-12T00:01:36Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8768892, "added": "review+"}], "who": "rjesup@jesup.org", "when": "2016-07-13T20:30:14Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8768893, "added": "review+"}], "who": "rjesup@jesup.org", "when": "2016-07-13T20:32:03Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8768894, "added": "review+"}], "who": "rjesup@jesup.org", "when": "2016-07-13T20:36:49Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761186, "added": "review?(rjesup@jesup.org)"}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8768892, "added": "review?(rjesup@jesup.org)"}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8768893, "added": "review?(rjesup@jesup.org)"}, {"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8768894, "added": "review?(rjesup@jesup.org)"}], "who": "jib@mozilla.com", "when": "2016-07-14T19:53:55Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8768893, "added": "review+"}], "who": "rjesup@jesup.org", "when": "2016-07-14T20:04:58Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8768892, "added": "review+"}], "who": "rjesup@jesup.org", "when": "2016-07-14T20:09:50Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1286945"}], "who": "jib@mozilla.com", "when": "2016-07-14T20:10:57Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8768894, "added": "review+"}], "who": "rjesup@jesup.org", "when": "2016-07-14T20:59:31Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(rjesup@jesup.org)"}], "who": "jib@mozilla.com", "when": "2016-07-14T21:18:11Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8761186, "added": ""}], "who": "rjesup@jesup.org", "when": "2016-07-14T21:24:33Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8761186, "added": "review+"}], "who": "rjesup@jesup.org", "when": "2016-07-14T21:26:01Z"}, {"changes": [{"removed": "needinfo?(rjesup@jesup.org)", "field_name": "flagtypes.name", "added": ""}], "who": "jib@mozilla.com", "when": "2016-07-17T21:05:12Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "ihsiao@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(jib@mozilla.com)"}], "who": "ihsiao@mozilla.com", "when": "2016-07-18T03:22:22Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1287378"}], "who": "jib@mozilla.com", "when": "2016-07-18T07:29:01Z"}, {"changes": [{"removed": "needinfo?(jib@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "jib@mozilla.com", "when": "2016-07-18T07:29:37Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8771954, "added": "review?(rjesup@jesup.org)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8771955, "added": "review?(rjesup@jesup.org)"}], "who": "jib@mozilla.com", "when": "2016-07-18T12:32:52Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8771954, "added": "review+"}], "who": "rjesup@jesup.org", "when": "2016-07-18T16:24:40Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rjesup@jesup.org)", "attachment_id": 8771955, "added": "review+"}], "who": "rjesup@jesup.org", "when": "2016-07-18T16:25:20Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla50"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2016-07-19 14:25:42"}, {"removed": "---", "field_name": "cf_status_firefox50", "added": "fixed"}], "who": "cbook@mozilla.com", "when": "2016-07-19T14:25:42Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1287854"}], "who": "lissyx+mozillians@lissyx.dyndns.org", "when": "2016-07-19T16:55:24Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1088621"}, {"removed": "1088621", "field_name": "depends_on", "added": ""}], "who": "jib@mozilla.com", "when": "2016-07-20T00:14:23Z"}, {"changes": [{"removed": "1088621", "field_name": "blocks", "added": ""}], "who": "jib@mozilla.com", "when": "2016-07-20T00:16:38Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1288338"}], "who": "lissyx+mozillians@lissyx.dyndns.org", "when": "2016-07-21T09:04:42Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1290866"}], "who": "rjesup@jesup.org", "when": "2016-08-01T12:02:32Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1307630"}], "who": "jib@mozilla.com", "when": "2016-10-04T22:45:55Z"}, {"changes": [{"removed": "1307630", "field_name": "depends_on", "added": ""}], "who": "jib@mozilla.com", "when": "2016-10-04T23:59:39Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1308605"}], "who": "jib@mozilla.com", "when": "2016-10-07T19:45:44Z"}, {"changes": [{"removed": "dev-doc-needed", "field_name": "keywords", "added": "dev-doc-complete"}], "who": "eshepherd@mozilla.com", "when": "2016-10-20T02:42:51Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1335005"}], "who": "vbacia.work@gmail.com", "when": "2017-02-06T14:00:21Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1341409"}], "who": "jib@mozilla.com", "when": "2017-02-21T19:41:14Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1433480"}], "who": "jib@mozilla.com", "when": "2018-01-26T15:39:15Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1436104"}], "who": "apehrson@mozilla.com", "when": "2018-02-06T17:46:24Z"}], "resolution": "FIXED", "op_sys": "All", "cf_fx_points": "---", "cf_blocking_fennec": "---"}