{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "attachments": [{"creator": "allstars.chh@mozilla.bugs", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 8709249}, {"creator": "allstars.chh@mozilla.bugs", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 8709353}, {"creator": "allstars.chh@mozilla.bugs", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2016-01-19T22:19:11Z", "type_id": 4, "creation_date": "2016-01-19T10:33:24Z", "id": 1325847, "setter": "bill.mccloskey@gmail.com"}, {"status": "+", "name": "review", "modification_date": "2016-01-20T02:56:17Z", "type_id": 4, "creation_date": "2016-01-19T10:33:24Z", "id": 1325848, "setter": "bobbyholley@gmail.com"}, {"status": "-", "name": "review", "modification_date": "2016-02-05T21:53:32Z", "type_id": 4, "creation_date": "2016-01-20T02:56:17Z", "id": 1326640, "setter": "benjamin@smedbergs.us"}], "content_type": "text/plain", "id": 8709354}], "classification": "Components", "creator": "allstars.chh@mozilla.bugs", "cc": ["allstars.chh@mozilla.bugs", "benjamin@smedbergs.us", "bill.mccloskey@gmail.com", "bobbyholley@gmail.com", "cbook@mozilla.com", "gfritzsche@mozilla.com"], "depends_on": [], "creation_time": "2016-01-19T03:55:52Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "cf_status_firefox58": "---", "cf_status_firefox59": "---", "keywords": [], "summary": "Annotate addonId into crash report", "id": 1240651, "assigned_to_detail": {"email": "allstars.chh@mozilla.bugs", "id": 434672, "name": "allstars.chh@mozilla.bugs", "real_name": "Yoshi Huang [:allstars.chh], Inactive"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "assigned_to": "allstars.chh@mozilla.bugs", "comment_count": 24, "comments": [{"text": "As suggested by Bobby and Bill in \nhttps://bugzilla.mozilla.org/show_bug.cgi?id=1210099#c5 and\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=1210099#c18\n\nI'll try to annotate addon id into crash report.", "author": "allstars.chh@mozilla.bugs", "id": 11086282, "time": "2016-01-19T03:55:52Z"}, {"text": "Created attachment 8709249\nPatch.", "author": "allstars.chh@mozilla.bugs", "id": 11086286, "time": "2016-01-19T03:59:20Z"}, {"text": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=0f50fc8dc4ac", "author": "allstars.chh@mozilla.bugs", "id": 11086287, "time": "2016-01-19T04:00:41Z"}, {"text": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=28232c7b1cb4", "author": "allstars.chh@mozilla.bugs", "id": 11086376, "time": "2016-01-19T06:27:20Z"}, {"text": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=2f8b4008cf35", "author": "allstars.chh@mozilla.bugs", "id": 11086459, "time": "2016-01-19T07:32:23Z"}, {"text": "Created attachment 8709353\nPatch.\n\nadd ifdef", "author": "allstars.chh@mozilla.bugs", "id": 11086758, "time": "2016-01-19T10:30:46Z"}, {"text": "Created attachment 8709354\nPatch.", "author": "allstars.chh@mozilla.bugs", "id": 11086763, "time": "2016-01-19T10:31:41Z"}, {"text": "Comment on attachment 8709354\nPatch.\n\nReview of attachment 8709354:\n-----------------------------------------------------------------\n\nThanks!\n\n::: caps/BasePrincipal.cpp\n@@ +129,5 @@\n> +#ifdef MOZ_CRASHREPORTER\n> +      CrashReporter::AnnotateCrashReport(NS_LITERAL_CSTRING(\"Crash_AddonId\"),\n> +                                         NS_ConvertUTF16toUTF8(mAddonId));\n> +#endif\n> +      MOZ_RELEASE_ASSERT(false);\n\nThis can just be MOZ_CRASH.", "author": "bill.mccloskey@gmail.com", "id": 11089272, "time": "2016-01-19T22:19:11Z"}, {"text": "Comment on attachment 8709354\nPatch.\n\nReview of attachment 8709354:\n-----------------------------------------------------------------\n\nr=me on the BasePrincipal.cpp changes.\n\nNeed data collection review. Flagging Georg.", "author": "bobbyholley@gmail.com", "id": 11090163, "time": "2016-01-20T02:56:17Z"}, {"text": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=2cc1bbba0b4b", "author": "allstars.chh@mozilla.bugs", "id": 11090454, "time": "2016-01-20T07:14:09Z"}, {"text": "https://hg.mozilla.org/integration/b2g-inbound/rev/a76600c2820bdc68e729a376d16cfe614a4a0b56\nBug 1240651 - Annotate addonId into crash report. r=billm, bholley", "author": "allstars.chh@mozilla.bugs", "id": 11090816, "time": "2016-01-20T10:42:16Z"}, {"text": "(In reply to Yoshi Huang[:allstars.chh] from comment #10)\n> https://hg.mozilla.org/integration/b2g-inbound/rev/\n> a76600c2820bdc68e729a376d16cfe614a4a0b56\n> Bug 1240651 - Annotate addonId into crash report. r=billm, bholley\n\nThis has pending data collection review, it shouldn't have landed yet.", "author": "gfritzsche@mozilla.com", "id": 11090912, "time": "2016-01-20T11:28:32Z"}, {"text": "Comment on attachment 8709354\nPatch.\n\nI'm not a data collection peer - redirecting.", "author": "gfritzsche@mozilla.com", "id": 11090916, "time": "2016-01-20T11:29:45Z"}, {"text": "sorry had to back this out for test failures like https://treeherder.mozilla.org/logviewer.html#?job_id=3796035&repo=b2g-inbound", "author": "cbook@mozilla.com", "id": 11091207, "time": "2016-01-20T14:05:06Z"}, {"text": "Backout:\nhttps://hg.mozilla.org/integration/b2g-inbound/rev/5426c8d6c687", "author": "pulsebot@bots.tld", "id": 11091232, "time": "2016-01-20T14:14:30Z"}, {"text": "Sorry for the trouble, I didn't notice that I have to get another review.\nI'll be more careful next time.", "author": "allstars.chh@mozilla.bugs", "id": 11093877, "time": "2016-01-21T02:47:36Z"}, {"text": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=d7db6a580967", "author": "allstars.chh@mozilla.bugs", "id": 11103610, "time": "2016-01-25T07:59:25Z"}, {"text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/62600c1a0dcb", "author": "pulsebot@bots.tld", "id": 11127651, "time": "2016-02-02T00:06:30Z"}, {"text": "This is a pretty bad crash, so I landed the patch with only part of the data collection. We already collect add-on IDs in crashes, so there shouldn't be any harm in doing it here. I left out the part that collects UUIDs since that's a new thing that I guess would require data collection review.", "author": "bill.mccloskey@gmail.com", "id": 11127659, "time": "2016-02-02T00:07:12Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/62600c1a0dcb", "author": "cbook@mozilla.com", "id": 11128849, "time": "2016-02-02T10:58:42Z"}, {"text": "Comment on attachment 8709354\nPatch.\n\nI don't understand what ExtensionManagement.jsm is trying to do. We already have the list of addons in crash reports, right? How is this list different? \n\nWhat is mAddonId? Addons can have arbitrary strings as their extension ID, so I'm a little concerned about this assert in general, unless mAddonId is somehow unrelated to the <em:id> ID. And in general for this kind of annotation, you'd want something more specific, such as \"Bug1240651_AddonID\"", "author": "benjamin@smedbergs.us", "id": 11134828, "time": "2016-02-03T21:19:27Z"}, {"text": "I think Bill might be better able to answer here.", "author": "bobbyholley@gmail.com", "id": 11136181, "time": "2016-02-04T04:07:44Z"}, {"text": "This code isn't really relevant anymore since we now know that the OriginAttributes crash wasn't related to a particular add-on. However, each WebExtension gets its own unique UUID when it's installed. This UUID is used in moz-extension: URIs rather than the add-on ID to make fingerprinting harder. The patch was including the mapping between UUIDs and add-on IDs in the crash report.\n\nAlso, my understanding is that add-on IDs have to match this regular expression here:\nhttps://dxr.mozilla.org/mozilla-central/source/toolkit/mozapps/extensions/internal/XPIProvider.jsm#270\nSo I think the assertion is valid.", "author": "bill.mccloskey@gmail.com", "id": 11139859, "time": "2016-02-05T01:03:11Z"}, {"text": "Comment on attachment 8709354\nPatch.\n\nIn that case, the \"Extensions\" annotation is very poorly named: it should be something like \"ExtensionUUIDMappings\" and you might as well make it machine-parseable JSON instead of this.\n\nThe other annotation, if it's still needed, should reference a specific bug and not be generic.", "author": "benjamin@smedbergs.us", "id": 11142699, "time": "2016-02-05T21:53:32Z"}], "cf_last_resolved": "2016-02-02T10:58:42Z", "priority": "--", "mentors_detail": [], "cf_crash_signature": "", "version": "Trunk", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox59": "---", "last_change_time": "2016-02-05T21:53:32Z", "cf_platform_rel": "---", "product": "Core", "cf_status_firefox_esr52": "---", "blocks": [1210099], "qa_contact": "", "see_also": [], "cf_fx_iteration": "---", "component": "Security: CAPS", "votes": 0, "groups": [], "cf_status_firefox60": "---", "target_milestone": "mozilla47", "cf_status_firefox47": "fixed", "cf_status_firefox46": "affected", "cf_status_thunderbird_esr52": "---", "url": "", "creator_detail": {"email": "allstars.chh@mozilla.bugs", "id": 434672, "name": "allstars.chh@mozilla.bugs", "real_name": "Yoshi Huang [:allstars.chh], Inactive"}, "whiteboard": "", "mentors": [], "cc_detail": [{"email": "allstars.chh@mozilla.bugs", "id": 434672, "name": "allstars.chh@mozilla.bugs", "real_name": "Yoshi Huang [:allstars.chh], Inactive"}, {"email": "benjamin@smedbergs.us", "id": 7044, "name": "benjamin@smedbergs.us", "real_name": "Benjamin Smedberg"}, {"email": "bill.mccloskey@gmail.com", "id": 389993, "name": "bill.mccloskey@gmail.com", "real_name": "Bill McCloskey [inactive unless it's an emergency] (:billm)"}, {"email": "bobbyholley@gmail.com", "id": 313730, "name": "bobbyholley@gmail.com", "real_name": "Bobby Holley (:bholley)"}, {"email": "cbook@mozilla.com", "id": 277293, "name": "cbook@mozilla.com", "real_name": "Carsten Book [:Tomcat]"}, {"email": "gfritzsche@mozilla.com", "id": 439671, "name": "gfritzsche@mozilla.com", "real_name": "Georg Fritzsche (slow to respond) [:gfritzsche]"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "cf_tracking_firefox58": "---", "cf_rank": null, "is_open": false, "cf_qa_whiteboard": "", "history": [{"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8709249, "added": "1"}], "who": "allstars.chh@mozilla.bugs", "when": "2016-01-19T10:30:46Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8709353, "added": "1"}], "who": "allstars.chh@mozilla.bugs", "when": "2016-01-19T10:31:41Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bobbyholley@gmail.com, wmccloskey@mozilla.com"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8709354, "added": "review?(wmccloskey@mozilla.com), review?(bobbyholley@gmail.com)"}], "who": "allstars.chh@mozilla.bugs", "when": "2016-01-19T10:33:24Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(wmccloskey@mozilla.com)", "attachment_id": 8709354, "added": "review+"}], "who": "bill.mccloskey@gmail.com", "when": "2016-01-19T22:19:11Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "gfritzsche@mozilla.com"}, {"field_name": "flagtypes.name", "removed": "review?(bobbyholley@gmail.com)", "attachment_id": 8709354, "added": "review+, review?(gfritzsche@mozilla.com)"}], "who": "bobbyholley@gmail.com", "when": "2016-01-20T02:56:17Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "allstars.chh@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(allstars.chh@mozilla.com)"}], "who": "gfritzsche@mozilla.com", "when": "2016-01-20T11:28:32Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "benjamin@smedbergs.us"}, {"field_name": "flagtypes.name", "removed": "review?(gfritzsche@mozilla.com)", "attachment_id": 8709354, "added": "review?(benjamin@smedbergs.us)"}], "who": "gfritzsche@mozilla.com", "when": "2016-01-20T11:29:45Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "cbook@mozilla.com"}], "who": "cbook@mozilla.com", "when": "2016-01-20T14:05:06Z"}, {"changes": [{"removed": "needinfo?(allstars.chh@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "allstars.chh@mozilla.bugs", "when": "2016-01-21T02:47:36Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla47"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2016-02-02 02:58:42"}, {"removed": "---", "field_name": "cf_status_firefox47", "added": "fixed"}], "who": "cbook@mozilla.com", "when": "2016-02-02T10:58:42Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(allstars.chh@mozilla.com)"}], "who": "benjamin@smedbergs.us", "when": "2016-02-03T21:19:27Z"}, {"changes": [{"removed": "needinfo?(allstars.chh@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(wmccloskey@mozilla.com)"}], "who": "bobbyholley@gmail.com", "when": "2016-02-04T04:07:44Z"}, {"changes": [{"removed": "needinfo?(wmccloskey@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "bill.mccloskey@gmail.com", "when": "2016-02-05T01:03:11Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(benjamin@smedbergs.us)", "attachment_id": 8709354, "added": "review-"}], "who": "benjamin@smedbergs.us", "when": "2016-02-05T21:53:32Z"}], "resolution": "FIXED", "op_sys": "Unspecified", "cf_fx_points": "---", "cf_blocking_fennec": "---"}