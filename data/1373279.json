{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "cf_tracking_firefox62": "---", "creator": "ray_engelking@hotmail.com", "mentors_detail": [], "depends_on": [], "cf_status_firefox_esr60": "---", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "All", "keywords": ["reproducible"], "cc_detail": [{"email": "aswan@mozilla.com", "id": 561655, "name": "aswan@mozilla.com", "real_name": "Andrew Swan [:aswan] (on PTO until 6/25)"}, {"email": "bugzilla@gemal.dk", "id": 6793, "name": "bugzilla@gemal.dk", "real_name": "Henrik Gemal"}, {"email": "florian@queze.net", "id": 149052, "name": "florian@queze.net", "real_name": "Florian Qu\u00e8ze [:florian]"}, {"email": "gbrown@mozilla.com", "id": 411471, "name": "gbrown@mozilla.com", "real_name": "Geoff Brown [:gbrown]"}, {"email": "hskupin@gmail.com", "id": 76551, "name": "hskupin@gmail.com", "real_name": "Henrik Skupin (:whimboo)"}, {"email": "jryans@gmail.com", "id": 282978, "name": "jryans@gmail.com", "real_name": "J. Ryan Stinnett [:jryans] (use ni?)"}, {"email": "kgilbert@mozilla.com", "id": 499338, "name": "kgilbert@mozilla.com", "real_name": ":kip (Kearwood Gilbert)"}, {"email": "MattN+bmo@mozilla.com", "id": 305228, "name": "MattN+bmo@mozilla.com", "real_name": "Matthew N. [:MattN] (PM if requests are blocking you)"}, {"email": "ray_engelking@hotmail.com", "id": 511231, "name": "ray_engelking@hotmail.com", "real_name": "Ray Engelking"}, {"email": "rbarker@mozilla.com", "id": 480362, "name": "rbarker@mozilla.com", "real_name": "Randall Barker [:rbarker]"}], "cf_last_resolved": "2018-05-11T09:38:44Z", "attachments": [{"creator": "kgilbert@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2018-05-10T17:23:44Z", "type_id": 4, "creation_date": "2018-05-10T00:19:06Z", "id": 1754995, "setter": "rbarker@mozilla.com"}], "content_type": "text/x-review-board-request", "id": 8973073}], "votes": 0, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 27, "comments": [{"text": "Getting 2 new errors with the latest Firefox update 53, and on 54;\nUnable to read VR Path Registry from C:\\Users\\rengelking\\AppData\\Local\\openvr\\openvrpaths.vrpath\nJavaScript error: chrome://pin4ever/content/pin4ever.js, line 421: TypeError: Components.classes['@mozilla.org/satchel/form-history;1'] is undefined", "author": "ray_engelking@hotmail.com", "id": 12401415, "time": "2017-06-15T15:38:20Z"}, {"text": "The second error appears to be from an extension, you should contact the extnesion author directly about that.\nRe-labeling and re-classifying this for the first message (which I believe is a warning and not an error, but it is noisy...)\n\nFor the WebVR folks, I see that same message even during xpcshell tests that don't do anything related to WebVR...", "author": "aswan@mozilla.com", "id": 12401617, "time": "2017-06-15T16:47:41Z"}, {"text": "(In reply to Andrew Swan [:aswan] from comment #1)\n> The second error appears to be from an extension, you should contact the\n> extnesion author directly about that.\n> Re-labeling and re-classifying this for the first message (which I believe\n> is a warning and not an error, but it is noisy...)\n> \n> For the WebVR folks, I see that same message even during xpcshell tests that\n> don't do anything related to WebVR...\n\nThank you; I guess the form-history has been deprecated for 3 to 4 years, and it was just removed. The replacement is FormHistory.jsm, although just learned that all \"Legacy\" extensions are being replaced with Chrome-like WebExtensions; if I wanted to write extensions like Chrome, I would just use Chrome, and not Firefox.. not sure about the rational behind eliminating all XUL type extensions, but there will be even less reason to use Firefox, when version 57 goes live on November 14th.", "author": "ray_engelking@hotmail.com", "id": 12403085, "time": "2017-06-16T01:53:24Z"}, {"text": "The real issue seems to be that WebVR is probing for the OpenVR runtime before hitting WebVR content.\n\nCan we narrow this down to a particular test that is triggering the message from WebVR, or does it happen on all of the xpcshell tests?", "author": "kgilbert@mozilla.com", "id": 12638966, "time": "2017-09-07T20:36:24Z"}, {"text": "(In reply to :kip (Kearwood Gilbert) from comment #3)\n> Can we narrow this down to a particular test that is triggering the message\n> from WebVR, or does it happen on all of the xpcshell tests?\n\nDunno, I don't see it in recent test output, but I remember it being quite frequent.  Perhaps its been fixed in the ~3 months since comment 1?", "author": "aswan@mozilla.com", "id": 12639157, "time": "2017-09-07T21:38:07Z"}, {"text": "Started nightly firefox using \"firefox --console\" and got:\n\"Unable to read VR Path Registry from C:\\Users\\Henrik Gemal\\AppData\\Local\\openvr\\openvrpaths.vrpath\"", "author": "bugzilla@gemal.dk", "id": 12711731, "time": "2017-09-28T20:11:51Z"}, {"text": "This happens on every startup on OS X and is quite annoying for debugging since it happens later on too (maybe for each new process startup?):\n\n$ /Applications/FirefoxNightly.app/Contents/MacOS/firefox --profile /tmp/vrspam\nUnable to read VR Path Registry from /Users/matthew/Library/Application Support/OpenVR/.openvr/openvrpaths.vrpath\nUnable to read VR Path Registry from /Users/matthew/Library/Application Support/OpenVR/.openvr/openvrpaths.vrpath\n\nThe general policy is that console logging shouldn't be output in official builds either and this happens on a stock Nightly.", "author": "MattN+bmo@mozilla.com", "id": 12804134, "time": "2017-10-31T02:08:35Z"}, {"text": "I would say more important than the console noise is the fact that this work is happening at startup at all.  Lots of people have worked very hard recently to remove unnecessary work from startup.  However fast reading a vr path registry is, these sorts of things all add up.", "author": "aswan@mozilla.com", "id": 12804216, "time": "2017-10-31T03:05:54Z"}, {"text": "I have reproduced it in the current nightly, thanks!  We should indeed not be firing up OpenVR until visiting a WebVR site.\n\nStay tuned for a patch.", "author": "kgilbert@mozilla.com", "id": 12806351, "time": "2017-10-31T19:42:13Z"}, {"text": "*** Bug 1422787 has been marked as a duplicate of this bug. ***", "author": "florian@queze.net", "id": 13075726, "time": "2018-02-28T15:55:04Z"}, {"text": "If this is causing main thread I/O, it's much more severe than just the noise caused by the warning. kip, are you still intending to produce a patch soon? :-)", "author": "florian@queze.net", "id": 13075731, "time": "2018-02-28T15:56:28Z"}, {"text": "(In reply to Florian Qu\u00e8ze [:florian] from comment #10)\n> If this is causing main thread I/O, it's much more severe than just the\n> noise caused by the warning. kip, are you still intending to produce a patch\n> soon? :-)\nI've confirmed that after the tty spam, there is no more I/O on the main thread, but this shouldn't be initializing for that thread -- it should only be running in the GPU process.\n\nI suspect the regression is that VRManager::ManagerInit() is being called twice:\n\n- In GPUParent::RecvInit\n- In gfxPlatform::gfxPlatform()\n\nIt should be only called once, with the location dependent on if e10s is enabled or not.\n\nIf we only support WebVR with e10s enabled, we may be able to simply delete one of these calls.  We need to be careful to test all the platforms [eg for Android/GeckoView] after removing it, or add conditions if needed.\n\nThis may be to late to fix for FF60, but can I land the fix shortly after.", "author": "kgilbert@mozilla.com", "id": 13080709, "time": "2018-03-01T19:21:42Z"}, {"text": "In bug 1414495 we are seeing intermittent browser startup hangs during Windows tests. At least some of those appear to be hung on the VRLOG call producing the warning of this bug: see https://bugzilla.mozilla.org/show_bug.cgi?id=1414495#c66 and https://bugzilla.mozilla.org/show_bug.cgi?id=1414495#c68.\n\n:kip -- Do you expect to resolve this bug soon?", "author": "gbrown@mozilla.com", "id": 13139771, "time": "2018-03-19T15:27:34Z"}, {"text": "(In reply to Geoff Brown [:gbrown] from comment #12)\n> In bug 1414495 we are seeing intermittent browser startup hangs during\n> Windows tests. At least some of those appear to be hung on the VRLOG call\n> producing the warning of this bug: see\n> https://bugzilla.mozilla.org/show_bug.cgi?id=1414495#c66 and\n> https://bugzilla.mozilla.org/show_bug.cgi?id=1414495#c68.\n> \n> :kip -- Do you expect to resolve this bug soon?\n\nI will try some fixes later this week.  There is a chance that fixing the redundant initialization in multiple processes may also solve some other issues I've seen reported.", "author": "kgilbert@mozilla.com", "id": 13144228, "time": "2018-03-20T23:39:32Z"}, {"text": "Sorry to pester you :kip, but do you have an update?", "author": "gbrown@mozilla.com", "id": 13195498, "time": "2018-04-10T17:11:39Z"}, {"text": "2 failures in 782 pushes (0.003 failures/push) were associated with this bug in the last 7 days.    \n\nRepository breakdown:\n* mozilla-central: 2\n\nPlatform breakdown:\n* osx-10-10: 2\n\nFor more details, see:\nhttps://treeherder.mozilla.org/intermittent-failures.html#/bugdetails?bug=1373279&startday=2018-04-16&endday=2018-04-22&tree=trunk", "author": "orangefactor@bots.tld", "id": 13225235, "time": "2018-04-23T01:24:41Z"}, {"text": "2 failures in 780 pushes (0.003 failures/push) were associated with this bug in the last 7 days.    \n\nRepository breakdown:\n* autoland: 2\n\nPlatform breakdown:\n* osx-10-10: 2\n\nFor more details, see:\nhttps://treeherder.mozilla.org/intermittent-failures.html#/bugdetails?bug=1373279&startday=2018-04-23&endday=2018-04-29&tree=trunk", "author": "orangefactor@bots.tld", "id": 13241302, "time": "2018-04-30T01:20:11Z"}, {"text": "Created attachment 8973073\nBug 1373279 - Avoid checking for OpenVR runtime until hitting WebVR content\n\nReview commit: https://reviewboard.mozilla.org/r/241610/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/241610/", "author": "kgilbert@mozilla.com", "id": 13253604, "time": "2018-05-03T23:29:26Z"}, {"text": "6 failures in 551 pushes (0.011 failures/push) were associated with this bug in the last 7 days.    \n\nRepository breakdown:\n* autoland: 4\n* mozilla-inbound: 2\n\nPlatform breakdown:\n* osx-10-10: 6\n\nFor more details, see:\nhttps://treeherder.mozilla.org/intermittent-failures.html#/bugdetails?bug=1373279&startday=2018-04-30&endday=2018-05-06&tree=trunk", "author": "orangefactor@bots.tld", "id": 13257853, "time": "2018-05-07T01:20:12Z"}, {"text": "It looks like that the attached patch broke all builds and nearly all test jobs. A common crash signature is:\n\n> [@ mozilla::gfx::VRManagerParent::RegisterVRManagerInVRListenerThread(mozilla::gfx::VRManagerParent*)]", "author": "hskupin@gmail.com", "id": 13261508, "time": "2018-05-08T06:19:45Z"}, {"text": "(In reply to Henrik Skupin (:whimboo) from comment #19)\n> It looks like that the attached patch broke all builds and nearly all test\n> jobs. A common crash signature is:\n> \n> > [@ mozilla::gfx::VRManagerParent::RegisterVRManagerInVRListenerThread(mozilla::gfx::VRManagerParent*)]\n\nIndeed.  It appears that there are some accesses to the redundantly initialized VRManager.  I'll track these down and update the patch.", "author": "kgilbert@mozilla.com", "id": 13266859, "time": "2018-05-09T21:54:24Z"}, {"text": "After some deeper inspection, it appears that the redundantly initialized VRManager is not connecting to any VR API's once started.  It early-exits during vsync refreshes and is only checking for presence of the OpenVR runtime files at startup.\n\nI'll clean up the redundantly initialized VR Manager, but to fix this particular TTY spam bug, I can defer the checking for the OpenVR runtime files until actually hitting WebVR content.\n\nUpdated patch incoming...", "author": "kgilbert@mozilla.com", "id": 13267085, "time": "2018-05-09T23:56:49Z"}, {"text": "Cleanup of the additional VRManager will be done as part of Bug 1362578 (Move VRManager to its own process)", "author": "kgilbert@mozilla.com", "id": 13267103, "time": "2018-05-10T00:17:22Z"}, {"text": "Comment on attachment 8973073\nBug 1373279 - Avoid checking for OpenVR runtime until hitting WebVR content\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/241610/diff/1-2/", "author": "kgilbert@mozilla.com", "id": 13267105, "time": "2018-05-10T00:18:30Z"}, {"text": "Comment on attachment 8973073\nBug 1373279 - Avoid checking for OpenVR runtime until hitting WebVR content\n\nhttps://reviewboard.mozilla.org/r/241610/#review248984", "author": "rbarker@mozilla.com", "id": 13268860, "time": "2018-05-10T17:23:44Z"}, {"text": "Pushed by kgilbert@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/0f11165c90a1\nAvoid checking for OpenVR runtime until hitting WebVR content r=rbarker", "author": "pulsebot@bots.tld", "id": 13268871, "time": "2018-05-10T17:27:23Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/0f11165c90a1", "author": "ebalazs@mozilla.com", "id": 13270283, "time": "2018-05-11T09:38:44Z"}], "id": 1373279, "priority": "P4", "cc": ["aswan@mozilla.com", "bugzilla@gemal.dk", "florian@queze.net", "gbrown@mozilla.com", "hskupin@gmail.com", "jryans@gmail.com", "kgilbert@mozilla.com", "MattN+bmo@mozilla.com", "ray_engelking@hotmail.com", "rbarker@mozilla.com"], "cf_crash_signature": "", "version": "unspecified", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_thunderbird_esr60": "---", "cf_platform_rel": "---", "product": "Core", "cf_fx_iteration": "---", "blocks": [1414495], "qa_contact": "", "creation_time": "2017-06-15T15:38:20Z", "cf_status_firefox_esr52": "---", "component": "WebVR", "assigned_to_detail": {"email": "kgilbert@mozilla.com", "id": 499338, "name": "kgilbert@mozilla.com", "real_name": ":kip (Kearwood Gilbert)"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "fixed", "cf_status_firefox61": "---", "cf_status_firefox60": "---", "target_milestone": "mozilla62", "cf_rank": null, "cf_qa_whiteboard": "", "severity": "normal", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "ray_engelking@hotmail.com", "id": 511231, "name": "ray_engelking@hotmail.com", "real_name": "Ray Engelking"}, "whiteboard": "", "mentors": [], "summary": "\"Unable to read VR Path Registry ...\" warning at startup", "cf_has_str": "yes", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-06-10T01:29:00Z", "assigned_to": "kgilbert@mozilla.com", "is_open": false, "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "aswan@mozilla.com"}, {"removed": "WebExtensions: Untriaged", "field_name": "component", "added": "WebVR"}, {"removed": "Toolkit", "field_name": "product", "added": "Core"}, {"removed": "Missing functionality: <add summary here>", "field_name": "summary", "added": "\"Unable to read VR Path Registry ...\" warning at startup"}], "who": "aswan@mozilla.com", "when": "2017-06-15T16:47:41Z"}, {"changes": [{"removed": "blocker", "field_name": "severity", "added": "normal"}], "who": "epinal99-bugzilla2@yahoo.fr", "when": "2017-06-16T00:59:43Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "ray_engelking@hotmail.com"}], "who": "ray_engelking@hotmail.com", "when": "2017-06-16T01:53:24Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "kgilbert@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(aswan@mozilla.com)"}], "who": "kgilbert@mozilla.com", "when": "2017-09-07T20:36:24Z"}, {"changes": [{"removed": "needinfo?(aswan@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "aswan@mozilla.com", "when": "2017-09-07T21:38:07Z"}, {"changes": [{"removed": "--", "field_name": "priority", "added": "P4"}, {"removed": "---", "field_name": "cf_status_firefox57", "added": "affected"}], "who": "kgilbert@mozilla.com", "when": "2017-09-19T22:22:47Z"}, {"changes": [{"removed": "UNCONFIRMED", "field_name": "status", "added": "NEW"}, {"removed": "", "field_name": "cc", "added": "bugzilla@gemal.dk"}, {"removed": "0", "field_name": "is_confirmed", "added": "1"}], "who": "bugzilla@gemal.dk", "when": "2017-09-28T20:11:01Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "reproducible"}, {"removed": "", "field_name": "cc", "added": "MattN+bmo@mozilla.com"}, {"removed": "---", "field_name": "cf_has_str", "added": "yes"}], "who": "MattN+bmo@mozilla.com", "when": "2017-10-31T02:08:35Z"}, {"changes": [{"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "kgilbert@mozilla.com"}], "who": "kgilbert@mozilla.com", "when": "2017-10-31T19:42:13Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "florian@queze.net"}], "who": "florian@queze.net", "when": "2018-02-28T15:55:04Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(kgilbert@mozilla.com)"}], "who": "florian@queze.net", "when": "2018-02-28T15:56:28Z"}, {"changes": [{"removed": "needinfo?(kgilbert@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "kgilbert@mozilla.com", "when": "2018-03-01T19:21:42Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1414495"}], "who": "florian@queze.net", "when": "2018-03-05T13:11:52Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "hskupin@gmail.com"}], "who": "hskupin@gmail.com", "when": "2018-03-05T14:49:00Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jryans@gmail.com"}], "who": "jryans@gmail.com", "when": "2018-03-15T19:38:21Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "gbrown@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(kgilbert@mozilla.com)"}], "who": "gbrown@mozilla.com", "when": "2018-03-19T15:27:34Z"}, {"changes": [{"removed": "needinfo?(kgilbert@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "kgilbert@mozilla.com", "when": "2018-03-20T23:39:32Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(kgilbert@mozilla.com)"}], "who": "gbrown@mozilla.com", "when": "2018-04-10T17:11:39Z"}, {"changes": [{"removed": "needinfo?(kgilbert@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "kgilbert@mozilla.com", "when": "2018-05-09T21:54:24Z"}, {"changes": [{"field_name": "attachments.description", "removed": "Bug 1373279 - Eliminate redundant VRManager initialization", "attachment_id": 8973073, "added": "Bug 1373279 - Avoid checking for OpenVR runtime until hitting WebVR content"}], "who": "kgilbert@mozilla.com", "when": "2018-05-10T00:18:30Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8973073, "added": "review?(rbarker@mozilla.com)"}, {"removed": "", "field_name": "cc", "added": "rbarker@mozilla.com"}], "who": "kgilbert@mozilla.com", "when": "2018-05-10T00:19:06Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(rbarker@mozilla.com)", "attachment_id": 8973073, "added": "review+"}], "who": "rbarker@mozilla.com", "when": "2018-05-10T17:23:44Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla62"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2018-05-11 09:38:44"}, {"removed": "---", "field_name": "cf_status_firefox62", "added": "fixed"}], "who": "ebalazs@mozilla.com", "when": "2018-05-11T09:38:44Z"}, {"changes": [{"removed": "affected", "field_name": "cf_status_firefox57", "added": "---"}], "who": "ryanvm@gmail.com", "when": "2018-06-10T01:29:00Z"}], "resolution": "FIXED", "op_sys": "All", "cf_fx_points": "---", "cf_blocking_fennec": "---"}