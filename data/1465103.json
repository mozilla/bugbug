{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "cf_tracking_firefox62": "---", "creator": "bkelly@mozilla.com", "mentors_detail": [], "depends_on": [1461326], "cf_status_firefox_esr60": "---", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "keywords": [], "cc_detail": [{"email": "bugmail@asutherland.org", "id": 151407, "name": "bugmail@asutherland.org", "real_name": "Andrew Sutherland [:asuth]"}, {"email": "mdaly@mozilla.com", "id": 609492, "name": "mdaly@mozilla.com", "real_name": "Marion Daly [:mdaly]"}], "cf_last_resolved": "2018-06-02T23:27:32Z", "attachments": [{"creator": "bkelly@mozilla.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 8982635}, {"creator": "bkelly@mozilla.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 8982639}, {"creator": "bkelly@mozilla.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2018-06-01T20:23:12Z", "type_id": 4, "creation_date": "2018-06-01T20:05:54Z", "id": 1764830, "setter": "bugmail@asutherland.org"}], "content_type": "text/plain", "id": 8982640}, {"creator": "bkelly@mozilla.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2018-06-01T20:32:07Z", "type_id": 4, "creation_date": "2018-06-01T20:32:07Z", "id": 1764841, "setter": "bkelly@mozilla.com"}, {"status": "+", "name": "approval-mozilla-beta", "modification_date": "2018-06-04T14:14:17Z", "type_id": 721, "creation_date": "2018-06-04T13:20:43Z", "id": 1765332, "setter": "ryanvm@gmail.com"}], "content_type": "text/plain", "id": 8982648}], "votes": 0, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 12, "comments": [{"text": "It looks like we've solved the beta crash issue that caused us to add some release assertions in bug 1461326.  Lets change these assertions back to diagnostics to avoid adding unnecessary overhead to release builds.  Note, this is not a straight revert because there is some new code that will remain, just restricted to the diagnostic condition.", "author": "bkelly@mozilla.com", "id": 13371384, "time": "2018-05-29T15:16:13Z"}, {"text": "Created attachment 8982635\nConvert service worker and clients release assertions to diagnostic assertions. r=asuth", "author": "bkelly@mozilla.com", "id": 13381178, "time": "2018-06-01T19:33:28Z"}, {"text": "Created attachment 8982639\nConvert service worker and clients release assertions to diagnostic assertions. r=asuth", "author": "bkelly@mozilla.com", "id": 13381227, "time": "2018-06-01T19:51:18Z"}, {"text": "Created attachment 8982640\nConvert service worker and clients release assertions to diagnostic assertions. r=asuth\n\nAndrew, this converts some release assertions we added to try to track down a crash on beta back to diagnostics.  I decided to leave the magic number checking in place for diagnostic builds as well.", "author": "bkelly@mozilla.com", "id": 13381277, "time": "2018-06-01T20:05:54Z"}, {"text": "I compiled this locally with both diagnostics enabled and forcibly disabled like they are on beta.", "author": "bkelly@mozilla.com", "id": 13381282, "time": "2018-06-01T20:08:06Z"}, {"text": "Comment on attachment 8982640\nConvert service worker and clients release assertions to diagnostic assertions. r=asuth\n\nReview of attachment 8982640:\n-----------------------------------------------------------------\n\n::: dom/clients/manager/ClientManager.cpp\n@@ +27,5 @@\n>  \n>  namespace {\n>  \n>  const uint32_t kBadThreadLocalIndex = -1;\n>  const uint32_t kThreadLocalMagic1 = 0x8d57eea6;\n\nnit: do the kThreadLocalMagicN's want to be ifdef'ed as well?\n\n::: dom/clients/manager/ClientThing.h\n@@ +16,5 @@\n>  // of code for handling activation and shutdown of IPC actors.\n>  template <typename ActorType>\n>  class ClientThing\n>  {\n>    static const uint32_t kMagic1 = 0xC9FE2C9C;\n\nnit: Do these want an ifdef guard as well?", "author": "bugmail@asutherland.org", "id": 13381320, "time": "2018-06-01T20:23:12Z"}, {"text": "Created attachment 8982648\nConvert service worker and clients release assertions to diagnostic assertions. r=asuth", "author": "bkelly@mozilla.com", "id": 13381344, "time": "2018-06-01T20:32:07Z"}, {"text": "Pushed by bkelly@mozilla.com:\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/209cc0d0c1df\nConvert service worker and clients release assertions to diagnostic assertions. r=asuth", "author": "pulsebot@bots.tld", "id": 13381355, "time": "2018-06-01T20:36:49Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/209cc0d0c1df", "author": "apavel@mozilla.com", "id": 13382462, "time": "2018-06-02T23:27:32Z"}, {"text": "Comment on attachment 8982648\nConvert service worker and clients release assertions to diagnostic assertions. r=asuth\n\nApproval Request Comment\n[Feature/Bug causing the regression]: Bug 1461326 added some release assertions to diagnose a beta-channel crash.\n[User impact if declined]: Leaving the release assertions introduces some minor overhead.  I'd like to revert the assertions back to diagnostics to avoid impacting release channel.\n[Is this code covered by automated tests?]: This code is exercised by a lot of tests.\n[Has the fix been verified in Nightly?]:  Landed in m-c a few days ago.\n[Needs manual test from QE? If yes, steps to reproduce]:  None\n[List of other uplifts needed for the feature/fix]: No\n[Is the change risky?]: Minimal\n[Why is the change risky/not risky?]: Flips some release assertions to diagnostic assertions.  No behavior change.\n[String changes made/needed]: None", "author": "bkelly@mozilla.com", "id": 13385072, "time": "2018-06-04T13:20:43Z"}, {"text": "Comment on attachment 8982648\nConvert service worker and clients release assertions to diagnostic assertions. r=asuth\n\nSwitches some release asserts back to diagnostic asserts, approved for 61.0b11.", "author": "ryanvm@gmail.com", "id": 13385212, "time": "2018-06-04T14:14:17Z"}, {"text": "https://hg.mozilla.org/releases/mozilla-beta/rev/c13cb09f0c25", "author": "ryanvm@gmail.com", "id": 13385274, "time": "2018-06-04T14:32:49Z"}], "id": 1465103, "priority": "P2", "cc": ["bugmail@asutherland.org", "mdaly@mozilla.com"], "cf_crash_signature": "", "version": "unspecified", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_thunderbird_esr60": "---", "cf_platform_rel": "---", "product": "Core", "cf_fx_iteration": "---", "blocks": [1328631], "qa_contact": "", "creation_time": "2018-05-29T15:16:13Z", "cf_status_firefox_esr52": "---", "component": "DOM: Service Workers", "assigned_to_detail": {"email": "bkelly@mozilla.com", "id": 465500, "name": "bkelly@mozilla.com", "real_name": "Ben Kelly [:bkelly]"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "fixed", "cf_status_firefox61": "fixed", "cf_status_firefox60": "unaffected", "target_milestone": "mozilla62", "cf_rank": null, "cf_qa_whiteboard": "", "severity": "normal", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "bkelly@mozilla.com", "id": 465500, "name": "bkelly@mozilla.com", "real_name": "Ben Kelly [:bkelly]"}, "whiteboard": "", "mentors": [], "summary": "revert release assertions from bug 1461326 back to diagnostic assertions", "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-06-04T14:32:49Z", "assigned_to": "bkelly@mozilla.com", "is_open": false, "history": [{"changes": [{"removed": "--", "field_name": "priority", "added": "P2"}, {"removed": "", "field_name": "cc", "added": "mdaly@mozilla.com"}], "who": "mdaly@mozilla.com", "when": "2018-05-29T15:27:09Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8982635, "added": "1"}], "who": "bkelly@mozilla.com", "when": "2018-06-01T19:51:18Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8982639, "added": "1"}, {"removed": "", "field_name": "cc", "added": "bugmail@asutherland.org"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8982640, "added": "review?(bugmail@asutherland.org)"}], "who": "bkelly@mozilla.com", "when": "2018-06-01T20:05:54Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(bugmail@asutherland.org)", "attachment_id": 8982640, "added": "review+"}], "who": "bugmail@asutherland.org", "when": "2018-06-01T20:23:12Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8982640, "added": "1"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8982648, "added": "review+"}], "who": "bkelly@mozilla.com", "when": "2018-06-01T20:32:07Z"}, {"changes": [{"removed": "ASSIGNED", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla62"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2018-06-02 23:27:32"}, {"removed": "---", "field_name": "cf_status_firefox62", "added": "fixed"}], "who": "apavel@mozilla.com", "when": "2018-06-02T23:27:32Z"}, {"changes": [{"removed": "---", "field_name": "cf_status_firefox60", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_firefox61", "added": "affected"}], "who": "bkelly@mozilla.com", "when": "2018-06-04T13:18:14Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8982648, "added": "approval-mozilla-beta?"}], "who": "bkelly@mozilla.com", "when": "2018-06-04T13:20:43Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "approval-mozilla-beta?", "attachment_id": 8982648, "added": "approval-mozilla-beta+"}], "who": "ryanvm@gmail.com", "when": "2018-06-04T14:14:17Z"}, {"changes": [{"removed": "affected", "field_name": "cf_status_firefox61", "added": "fixed"}], "who": "ryanvm@gmail.com", "when": "2018-06-04T14:32:49Z"}], "resolution": "FIXED", "op_sys": "Unspecified", "cf_fx_points": "---", "cf_blocking_fennec": "---"}