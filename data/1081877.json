{"status": "NEW", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "classification": "Client Software", "creator": "henrik.lievonen@hotmail.com", "cc": ["alberto.crespell@gmail.com", "beatriz.rodriguezgomez@telefonica.com", "bhargavak37@gmail.com", "bogdan.surd@softvision.ro", "bug.zilla@mail.com", "gpascutto@mozilla.com", "kbrosnan@mozilla.com", "marcelino.veigatuimil@telefonica.com", "mark.finkle@gmail.com", "mking@mking.me", "snorp@snorp.net"], "depends_on": [], "creation_time": "2014-10-13T09:53:11Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "ARM", "keywords": ["reproducible"], "summary": "Visited links with long urls don't show purple as expected.", "cf_last_resolved": null, "attachments": [], "assigned_to_detail": {"email": "nobody@mozilla.org", "id": 1, "name": "nobody@mozilla.org", "real_name": "Nobody; OK to take it and work on it"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 24, "comments": [{"text": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:32.0) Gecko/20100101 Firefox/32.0\nBuild ID: 20140923175406\n\nSteps to reproduce:\n\n1. Visit site: http://www.ohjelmointiputka.net/keskustelu/uudet.php (A Finnish programming forum, the list of recent discussion).\n2. Open one of the links in the list under \"Aihe\" (Subject). (Like \"Android Studio - 'Gradle project sync failed'\")\n3. Go back to the previous page (in step 1).\n\n\nActual results:\n\nThe visited link shows in blue.\n\n\nExpected results:\n\nThe visited link should how in purple.", "author": "henrik.lievonen@hotmail.com", "id": 9437787, "time": "2014-10-13T09:53:11Z"}, {"text": "My device is a brand new Nexus 5 (D821) with Android 4.4.4. The same problem happens also on other sites like Google.", "author": "henrik.lievonen@hotmail.com", "id": 9437816, "time": "2014-10-13T10:01:21Z"}, {"text": "The site defines it's own a:visited, which doesn't seem to take affect on hitting back. Desktop adheres to this styling.\n\na:visited {\ncolor: #633;\n}", "author": "aaron.train@gmail.com", "id": 9439705, "time": "2014-10-13T18:15:19Z"}, {"text": "filter on [mass-p5]", "author": "brad@lassey.us", "id": 9470529, "time": "2014-10-20T15:26:33Z"}, {"text": "*** Bug 1090802 has been marked as a duplicate of this bug. ***", "author": "aaron.train@gmail.com", "id": 9517735, "time": "2014-10-29T15:08:42Z"}, {"text": "*** Bug 1090798 has been marked as a duplicate of this bug. ***", "author": "aaron.train@gmail.com", "id": 9517802, "time": "2014-10-29T15:17:45Z"}, {"text": "I would like to help fix this bug, and would like mentor help. Where should I start?", "author": "mking@mking.me", "id": 10115301, "time": "2015-04-03T11:46:36Z"}, {"text": "This bug has the \"regressionwindow-wanted\" keyword set, so if you are able to make your own Firefox for Android builds, then trying to bisect (with Mercurial) the commit that caused this problem would be a good start.", "author": "gpascutto@mozilla.com", "id": 10115306, "time": "2015-04-03T11:49:30Z"}, {"text": "Not sure where to look for the code that would alter this behavior, any tips?", "author": "mking@mking.me", "id": 10115359, "time": "2015-04-03T12:16:33Z"}, {"text": "The comment above yours explains how to find the code that caused the problem.", "author": "gpascutto@mozilla.com", "id": 10115504, "time": "2015-04-03T13:09:08Z"}, {"text": "Sorry, I think I'm missing something, I don't see the comment you're referring to.", "author": "mking@mking.me", "id": 10115551, "time": "2015-04-03T13:19:04Z"}, {"text": "https://bugzilla.mozilla.org/show_bug.cgi?id=1081877#c7\n\nNone of that requires knowledge of the codebase or looking for any code - it just consists of building historical versions of the code to see where the problem was introduced, thus giving you the code changes that caused the problem. That will narrow down the place to start looking immensely.", "author": "gpascutto@mozilla.com", "id": 10115627, "time": "2015-04-03T13:31:50Z"}, {"text": "You can use mozregression[0] to narrow it down to a specific Nightly first. I don't think we know the last time it worked, though, so that would be the first part you'd need to figure it out.\n\n[0] http://harthur.github.io/mozregression/", "author": "snorp@snorp.net", "id": 10115662, "time": "2015-04-03T13:41:21Z"}, {"text": "I don't think this is bfcache related. Refreshing the page also shows no visited link status. I used the remote debugging tools to inspect the page itself. the \"a:visited\" state did not kick in.\n\nI think we should start by looking at the place where the \"visited\" state is passed back to Gecko:\nhttp://mxr.mozilla.org/mozilla-central/source/mobile/android/base/GlobalHistory.java", "author": "mark.finkle@gmail.com", "id": 10117782, "time": "2015-04-03T22:13:25Z"}, {"text": "I put some logging into the code and found the <a> links look like:\nhttp://www.ohjelmointiputka.net/keskustelu/28605-javascript-periytys/v-227204\n\nBut the actual page URL (added to history) is:\nhttp://www.ohjelmointiputka.net/keskustelu/28605-javascript-periytys/sivu-1\n\nThe page does a redirect, possibly on the server. The Android code is designed to ignore redirects, so the useless URL is not displayed in the Awesomescreen or Top Sites along with the actual destination URL.\n\nI looked on Desktop and Desktop puts both URLs in history:\nhttp://www.ohjelmointiputka.net/keskustelu/28605-javascript-periytys/v-227204\nhttp://www.ohjelmointiputka.net/keskustelu/28605-javascript-periytys/sivu-1\n\nWONTFIX?", "author": "mark.finkle@gmail.com", "id": 10118245, "time": "2015-04-04T01:41:18Z"}, {"text": "I used mozregression and the problem appears as far back as I can possibly go until the builds won't run on my current device with Lollipop or an emulator with the previous OS (Jelly Bean). This goes back to 2013.", "author": "mking@mking.me", "id": 10124385, "time": "2015-04-07T06:57:14Z"}, {"text": "(In reply to Mark Finkle (:mfinkle) from comment #14)\n> WONTFIX?\n\nThe behaviour on the desktop works as expected, so I would expect that the Android version would match.", "author": "mking@mking.me", "id": 10124394, "time": "2015-04-07T06:59:37Z"}, {"text": "We don't store all the data that desktop does for history to keep the file smaller and have better performance on low end devices.", "author": "kbrosnan@mozilla.com", "id": 10133837, "time": "2015-04-08T23:23:10Z"}, {"text": "(In reply to Kevin Brosnan [:kbrosnan] from comment #17)\n> We don't store all the data that desktop does for history to keep the file\n> smaller and have better performance on low end devices.\n\nWell yes but being able to correctly show which links a user clicked isn't something we should optimize away, probably.", "author": "gpascutto@mozilla.com", "id": 10135930, "time": "2015-04-09T13:09:06Z"}, {"text": "(In reply to Gian-Carlo Pascutto [:gcp] from comment #18)\n> (In reply to Kevin Brosnan [:kbrosnan] from comment #17)\n> > We don't store all the data that desktop does for history to keep the file\n> > smaller and have better performance on low end devices.\n> \n> Well yes but being able to correctly show which links a user clicked isn't\n> something we should optimize away, probably.\n\nAgreed, we shouldn't sacrifice basic functionality for what seems like negligible performance gains.", "author": "mking@mking.me", "id": 10136305, "time": "2015-04-09T14:21:24Z"}, {"text": "Note that the links turn into visited if I visit them on a computer and then use Sync to synchronize history to Android. I guess this means the redirecting URL is also synchronized to Android so there is no memory gain in not saving that URL on Android device.", "author": "henrik.lievonen@hotmail.com", "id": 10137311, "time": "2015-04-09T17:07:03Z"}, {"text": "I don't want to add support for this until we change the way the URLs are displayed in Top Sites, Awesomescreen and other places. The redirected URLs should never be visible to the user and the Android history DB schema can't separate them right now.\n\nThere is a different bug about changing our history storage to allow for a \"visit type\" and then we could tag the redirects as \"redirect\", using that to filter them from UI visible lists. Since the URLs would be in the DB, they'd be \"found\" when looking for visited links.\n\nSee bug 934702 for bugs about local storage and bug 1046709 for issues around syncing from desktop.", "author": "mark.finkle@gmail.com", "id": 10138205, "time": "2015-04-09T19:40:11Z"}, {"text": "*** Bug 1374209 has been marked as a duplicate of this bug. ***", "author": "kbrosnan@mozilla.com", "id": 12411576, "time": "2017-06-19T17:45:40Z"}, {"text": "After running a mozregression, it would seem that the issue is reproducible since the first build(2014-08-08) that I was able to install on my device. Any other builds sooner than 2014-08-08 instantly crashed or just didn't start up. I can confirm that the issue is still reproducible even on the latest versions of FF. In Comment 15, Matt went as far as 2013 and the issue was still reproducible.\n\nFor build 2014-08-08: \napplication_buildid: 20140808030201\napplication_changeset: 18f408a5984e\n\nSeeing as a valid regression window can't be found I am removing the regressionwindow-wanted keyword as it is no longer needed.", "author": "bogdan.surd@softvision.ro", "id": 13400580, "time": "2018-06-11T11:27:26Z"}], "id": 1081877, "priority": "P5", "mentors_detail": [{"email": "snorp@snorp.net", "id": 227322, "name": "snorp@snorp.net", "real_name": "James Willcox (:snorp) (jwillcox@mozilla.com)"}], "cf_crash_signature": "", "version": "Trunk", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox62": "---", "cf_platform_rel": "---", "product": "Firefox for Android", "cf_status_firefox_esr52": "---", "blocks": [], "qa_contact": "", "see_also": [], "cf_fx_iteration": "---", "component": "General", "votes": 0, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "---", "cf_status_firefox60": "---", "target_milestone": "---", "is_cc_accessible": true, "cf_rank": null, "groups": [], "url": "", "creator_detail": {"email": "henrik.lievonen@hotmail.com", "id": 520259, "name": "henrik.lievonen@hotmail.com", "real_name": ""}, "whiteboard": "[lang=C++]", "mentors": ["snorp@snorp.net"], "cc_detail": [{"email": "alberto.crespell@gmail.com", "id": 442714, "name": "alberto.crespell@gmail.com", "real_name": "Albert [:albert]"}, {"email": "beatriz.rodriguezgomez@telefonica.com", "id": 447055, "name": "beatriz.rodriguezgomez@telefonica.com", "real_name": "Beatriz Rodr\u00edguez [:brg]"}, {"email": "bhargavak37@gmail.com", "id": 597145, "name": "bhargavak37@gmail.com", "real_name": "bhargava k"}, {"email": "bogdan.surd@softvision.ro", "id": 563218, "name": "bogdan.surd@softvision.ro", "real_name": "Bogdan Surd, QA [:BogdanS, NI]"}, {"email": "bug.zilla@mail.com", "id": 432697, "name": "bug.zilla@mail.com", "real_name": ""}, {"email": "gpascutto@mozilla.com", "id": 151147, "name": "gpascutto@mozilla.com", "real_name": "Gian-Carlo Pascutto [:gcp]"}, {"email": "kbrosnan@mozilla.com", "id": 406670, "name": "kbrosnan@mozilla.com", "real_name": "Kevin Brosnan [:kbrosnan]"}, {"email": "marcelino.veigatuimil@telefonica.com", "id": 448452, "name": "marcelino.veigatuimil@telefonica.com", "real_name": "Marcelino Veiga Tuimil [:sonmarce]"}, {"email": "mark.finkle@gmail.com", "id": 252194, "name": "mark.finkle@gmail.com", "real_name": "Mark Finkle (:mfinkle) (use needinfo?)"}, {"email": "mking@mking.me", "id": 535116, "name": "mking@mking.me", "real_name": "Matt King"}, {"email": "snorp@snorp.net", "id": 227322, "name": "snorp@snorp.net", "real_name": "James Willcox (:snorp) (jwillcox@mozilla.com)"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-06-11T11:27:26Z", "cf_status_firefox_esr60": "---", "assigned_to": "nobody@mozilla.org", "is_open": true, "history": [{"changes": [{"removed": "x86_64", "field_name": "platform", "added": "ARM"}, {"removed": "Windows 7", "field_name": "op_sys", "added": "Android"}], "who": "henrik.lievonen@hotmail.com", "when": "2014-10-13T10:01:21Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "reproducible"}, {"removed": "UNCONFIRMED", "field_name": "status", "added": "NEW"}, {"removed": "", "field_name": "cc", "added": "aaron.train@gmail.com"}, {"removed": "0", "field_name": "is_confirmed", "added": "1"}, {"removed": "---", "field_name": "cf_blocking_fennec", "added": "?"}], "who": "aaron.train@gmail.com", "when": "2014-10-13T18:15:19Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "gpascutto@mozilla.com"}], "who": "gpascutto@mozilla.com", "when": "2014-10-16T17:27:12Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "snorp@snorp.net"}, {"removed": "", "field_name": "whiteboard", "added": "[lang=C++] [mentor=snorp@snorp.net]"}, {"removed": "?", "field_name": "cf_blocking_fennec", "added": "+"}], "who": "snorp@snorp.net", "when": "2014-10-16T17:27:32Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "regressionwindow-wanted"}], "who": "snorp@snorp.net", "when": "2014-10-16T17:27:56Z"}, {"changes": [{"removed": "--", "field_name": "priority", "added": "P5"}], "who": "brad@lassey.us", "when": "2014-10-20T15:26:33Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "alberto.crespellperez@telefonica.com"}], "who": "aaron.train@gmail.com", "when": "2014-10-29T15:08:42Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "beatriz.rodriguezgomez@telefonica.com"}], "who": "beatriz.rodriguezgomez@telefonica.com", "when": "2014-10-29T15:15:21Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "marce@tid.es"}], "who": "marcelino.veigatuimil@telefonica.com", "when": "2014-10-29T16:10:08Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bug.zilla@mail.com"}], "who": "bug.zilla@mail.com", "when": "2014-12-18T14:07:10Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mking@mking.me"}], "who": "mking@mking.me", "when": "2015-04-03T11:46:36Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mark.finkle@gmail.com"}], "who": "mark.finkle@gmail.com", "when": "2015-04-03T22:13:25Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "kbrosnan@mozilla.com"}], "who": "kbrosnan@mozilla.com", "when": "2015-04-08T23:23:10Z"}, {"changes": [{"removed": "[lang=C++] [mentor=snorp@snorp.net]", "field_name": "whiteboard", "added": "[lang=C++]"}, {"removed": "", "field_name": "bug_mentor", "added": "snorp@snorp.net"}], "who": "josh@joshmatthews.net", "when": "2015-06-02T03:44:54Z"}, {"changes": [{"removed": "aaron.train@gmail.com", "field_name": "cc", "added": ""}], "who": "automation@bmo.tld", "when": "2016-07-29T21:42:00Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bhargavak37@gmail.com"}], "who": "kbrosnan@mozilla.com", "when": "2017-06-19T17:45:40Z"}, {"changes": [{"removed": "regressionwindow-wanted", "field_name": "keywords", "added": ""}, {"removed": "", "field_name": "cc", "added": "bogdan.surd@softvision.ro"}, {"removed": "32 Branch", "field_name": "version", "added": "Trunk"}], "who": "bogdan.surd@softvision.ro", "when": "2018-06-11T11:27:26Z"}], "resolution": "", "op_sys": "Android", "cf_fx_points": "---", "cf_blocking_fennec": "+"}