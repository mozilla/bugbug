{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "cf_tracking_firefox62": "---", "creator": "apehrson@mozilla.com", "mentors_detail": [], "depends_on": [], "cf_status_firefox_esr60": "---", "cf_user_story": "", "cf_backlog": "---", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "cf_status_firefox58": "wontfix", "cf_status_firefox59": "wontfix", "keywords": [], "summary": "A WrappedI420Buffer in MediaPipeline might outlive its buffer", "cf_last_resolved": "2018-02-26T22:26:19Z", "attachments": [{"creator": "apehrson@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2018-02-26T14:04:37Z", "type_id": 4, "creation_date": "2018-02-26T09:33:38Z", "id": 1721428, "setter": "dminor@mozilla.com"}, {"status": "-", "name": "approval-mozilla-beta", "modification_date": "2018-02-28T19:29:39Z", "type_id": 721, "creation_date": "2018-02-27T10:40:09Z", "id": 1722083, "setter": "lhenry@mozilla.com"}], "content_type": "text/x-review-board-request", "id": 8953919}], "votes": 0, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 9, "comments": [{"text": "One use of a WrappedI420Buffer in MediaPipeline [1] gets passed on further into the stack, but nothing keeps the PlanarYCbCrImage that owns the actual pixel buffer alive.\n\nThe WrappedI420Buffer outliving the PlanarYCbCrImage would be bad, but I hope and think we only end up reading that data as an image in a webrtc encoder and not doing any writing.\n\n[1] https://searchfox.org/mozilla-central/rev/f80722d4f3bfb722c5ec53880c4a7efb71285676/media/webrtc/signaling/src/mediapipeline/MediaPipeline.cpp#345-356", "author": "apehrson@mozilla.com", "id": 13022230, "time": "2018-02-06T18:32:11Z"}, {"text": "Created attachment 8953919\nBug 1436117 - Keep aImage around until the WrappedI420Buffer is released.\n\nReview commit: https://reviewboard.mozilla.org/r/223070/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/223070/", "author": "apehrson@mozilla.com", "id": 13068607, "time": "2018-02-26T09:33:38Z"}, {"text": "Comment on attachment 8953919\nBug 1436117 - Keep aImage around until the WrappedI420Buffer is released.\n\nhttps://reviewboard.mozilla.org/r/223070/#review229072\n\nlgtm", "author": "dminor@mozilla.com", "id": 13069092, "time": "2018-02-26T14:04:37Z"}, {"text": "Pushed by pehrsons@gmail.com:\nhttps://hg.mozilla.org/integration/autoland/rev/ca97ef07a045\nKeep aImage around until the WrappedI420Buffer is released. r=dminor", "author": "pulsebot@bots.tld", "id": 13069520, "time": "2018-02-26T16:19:05Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/ca97ef07a045", "author": "toros@mozilla.com", "id": 13070865, "time": "2018-02-26T22:26:19Z"}, {"text": "Comment on attachment 8953919\nBug 1436117 - Keep aImage around until the WrappedI420Buffer is released.\n\nApproval Request Comment\n[Feature/Bug causing the regression]: bug 1341285\n[User impact if declined]: There's a risk of the webrtc encoder accessing uninitialized memory. However we haven't seen or heard reports about this so I gather it's a very low risk.\n[Is this code covered by automated tests?]: Yes, though not explicitly testing what this fix is for, as it is speculative.\n[Has the fix been verified in Nightly?]: It's speculative, so no\n[Needs manual test from QE? If yes, steps to reproduce]: No\n[List of other uplifts needed for the feature/fix]: None\n[Is the change risky?]: No\n[Why is the change risky/not risky?]: It may extend the lifetime of some internal images. The worst that could happen would be shutdown leaks.\n[String changes made/needed]: None", "author": "apehrson@mozilla.com", "id": 13072054, "time": "2018-02-27T10:40:09Z"}, {"text": "Comment on attachment 8953919\nBug 1436117 - Keep aImage around until the WrappedI420Buffer is released.\n\nI'd like to let this ride with 60 unless you feel strongly about fixing it in 59.", "author": "lhenry@mozilla.com", "id": 13077298, "time": "2018-02-28T19:29:39Z"}, {"text": "*** Bug 1453899 has been marked as a duplicate of this bug. ***", "author": "abillings@mozilla.com", "id": 13250023, "time": "2018-05-02T18:42:09Z"}, {"text": "*** Bug 1429617 has been marked as a duplicate of this bug. ***", "author": "rjesup@jesup.org", "id": 13265810, "time": "2018-05-09T16:11:01Z"}], "id": 1436117, "priority": "P2", "cc": ["abillings@mozilla.com", "dminor@mozilla.com", "drno@ohlmeier.org", "jcristau@mozilla.com", "jib@mozilla.com", "zling.ustc@gmail.com"], "cf_crash_signature": "", "version": "60 Branch", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_thunderbird_esr60": "---", "cf_platform_rel": "---", "product": "Core", "cf_fx_iteration": "---", "blocks": [], "qa_contact": "", "creation_time": "2018-02-06T18:32:11Z", "cf_status_firefox_esr52": "---", "component": "WebRTC: Audio/Video", "assigned_to_detail": {"email": "apehrson@mozilla.com", "id": 489889, "name": "apehrson@mozilla.com", "real_name": "Andreas Pehrson [:pehrsons]"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "---", "cf_status_firefox60": "fixed", "target_milestone": "mozilla60", "cf_rank": "15", "cf_qa_whiteboard": "", "severity": "normal", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "apehrson@mozilla.com", "id": 489889, "name": "apehrson@mozilla.com", "real_name": "Andreas Pehrson [:pehrsons]"}, "whiteboard": "", "mentors": [], "cc_detail": [{"email": "abillings@mozilla.com", "id": 280903, "name": "abillings@mozilla.com", "real_name": "Al Billings [:abillings]"}, {"email": "dminor@mozilla.com", "id": 466787, "name": "dminor@mozilla.com", "real_name": "Dan Minor [:dminor]"}, {"email": "drno@ohlmeier.org", "id": 489581, "name": "drno@ohlmeier.org", "real_name": "Nils Ohlmeier [:drno]"}, {"email": "jcristau@mozilla.com", "id": 580382, "name": "jcristau@mozilla.com", "real_name": "Julien Cristau [:jcristau]"}, {"email": "jib@mozilla.com", "id": 456498, "name": "jib@mozilla.com", "real_name": "Jan-Ivar Bruaroey [:jib] (needinfo? me)"}, {"email": "zling.ustc@gmail.com", "id": 615916, "name": "zling.ustc@gmail.com", "real_name": ""}], "cf_has_str": "---", "alias": "CVE-2018-5160", "dupe_of": null, "flags": [], "last_change_time": "2018-05-09T16:11:01Z", "assigned_to": "apehrson@mozilla.com", "is_open": false, "history": [{"changes": [{"removed": "", "field_name": "cf_rank", "added": "15"}, {"removed": "--", "field_name": "priority", "added": "P2"}], "who": "apehrson@mozilla.com", "when": "2018-02-07T15:34:27Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8953919, "added": "review?(dminor@mozilla.com)"}], "who": "apehrson@mozilla.com", "when": "2018-02-26T09:33:38Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(dminor@mozilla.com)", "attachment_id": 8953919, "added": "review+"}], "who": "dminor@mozilla.com", "when": "2018-02-26T14:04:37Z"}, {"changes": [{"removed": "ASSIGNED", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla60"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2018-02-26 22:26:19"}, {"removed": "affected", "field_name": "cf_status_firefox60", "added": "fixed"}], "who": "toros@mozilla.com", "when": "2018-02-26T22:26:19Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8953919, "added": "approval-mozilla-beta?"}], "who": "apehrson@mozilla.com", "when": "2018-02-27T10:40:09Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "approval-mozilla-beta?", "attachment_id": 8953919, "added": "approval-mozilla-beta-"}], "who": "lhenry@mozilla.com", "when": "2018-02-28T19:29:39Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jcristau@mozilla.com"}, {"removed": "affected", "field_name": "cf_status_firefox59", "added": "wontfix"}], "who": "jcristau@mozilla.com", "when": "2018-03-05T14:33:42Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "abillings@mozilla.com"}, {"removed": "", "field_name": "alias", "added": "CVE-2018-5160"}], "who": "abillings@mozilla.com", "when": "2018-05-02T18:41:07Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "zling.ustc@gmail.com"}], "who": "abillings@mozilla.com", "when": "2018-05-02T18:42:09Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "drno@ohlmeier.org"}], "who": "rjesup@jesup.org", "when": "2018-05-09T16:11:01Z"}], "resolution": "FIXED", "op_sys": "Unspecified", "cf_fx_points": "---", "cf_blocking_fennec": "---"}