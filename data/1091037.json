{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "attachments": [{"creator": "sotaro.ikeda.g@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "feedback", "modification_date": "2015-05-06T14:16:35Z", "type_id": 607, "creation_date": "2015-05-04T18:38:28Z", "id": 1160416, "setter": "gsvelto@mozilla.com"}, {"status": "+", "name": "feedback", "modification_date": "2015-05-05T12:22:28Z", "type_id": 607, "creation_date": "2015-05-04T18:38:28Z", "id": 1160417, "setter": "nical.bugzilla@gmail.com"}], "content_type": "text/plain", "id": 8601027}, {"creator": "sotaro.ikeda.g@gmail.com", "is_obsolete": 0, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 8602242}, {"creator": "sotaro.ikeda.g@gmail.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2015-05-07T10:24:57Z", "type_id": 4, "creation_date": "2015-05-06T19:05:59Z", "id": 1162305, "setter": "gsvelto@mozilla.com"}, {"status": "+", "name": "review", "modification_date": "2015-05-07T08:58:49Z", "type_id": 4, "creation_date": "2015-05-06T19:05:59Z", "id": 1162306, "setter": "nical.bugzilla@gmail.com"}], "content_type": "text/plain", "id": 8602248}], "classification": "Components", "creator": "sotaro.ikeda.g@gmail.com", "cc": ["gsvelto@mozilla.com", "milan@mozilla.com", "nical.bugzilla@gmail.com"], "depends_on": [], "creation_time": "2014-10-29T16:02:14Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "ARM", "cf_status_firefox58": "---", "cf_status_firefox59": "---", "keywords": [], "summary": "ImageBridgeChild thread's priority is not high enough on gonk", "id": 1091037, "assigned_to_detail": {"email": "sotaro.ikeda.g@gmail.com", "id": 434202, "name": "sotaro.ikeda.g@gmail.com", "real_name": "Sotaro Ikeda [:sotaro]"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "assigned_to": "sotaro.ikeda.g@gmail.com", "comment_count": 15, "comments": [{"text": "Image thread runs as default thread priority. \n - nice=1 ,when application is in foreground\n - nice=18, when application is in background.\n\nImageBridge just doing forwarding TextureClient to Compositor. ImageBridge need to handle data as quickly as possible. And it does not consume cpu continuouly long time. It's priority should be more high than current gecko.", "author": "sotaro.ikeda.g@gmail.com", "id": 9518119, "time": "2014-10-29T16:02:14Z"}, {"text": "On gonk, if thread's nice value is less than or equal to 0, it's priority is not changed when application goes to background.", "author": "sotaro.ikeda.g@gmail.com", "id": 9518144, "time": "2014-10-29T16:06:09Z"}, {"text": "Hmm, hal::SetCurrentThreadPriority() is not allowed to be called from content process.\n https://dxr.mozilla.org/mozilla-central/source/hal/sandbox/SandboxHal.cpp#357", "author": "sotaro.ikeda.g@gmail.com", "id": 10227532, "time": "2015-05-04T15:19:21Z"}, {"text": "Instead of permitting hal::SetCurrentThreadPriority(), it seems better that ImageBridgeParent calls hal::SetCurrentThreadPriority() to raise ImageBridge thread's priority.", "author": "sotaro.ikeda.g@gmail.com", "id": 10228426, "time": "2015-05-04T18:27:26Z"}, {"text": "Created attachment 8601027\npatch - Raise ImageBridge thread priority", "author": "sotaro.ikeda.g@gmail.com", "id": 10228462, "time": "2015-05-04T18:36:40Z"}, {"text": "(In reply to Sotaro Ikeda [:sotaro] from comment #3)\n> Instead of permitting hal::SetCurrentThreadPriority(), it seems better that\n> ImageBridgeParent calls hal::SetCurrentThreadPriority() to raise ImageBridge\n> thread's priority.\n\nIt is from security point of view.", "author": "sotaro.ikeda.g@gmail.com", "id": 10228463, "time": "2015-05-04T18:37:15Z"}, {"text": "Comment on attachment 8601027\npatch - Raise ImageBridge thread priority\n\nReview of attachment 8601027:\n-----------------------------------------------------------------\n\nI don't know the android APIs very well but the general idea looks good to me. It also makes sense to do this on the other platforms.", "author": "nical.bugzilla@gmail.com", "id": 10231739, "time": "2015-05-05T12:22:28Z"}, {"text": "Comment on attachment 8601027\npatch - Raise ImageBridge thread priority\n\nThis looks good to me but there's an important thing you have to bear in mind. Since bug 1081871 landed process priorities on b2g are not adjusted anymore using nice values but using control groups instead. Adjusting nice values of a process' threads will thus only have an effect relatively to the other threads in that process and not globally anymore. So lowering the nice value of a content process' thread below the nice value of one of the main process' threads is not going to give it higher priority.", "author": "gsvelto@mozilla.com", "id": 10237148, "time": "2015-05-06T14:16:35Z"}, {"text": "Thanks. I did not noticed bug 1081871 fix. For ImageBridge thread \"relatively to the other threads in that process\" is enough.", "author": "sotaro.ikeda.g@gmail.com", "id": 10237516, "time": "2015-05-06T15:35:07Z"}, {"text": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=0cd1df58527f", "author": "sotaro.ikeda.g@gmail.com", "id": 10238259, "time": "2015-05-06T17:37:34Z"}, {"text": "Created attachment 8602242\npatch for b2gv2.1s - Raise ImageBridge thread priority", "author": "sotaro.ikeda.g@gmail.com", "id": 10238672, "time": "2015-05-06T18:56:27Z"}, {"text": "Created attachment 8602248\npatch - Raise ImageBridge thread priority\n\nUpdate nits.", "author": "sotaro.ikeda.g@gmail.com", "id": 10238711, "time": "2015-05-06T19:05:28Z"}, {"text": "Comment on attachment 8602248\npatch - Raise ImageBridge thread priority\n\nReview of attachment 8602248:\n-----------------------------------------------------------------\n\nLGTM, r+ for the HAL bits.", "author": "gsvelto@mozilla.com", "id": 10241512, "time": "2015-05-07T10:24:57Z"}, {"text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/d0b48a557161", "author": "sotaro.ikeda.g@gmail.com", "id": 10242106, "time": "2015-05-07T13:54:25Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/d0b48a557161", "author": "kwierso@gmail.com", "id": 10244891, "time": "2015-05-07T22:15:09Z"}], "cf_last_resolved": "2015-05-07T22:15:09Z", "priority": "--", "mentors_detail": [], "cf_crash_signature": "", "version": "unspecified", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox59": "---", "last_change_time": "2015-05-07T22:15:09Z", "cf_platform_rel": "---", "product": "Core", "cf_status_firefox_esr52": "---", "blocks": [1073549], "qa_contact": "", "see_also": [], "cf_fx_iteration": "---", "component": "Graphics: Layers", "votes": 0, "groups": [], "cf_status_firefox60": "---", "cf_status_firefox40": "fixed", "target_milestone": "mozilla40", "is_cc_accessible": true, "cf_status_thunderbird_esr52": "---", "url": "", "creator_detail": {"email": "sotaro.ikeda.g@gmail.com", "id": 434202, "name": "sotaro.ikeda.g@gmail.com", "real_name": "Sotaro Ikeda [:sotaro]"}, "whiteboard": "", "mentors": [], "cc_detail": [{"email": "gsvelto@mozilla.com", "id": 448747, "name": "gsvelto@mozilla.com", "real_name": "Gabriele Svelto [:gsvelto]"}, {"email": "milan@mozilla.com", "id": 456486, "name": "milan@mozilla.com", "real_name": "Milan Sreckovic [:milan]"}, {"email": "nical.bugzilla@gmail.com", "id": 438998, "name": "nical.bugzilla@gmail.com", "real_name": "Nicolas Silva [:nical]"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "cf_tracking_firefox58": "---", "cf_rank": null, "is_open": false, "history": [{"changes": [{"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "sotaro.ikeda.g@gmail.com"}], "who": "sotaro.ikeda.g@gmail.com", "when": "2014-10-29T17:30:07Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "milan@mozilla.com"}, {"removed": "", "field_name": "blocks", "added": "1073549"}], "who": "milan@mozilla.com", "when": "2014-11-04T20:02:50Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "gsvelto@mozilla.com, nical.bugzilla@gmail.com"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8601027, "added": "feedback?(gsvelto@mozilla.com), feedback?(nical.bugzilla@gmail.com)"}], "who": "sotaro.ikeda.g@gmail.com", "when": "2015-05-04T18:38:28Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "feedback?(nical.bugzilla@gmail.com)", "attachment_id": 8601027, "added": "feedback+"}], "who": "nical.bugzilla@gmail.com", "when": "2015-05-05T12:22:28Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "feedback?(gsvelto@mozilla.com)", "attachment_id": 8601027, "added": "feedback+"}], "who": "gsvelto@mozilla.com", "when": "2015-05-06T14:16:35Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8601027, "added": "review?(gsvelto@mozilla.com), review?(nical.bugzilla@gmail.com)"}], "who": "sotaro.ikeda.g@gmail.com", "when": "2015-05-06T17:30:33Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8601027, "added": "1"}, {"field_name": "flagtypes.name", "removed": "review?(gsvelto@mozilla.com), review?(nical.bugzilla@gmail.com)", "attachment_id": 8601027, "added": ""}], "who": "sotaro.ikeda.g@gmail.com", "when": "2015-05-06T19:05:28Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8602248, "added": "review?(gsvelto@mozilla.com), review?(nical.bugzilla@gmail.com)"}], "who": "sotaro.ikeda.g@gmail.com", "when": "2015-05-06T19:05:59Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(nical.bugzilla@gmail.com)", "attachment_id": 8602248, "added": "review+"}], "who": "nical.bugzilla@gmail.com", "when": "2015-05-07T08:58:49Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(gsvelto@mozilla.com)", "attachment_id": 8602248, "added": "review+"}], "who": "gsvelto@mozilla.com", "when": "2015-05-07T10:24:57Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla40"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2015-05-07 15:15:09"}, {"removed": "---", "field_name": "cf_status_firefox40", "added": "fixed"}], "who": "kwierso@gmail.com", "when": "2015-05-07T22:15:09Z"}], "resolution": "FIXED", "op_sys": "Gonk (Firefox OS)", "cf_fx_points": "---", "cf_blocking_fennec": "---"}