{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "attachments": [{"creator": "nicolas.b.pierron@mozilla.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2016-02-05T14:30:49Z", "type_id": 4, "creation_date": "2016-02-05T14:30:49Z", "id": 1337388, "setter": "hv1989@gmail.com"}], "content_type": "text/plain", "id": 8715302}], "classification": "Components", "creator": "choller@mozilla.com", "cc": ["choller@mozilla.com", "fuzzing@mozilla.com", "hv1989@gmail.com", "jdemooij@mozilla.com", "jruderman@gmail.com", "nicolas.b.pierron@mozilla.com", "nth10sd@gmail.com"], "depends_on": [], "creation_time": "2016-01-27T15:57:28Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "x86_64", "cf_status_firefox58": "---", "cf_status_firefox59": "---", "keywords": ["assertion", "regression", "testcase"], "summary": "Assertion failure: result ([OOM] Is it really infallible?), at js/src/ds/LifoAlloc.h:281 with BacktrackingAllocator involved", "id": 1243397, "assigned_to_detail": {"email": "nicolas.b.pierron@mozilla.com", "id": 422187, "name": "nicolas.b.pierron@mozilla.com", "real_name": "Nicolas B. Pierron [:nbp] {backlog: ~36}"}, "severity": "critical", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "assigned_to": "nicolas.b.pierron@mozilla.com", "comment_count": 14, "comments": [{"text": "The following testcase crashes on mozilla-central revision c0ba5835ca48 (build with --enable-optimize --enable-posix-nspr-emulation --enable-valgrind --enable-gczeal --disable-tests --enable-debug, run with --thread-count=2 --ion-extra-checks --ion-check-range-analysis --ion-eager):\n\noomTest(() => (4294967295 >>> 45.1)({ thisprops: gc('' + oomTest + '') }));\n\n\n\nBacktrace:\n\nProgram received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x7ffff5cc3700 (LWP 49201)]\n0x0000000000c7d556 in allocInfallibleOrAssert (n=72, this=<optimized out>) at js/src/ds/LifoAlloc.h:281\n#0  0x0000000000c7d556 in allocInfallibleOrAssert (n=72, this=<optimized out>) at js/src/ds/LifoAlloc.h:281\n#1  allocateInfallible (bytes=72, this=<optimized out>) at js/src/jit/JitAllocPolicy.h:40\n#2  operator new (alloc=..., nbytes=72) at js/src/jit/JitAllocPolicy.h:174\n#3  js::jit::LiveRange::New (alloc=..., vreg=3, from=..., to=...) at js/src/jit/BacktrackingAllocator.h:274\n#4  0x0000000000c6383a in js::jit::VirtualRegister::addInitialRange (this=0x7ffff69a2428, alloc=..., from=from@entry=..., to=to@entry=...) at js/src/jit/BacktrackingAllocator.cpp:299\n#5  0x0000000000c674b8 in js::jit::BacktrackingAllocator::buildLivenessInfo (this=this@entry=0x7ffff5cc20e0) at js/src/jit/BacktrackingAllocator.cpp:699\n#6  0x0000000000c78380 in js::jit::BacktrackingAllocator::go (this=this@entry=0x7ffff5cc20e0) at js/src/jit/BacktrackingAllocator.cpp:807\n#7  0x0000000000679e63 in js::jit::GenerateLIR (mir=mir@entry=0x7ffff699b1c0) at js/src/jit/Ion.cpp:1941\n#8  0x000000000067a133 in js::jit::CompileBackEnd (mir=mir@entry=0x7ffff699b1c0) at js/src/jit/Ion.cpp:2011\n#9  0x00000000009f79b4 in js::HelperThread::handleIonWorkload (this=this@entry=0x7ffff6933800) at js/src/vm/HelperThreads.cpp:1276\n#10 0x00000000009f96c7 in js::HelperThread::threadLoop (this=0x7ffff6933800) at js/src/vm/HelperThreads.cpp:1603\n#11 0x0000000000aaff71 in nspr::Thread::ThreadRoutine (arg=0x7ffff692e160) at js/src/vm/PosixNSPR.cpp:45\n#12 0x00007ffff7bc4182 in start_thread (arg=0x7ffff5cc3700) at pthread_create.c:312\n#13 0x00007ffff6cb3fbd in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:111\nrax\t0x0\t0\nrbx\t0x2\t2\nrcx\t0x7ffff6ca53cd\t140737333842893\nrdx\t0x0\t0\nrsi\t0x7ffff6f7a9d0\t140737336814032\nrdi\t0x7ffff6f791c0\t140737336807872\nrbp\t0x7ffff5cc1a80\t140737317182080\nrsp\t0x7ffff5cc1a60\t140737317182048\nr8\t0x7ffff5cc3700\t140737317189376\nr9\t0x6372732f736a2f6c\t7165916604736876396\nr10\t0x7ffff5cc1820\t140737317181472\nr11\t0x7ffff6c27960\t140737333328224\nr12\t0xf\t15\nr13\t0x3\t3\nr14\t0x0\t0\nr15\t0x0\t0\nrip\t0xc7d556 <js::jit::LiveRange::New(js::jit::TempAllocator&, unsigned int, js::jit::CodePosition, js::jit::CodePosition)+150>\n=> 0xc7d556 <js::jit::LiveRange::New(js::jit::TempAllocator&, unsigned int, js::jit::CodePosition, js::jit::CodePosition)+150>:\tmovl   $0x119,0x0\n   0xc7d561 <js::jit::LiveRange::New(js::jit::TempAllocator&, unsigned int, js::jit::CodePosition, js::jit::CodePosition)+161>:\tcallq  0x4a3830 <abort()>", "author": "choller@mozilla.com", "id": 11112586, "time": "2016-01-27T15:57:28Z"}, {"text": "JSBugMon: Bisection requested, result:\n=== Treeherder Build Bisection Results by autoBisect ===\n\nThe \"good\" changeset has the timestamp \"20151027074027\" and the hash \"5430b2dba98b2a39ccdfd3700131f780a27be17c\".\nThe \"bad\" changeset has the timestamp \"20151027075125\" and the hash \"fbf7d94986bb51bb53bdfdfd57d29dcc62f31ae4\".\n\nLikely regression window: https://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=5430b2dba98b2a39ccdfd3700131f780a27be17c&tochange=fbf7d94986bb51bb53bdfdfd57d29dcc62f31ae4", "author": "fuzzing@mozilla.com", "id": 11112636, "time": "2016-01-27T16:12:32Z"}, {"text": "Nicolas, is bug 991249 a likely regressor?", "author": "nth10sd@gmail.com", "id": 11117030, "time": "2016-01-28T17:09:17Z"}, {"text": "(In reply to Gary Kwong [:gkw] [:nth10sd] from comment #2)\n> Nicolas, is bug 991249 a likely regressor?\n\nNo, this is just the patch which made these OOM testable.", "author": "nicolas.b.pierron@mozilla.com", "id": 11117411, "time": "2016-01-28T18:53:47Z"}, {"text": "Is this then related to bug 1244828?", "author": "nth10sd@gmail.com", "id": 11129619, "time": "2016-02-02T16:06:46Z"}, {"text": "(In reply to Gary Kwong [:gkw] [:nth10sd] from comment #4)\n> Is this then related to bug 1244828?\n\nNo, this one is under the BacktrackingAllocator, as opposed to the TypeAnalysis.\nStill this should be a blocker of Bug 1244824.", "author": "nicolas.b.pierron@mozilla.com", "id": 11129989, "time": "2016-02-02T17:46:36Z"}, {"text": "Created attachment 8715302\nEnsure enough ballast space in LiveRange::New.\n\nLiveRange allocations are not happening at every loop iterations, and are\ndependent on the number of virtual register which is somewhat a function of\nthe number of instructions.\n\nThus we cannot consider this allocation as being infallible.\n\nHopefulle (git grep -A 3 LiveRange::New) all allocations are already guarded.", "author": "nicolas.b.pierron@mozilla.com", "id": 11133171, "time": "2016-02-03T14:28:24Z"}, {"text": "Comment on attachment 8715302\nEnsure enough ballast space in LiveRange::New.\n\nReview of attachment 8715302:\n-----------------------------------------------------------------\n\nThe fix in bug 1245154 is better", "author": "hv1989@gmail.com", "id": 11141253, "time": "2016-02-05T14:28:41Z"}, {"text": "Comment on attachment 8715302\nEnsure enough ballast space in LiveRange::New.\n\nReview of attachment 8715302:\n-----------------------------------------------------------------\n\nWoops. Going too fast.\n\nCan you create FallibleNew and make sure all uses now use this new variant? (Just like in bug 1245154)", "author": "hv1989@gmail.com", "id": 11141263, "time": "2016-02-05T14:30:49Z"}, {"text": "*** Bug 1245155 has been marked as a duplicate of this bug. ***", "author": "nicolas.b.pierron@mozilla.com", "id": 11146266, "time": "2016-02-08T13:51:55Z"}, {"text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/092754992cef", "author": "pulsebot@bots.tld", "id": 11147236, "time": "2016-02-08T17:40:30Z"}, {"text": "I had to back this out for breaking asm tests in mochitest-1:\n\nhttps://treeherder.mozilla.org/logviewer.html#?job_id=21287226&repo=mozilla-inbound\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/7131c65c0d4a", "author": "kwierso@gmail.com", "id": 11147530, "time": "2016-02-08T18:54:58Z"}, {"text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/08c473408dcc", "author": "pulsebot@bots.tld", "id": 11158321, "time": "2016-02-11T17:51:51Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/08c473408dcc", "author": "cbook@mozilla.com", "id": 11161059, "time": "2016-02-12T14:20:21Z"}], "cf_last_resolved": "2016-02-12T14:20:21Z", "priority": "--", "mentors_detail": [], "cf_crash_signature": "", "version": "Trunk", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox59": "---", "last_change_time": "2016-02-12T14:20:21Z", "cf_platform_rel": "---", "product": "Core", "cf_status_firefox_esr52": "---", "blocks": [676763, 912928, 991249, 1244824], "qa_contact": "", "see_also": [], "cf_fx_iteration": "---", "component": "JavaScript Engine", "votes": 0, "groups": [], "cf_status_firefox60": "---", "target_milestone": "mozilla47", "is_cc_accessible": true, "cf_status_firefox46": "---", "cf_status_thunderbird_esr52": "---", "url": "", "creator_detail": {"email": "choller@mozilla.com", "id": 395101, "name": "choller@mozilla.com", "real_name": "Christian Holler (:decoder)"}, "whiteboard": "[jsbugmon:update]", "mentors": [], "cc_detail": [{"email": "choller@mozilla.com", "id": 395101, "name": "choller@mozilla.com", "real_name": "Christian Holler (:decoder)"}, {"email": "fuzzing@mozilla.com", "id": 469204, "name": "fuzzing@mozilla.com", "real_name": "Fuzzing Team"}, {"email": "hv1989@gmail.com", "id": 196399, "name": "hv1989@gmail.com", "real_name": "Hannes Verschore [:h4writer]"}, {"email": "jdemooij@mozilla.com", "id": 375297, "name": "jdemooij@mozilla.com", "real_name": "Jan de Mooij [:jandem] (PTO Mar 8)"}, {"email": "jruderman@gmail.com", "id": 11608, "name": "jruderman@gmail.com", "real_name": "Jesse Ruderman"}, {"email": "nicolas.b.pierron@mozilla.com", "id": 422187, "name": "nicolas.b.pierron@mozilla.com", "real_name": "Nicolas B. Pierron [:nbp] {backlog: ~36}"}, {"email": "nth10sd@gmail.com", "id": 132034, "name": "nth10sd@gmail.com", "real_name": "Gary Kwong [:gkw] [:nth10sd]"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "cf_tracking_firefox58": "---", "cf_rank": null, "is_open": false, "history": [{"changes": [{"removed": "[jsbugmon:update,bisect]", "field_name": "whiteboard", "added": "[jsbugmon:update]"}], "who": "fuzzing@mozilla.com", "when": "2016-01-27T16:12:31Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jdemooij@mozilla.com, nicolas.b.pierron@mozilla.com"}, {"removed": "", "field_name": "blocks", "added": "991249"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(nicolas.b.pierron@mozilla.com)"}], "who": "nth10sd@gmail.com", "when": "2016-01-28T17:09:17Z"}, {"changes": [{"removed": "needinfo?(nicolas.b.pierron@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "nicolas.b.pierron@mozilla.com", "when": "2016-01-28T18:53:47Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(nicolas.b.pierron@mozilla.com)"}], "who": "nth10sd@gmail.com", "when": "2016-02-02T16:06:46Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1244824"}, {"removed": "needinfo?(nicolas.b.pierron@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "nicolas.b.pierron@mozilla.com", "when": "2016-02-02T17:46:36Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8715302, "added": "review?(hv1989@gmail.com)"}, {"removed": "", "field_name": "cc", "added": "hv1989@gmail.com"}], "who": "nicolas.b.pierron@mozilla.com", "when": "2016-02-03T14:28:24Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "ASSIGNED"}, {"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "nicolas.b.pierron@mozilla.com"}], "who": "nicolas.b.pierron@mozilla.com", "when": "2016-02-03T14:28:49Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(hv1989@gmail.com)", "attachment_id": 8715302, "added": "review+"}], "who": "hv1989@gmail.com", "when": "2016-02-04T08:55:26Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8715302, "added": ""}], "who": "hv1989@gmail.com", "when": "2016-02-05T14:28:41Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8715302, "added": "review+"}], "who": "hv1989@gmail.com", "when": "2016-02-05T14:30:49Z"}, {"changes": [{"removed": "ASSIGNED", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla47"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2016-02-12 06:20:21"}, {"removed": "affected", "field_name": "cf_status_firefox47", "added": "fixed"}], "who": "cbook@mozilla.com", "when": "2016-02-12T14:20:21Z"}], "resolution": "FIXED", "op_sys": "Linux", "cf_fx_points": "---", "cf_blocking_fennec": "---"}