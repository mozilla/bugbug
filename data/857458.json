{"cf_tracking_thunderbird_esr52": "---", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "cf_tracking_firefox62": "---", "creator": "blair@theunfocused.net", "mentors_detail": [], "depends_on": [357276, 1446868, 1460336], "cf_status_firefox_esr60": "---", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "All", "keywords": [], "cc_detail": [{"email": "andy+bugzilla@mckay.pub", "id": 397635, "name": "andy+bugzilla@mckay.pub", "real_name": "Andy McKay"}, {"email": "bugzilla-mozilla@dorando.at", "id": 110580, "name": "bugzilla-mozilla@dorando.at", "real_name": "Dorando"}, {"email": "erahm@mozilla.com", "id": 496127, "name": "erahm@mozilla.com", "real_name": "Eric Rahm [:erahm] (please no mozreview requests)"}, {"email": "gavin.sharp@gmail.com", "id": 103593, "name": "gavin.sharp@gmail.com", "real_name": ":Gavin Sharp [email: gavin@gavinsharp.com]"}, {"email": "jorge@mozilla.com", "id": 189742, "name": "jorge@mozilla.com", "real_name": "Jorge Villalobos [:jorgev]"}, {"email": "kmaglione+bmo@mozilla.com", "id": 106098, "name": "kmaglione+bmo@mozilla.com", "real_name": "Kris Maglione [:kmag]"}, {"email": "mak77@bonardo.net", "id": 240353, "name": "mak77@bonardo.net", "real_name": "Marco Bonardo [::mak]"}, {"email": "mcastelluccio@mozilla.com", "id": 420453, "name": "mcastelluccio@mozilla.com", "real_name": "Marco Castelluccio [:marco]"}, {"email": "ngyikp@gmail.com", "id": 524888, "name": "ngyikp@gmail.com", "real_name": "ngyikp"}, {"email": "scolville@mozilla.com", "id": 462407, "name": "scolville@mozilla.com", "real_name": "Stuart Colville [:scolville] [:muffinresearch]"}, {"email": "timbugzilla@gmail.com", "id": 437905, "name": "timbugzilla@gmail.com", "real_name": ""}], "cf_last_resolved": null, "attachments": [], "votes": 3, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 15, "comments": [{"text": "Currently, the Add-ons Manager uses nsIRDFService to read update manifests (update.rdf) - we'd like to kill that with fire. However, we can't just drop support for update.rdf. Instead, I'd like to move to using the RDF reader JSM that bug 857454 will implement.", "author": "blair@theunfocused.net", "id": 7270427, "time": "2013-04-03T06:12:25Z"}, {"text": ":mak, it seems like we can close this now that we only support web extensions. Is that correct?", "author": "erahm@mozilla.com", "id": 12730193, "time": "2017-10-04T22:28:25Z"}, {"text": "I'm pretty sure AMO still serves update manifests as rdf, even for webextensions.", "author": "aswan@mozilla.com", "id": 12730236, "time": "2017-10-04T22:51:27Z"}, {"text": "This one is tricky.  We support both rdf and json for updates.  There's an immediate dependency on AMO to get it to serve updates as json.  But we also document the rdf update format for extension developers so we need to give them some notice if we're going to take it away.\nI think we talked about this earlier but I can't find the bug.  In any case, Jorge, can we make it deprecated an announce an intent to remove it in some specific release (say 60 just to pull something out of thin air?)", "author": "aswan@mozilla.com", "id": 12730715, "time": "2017-10-05T02:28:19Z"}, {"text": "(In reply to Eric Rahm [:erahm] (please no mozreview requests) from comment #1)\n> :mak, it seems like we can close this now that we only support web\n> extensions. Is that correct?\n\nRegardless, once AMO is fixed, we should also remove the add-ons code that uses nsIRDFService and some tests could have to rewritten or removed.", "author": "mak77@bonardo.net", "id": 12731269, "time": "2017-10-05T08:28:33Z"}, {"text": "(In reply to Andrew Swan [:aswan] from comment #3)\n> This one is tricky.  We support both rdf and json for updates.  There's an\n> immediate dependency on AMO to get it to serve updates as json.  But we also\n> document the rdf update format for extension developers so we need to give\n> them some notice if we're going to take it away.\n> I think we talked about this earlier but I can't find the bug.  In any case,\n> Jorge, can we make it deprecated an announce an intent to remove it in some\n> specific release (say 60 just to pull something out of thin air?)\n\n59 might make more sense so that it corresponds with the next ESR.", "author": "erahm@mozilla.com", "id": 12732923, "time": "2017-10-05T18:30:59Z"}, {"text": "Moving AMO to use the JSON update format is not a priority at the moment, and Firefox 59 is too soon. I'll try to get this in for H1 2018, but unless there's some urgency to get this done sooner I can't make any promises.", "author": "jorge@mozilla.com", "id": 12733213, "time": "2017-10-05T19:36:02Z"}, {"text": "One thing we could do earlier is show a warning in the console when an RDF update happens (except for AMO). That will reach developers more effectively than any comms we put out, since these are all unlisted add-ons we're talking about.", "author": "jorge@mozilla.com", "id": 12733223, "time": "2017-10-05T19:39:56Z"}, {"text": "That log will show to the end users of the add-ons not the developers (unless they test their add-on updates). Since at least all the add-ons come through AMO we could try hitting the end point specified in the add-on as it gets signed and seeing what format it is.", "author": "andy+bugzilla@mckay.pub", "id": 12733326, "time": "2017-10-05T20:07:37Z"}, {"text": "(In reply to Jorge Villalobos [:jorgev] from comment #6)\n> Moving AMO to use the JSON update format is not a priority at the moment,\n> and Firefox 59 is too soon. I'll try to get this in for H1 2018, but unless\n> there's some urgency to get this done sooner I can't make any promises.\n\nEric might feel differently but this is about a chunk of obsolete bloat that we would like to remove from the browser.  That's never really going to something we can realistically call \"urgent\" but its an ongoing tax.  If I do the addons-server patches can we do this soon or is there another bottleneck like QA or something?", "author": "aswan@mozilla.com", "id": 12733807, "time": "2017-10-05T23:52:14Z"}, {"text": "> That log will show to the end users of the add-ons not the developers (unless they test their add-on updates)\n\nWe encourage devs to always test their add-ons with the console open. But I suppose it's a stretch to expect them to test their updates in the same way.\n\n> If I do the addons-server patches can we do this soon or is there another bottleneck like QA or something?\n\nIt's not just a matter of changing to the new format. We'll probably need to support both formats for some time, to support older clients, and that means we'll need to add client detection and figure out what its performance impact will be. And sure, this needs lots of QA since add-on updates are a critical feature.", "author": "jorge@mozilla.com", "id": 12735840, "time": "2017-10-06T17:20:52Z"}, {"text": "(In reply to Jorge Villalobos [:jorgev] from comment #10)\n> > If I do the addons-server patches can we do this soon or is there another bottleneck like QA or something?\n> \n> It's not just a matter of changing to the new format. We'll probably need to\n> support both formats for some time, to support older clients, and that means\n> we'll need to add client detection and figure out what its performance\n> impact will be. And sure, this needs lots of QA since add-on updates are a\n> critical feature.\n\nThe JSON format has been supported since Firefox 45 (see bug 1214058), given that webextensions were pretty primitive back then and AMO no longer accepts updates to legacy extensions, I think we can just make a clean switch.  So sorry to keep nagging on this but in light of the above, if I write the addons-server patches, can we make time in the QA schedule to push this out soon-ish?", "author": "aswan@mozilla.com", "id": 12735867, "time": "2017-10-06T17:28:25Z"}, {"text": "> I think we can just make a clean switch\n\nSorry, but this is not a decision that we're going to make lightly. I understand the value of getting rid of RDF, and agree it should happen sooner rather than later, but I'm not going rush this through.", "author": "jorge@mozilla.com", "id": 12735922, "time": "2017-10-06T17:43:29Z"}, {"text": "I filed an issue to investigate the clean switch option: https://github.com/mozilla/addons-server/issues/6612", "author": "jorge@mozilla.com", "id": 12735989, "time": "2017-10-06T18:05:19Z"}, {"text": "This is becoming increasingly problematic to maintain. We need to remove support for non-restartless add-ons before we can start working on things like supporting async startup and shutdown of bootstrap operations. At the moment, that requires majorly reworking a bunch of tests that currently need to support both RDF and JSON update formats.", "author": "kmaglione+bmo@mozilla.com", "id": 13135918, "time": "2018-03-17T19:30:57Z"}], "id": 857458, "priority": "P1", "cc": ["andy+bugzilla@mckay.pub", "bugzilla-mozilla@dorando.at", "erahm@mozilla.com", "gavin.sharp@gmail.com", "jorge@mozilla.com", "kmaglione+bmo@mozilla.com", "mak77@bonardo.net", "mcastelluccio@mozilla.com", "ngyikp@gmail.com", "scolville@mozilla.com", "timbugzilla@gmail.com"], "cf_crash_signature": "", "version": "Trunk", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": ["https://github.com/mozilla/addons-server/issues/7223"], "cf_tracking_thunderbird_esr60": "---", "status": "NEW", "product": "Toolkit", "cf_fx_iteration": "---", "blocks": [1446677], "qa_contact": "", "creation_time": "2013-04-03T06:12:25Z", "cf_status_firefox_esr52": "---", "component": "Add-ons Manager", "assigned_to_detail": {"email": "kmaglione+bmo@mozilla.com", "id": 106098, "name": "kmaglione+bmo@mozilla.com", "real_name": "Kris Maglione [:kmag]"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "---", "cf_status_firefox60": "---", "target_milestone": "---", "cf_rank": null, "cf_qa_whiteboard": "", "severity": "normal", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "blair@theunfocused.net", "id": 292667, "name": "blair@theunfocused.net", "real_name": "Blair McBride [:Unfocused] (UNAVAILABLE)"}, "whiteboard": "", "mentors": [], "summary": "Remove support for update.rdf", "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-05-15T05:03:09Z", "assigned_to": "kmaglione+bmo@mozilla.com", "is_open": true, "history": [{"changes": [{"removed": "857454", "field_name": "depends_on", "added": "357276"}], "who": "blair@theunfocused.net", "when": "2013-04-03T06:18:03Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "833098"}], "who": "blair@theunfocused.net", "when": "2013-04-03T06:19:29Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "gavin.sharp@gmail.com"}], "who": "gavin.sharp@gmail.com", "when": "2013-04-03T07:40:57Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "timbugzilla@gmail.com"}], "who": "timbugzilla@gmail.com", "when": "2014-09-10T00:45:52Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mak77@bonardo.net"}, {"removed": "Use RDF reader module for reading update.rdf manifests", "field_name": "summary", "added": "Use RDF reader module for reading update.rdf manifests, or convert them to JSON"}], "who": "mak77@bonardo.net", "when": "2017-03-15T08:39:00Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "erahm@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(mak77@bonardo.net)"}], "who": "erahm@mozilla.com", "when": "2017-10-04T22:28:25Z"}, {"changes": [{"removed": "needinfo?(mak77@bonardo.net)", "field_name": "flagtypes.name", "added": ""}], "who": "aswan@mozilla.com", "when": "2017-10-04T22:51:27Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jorge@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(jorge@mozilla.com)"}], "who": "aswan@mozilla.com", "when": "2017-10-05T02:28:19Z"}, {"changes": [{"removed": "needinfo?(jorge@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "jorge@mozilla.com", "when": "2017-10-05T19:36:02Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "amckay@mozilla.com"}], "who": "andy+bugzilla@mckay.pub", "when": "2017-10-05T20:07:37Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(jorge@mozilla.com)"}], "who": "aswan@mozilla.com", "when": "2017-10-05T23:52:14Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "scolville@mozilla.com"}, {"removed": "needinfo?(jorge@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "jorge@mozilla.com", "when": "2017-10-06T17:20:52Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(jorge@mozilla.com)"}], "who": "aswan@mozilla.com", "when": "2017-10-06T17:28:25Z"}, {"changes": [{"removed": "needinfo?(jorge@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "jorge@mozilla.com", "when": "2017-10-06T17:43:29Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mcastelluccio@mozilla.com"}], "who": "mcastelluccio@mozilla.com", "when": "2018-01-10T23:56:37Z"}, {"changes": [{"removed": "Use RDF reader module for reading update.rdf manifests, or convert them to JSON", "field_name": "summary", "added": "stop supporting update.rdf"}], "who": "mak77@bonardo.net", "when": "2018-01-12T09:03:17Z"}, {"changes": [{"removed": "--", "field_name": "priority", "added": "P1"}, {"removed": "", "field_name": "cc", "added": "kmaglione+bmo@mozilla.com"}, {"removed": "", "field_name": "see_also", "added": "https://github.com/mozilla/addons-server/issues/7223"}, {"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "kmaglione+bmo@mozilla.com"}, {"removed": "stop supporting update.rdf", "field_name": "summary", "added": "Remove support for update.rdf"}], "who": "kmaglione+bmo@mozilla.com", "when": "2018-03-17T19:30:57Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1446677"}], "who": "kmaglione+bmo@mozilla.com", "when": "2018-03-17T19:38:46Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1446868"}], "who": "kmaglione+bmo@mozilla.com", "when": "2018-03-19T04:23:02Z"}, {"changes": [{"removed": "833098", "field_name": "blocks", "added": ""}], "who": "kmaglione+bmo@mozilla.com", "when": "2018-04-29T04:05:09Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bugzilla-mozilla@dorando.at"}], "who": "bugzilla-mozilla@dorando.at", "when": "2018-04-29T12:36:53Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1460336"}], "who": "kmaglione+bmo@mozilla.com", "when": "2018-05-09T16:22:07Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "ngyikp@gmail.com"}], "who": "ngyikp@gmail.com", "when": "2018-05-15T05:03:09Z"}], "resolution": "", "op_sys": "All", "cf_fx_points": "---", "cf_blocking_fennec": "---"}