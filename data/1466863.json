{"status": "VERIFIED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "+", "classification": "Client Software", "creator": "mozilla@kaply.com", "cc": ["catalin.sasca@softvision.ro", "florian@queze.net", "ryanvm@gmail.com"], "depends_on": [], "creation_time": "2018-06-05T14:56:34Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "keywords": [], "summary": "Set metadata to {} instead of checking every time", "cf_last_resolved": "2018-06-08T10:00:39Z", "attachments": [{"creator": "mozilla@kaply.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2018-06-07T10:12:11Z", "type_id": 748, "creation_date": "2018-06-06T20:59:22Z", "id": 1766796, "setter": "florian@queze.net"}, {"status": "+", "name": "approval-mozilla-beta", "modification_date": "2018-06-13T23:22:08Z", "type_id": 721, "creation_date": "2018-06-13T20:01:32Z", "id": 1768701, "setter": "ryanvm@gmail.com"}, {"status": "+", "name": "approval-mozilla-esr60", "modification_date": "2018-06-13T23:22:08Z", "type_id": 929, "creation_date": "2018-06-13T20:01:32Z", "id": 1768702, "setter": "ryanvm@gmail.com"}], "content_type": "text/x-review-board-request", "id": 8983954}], "assigned_to_detail": {"email": "mozilla@kaply.com", "id": 7313, "name": "mozilla@kaply.com", "real_name": "Mike Kaply [:mkaply]"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 11, "comments": [{"text": "Per Florian's comment in bug 1455261, we shouldn't check the value on every getAttr, we should just store the null metadata now that we know what the problem is.", "author": "mozilla@kaply.com", "id": 13388196, "time": "2018-06-05T14:56:34Z"}, {"text": "Created attachment 8983954\nBug 1466863 - Just use empty metadata if invalid.\n\nReview commit: https://reviewboard.mozilla.org/r/249800/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/249800/", "author": "mozilla@kaply.com", "id": 13392147, "time": "2018-06-06T20:59:22Z"}, {"text": "Comment on attachment 8983954\nBug 1466863 - Just use empty metadata if invalid.\n\nhttps://reviewboard.mozilla.org/r/249800/#review256158\n\nLooks good to me with the '|| undefined' re-added.\n\nI think we'll want QA to verify this fix using the file provided in bug 1466134.\n\n::: toolkit/components/search/nsSearchService.js:2046\n(Diff revision 1)\n>    setAttr(name, val) {\n>      this._metaData[name] = val;\n>    },\n>  \n>    getAttr(name) {\n> -    return (this._metaData && this._metaData[name]) || undefined;\n> +    return this._metaData[name];\n\nThe '|| undefined' was already there before your previous patch, I don't think we want to remove it. Without it I think we would cause JS strict warnings when accessing optional attributes (eg 'alias').", "author": "florian@queze.net", "id": 13393224, "time": "2018-06-07T10:12:11Z"}, {"text": "Comment on attachment 8983954\nBug 1466863 - Just use empty metadata if invalid.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/249800/diff/1-2/", "author": "mozilla@kaply.com", "id": 13393913, "time": "2018-06-07T15:12:16Z"}, {"text": "Pushed by mozilla@kaply.com:\nhttps://hg.mozilla.org/integration/autoland/rev/5404016c6d16\nJust use empty metadata if invalid. r=florian", "author": "pulsebot@bots.tld", "id": 13394537, "time": "2018-06-07T19:11:49Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/5404016c6d16", "author": "aiakab@mozilla.com", "id": 13395846, "time": "2018-06-08T10:00:39Z"}, {"text": "Comment on attachment 8983954\nBug 1466863 - Just use empty metadata if invalid.\n\nApproval Request Comment\n[Feature/Bug causing the regression]: None\n[User impact if declined]: Some users who get engines added by third party can't use their browser.\n[Is this code covered by automated tests?]: No\n[Has the fix been verified in Nightly?]: Yes\n[Needs manual test from QE? If yes, steps to reproduce]:  No (already done)\n[List of other uplifts needed for the feature/fix]: bug 1455261\n[Is the change risky?]: No\n[Why is the change risky/not risky?]: Just adds a null check.\n[String changes made/needed]: None\n\n[Approval Request Comment]\nIf this is not a sec:{high,crit} bug, please state case for ESR consideration:\nUser impact if declined: Some users can't use URL bar/search if they have hijacked.\nFix Landed on Version: 62\nRisk to taking this patch (and alternatives if risky):  Very low\nString or UUID changes made by this patch:  None\n\nSee https://wiki.mozilla.org/Release_Management/ESR_Landing_Process for more info.\n\n\nThe reason Bug 1455261 is needed is to avoid conflicts. This patch is an improvement on the existing fix in 1455261 (which was tested and verified by QE).", "author": "mozilla@kaply.com", "id": 13404109, "time": "2018-06-13T20:01:32Z"}, {"text": "Comment on attachment 8983954\nBug 1466863 - Just use empty metadata if invalid.\n\nFixes broken search when some third parties add search engines. Approved for 61.0b14 and ESR 60.1.", "author": "ryanvm@gmail.com", "id": 13404488, "time": "2018-06-13T23:22:08Z"}, {"text": "https://hg.mozilla.org/releases/mozilla-beta/rev/70c46487e513", "author": "ryanvm@gmail.com", "id": 13404507, "time": "2018-06-13T23:34:03Z"}, {"text": "https://hg.mozilla.org/releases/mozilla-esr60/rev/9b9625e75c2f", "author": "ryanvm@gmail.com", "id": 13404529, "time": "2018-06-13T23:45:24Z"}, {"text": "The issue is verified fixed using the patch and STR provided in the e-mail forwarded from Mike. Tests were performed under latest Nightly 62.0a1 (2018-06-14) and Firefox 61.0b14.", "author": "catalin.sasca@softvision.ro", "id": 13406430, "time": "2018-06-15T06:15:19Z"}], "id": 1466863, "priority": "P1", "mentors_detail": [], "cf_crash_signature": "", "version": "Trunk", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox62": "+", "cf_platform_rel": "---", "product": "Firefox", "cf_status_firefox_esr52": "wontfix", "blocks": [], "qa_contact": "", "see_also": [], "cf_fx_iteration": "---", "component": "Search", "votes": 0, "cf_tracking_firefox_esr60": "61+", "cf_status_firefox62": "verified", "cf_status_firefox61": "verified", "cf_status_firefox60": "wontfix", "target_milestone": "Firefox 62", "is_cc_accessible": true, "cf_rank": null, "groups": [], "url": "", "creator_detail": {"email": "mozilla@kaply.com", "id": 7313, "name": "mozilla@kaply.com", "real_name": "Mike Kaply [:mkaply]"}, "whiteboard": "", "mentors": [], "cc_detail": [{"email": "catalin.sasca@softvision.ro", "id": 612754, "name": "catalin.sasca@softvision.ro", "real_name": "Sasca Catalin, QA [:csasca]"}, {"email": "florian@queze.net", "id": 149052, "name": "florian@queze.net", "real_name": "Florian Qu\u00e8ze [:florian]"}, {"email": "ryanvm@gmail.com", "id": 75935, "name": "ryanvm@gmail.com", "real_name": "Ryan VanderMeulen [:RyanVM]"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [{"status": "+", "name": "qe-verify", "modification_date": "2018-06-08T19:40:53Z", "type_id": 864, "creation_date": "2018-06-08T19:40:53Z", "id": 1767753, "setter": "ryanvm@gmail.com"}], "last_change_time": "2018-06-15T06:15:19Z", "cf_status_firefox_esr60": "fixed", "assigned_to": "mozilla@kaply.com", "is_open": false, "resolution": "FIXED", "op_sys": "Unspecified", "cf_fx_points": "---", "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "florian@queze.net"}], "who": "florian@queze.net", "when": "2018-06-05T14:58:03Z"}, {"changes": [{"removed": "--", "field_name": "priority", "added": "P1"}], "who": "mozilla@kaply.com", "when": "2018-06-05T22:01:25Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8983954, "added": "review?(florian@queze.net)"}], "who": "mozilla@kaply.com", "when": "2018-06-06T20:59:22Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "ryanvm@gmail.com"}, {"removed": "---", "field_name": "cf_status_firefox_esr52", "added": "wontfix"}, {"removed": "---", "field_name": "cf_tracking_firefox_esr60", "added": "61+"}, {"removed": "---", "field_name": "cf_status_firefox_esr60", "added": "affected"}, {"removed": "---", "field_name": "cf_status_firefox60", "added": "wontfix"}, {"removed": "---", "field_name": "cf_tracking_firefox61", "added": "+"}, {"removed": "---", "field_name": "cf_status_firefox61", "added": "affected"}, {"removed": "---", "field_name": "cf_tracking_firefox62", "added": "+"}], "who": "ryanvm@gmail.com", "when": "2018-06-07T01:54:05Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(florian@queze.net)", "attachment_id": 8983954, "added": "review+"}], "who": "florian@queze.net", "when": "2018-06-07T10:12:11Z"}, {"changes": [{"removed": "ASSIGNED", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "Firefox 62"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2018-06-08 10:00:39"}, {"removed": "affected", "field_name": "cf_status_firefox62", "added": "fixed"}], "who": "aiakab@mozilla.com", "when": "2018-06-08T10:00:39Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "qe-verify+"}], "who": "ryanvm@gmail.com", "when": "2018-06-08T19:40:53Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8983954, "added": "approval-mozilla-beta?, approval-mozilla-esr60?"}], "who": "mozilla@kaply.com", "when": "2018-06-13T20:01:32Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "approval-mozilla-beta?, approval-mozilla-esr60?", "attachment_id": 8983954, "added": "approval-mozilla-beta+, approval-mozilla-esr60+"}], "who": "ryanvm@gmail.com", "when": "2018-06-13T23:22:08Z"}, {"changes": [{"removed": "affected", "field_name": "cf_status_firefox61", "added": "fixed"}], "who": "ryanvm@gmail.com", "when": "2018-06-13T23:34:03Z"}, {"changes": [{"removed": "affected", "field_name": "cf_status_firefox_esr60", "added": "fixed"}], "who": "ryanvm@gmail.com", "when": "2018-06-13T23:45:24Z"}, {"changes": [{"removed": "RESOLVED", "field_name": "status", "added": "VERIFIED"}, {"removed": "", "field_name": "cc", "added": "catalin.sasca@softvision.ro"}, {"removed": "fixed", "field_name": "cf_status_firefox61", "added": "verified"}, {"removed": "fixed", "field_name": "cf_status_firefox62", "added": "verified"}], "who": "catalin.sasca@softvision.ro", "when": "2018-06-15T06:15:19Z"}]}