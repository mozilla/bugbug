{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "cf_tracking_firefox62": "---", "creator": "MattN+bmo@mozilla.com", "mentors_detail": [], "depends_on": [1455309], "cf_status_firefox_esr60": "---", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "All", "cf_status_firefox59": "---", "keywords": ["intermittent-failure", "reproducible"], "cc_detail": [{"email": "amarchesini@mozilla.com", "id": 446257, "name": "amarchesini@mozilla.com", "real_name": "Andrea Marchesini [:baku]"}, {"email": "andrei.br92@gmail.com", "id": 476157, "name": "andrei.br92@gmail.com", "real_name": "Andrei Oprea [:andreio]"}, {"email": "bugmail@mozilla.staktrace.com", "id": 426788, "name": "bugmail@mozilla.staktrace.com", "real_name": "Kartikaya Gupta (email:kats@mozilla.com)"}, {"email": "intermittent-bug-filer@mozilla.bugs", "id": 573381, "name": "intermittent-bug-filer@mozilla.bugs", "real_name": "Treeherder Bug Filer"}, {"email": "jhofmann@mozilla.com", "id": 522029, "name": "jhofmann@mozilla.com", "real_name": "Johann Hofmann [:johannh]"}, {"email": "jmaher@mozilla.com", "id": 324370, "name": "jmaher@mozilla.com", "real_name": "Joel Maher ( :jmaher ) (UTC-4)"}, {"email": "mconley@mozilla.com", "id": 403756, "name": "mconley@mozilla.com", "real_name": "Mike Conley (:mconley) (:\u2699\ufe0f) (Catching up on needinfos / reviews)"}, {"email": "milaninbugzilla@gmail.com", "id": 456486, "name": "milaninbugzilla@gmail.com", "real_name": "Milan Sreckovic [:milan] (needinfo for best results)"}], "cf_last_resolved": "2018-04-20T13:21:40Z", "attachments": [{"creator": "MattN+bmo@mozilla.com", "is_obsolete": 0, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 8968384}], "votes": 0, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 19, "comments": [{"text": "BrowserTestUtils tab helpers used for mochitest-browser-chrome tests are causing test-verify-e10s (TV) perma-fails with QuantumRender enabled on both macOS and linux64 (opt and debug). The issue affects BrowserTestUtils.openNewForegroundTab which is used by BrowserTestUtils.withNewTab.\n\nReproducible examples:\n* bug 1454333\n> MOZ_WEBRENDER=1 MOZ_ACCELERATED=1 ./mach mochitest browser/base/content/test/urlbar/browser_search_favicon.js --verify\n* bug 1428472 comment 8\n> MOZ_WEBRENDER=1 MOZ_ACCELERATED=1 ./mach mochitest toolkit/components/payments/test/browser/browser_change_shipping.js --verify\n\nProbably any tests using `BrowserTestUtils.withNewTab` or `BrowserTestUtils.openNewForegroundTab` are affected. Other potential candidates: https://bit.ly/2vnm6FE\n\nThe issue seems to be that `BrowserTestUtils.switchTab` never receives the `TabSwitchDone` event while AsyncTabSwitcher gets stuck repeatedly running onUnloadTimeout (visible via --setpref browser.tabs.remote.logSwitchTiming=true). I'm not sure if the bug is in AsyncTabSwitcher or QuantumRender though.", "author": "MattN+bmo@mozilla.com", "id": 13211324, "time": "2018-04-17T01:35:29Z"}, {"text": "This might be caused by bug 1437036, but that's just a guess based on how it sounds kind of similar to the other issues caused by that bug (see the dependencies). There's a patch there you can apply to see if it helps.", "author": "bugmail@mozilla.staktrace.com", "id": 13211347, "time": "2018-04-17T01:43:15Z"}, {"text": "Created attachment 8968384\nDebug logging patch", "author": "MattN+bmo@mozilla.com", "id": 13211348, "time": "2018-04-17T01:45:31Z"}, {"text": "(In reply to Kartikaya Gupta (email:kats@mozilla.com) from comment #1)\n> This might be caused by bug 1437036, but that's just a guess based on how it\n> sounds kind of similar to the other issues caused by that bug (see the\n> dependencies). There's a patch there you can apply to see if it helps.\n\nUnfortunately https://hg.mozilla.org/try/rev/65c4531ccaee3dac80cf8e17e3d2ada667080b48 doesn't seem to fix the problem.", "author": "MattN+bmo@mozilla.com", "id": 13211356, "time": "2018-04-17T01:52:56Z"}, {"text": "We have been trying to figure out the same issue which is preventing landing bug 1252998...\n\nhttps://treeherder.mozilla.org/#/jobs?repo=try&revision=d07c9490b5e5757af316f4f15dc8a9d5a2f22d7d&selectedJob=173468539\n\nIt looks like more people are starting to hit this, it seems pretty important to fix...", "author": "jhofmann@mozilla.com", "id": 13212277, "time": "2018-04-17T13:02:04Z"}, {"text": "Similar issue for Activity Stream https://bugzilla.mozilla.org/show_bug.cgi?id=1454110 We use `BrowserTestUtils.openNewForegroundTab` for most of our tests.", "author": "andrei.br92@gmail.com", "id": 13212285, "time": "2018-04-17T13:06:40Z"}, {"text": "*** Bug 1454787 has been marked as a duplicate of this bug. ***", "author": "jhofmann@mozilla.com", "id": 13214786, "time": "2018-04-18T09:04:06Z"}, {"text": "*** Bug 1454776 has been marked as a duplicate of this bug. ***", "author": "standard8@mozilla.com", "id": 13214828, "time": "2018-04-18T09:14:16Z"}, {"text": "*** Bug 1455172 has been marked as a duplicate of this bug. ***", "author": "jhofmann@mozilla.com", "id": 13217793, "time": "2018-04-19T08:50:54Z"}, {"text": "*** Bug 1455194 has been marked as a duplicate of this bug. ***", "author": "jhofmann@mozilla.com", "id": 13217797, "time": "2018-04-19T08:52:37Z"}, {"text": "Can we please disable TV on QuantumRender? This is piling up duplicates and I can imagine that there are still some people out there who haven't heard of this bug and spend a lot of time debugging because they think their own tests are failing (like me).\n\nWe might want to consider not turning on TV on preffed off/experimental platforms at all. Running TV on the main configurations sounds totally sufficient to me.", "author": "jhofmann@mozilla.com", "id": 13217806, "time": "2018-04-19T08:59:59Z"}, {"text": "at some point in time we will need to make QR tier-1 and running all the tests- progress is made every week towards that.  test-verify (TV) is tier-2 and typically gives a great indication to \"if the test is stable\"- we have many cases where we ignore it and the test is a high frequency intermittent test failure.\n\nWe just enabled TV for QR in bug 1453478, maybe we back that out and reland in a few weeks?", "author": "jmaher@mozilla.com", "id": 13218055, "time": "2018-04-19T10:58:03Z"}, {"text": "We don't run browser-chrome mochitest suites on QR, so why is TV running these tests? Ideally it should be able to figure out that the test is \"disabled\" on QR based on the taskcluster configs. Or is that not the case?", "author": "bugmail@mozilla.staktrace.com", "id": 13218248, "time": "2018-04-19T12:28:33Z"}, {"text": "Note that QR has its own test set at [1] that excludes mochitest-browser-chrome. However if it helps I can remove this test set, use the common-tests set, and update the mochitest-browser-chrome task definition with an empty run-on-projects set for QR. If TV would skip running browser-chrome tests in that situation it might be preferable.\n\n[1] https://searchfox.org/mozilla-central/rev/59a9a86553e9bfd9277202748ff791fd9bc0713b/taskcluster/ci/test/test-sets.yml#105", "author": "bugmail@mozilla.staktrace.com", "id": 13218253, "time": "2018-04-19T12:33:21Z"}, {"text": "test-verify looks at the *.ini manifests in tree to determine which tests are disabled.  We would have to figure out a solution for determining if test jobs are enabled on a specific platform.  It is probably doable, but I don't see an easy solution.\n\nI filed bug 1455309 to track working on test-verify.  There are 4 bugs in progress right now on test-verify, when those are done, I can imagine this could be picked up next.\n\n:kats- given the fact that this is not something that is currently supported or easily hacked, I would recommend turning off the TV jobs for QR builds.", "author": "jmaher@mozilla.com", "id": 13218427, "time": "2018-04-19T13:38:19Z"}, {"text": "(In reply to Joel Maher ( :jmaher) (UTC-5) from comment #14)\n> :kats- given the fact that this is not something that is currently supported\n> or easily hacked, I would recommend turning off the TV jobs for QR builds.\n\nYeah, fair enough. I'll write up the patch.", "author": "bugmail@mozilla.staktrace.com", "id": 13218556, "time": "2018-04-19T14:07:01Z"}, {"text": "I backed out bug 1453478, which turned on the test-verify jobs.\n\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/1f7eb198c7e1590d1a4801906f93c0014a094e72\n\nWill close this once it merges to m-c.", "author": "bugmail@mozilla.staktrace.com", "id": 13218596, "time": "2018-04-19T14:18:19Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/1f7eb198c7e1", "author": "bugmail@mozilla.staktrace.com", "id": 13221311, "time": "2018-04-20T13:21:40Z"}, {"text": "16 failures in 782 pushes (0.02 failures/push) were associated with this bug in the last 7 days.    \n\nRepository breakdown:\n* autoland: 15\n* mozilla-inbound: 1\n\nPlatform breakdown:\n* linux64-qr: 13\n* windows10-64-qr: 2\n* linux32: 1\n\nFor more details, see:\nhttps://treeherder.mozilla.org/intermittent-failures.html#/bugdetails?bug=1454531&startday=2018-04-16&endday=2018-04-22&tree=trunk", "author": "orangefactor@bots.tld", "id": 13225566, "time": "2018-04-23T01:34:33Z"}], "id": 1454531, "priority": "P2", "cc": ["amarchesini@mozilla.com", "andrei.br92@gmail.com", "bugmail@mozilla.staktrace.com", "intermittent-bug-filer@mozilla.bugs", "jhofmann@mozilla.com", "jmaher@mozilla.com", "mconley@mozilla.com", "milaninbugzilla@gmail.com"], "cf_crash_signature": "", "version": "Trunk", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_thunderbird_esr60": "---", "cf_platform_rel": "---", "product": "Core", "cf_fx_iteration": "---", "blocks": [1386669, 1424750, 1453478, 1454110, 1454333, 1454776, 1454856], "qa_contact": "", "creation_time": "2018-04-17T01:35:29Z", "cf_status_firefox_esr52": "---", "component": "Graphics: WebRender", "assigned_to_detail": {"email": "bugmail@mozilla.staktrace.com", "id": 426788, "name": "bugmail@mozilla.staktrace.com", "real_name": "Kartikaya Gupta (email:kats@mozilla.com)"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "---", "cf_status_firefox60": "---", "target_milestone": "---", "cf_rank": null, "cf_qa_whiteboard": "", "severity": "normal", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "MattN+bmo@mozilla.com", "id": 305228, "name": "MattN+bmo@mozilla.com", "real_name": "Matthew N. [:MattN] (PM if requests are blocking you)"}, "whiteboard": "[wr][triage] ", "mentors": [], "summary": "QuantumRender (qr) browser_*.js perma \"Test timed out\" in test-verify-e10s (TV) for BrowserTestUtils.withNewTab/openNewForegroundTab due to no TabSwitchDone event", "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-04-23T01:34:33Z", "assigned_to": "bugmail@mozilla.staktrace.com", "is_open": false, "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "amarchesini@mozilla.com, jhofmann@mozilla.com"}], "who": "jhofmann@mozilla.com", "when": "2018-04-17T13:02:04Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "andrei.br92@gmail.com"}], "who": "andrei.br92@gmail.com", "when": "2018-04-17T13:06:40Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1454110"}], "who": "MattN+bmo@mozilla.com", "when": "2018-04-17T18:17:03Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1454776"}], "who": "standard8@mozilla.com", "when": "2018-04-18T09:01:50Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "intermittent-bug-filer@mozilla.bugs"}], "who": "jhofmann@mozilla.com", "when": "2018-04-18T09:04:06Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1454856"}], "who": "andrei.br92@gmail.com", "when": "2018-04-18T09:46:25Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(bugmail@mozilla.staktrace.com), needinfo?(jmaher@mozilla.com)"}], "who": "jhofmann@mozilla.com", "when": "2018-04-19T08:59:59Z"}, {"changes": [{"removed": "General", "field_name": "component", "added": "Graphics: WebRender"}, {"removed": "Firefox", "field_name": "product", "added": "Core"}], "who": "jhofmann@mozilla.com", "when": "2018-04-19T09:00:29Z"}, {"changes": [{"removed": "needinfo?(jmaher@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "jmaher@mozilla.com", "when": "2018-04-19T10:58:03Z"}, {"changes": [{"removed": "needinfo?(bugmail@mozilla.staktrace.com)", "field_name": "flagtypes.name", "added": "needinfo?(jmaher@mozilla.com)"}], "who": "bugmail@mozilla.staktrace.com", "when": "2018-04-19T12:28:33Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1455309"}], "who": "jmaher@mozilla.com", "when": "2018-04-19T13:36:41Z"}, {"changes": [{"removed": "needinfo?(jmaher@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "jmaher@mozilla.com", "when": "2018-04-19T13:38:19Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1453478"}], "who": "bugmail@mozilla.staktrace.com", "when": "2018-04-19T14:14:37Z"}, {"changes": [{"removed": "--", "field_name": "priority", "added": "P2"}, {"removed": "", "field_name": "cc", "added": "milan@mozilla.com"}, {"removed": "", "field_name": "blocks", "added": "1386669"}], "who": "milaninbugzilla@gmail.com", "when": "2018-04-19T15:43:31Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2018-04-20 13:21:40"}], "who": "bugmail@mozilla.staktrace.com", "when": "2018-04-20T13:21:40Z"}, {"changes": [{"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "bugmail@mozilla.staktrace.com"}], "who": "bugmail@mozilla.staktrace.com", "when": "2018-04-20T13:22:07Z"}], "resolution": "FIXED", "op_sys": "All", "cf_fx_points": "---", "cf_blocking_fennec": "---"}