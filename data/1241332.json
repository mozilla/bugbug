{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "attachments": [{"creator": "rbarker@mozilla.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 8710187}, {"creator": "rbarker@mozilla.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 8726421}, {"creator": "rbarker@mozilla.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 8726422}, {"creator": "rbarker@mozilla.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2016-03-03T22:41:40Z", "type_id": 4, "creation_date": "2016-03-03T21:59:28Z", "id": 1353619, "setter": "bugmail@mozilla.staktrace.com"}], "content_type": "text/plain", "id": 8726423}, {"creator": "rbarker@mozilla.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 8726424}, {"creator": "rbarker@mozilla.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 8726428}, {"creator": "rbarker@mozilla.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 8726498}, {"creator": "rbarker@mozilla.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2016-03-04T16:03:48Z", "type_id": 4, "creation_date": "2016-03-04T16:00:40Z", "id": 1354067, "setter": "bugmail@mozilla.staktrace.com"}], "content_type": "text/plain", "id": 8726768}, {"creator": "rbarker@mozilla.com", "is_obsolete": 0, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 8726772}], "classification": "Components", "creator": "rbarker@mozilla.com", "cc": ["alam@mozilla.com", "bbermes@mozilla.com", "bugmail@mozilla.staktrace.com", "rbarker@mozilla.com", "snorp@snorp.net", "tnikkel@gmail.com"], "depends_on": [1370995, 1231517, 1253426], "creation_time": "2016-01-21T00:06:03Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "cf_status_firefox58": "---", "cf_status_firefox59": "---", "keywords": ["polish"], "summary": "Panning and zooming an input field when it gains focus has too much latency in Fennec", "id": 1241332, "assigned_to_detail": {"email": "rbarker@mozilla.com", "id": 480362, "name": "rbarker@mozilla.com", "real_name": "Randall Barker [:rbarker]"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "assigned_to": "rbarker@mozilla.com", "comment_count": 16, "comments": [{"text": "Created attachment 8710187\nzoom-to-focused-on-window-resize.patch\n\nFennec uses the APZC function ZoomToRect to ensure a focused input element is visible in the window (see bug 1231517). Currently it is using a timeout to wait for the window resize to propagate to the compositor thread. The attached patch was an attempt to flush APZ to ensure the updated frame metrics had propagated to the compositor thread. Unfortunately, it would intermittently fail. Examining the frame metrics in the APZC revealed the composition bounds had not yet been updated when the call failed.", "author": "rbarker@mozilla.com", "id": 11093486, "time": "2016-01-21T00:06:03Z"}, {"text": "Based on what we do in testing code I think what needs to happen here is that you need to wait for (1) the resize event, (2) any pending paints, and (3) the apz-flush. Once all three have completed the APZC should have the updated composition bounds. And actually if the zoomToRect call goes via the compositor thread then you don't need to wait for (3) because it will implicitly follow (2).", "author": "bugmail@mozilla.staktrace.com", "id": 11175579, "time": "2016-02-18T14:30:18Z"}, {"text": "I tested this out today on my 6P, Nightly. \n\nThe delay between A) user touches input field and B) input field is fully zoomed into view is really long right now. I think we need to fix this sooner rather than later because it feels kind of broken to have the feedback for a basic touch be so lagged behind. :)", "author": "alam@mozilla.com", "id": 11197241, "time": "2016-02-26T01:08:59Z"}, {"text": "(In reply to Anthony Lam (:antlam) from comment #2)\n> I tested this out today on my 6P, Nightly. \n> \n> The delay between A) user touches input field and B) input field is fully\n> zoomed into view is really long right now. I think we need to fix this\n> sooner rather than later because it feels kind of broken to have the\n> feedback for a basic touch be so lagged behind. :)\n\nI will attempt the fix outlined in comment #1 when I get a chance. Right now the feature works (not ideally) and we have a number features that are busted that need more urgent attention.", "author": "rbarker@mozilla.com", "id": 11199277, "time": "2016-02-26T18:31:13Z"}, {"text": "Created attachment 8726421\n0001-Bug-1241332-part-1-Request-content-repaint-at-end-of-APZ-animation-r-16030313-5669551.patch", "author": "rbarker@mozilla.com", "id": 11216718, "time": "2016-03-03T21:55:01Z"}, {"text": "Created attachment 8726422\n0002-Bug-1241332-part-2-Request-zoomToFocusedInput-after-resize-finishes-and-propagates-through-APZ-r-16030313-a61373f.patch", "author": "rbarker@mozilla.com", "id": 11216723, "time": "2016-03-03T21:55:24Z"}, {"text": "Created attachment 8726423\n0001-Bug-1241332-part-1-Request-content-repaint-at-end-of-APZ-animation-r-16030313-14af03e.patch", "author": "rbarker@mozilla.com", "id": 11216734, "time": "2016-03-03T21:57:45Z"}, {"text": "Created attachment 8726424\n0002-Bug-1241332-part-2-Request-zoomToFocusedInput-after-resize-finishes-and-propagates-through-APZ-r-16030313-0fb8870.patch", "author": "rbarker@mozilla.com", "id": 11216735, "time": "2016-03-03T21:58:08Z"}, {"text": "Created attachment 8726428\n0002-Bug-1241332-part-2-Request-zoomToFocusedInput-after-resize-finishes-and-propagates-through-APZ-r-16030314-2d4be77.patch", "author": "rbarker@mozilla.com", "id": 11216765, "time": "2016-03-03T22:04:40Z"}, {"text": "Created attachment 8726498\n0002-Bug-1241332-part-2-Request-zoomToFocusedInput-after-resize-finishes-and-propagates-through-APZ-r-16030316-1e25225.patch", "author": "rbarker@mozilla.com", "id": 11217229, "time": "2016-03-04T00:54:26Z"}, {"text": "Comment on attachment 8726498\n0002-Bug-1241332-part-2-Request-zoomToFocusedInput-after-resize-finishes-and-propagates-through-APZ-r-16030316-1e25225.patch\n\nReview of attachment 8726498:\n-----------------------------------------------------------------\n\n::: mobile/android/chrome/content/browser.js\n@@ +1564,5 @@\n> +      };\n> +\n> +      let apzFlushDone = function() {\n> +        Services.obs.removeObserver(apzFlushDone, \"apz-repaints-flushed\", false);\n> +        setTimeout(focusInput, 100);\n\nWhat's this setTimeout for? Can you just call dwu.zoomToFocusedInput() directly?", "author": "bugmail@mozilla.staktrace.com", "id": 11218828, "time": "2016-03-04T15:30:28Z"}, {"text": "Created attachment 8726768\n0002-Bug-1241332-part-2-Request-zoomToFocusedInput-after-resize-finishes-and-propagates-through-APZ-r-16030407-bf01cba.patch\n\nI think that 0 timeout was left over from the original patch when I was trying to figure out how to ensure the resize had completely propagated.", "author": "rbarker@mozilla.com", "id": 11219155, "time": "2016-03-04T16:00:40Z"}, {"text": "Comment on attachment 8726768\n0002-Bug-1241332-part-2-Request-zoomToFocusedInput-after-resize-finishes-and-propagates-through-APZ-r-16030407-bf01cba.patch\n\nReview of attachment 8726768:\n-----------------------------------------------------------------\n\n::: mobile/android/chrome/content/browser.js\n@@ +1582,5 @@\n> +          paintDone();\n> +        }\n> +      }\n> +\n> +      let gotResizeWindow = false;\n\nI'd prefer moving this declaration up to before the resizeWindow declaration.", "author": "bugmail@mozilla.staktrace.com", "id": 11219162, "time": "2016-03-04T16:03:48Z"}, {"text": "Created attachment 8726772\n0002-Bug-1241332-part-2-Request-zoomToFocusedInput-after-resize-finishes-and-propagates-through-APZ-r-16030408-5a4f2c4.patch\n\nAddress, comments. Carry forward r+ from :kats", "author": "rbarker@mozilla.com", "id": 11219182, "time": "2016-03-04T16:09:21Z"}, {"text": "https://hg.mozilla.org/integration/mozilla-inbound/rev/409f7a0e990f\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/953545615bdc", "author": "pulsebot@bots.tld", "id": 11220441, "time": "2016-03-04T22:44:45Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/409f7a0e990f\nhttps://hg.mozilla.org/mozilla-central/rev/953545615bdc", "author": "ryanvm@gmail.com", "id": 11221572, "time": "2016-03-06T00:27:00Z"}], "cf_last_resolved": "2016-03-06T00:27:00Z", "priority": "--", "mentors_detail": [], "cf_crash_signature": "", "version": "Trunk", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox59": "---", "last_change_time": "2017-06-07T19:14:15Z", "cf_platform_rel": "---", "product": "Core", "cf_status_firefox_esr52": "---", "blocks": [1206874, 1253469], "qa_contact": "", "see_also": [], "cf_fx_iteration": "---", "component": "Panning and Zooming", "votes": 0, "groups": [], "cf_status_firefox60": "---", "target_milestone": "mozilla47", "cf_status_firefox47": "fixed", "cf_status_firefox46": "wontfix", "cf_status_thunderbird_esr52": "---", "url": "", "creator_detail": {"email": "rbarker@mozilla.com", "id": 480362, "name": "rbarker@mozilla.com", "real_name": "Randall Barker [:rbarker]"}, "whiteboard": "[gfx-noted]", "mentors": [], "cc_detail": [{"email": "alam@mozilla.com", "id": 479537, "name": "alam@mozilla.com", "real_name": "Anthony Lam (:antlam)"}, {"email": "bbermes@mozilla.com", "id": 542658, "name": "bbermes@mozilla.com", "real_name": "Barbara Bermes [:barbara] - NI please!"}, {"email": "bugmail@mozilla.staktrace.com", "id": 426788, "name": "bugmail@mozilla.staktrace.com", "real_name": "Kartikaya Gupta (email:kats@mozilla.com)"}, {"email": "rbarker@mozilla.com", "id": 480362, "name": "rbarker@mozilla.com", "real_name": "Randall Barker [:rbarker]"}, {"email": "snorp@snorp.net", "id": 227322, "name": "snorp@snorp.net", "real_name": "James Willcox (:snorp) (jwillcox@mozilla.com)"}, {"email": "tnikkel@gmail.com", "id": 255010, "name": "tnikkel@gmail.com", "real_name": "Timothy Nikkel (:tnikkel)"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "cf_tracking_firefox58": "---", "cf_rank": null, "is_open": false, "cf_qa_whiteboard": "", "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "bugmail.mozilla@staktrace.com, rbarker@mozilla.com, snorp@snorp.net"}], "who": "rbarker@mozilla.com", "when": "2016-01-21T00:06:38Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1231517"}], "who": "rbarker@mozilla.com", "when": "2016-01-21T00:07:55Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "tnikkel@gmail.com"}, {"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "rbarker@mozilla.com"}], "who": "tnikkel@gmail.com", "when": "2016-01-21T04:04:44Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1206874"}], "who": "bugmail@mozilla.staktrace.com", "when": "2016-01-23T19:23:38Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "polish"}, {"removed": "", "field_name": "whiteboard", "added": "[gfx-noted]"}], "who": "bugmail@mozilla.staktrace.com", "when": "2016-02-18T14:30:18Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "alam@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(rbarker@mozilla.com)"}], "who": "alam@mozilla.com", "when": "2016-02-26T01:08:59Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bbermes@mozilla.com"}], "who": "alam@mozilla.com", "when": "2016-02-26T01:09:09Z"}, {"changes": [{"removed": "needinfo?(rbarker@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "rbarker@mozilla.com", "when": "2016-02-26T18:31:13Z"}, {"changes": [{"removed": "calling nsDomWindowUtils.flushApzRepaints() after a window resize does not guarantee the frame metrics will have finished propagating in C++APZ", "field_name": "summary", "added": "Panning and zooming a input field when it gains focus has too much latency in Fennec"}], "who": "rbarker@mozilla.com", "when": "2016-03-02T21:41:04Z"}, {"changes": [{"removed": "Panning and zooming a input field when it gains focus has too much latency in Fennec", "field_name": "summary", "added": "Panning and zooming an input field when it gains focus has too much latency in Fennec"}], "who": "rbarker@mozilla.com", "when": "2016-03-02T21:41:22Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8710187, "added": "1"}], "who": "rbarker@mozilla.com", "when": "2016-03-03T21:55:01Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8726421, "added": "1"}], "who": "rbarker@mozilla.com", "when": "2016-03-03T21:57:45Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8726422, "added": "1"}], "who": "rbarker@mozilla.com", "when": "2016-03-03T21:58:08Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1253426"}], "who": "rbarker@mozilla.com", "when": "2016-03-03T21:58:47Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8726423, "added": "review?(bugmail.mozilla@staktrace.com)"}], "who": "rbarker@mozilla.com", "when": "2016-03-03T21:59:28Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8726424, "added": "1"}], "who": "rbarker@mozilla.com", "when": "2016-03-03T22:04:40Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(bugmail.mozilla@staktrace.com)", "attachment_id": 8726423, "added": "review+"}], "who": "bugmail@mozilla.staktrace.com", "when": "2016-03-03T22:41:40Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8726428, "added": "1"}], "who": "rbarker@mozilla.com", "when": "2016-03-04T00:54:26Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8726498, "added": "review?(bugmail.mozilla@staktrace.com)"}], "who": "rbarker@mozilla.com", "when": "2016-03-04T00:55:04Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1253469"}], "who": "rbarker@mozilla.com", "when": "2016-03-04T00:55:35Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8726498, "added": "1"}, {"field_name": "flagtypes.name", "removed": "review?(bugmail.mozilla@staktrace.com)", "attachment_id": 8726498, "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8726768, "added": "review?(bugmail.mozilla@staktrace.com)"}], "who": "rbarker@mozilla.com", "when": "2016-03-04T16:00:40Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(bugmail.mozilla@staktrace.com)", "attachment_id": 8726768, "added": "review+"}], "who": "bugmail@mozilla.staktrace.com", "when": "2016-03-04T16:03:48Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8726768, "added": "1"}], "who": "rbarker@mozilla.com", "when": "2016-03-04T16:09:21Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla47"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2016-03-05 16:27:00"}, {"removed": "---", "field_name": "cf_status_firefox47", "added": "fixed"}], "who": "ryanvm@gmail.com", "when": "2016-03-06T00:27:00Z"}, {"changes": [{"removed": "affected", "field_name": "cf_status_firefox46", "added": "wontfix"}], "who": "bugmail@mozilla.staktrace.com", "when": "2016-03-17T20:20:28Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1370995"}], "who": "bugmail@mozilla.staktrace.com", "when": "2017-06-07T19:14:15Z"}], "resolution": "FIXED", "op_sys": "Unspecified", "cf_fx_points": "---", "cf_blocking_fennec": "---"}