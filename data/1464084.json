{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "classification": "Components", "creator": "nfroyd@mozilla.com", "cc": ["josh@joshmatthews.net", "mh+mozilla@glandium.org", "padenot@mozilla.com", "ryanvm@gmail.com"], "depends_on": [1467337], "creation_time": "2018-05-24T14:53:08Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "All", "keywords": [], "summary": "libstdc++ compat for std::thread::_M_start_thread is busted", "cf_last_resolved": "2018-06-04T18:58:30Z", "attachments": [{"creator": "mh+mozilla@glandium.org", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2018-06-01T18:59:53Z", "type_id": 4, "creation_date": "2018-06-01T00:52:50Z", "id": 1764441, "setter": "nfroyd@mozilla.com"}, {"status": "+", "name": "approval-mozilla-beta", "modification_date": "2018-06-06T01:39:22Z", "type_id": 721, "creation_date": "2018-06-05T23:15:49Z", "id": 1766312, "setter": "ryanvm@gmail.com"}, {"status": "+", "name": "approval-mozilla-esr60", "modification_date": "2018-06-06T01:39:22Z", "type_id": 929, "creation_date": "2018-06-05T23:15:49Z", "id": 1766313, "setter": "ryanvm@gmail.com"}], "content_type": "text/x-review-board-request", "id": 8982390}], "assigned_to_detail": {"email": "mh+mozilla@glandium.org", "id": 47192, "name": "mh+mozilla@glandium.org", "real_name": "Mike Hommey [:glandium]"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "comments": [{"text": "padenot noticed that he was getting crashes with deep stacks when using std::thread:\n\n(gdb) up 100000\n#100060 0x000000000041824b in std::thread::_M_start_thread(std::shared_ptr<std::thread::_Impl_base>, void (*)()) ()\n(gdb) up\n#100061 0x00007ffff76ececd in std::thread::_M_start_thread(std::shared_ptr<std::thread::_Impl_base>) ()\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n(gdb) up\n#100062 0x000000000041824b in std::thread::_M_start_thread(std::shared_ptr<std::thread::_Impl_base>, void (*)()) ()\n(gdb) up\n#100063 0x00007ffff76ececd in std::thread::_M_start_thread(std::shared_ptr<std::thread::_Impl_base>) ()\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n(gdb) up\n#100064 0x000000000041824b in std::thread::_M_start_thread(std::shared_ptr<std::thread::_Impl_base>, void (*)()) ()\n(gdb) up\n#100065 0x00007ffff76ececd in std::thread::_M_start_thread(std::shared_ptr<std::thread::_Impl_base>) ()\n   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n\n...and this continues on for quite some time.\n\nThe problem here is that we override _M_start_thread(shared_ptr, void (*)()):\n\nhttps://searchfox.org/mozilla-central/source/build/unix/stdc++compat/stdc++compat.cpp#128\n\nBut the libstdc++ 6 sources use that symbol to actually start the thread:\n\nhttps://github.com/gcc-mirror/gcc/blob/gcc-6-branch/libstdc%2B%2B-v3/src/c%2B%2B11/thread.cc#L184-L197\n\nand our override calls _M_start_thread(shared_ptr), which just calls the other overload:\n\nhttps://github.com/gcc-mirror/gcc/blob/gcc-6-branch/libstdc%2B%2B-v3/src/c%2B%2B11/thread.cc#L170-L182\n\nSo we get the infinite recursion seen in padenot's debugging session.\n\nThe setup is the same for the libstdc++ 5 sources:\n\nhttps://github.com/gcc-mirror/gcc/blob/gcc-5-branch/libstdc%2B%2B-v3/src/c%2B%2B11/thread.cc#L129-L155\n\nThe libstdc++ 4.9 sources, however, start the thread from the _M_start_thread(shared_ptr) overload:\n\nhttps://github.com/gcc-mirror/gcc/blob/gcc-4_9-branch/libstdc++-v3/src/c++11/thread.cc#L129-L148\n\nThis also means that any other std::thread usages are busted, but at least according to crash-stats, padenot is the first person to create std::thread in anger.  This could silently bite us in other ways if webrtc or skia or something starts using std::thread; presumably our test suite would catch such things, but it would also not totally surprise me if such things made it into Nightly, at least, with minimal testing.\n\nI think this means we have a problem, because we need to have the symbol override so we don't depend on a newer libstdc++, but we need to figure out which libstdc++ version we're using at runtime so we can call the right symbol:\n\n- the shared_ptr overload if we're using libstdc++ 4.9; or\n- the shared_ptr, funcptr overload if we're using something different; or\n- reimplement more bits using private routines (ick?).\n\nAnd ideally GCC won't decide to switch back in a future version of libstdc++.\n\nMarking statuses appropriately; we could track this for 62, I guess?", "author": "nfroyd@mozilla.com", "id": 13349969, "time": "2018-05-24T14:53:08Z"}, {"text": "I have a patch for this, just need to convince everything to link libdl appropriately.", "author": "nfroyd@mozilla.com", "id": 13372423, "time": "2018-05-29T20:57:20Z"}, {"text": "Tracking to keep an eye on this for 62.", "author": "lhenry@mozilla.com", "id": 13379023, "time": "2018-05-31T22:25:00Z"}, {"text": "Should we track this for 61? We may only not catch this on automation because of the libstdc++ version.", "author": "mh+mozilla@glandium.org", "id": 13379075, "time": "2018-05-31T22:52:55Z"}, {"text": "A simpler fix is to stop exporting stl symbols from libxul.", "author": "mh+mozilla@glandium.org", "id": 13379239, "time": "2018-06-01T00:50:37Z"}, {"text": "Created attachment 8982390\nBug 1464084 - Don't export std::thread::_M_start_thread symbols with --enable-stdcxx-compat.\n\nReview commit: https://reviewboard.mozilla.org/r/248328/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/248328/", "author": "mh+mozilla@glandium.org", "id": 13379242, "time": "2018-06-01T00:52:50Z"}, {"text": "Comment on attachment 8982390\nBug 1464084 - Don't export std::thread::_M_start_thread symbols with --enable-stdcxx-compat.\n\nhttps://reviewboard.mozilla.org/r/248328/#review254570\n\nThis ought to work.  Have you tested with padenot's test re-enabled on try?", "author": "nfroyd@mozilla.com", "id": 13379248, "time": "2018-06-01T00:59:44Z"}, {"text": "Comment on attachment 8982390\nBug 1464084 - Don't export std::thread::_M_start_thread symbols with --enable-stdcxx-compat.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/248328/diff/1-2/", "author": "mh+mozilla@glandium.org", "id": 13379260, "time": "2018-06-01T01:05:22Z"}, {"text": "Comment on attachment 8982390\nBug 1464084 - Don't export std::thread::_M_start_thread symbols with --enable-stdcxx-compat.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/248328/diff/2-3/", "author": "mh+mozilla@glandium.org", "id": 13379453, "time": "2018-06-01T06:12:00Z"}, {"text": "Comment on attachment 8982390\nBug 1464084 - Don't export std::thread::_M_start_thread symbols with --enable-stdcxx-compat.\n\nhttps://reviewboard.mozilla.org/r/248328/#review254816\n\n::: python/mozbuild/mozbuild/action/generate_symbols_file.py:75\n(Diff revision 3)\n>          # A linker version script is generated for GNU LD that looks like the\n>          # following:\n>          # {\n\nUpdate this comment to reflect that we're sticking the library name in here now?", "author": "nfroyd@mozilla.com", "id": 13381099, "time": "2018-06-01T18:59:53Z"}, {"text": "Comment on attachment 8982390\nBug 1464084 - Don't export std::thread::_M_start_thread symbols with --enable-stdcxx-compat.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/248328/diff/3-4/", "author": "mh+mozilla@glandium.org", "id": 13381490, "time": "2018-06-01T21:33:41Z"}, {"text": "Pushed by mh@glandium.org:\nhttps://hg.mozilla.org/integration/autoland/rev/838c0ab9cbdb\nDon't export libstdc++ symbols with --enable-stdcxx-compat. r=froydnj", "author": "pulsebot@bots.tld", "id": 13381510, "time": "2018-06-01T21:44:14Z"}, {"text": "Backed out for Linux static bustage.\n\nbackout: https://hg.mozilla.org/integration/autoland/rev/74dffd02a249f90777df32ca01579e6c5d3e6a3f\n\npush with failures: https://treeherder.mozilla.org/#/jobs?repo=autoland&revision=838c0ab9cbdbe85b0f7997ec48289d0a7fc12360&selectedJob=181443402\n\nfailure log: https://treeherder.mozilla.org/logviewer.html#?job_id=181443400&repo=autoland&lineNumber=3904\n\n[task 2018-06-01T22:43:34.378Z] 22:43:34     INFO -  /builds/worker/workspace/build/src/sccache2/sccache /builds/worker/workspace/build/src/clang/bin/clang++ -std=gnu++14 -o TestNoRefcountedInsideLambdas.o -c -DNDEBUG=1 -DTRIMMED=1 -I/builds/worker/workspace/build/src/build/clang-plugin/tests -I/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests -I/builds/worker/workspace/build/src/obj-firefox/dist/include -I/builds/worker/workspace/build/src/obj-firefox/dist/include/nspr -I/builds/worker/workspace/build/src/obj-firefox/dist/include/nss -fPIC -DMOZILLA_CLIENT -include /builds/worker/workspace/build/src/obj-firefox/mozilla-config.h -Qunused-arguments -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -Qunused-arguments -D_GLIBCXX_USE_CXX11_ABI=0 -fno-sized-deallocation -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -fno-exceptions -fno-strict-aliasing -fno-rtti -ffunction-sections -fdata-sections -fno-exceptions -fno-math-errno -pthread -pipe -fsyntax-only -Xclang -verify -ferror-limit=0 -Wno-invalid-noreturn -g -Xclang -load -Xclang /builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/libclang-plugin.so -Xclang -add-plugin -Xclang moz-check -O2 -fno-omit-frame-pointer -Werror  -MD -MP -MF .deps/TestNoRefcountedInsideLambdas.o.pp   /builds/worker/workspace/build/src/build/clang-plugin/tests/TestNoRefcountedInsideLambdas.cpp\n[task 2018-06-01T22:43:34.378Z] 22:43:34     INFO -  make[4]: Leaving directory '/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests'\n[task 2018-06-01T22:43:34.486Z] 22:43:34     INFO -  make[4]: Entering directory '/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests'\n[task 2018-06-01T22:43:34.486Z] 22:43:34     INFO -  /builds/worker/workspace/build/src/sccache2/sccache /builds/worker/workspace/build/src/clang/bin/clang++ -std=gnu++14 -o TestNonMemMovable.o -c -DNDEBUG=1 -DTRIMMED=1 -I/builds/worker/workspace/build/src/build/clang-plugin/tests -I/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests -I/builds/worker/workspace/build/src/obj-firefox/dist/include -I/builds/worker/workspace/build/src/obj-firefox/dist/include/nspr -I/builds/worker/workspace/build/src/obj-firefox/dist/include/nss -fPIC -DMOZILLA_CLIENT -include /builds/worker/workspace/build/src/obj-firefox/mozilla-config.h -Qunused-arguments -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -Qunused-arguments -D_GLIBCXX_USE_CXX11_ABI=0 -fno-sized-deallocation -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -fno-exceptions -fno-strict-aliasing -fno-rtti -ffunction-sections -fdata-sections -fno-exceptions -fno-math-errno -pthread -pipe -fsyntax-only -Xclang -verify -ferror-limit=0 -Wno-invalid-noreturn -g -Xclang -load -Xclang /builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/libclang-plugin.so -Xclang -add-plugin -Xclang moz-check -O2 -fno-omit-frame-pointer -Werror  -MD -MP -MF .deps/TestNonMemMovable.o.pp   /builds/worker/workspace/build/src/build/clang-plugin/tests/TestNonMemMovable.cpp\n[task 2018-06-01T22:43:34.486Z] 22:43:34     INFO -  make[4]: Leaving directory '/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests'\n[task 2018-06-01T23:23:34.502Z] 23:23:34     INFO - Automation Error: mozprocess timed out after 2400 seconds running ['/usr/bin/python2.7', 'mach', '--log-no-times', 'build', '-v']\n[task 2018-06-01T23:23:34.514Z] 23:23:34    ERROR - timed out after 2400 seconds of no output\n[task 2018-06-01T23:23:34.514Z] 23:23:34    ERROR - Return code: -15\n[task 2018-06-01T23:23:34.514Z] 23:23:34  WARNING - setting return code to 2\n[task 2018-06-01T23:23:34.514Z] 23:23:34    FATAL - 'mach build -v' did not run successfully. Please check log for errors.\n[task 2018-06-01T23:23:34.514Z] 23:23:34    FATAL - Running post_fatal callback...\n[task 2018-06-01T23:23:34.515Z] 23:23:34    FATAL - Exiting -1\n[task 2018-06-01T23:23:34.515Z] 23:23:34     INFO - [mozharness: 2018-06-01 23:23:34.515167Z] Finished build step (failed)\n[task 2018-06-01T23:23:34.515Z] 23:23:34     INFO - Running post-run listener: _summarize\n[task 2018-06-01T23:23:34.515Z] 23:23:34    ERROR - # TBPL FAILURE #\n[task 2018-06-01T23:23:34.515Z] 23:23:34     INFO - [mozharness: 2018-06-01 23:23:34.515398Z] FxDesktopBuild summary:\n[task 2018-06-01T23:23:34.515Z] 23:23:34    ERROR - # TBPL FAILURE #", "author": "ncsoregi@mozilla.com", "id": 13381751, "time": "2018-06-01T23:44:25Z"}, {"text": "Huh, looks like the clang-plugin didn't like this\n\n\n*** glibc detected *** /builds/worker/workspace/build/src/clang/bin/clang-5.0: free(): invalid pointer: 0x0000000003c8bf80 ***\n======= Backtrace: =========\n/lib/x86_64-linux-gnu/libc.so.6(+0x75bb6)[0x7fb8f696fbb6]\n/lib/x86_64-linux-gnu/libc.so.6(cfree+0x6c)[0x7fb8f697495c]\n/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/libclang-plugin.so(_ZN26DanglingOnTemporaryChecker5checkERKN5clang12ast_matchers11MatchFinder11MatchResultE+0x8c1)[0x7fb8f6608fa1]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0[0x29a1bdf]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0(_ZN5clang12ast_matchers8internal21BoundNodesTreeBuilder12visitMatchesEPNS2_7VisitorE+0x172)[0x29b76d2]\n[task 2018-06-01T22:43:34.054Z] 22:43:34     INFO -  make[4]: Entering directory '/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests'\n[task 2018-06-01T22:43:34.054Z] 22:43:34     INFO -  /builds/worker/workspace/build/src/sccache2/sccache /builds/worker/workspace/build/src/clang/bin/clang -std=gnu99 -o TestNANTestingExprC.o -c -DNDEBUG=1 -DTRIMMED=1 -I/builds/worker/workspace/build/src/build/clang-plugin/tests -I/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests -I/builds/worker/workspace/build/src/obj-firefox/dist/include -I/builds/worker/workspace/build/src/obj-firefox/dist/include/nspr -I/builds/worker/workspace/build/src/obj-firefox/dist/include/nss -fPIC -include /builds/worker/workspace/build/src/obj-firefox/mozilla-config.h -DMOZILLA_CLIENT -Qunused-arguments -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -Qunused-arguments -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -fno-strict-aliasing -ffunction-sections -fdata-sections -fno-math-errno -pthread -pipe -fsyntax-only -Xclang -verify -ferror-limit=0 -std=c11 -Wno-invalid-noreturn -g -Xclang -load -Xclang /builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/libclang-plugin.so -Xclang -add-plugin -Xclang moz-check -O2 -fno-omit-frame-pointer -Werror  -MD -MP -MF .deps/TestNANTestingExprC.o.pp   /builds/worker/workspace/build/src/build/clang-plugin/tests/TestNANTestingExprC.c\n[task 2018-06-01T22:43:34.054Z] 22:43:34     INFO -  make[4]: Leaving directory '/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests'\n[task 2018-06-01T22:43:34.055Z] 22:43:34     INFO -  make[4]: Entering directory '/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests'\n/builds/worker/workspace/build/src/clang/bin/clang-5.0[0x29a1a8b]\n[task 2018-06-01T22:43:34.055Z] 22:43:34     INFO -  make[4]: Leaving directory '/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests'\n[task 2018-06-01T22:43:34.055Z] 22:43:34     INFO -  make[4]: Entering directory '/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests'\n[task 2018-06-01T22:43:34.055Z] 22:43:34     INFO -  make[4]: Leaving directory '/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests'\n/builds/worker/workspace/build/src/clang/bin/clang-5.0[0x29adc2a]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0[0x29a7cb7]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0[0x29a4d05]\n[task 2018-06-01T22:43:34.056Z] 22:43:34     INFO -  make[4]: Entering directory '/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests'\n/builds/worker/workspace/build/src/clang/bin/clang-5.0[0x29b0b46]\n[task 2018-06-01T22:43:34.058Z] 22:43:34     INFO -  /builds/worker/workspace/build/src/sccache2/sccache /builds/worker/workspace/build/src/clang/bin/clang++ -std=gnu++14 -o TestExplicitOperatorBool.o -c -DNDEBUG=1 -DTRIMMED=1 -I/builds/worker/workspace/build/src/build/clang-plugin/tests -I/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests -I/builds/worker/workspace/build/src/obj-firefox/dist/include -I/builds/worker/workspace/build/src/obj-firefox/dist/include/nspr -I/builds/worker/workspace/build/src/obj-firefox/dist/include/nss -fPIC -DMOZILLA_CLIENT -include /builds/worker/workspace/build/src/obj-firefox/mozilla-config.h -Qunused-arguments -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -Qunused-arguments -D_GLIBCXX_USE_CXX11_ABI=0 -fno-sized-deallocation -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -fno-exceptions -fno-strict-aliasing -fno-rtti -ffunction-sections -fdata-sections -fno-exceptions -fno-math-errno -pthread -pipe -fsyntax-only -Xclang -verify -ferror-limit=0 -Wno-invalid-noreturn -g -Xclang -load -Xclang /builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/libclang-plugin.so -Xclang -add-plugin -Xclang moz-check -O2 -fno-omit-frame-pointer -Werror  -MD -MP -MF .deps/TestExplicitOperatorBool.o.pp   /builds/worker/workspace/build/src/build/clang-plugin/tests/TestExplicitOperatorBool.cpp\n[task 2018-06-01T22:43:34.058Z] 22:43:34     INFO -  make[4]: Leaving directory '/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests'\n[task 2018-06-01T22:43:34.058Z] 22:43:34     INFO -  make[4]: Entering directory '/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests'\n/builds/worker/workspace/build/src/clang/bin/clang-5.0[0x29a7cb7]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0[0x29aa62c]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0[0x29a7cb7]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0[0x29b4f4a]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0[0x29a1f11]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0[task 2018-06-01T22:43:34.062Z] 22:43:34     INFO -  /builds/worker/workspace/build/src/sccache2/sccache /builds/worker/workspace/build/src/clang/bin/clang++ -std=gnu++14 -o TestBadImplicitConversionCtor.o -c -DNDEBUG=1 -DTRIMMED=1 -I/builds/worker/workspace/build/src/build/clang-plugin/tests -I/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests -I/builds/worker/workspace/build/src/obj-firefox/dist/include -I/builds/worker/workspace/build/src/obj-firefox/dist/include/nspr -I/builds/worker/workspace/build/src/obj-firefox/dist/include/nss -fPIC -DMOZILLA_CLIENT -include /builds/worker/workspace/build/src/obj-firefox/mozilla-config.h -Qunused-arguments -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -Qunused-arguments -D_GLIBCXX_USE_CXX11_ABI=0 -fno-sized-deallocation -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -fno-exceptions -fno-strict-aliasing -fno-rtti -ffunction-sections -fdata-sections -fno-exceptions -fno-math-errno -pthread -pipe -fsyntax-only -Xclang -verify -ferror-limit=0 -Wno-invalid-noreturn -g -Xclang -load -Xclang /builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/libclang-plugin.so -Xclang -add-plugin -Xclang moz-check -O2 -fno-omit-frame-pointer -Werror  -MD -MP -MF .deps/TestBadImplicitConversionCtor.o.pp   /builds/worker/workspace/build/src/build/clang-plugin/tests/TestBadImplicitConversionCtor.cpp\n[task 2018-06-01T22:43:34.062Z] 22:43:34     INFO -  make[4]: Leaving directory '/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests'\n[task 2018-06-01T22:43:34.062Z] 22:43:34     INFO -  make[4]: Entering directory '/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests'\n[task 2018-06-01T22:43:34.062Z] 22:43:34     INFO -  make[4]: Leaving directory '/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests'\n[task 2018-06-01T22:43:34.062Z] 22:43:34     INFO -  make[4]: Entering directory '/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/tests'\n/builds/worker/workspace/build/src/clang/bin/clang-5.0(_ZN5clang12ast_matchers11MatchFinder8matchASTERNS_10ASTContextE+0x2cd)[0x29865ad]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0(_ZN5clang17MultiplexConsumer21HandleTranslationUnitERNS_10ASTContextE+0x2c)[0x1976e9c]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0(_ZN5clang8ParseASTERNS_4SemaEbb+0x1c6)[0x2057036]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0(_ZN5clang14FrontendAction7ExecuteEv+0x3f)[0x195215f]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0(_ZN5clang16CompilerInstance13ExecuteActionERNS_14FrontendActionE+0x418)[0x1901ab8]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0(_ZN5clang25ExecuteCompilerInvocationEPNS_16CompilerInstanceE+0x1086)[0x19cf0b6]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0(_Z8cc1_mainN4llvm8ArrayRefIPKcEES2_Pv+0x3ff)[0x7fff6f]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0(main+0x2b69)[0x7fe039]\n*** glibc detected *** /builds/worker/workspace/build/src/clang/bin/clang-5.0: free(): invalid pointer: 0x0000000003c8bf80 ***\n/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xfd)[0x7fb8f6918ead]\n======= Backtrace: =========\n/lib/x86_64-linux-gnu/libc.so.6(+0x75bb6)[0x7f77e6ddabb6]\n/lib/x86_64-linux-gnu/libc.so.6(cfree+0x6c)[0x7f77e6ddf95c]\n/builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/libclang-plugin.so(_ZN22KungFuDeathGripChecker5checkERKN5clang12ast_matchers11MatchFinder11MatchResultE+0x643)[0x7f77e6a78c03]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0[0x7fb1f1]\n======= Memory map: ========\n00400000-03773000 r-xp 00000000 fc:00 1593850                            /builds/worker/workspace/build/src/clang/bin/clang-5.0\n03972000-03bea000 rw-p 03372000 fc:00 1593850                            /builds/worker/workspace/build/src/clang/bin/clang-5.0\n03bea000-03c9e000 rw-p 00000000 00:00 0 \n05971000-05a5b000 rw-p 00000000 00:00 0                                  [heap]\n7fb8f0000000-7fb8f0021000 rw-p 00000000 00:00 0 \n7fb8f0021000-7fb8f4000000 ---p 00000000 00:00 0 \n7fb8f65c0000-7fb8f66de000 r-xp 00000000 fc:00 4234465                    /builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/libclang-plugin.so\n7fb8f66de000-7fb8f68de000 ---p 0011e000 fc:00 4234465                    /builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/libclang-plugin.so\n7fb8f68de000-7fb8f68e7000 rw-p 0011e000 fc:00 4234465                    /builds/worker/workspace/build/src/obj-firefox/build/clang-plugin/libclang-plugin.so\n7fb8f68e7000-7fb8f68fa000 rw-p 00000000 00:00 0 \n7fb8f68fa000-7fb8f6a7e000 r-xp 00000000 fc:00 2365198                    /lib/x86_64-linux-gnu/libc-2.13.so\n7fb8f6a7e000-7fb8f6c7d000 ---p 00184000 fc:00 2365198                    /lib/x86_64-linux-gnu/libc-2.13.so\n7fb8f6c7d000-7fb8f6c81000 r--p 00183000 fc:00 2365198                    /lib/x86_64-linux-gnu/libc-2.13.so\n7fb8f6c81000-7fb8f6c82000 rw-p 00187000 fc:00 2365198                    /lib/x86_64-linux-gnu/libc-2.13.so\n7fb8f6c82000-7fb8f6c87000 rw-p 00000000 00:00 0 \n7fb8f6c87000-7fb8f6c9d000 r-xp 00000000 fc:00 1722333                    /builds/worker/workspace/build/src/clang/lib/libgcc_s.so.1\n7fb8f6c9d000-7fb8f6e9c000 ---p 00016000 fc:00 1722333                    /builds/worker/workspace/build/src/clang/lib/libgcc_s.so.1\n7fb8f6e9c000-7fb8f6e9d000 rw-p 00015000 fc:00 1722333                    /builds/worker/workspace/build/src/clang/lib/libgcc_s.so.1\n7fb8f6e9d000-7fb8f6f1e000 r-xp 00000000 fc:00 2365217                    /lib/x86_64-linux-gnu/libm-2.13.so\n7fb8f6f1e000-7fb8f711d000 ---p 00081000 fc:00 2365217                    /lib/x86_64-linux-gnu/libm-2.13.so\n7fb8f711d000-7fb8f711e000 r--p 00080000 fc:00 2365217                    /lib/x86_64-linux-gnu/libm-2.13.so\n7fb8f711e000-7fb8f711f000 rw-p 00081000 fc:00 2365217                    /lib/x86_64-linux-gnu/libm-2.13.so\n7fb8f711f000-7fb8f7135000 r-xp 00000000 fc:00 2365270                    /lib/x86_64-linux-gnu/libz.so.1.2.7\n7fb8f7135000-7fb8f7334000 ---p 00016000 fc:00 2365270                    /lib/x86_64-linux-gnu/libz.so.1.2.7\n7fb8f7334000-7fb8f7335000 r--p 00015000 fc:00 2365270                    /lib/x86_64-linux-gnu/libz.so.1.2.7\n7fb8f7335000-7fb8f7336000 rw-p 00016000 fc:00 2365270                    /lib/x86_64-linux-gnu/libz.so.1.2.7\n7fb8f7336000-7fb8f7338000 r-xp 00000000 fc:00 2365206                    /lib/x86_64-linux-gnu/libdl-2.13.so\n7fb8f7338000-7fb8f7538000 ---p 00002000 fc:00 2365206                    /lib/x86_64-linux-gnu/libdl-2.13.so\n7fb8f7538000-7fb8f7539000 r--p 00002000 fc:00 2365206                    /lib/x86_64-linux-gnu/libdl-2.13.so\n7fb8f7539000-7fb8f753a000 rw-p 00003000 fc:00 2365206                    /lib/x86_64-linux-gnu/libdl-2.13.so\n7fb8f753a000-7fb8f7541000 r-xp 00000000 fc:00 2365251                    /lib/x86_64-linux-gnu/librt-2.13.so\n7fb8f7541000-7fb8f7740000 ---p 00007000 fc:00 2365251                    /lib/x86_64-linux-gnu/librt-2.13.so\n7fb8f7740000-7fb8f7741000 r--p 00006000 fc:00 2365251                    /lib/x86_64-linux-gnu/librt-2.13.so\n7fb8f7741000-7fb8f7742000 rw-p 00007000 fc:00 2365251                    /lib/x86_64-linux-gnu/librt-2.13.so\n7fb8f7742000-7fb8f7759000 r-xp 00000000 fc:00 2365245                    /lib/x86_64-linux-gnu/libpthread-2.13.so\n7fb8f7759000-7fb8f7958000 ---p 00017000 fc:00 2365245                    /lib/x86_64-linux-gnu/libpthread-2.13.so\n7fb8f7958000-7fb8f7959000 r--p 00016000 fc:00 2365245                    /lib/x86_64-linux-gnu/libpthread-2.13.so\n7fb8f7959000-7fb8f795a000 rw-p 00017000 fc:00 2365245                    /lib/x86_64-linux-gnu/libpthread-2.13.so\n7fb8f795a000-7fb8f795e000 rw-p 00000000 00:00 0 \n7fb8f795e000-7fb8f797e000 r-xp 00000000 fc:00 2365182                    /lib/x86_64-linux-gnu/ld-2.13.so\n7fb8f7b39000-7fb8f7b6f000 rw-p 00000000 00:00 0 \n7fb8f7b76000-7fb8f7b78000 rw-p 00000000 00:00 0 \n7fb8f7b78000-7fb8f7b7b000 r--p 00000000 00:00 0                          [vvar]\n7fb8f7b7b000-7fb8f7b7d000 r-xp 00000000 00:00 0                          [vdso]\n7fb8f7b7d000-7fb8f7b7e000 r--p 0001f000 fc:00 2365182                    /lib/x86_64-linux-gnu/ld-2.13.so\n7fb8f7b7e000-7fb8f7b7f000 rw-p 00020000 fc:00 2365182                    /lib/x86_64-linux-gnu/ld-2.13.so\n7fb8f7b7f000-7fb8f7b80000 rw-p 00000000 00:00 0 \n7ffdd6bd8000-7ffdd6bfa000 rw-p 00000000 00:00 0                          [stack]\nffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0[0x29a1bdf]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0(_ZN5clang12ast_matchers8internal21BoundNodesTreeBuilder12visitMatchesEPNS2_7VisitorE+0x172)[0x29b76d2]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0[0x29a1a8b]\n/builds/worker/workspace/build/src/clang/bin/clang-5.0[0x29b0b3b]", "author": "mh+mozilla@glandium.org", "id": 13381756, "time": "2018-06-01T23:48:27Z"}, {"text": "Comment on attachment 8982390\nBug 1464084 - Don't export std::thread::_M_start_thread symbols with --enable-stdcxx-compat.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/248328/diff/4-5/", "author": "mh+mozilla@glandium.org", "id": 13381969, "time": "2018-06-02T05:12:57Z"}, {"text": "I'll just go with hiding the _M_start_thread symbols only. Let's figure out the more general std:: thing separately, if ever.", "author": "mh+mozilla@glandium.org", "id": 13381970, "time": "2018-06-02T05:14:35Z"}, {"text": "Pushed by mh@glandium.org:\nhttps://hg.mozilla.org/integration/autoland/rev/7c74241c18ea\nDon't export std::thread::_M_start_thread symbols with --enable-stdcxx-compat. r=froydnj", "author": "pulsebot@bots.tld", "id": 13381971, "time": "2018-06-02T05:15:06Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/7c74241c18ea", "author": "dluca@mozilla.com", "id": 13386082, "time": "2018-06-04T18:58:30Z"}, {"text": "Hey Mike, what branches need uplift here?", "author": "ryanvm@gmail.com", "id": 13387793, "time": "2018-06-05T12:42:17Z"}, {"text": "Comment on attachment 8982390\nBug 1464084 - Don't export std::thread::_M_start_thread symbols with --enable-stdcxx-compat.\n\nApproval Request Comment\n[Feature/Bug causing the regression]: bug 1389435 (switching the build to GCC 6), which means this has been a problem since 57.\n[User impact if declined]: possible infinite loop when creating /some/ kinds of threads, although it doesn't seem to be happening in the wild (according to crash-stats).\n[Is this code covered by automated tests?]: The test for bug 1454385 covers it (this is how this was found in the first place).\n[Has the fix been verified in Nightly?]: Yes, by reenabling the test for bug 1454385\n[Needs manual test from QE? If yes, steps to reproduce]: N/A\n[List of other uplifts needed for the feature/fix]: N/A\n[Is the change risky?]: Not much\n[Why is the change risky/not risky?]: There is a change in how symbols are exported from libraries such as libmozavcodec.so, but that would tend to make things stricter than what they were before, forcing symbols being resolved from those libraries rather than system libraries that might have the same symbols, so overall, this should be a win.\n[String changes made/needed]: N/A", "author": "mh+mozilla@glandium.org", "id": 13389657, "time": "2018-06-05T23:15:49Z"}, {"text": "Comment on attachment 8982390\nBug 1464084 - Don't export std::thread::_M_start_thread symbols with --enable-stdcxx-compat.\n\nFixes a possible infinite loop caused by the switch to gcc6. Verified by the test on trunk which was previously failing due to this bug and is now successfully re-enabled in production. Approved for 61.0b12 and ESR 60.1.", "author": "ryanvm@gmail.com", "id": 13389878, "time": "2018-06-06T01:39:22Z"}, {"text": "https://hg.mozilla.org/releases/mozilla-beta/rev/4f9a0ee0ac42", "author": "ryanvm@gmail.com", "id": 13389890, "time": "2018-06-06T01:46:06Z"}, {"text": "Backed out for SM(pkg) libc-2.13.so crashes (seen on top of both Beta and ESR60).\nhttps://treeherder.mozilla.org/logviewer.html#?job_id=182006189&repo=mozilla-beta\n\nhttps://hg.mozilla.org/releases/mozilla-beta/rev/2e763d5ed8e5eba9cba54780a3142b9365b0cce3", "author": "ryanvm@gmail.com", "id": 13389924, "time": "2018-06-06T02:42:33Z"}, {"text": "The more I look at it, the more I'm puzzled.\n\nOn the failing build, this is what happens per LD_DEBUG=all:\n     24392:     symbol=malloc;  lookup in file=./dist/bin/jsapi-tests [0]\n     24392:     symbol=malloc;  lookup in file=/lib/x86_64-linux-gnu/libpthread.so.0 [0]\n     24392:     symbol=malloc;  lookup in file=/builds/worker/workspace/sm-package/mozjs-60.0.2/obj-spider/dist/bin/libnspr4.so [0]\n     24392:     symbol=malloc;  lookup in file=/builds/worker/workspace/sm-package/mozjs-60.0.2/obj-spider/dist/bin/libplc4.so [0]\n     24392:     symbol=malloc;  lookup in file=/builds/worker/workspace/sm-package/mozjs-60.0.2/obj-spider/dist/bin/libplds4.so [0]\n     24392:     symbol=malloc;  lookup in file=/lib/x86_64-linux-gnu/libdl.so.2 [0]\n     24392:     symbol=malloc;  lookup in file=/lib/x86_64-linux-gnu/librt.so.1 [0]\n     24392:     symbol=malloc;  lookup in file=/lib/x86_64-linux-gnu/libz.so.1 [0]\n     24392:     symbol=malloc;  lookup in file=/lib/x86_64-linux-gnu/libm.so.6 [0]\n     24392:     symbol=malloc;  lookup in file=/usr/lib/x86_64-linux-gnu/libstdc++.so.6 [0]\n     24392:     symbol=malloc;  lookup in file=/lib/x86_64-linux-gnu/libgcc_s.so.1 [0]\n     24392:     symbol=malloc;  lookup in file=/lib/x86_64-linux-gnu/libc.so.6 [0]\n     24392:     binding file /lib/x86_64-linux-gnu/libc.so.6 [0] to /lib/x86_64-linux-gnu/libc.so.6 [0]: normal symbol `malloc' [GLIBC_2.2.5]\n\nThat is, mozjemalloc is not used.\n\nOn a non failing build (with the backout):\n      2276:     symbol=malloc;  lookup in file=./dist/bin/jsapi-tests [0]\n      2276:     binding file /lib/x86_64-linux-gnu/libc.so.6 [0] to ./dist/bin/jsapi-tests [0]: normal symbol `malloc' [GLIBC_2.2.5]\n\nso malloc is taken from jsapi-tests as expected, and is thus mozjemalloc.\n\nBut here is the crazy thing: in both cases, malloc is exported from jsapi-tests:\nbroken:\n  $ objdump -T dist/bin/jsapi-tests | grep \\ malloc$\n  000000000051e400 g    DF .text  0000000000000350  Base        malloc\nnon-broken:\n  $ objdump -T dist/bin/jsapi-tests | grep \\ malloc$\n  000000000051e5a0 g    DF .text  0000000000000350  Base        malloc\n\nThe LD_DEBUG=all output above are the first lines that differ between both cases. There is no difference between the logs before that.\n\nAnd if I download jsapi-tests from a mozilla-central sm-pkg build, malloc is correctly bound to jsapi-tests!", "author": "mh+mozilla@glandium.org", "id": 13390079, "time": "2018-06-06T05:50:14Z"}, {"text": "So whatever gold is doing to break this, it's because of gold being used for those builds. Which means there are two things to figure out:\n- why the sm-pkg builds on beta are using gold but the ones on central aren't?\n- what is the hidden difference between what gold and bfd ld produce that makes ld.so not find malloc in jsapi-tests?", "author": "mh+mozilla@glandium.org", "id": 13390102, "time": "2018-06-06T06:28:06Z"}, {"text": "> - why the sm-pkg builds on beta are using gold but the ones on central aren't?\n\nThat's because bug 1455767 apparently broke defaulting to gold on local builds. Which brings to the problem that the sm-pkg builds shouldn't be using gold anyways.", "author": "mh+mozilla@glandium.org", "id": 13390123, "time": "2018-06-06T06:54:52Z"}, {"text": "So the problem is that gold doesn't do what would seem to be the right thing when it creates symbol versions (at least, it does things differently than both bfd ld and lld), *and* both objdump and readelf mask the problem by not displaying versions correctly in their output of the symbol table: they show the same thing as if there was no symbol version even when there is.", "author": "mh+mozilla@glandium.org", "id": 13390304, "time": "2018-06-06T08:50:32Z"}, {"text": "Filed:\nhttps://bugs.llvm.org/show_bug.cgi?id=37724\nhttps://sourceware.org/bugzilla/show_bug.cgi?id=23267\nhttps://sourceware.org/bugzilla/show_bug.cgi?id=23268", "author": "mh+mozilla@glandium.org", "id": 13392782, "time": "2018-06-07T04:49:25Z"}, {"text": "(In reply to Ryan VanderMeulen [:RyanVM] from comment #22)\n> Backed out for SM(pkg) libc-2.13.so crashes (seen on top of both Beta and\n> ESR60).\n> https://treeherder.mozilla.org/logviewer.html#?job_id=182006189&repo=mozilla-\n> beta\n> \n> https://hg.mozilla.org/releases/mozilla-beta/rev/\n> 2e763d5ed8e5eba9cba54780a3142b9365b0cce3\n\nThese go away thanks to bug 1467041. Can this reland?", "author": "mh+mozilla@glandium.org", "id": 13398268, "time": "2018-06-09T22:58:36Z"}, {"text": "https://hg.mozilla.org/releases/mozilla-beta/rev/4c893cb98224", "author": "ryanvm@gmail.com", "id": 13398312, "time": "2018-06-10T00:50:27Z"}, {"text": "https://hg.mozilla.org/releases/mozilla-esr60/rev/123bd919d459", "author": "ryanvm@gmail.com", "id": 13398313, "time": "2018-06-10T00:52:22Z"}], "id": 1464084, "priority": "--", "mentors_detail": [], "comment_count": 31, "cf_status_thunderbird_esr52": "---", "cf_qa_whiteboard": "", "version": "Trunk", "cf_tracking_firefox62": "+", "cf_platform_rel": "---", "product": "Firefox Build System", "cf_fx_iteration": "---", "blocks": [1389422, 1454385], "qa_contact": "", "see_also": [], "cf_status_firefox_esr52": "unaffected", "component": "Toolchains", "votes": 0, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "fixed", "cf_status_firefox61": "fixed", "cf_status_firefox60": "wontfix", "target_milestone": "mozilla62", "is_cc_accessible": true, "cf_tracking_thunderbird_esr60": "---", "groups": [], "cf_tracking_firefox_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "nfroyd@mozilla.com", "id": 417288, "name": "nfroyd@mozilla.com", "real_name": "Nathan Froyd [:froydnj]"}, "whiteboard": "", "mentors": [], "cc_detail": [{"email": "josh@joshmatthews.net", "id": 241497, "name": "josh@joshmatthews.net", "real_name": "Josh Matthews [:jdm]"}, {"email": "mh+mozilla@glandium.org", "id": 47192, "name": "mh+mozilla@glandium.org", "real_name": "Mike Hommey [:glandium]"}, {"email": "padenot@mozilla.com", "id": 404637, "name": "padenot@mozilla.com", "real_name": "Paul Adenot (:padenot)"}, {"email": "ryanvm@gmail.com", "id": 75935, "name": "ryanvm@gmail.com", "real_name": "Ryan VanderMeulen [:RyanVM]"}], "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-06-10T00:52:22Z", "cf_status_firefox_esr60": "fixed", "assigned_to": "mh+mozilla@glandium.org", "is_open": false, "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "josh@joshmatthews.net"}], "who": "josh@joshmatthews.net", "when": "2018-05-24T14:57:27Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1454385"}], "who": "padenot@mozilla.com", "when": "2018-05-24T15:04:51Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "kmoir@mozilla.com"}, {"removed": "General", "field_name": "component", "added": "Toolchains"}], "who": "kmoir@mozilla.com", "when": "2018-05-25T18:52:38Z"}, {"changes": [{"removed": "kmoir@mozilla.com", "field_name": "cc", "added": ""}], "who": "kmoir@mozilla.com", "when": "2018-05-25T18:52:47Z"}, {"changes": [{"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "nfroyd@mozilla.com"}], "who": "nfroyd@mozilla.com", "when": "2018-05-29T20:57:20Z"}, {"changes": [{"removed": "?", "field_name": "cf_tracking_firefox62", "added": "+"}], "who": "lhenry@mozilla.com", "when": "2018-05-31T22:25:00Z"}, {"changes": [{"removed": "nfroyd@mozilla.com", "field_name": "assigned_to", "added": "mh+mozilla@glandium.org"}], "who": "mh+mozilla@glandium.org", "when": "2018-06-01T00:50:37Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8982390, "added": "review?(nfroyd@mozilla.com)"}], "who": "mh+mozilla@glandium.org", "when": "2018-06-01T00:52:50Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(nfroyd@mozilla.com)", "attachment_id": 8982390, "added": "review+"}], "who": "nfroyd@mozilla.com", "when": "2018-06-01T00:59:44Z"}, {"changes": [{"field_name": "attachments.description", "removed": "Bug 1464084 - Stop exporting libstdc++ symbols from libxul.", "attachment_id": 8982390, "added": "Bug 1464084 - Don't export libstdc++ symbols with --enable-stdcxx-compat."}], "who": "mh+mozilla@glandium.org", "when": "2018-06-01T06:12:00Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8982390, "added": "review?(nfroyd@mozilla.com)"}], "who": "mh+mozilla@glandium.org", "when": "2018-06-01T06:12:40Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(nfroyd@mozilla.com)", "attachment_id": 8982390, "added": "review+"}], "who": "nfroyd@mozilla.com", "when": "2018-06-01T18:59:53Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(mh+mozilla@glandium.org)"}], "who": "ncsoregi@mozilla.com", "when": "2018-06-01T23:44:25Z"}, {"changes": [{"removed": "needinfo?(mh+mozilla@glandium.org)", "field_name": "flagtypes.name", "added": ""}], "who": "mh+mozilla@glandium.org", "when": "2018-06-01T23:48:27Z"}, {"changes": [{"field_name": "attachments.description", "removed": "Bug 1464084 - Don't export libstdc++ symbols with --enable-stdcxx-compat.", "attachment_id": 8982390, "added": "Bug 1464084 - Don't export std::thread::_M_start_thread symbols with --enable-stdcxx-compat."}], "who": "mh+mozilla@glandium.org", "when": "2018-06-02T05:12:57Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla62"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2018-06-04 18:58:30"}, {"removed": "affected", "field_name": "cf_status_firefox62", "added": "fixed"}], "who": "dluca@mozilla.com", "when": "2018-06-04T18:58:30Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "ryanvm@gmail.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(mh+mozilla@glandium.org)"}, {"removed": "fix-optional", "field_name": "cf_status_firefox60", "added": "wontfix"}], "who": "ryanvm@gmail.com", "when": "2018-06-05T12:42:17Z"}, {"changes": [{"removed": "needinfo?(mh+mozilla@glandium.org)", "field_name": "flagtypes.name", "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8982390, "added": "approval-mozilla-beta?, approval-mozilla-esr60?"}], "who": "mh+mozilla@glandium.org", "when": "2018-06-05T23:15:49Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "approval-mozilla-beta?, approval-mozilla-esr60?", "attachment_id": 8982390, "added": "approval-mozilla-beta+, approval-mozilla-esr60+"}], "who": "ryanvm@gmail.com", "when": "2018-06-06T01:39:22Z"}, {"changes": [{"removed": "affected", "field_name": "cf_status_firefox61", "added": "fixed"}], "who": "ryanvm@gmail.com", "when": "2018-06-06T01:46:06Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(mh+mozilla@glandium.org)"}, {"removed": "fixed", "field_name": "cf_status_firefox61", "added": "affected"}], "who": "ryanvm@gmail.com", "when": "2018-06-06T02:42:33Z"}, {"changes": [{"removed": "needinfo?(mh+mozilla@glandium.org)", "field_name": "flagtypes.name", "added": ""}], "who": "mh+mozilla@glandium.org", "when": "2018-06-06T05:50:14Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1467337"}], "who": "mh+mozilla@glandium.org", "when": "2018-06-07T01:39:29Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(ryanvm@gmail.com)"}], "who": "mh+mozilla@glandium.org", "when": "2018-06-09T22:58:36Z"}, {"changes": [{"removed": "affected", "field_name": "cf_status_firefox61", "added": "fixed"}], "who": "ryanvm@gmail.com", "when": "2018-06-10T00:50:27Z"}, {"changes": [{"removed": "needinfo?(ryanvm@gmail.com)", "field_name": "flagtypes.name", "added": ""}], "who": "ryanvm@gmail.com", "when": "2018-06-10T00:51:16Z"}, {"changes": [{"removed": "affected", "field_name": "cf_status_firefox_esr60", "added": "fixed"}], "who": "ryanvm@gmail.com", "when": "2018-06-10T00:52:22Z"}], "resolution": "FIXED", "op_sys": "All", "cf_fx_points": "---", "cf_blocking_fennec": "---"}