{"status": "RESOLVED", "cf_tracking_firefox60": "---", "attachments": [{"creator": "nalexander@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2015-10-21T13:34:05Z", "type_id": 4, "creation_date": "2015-10-20T17:34:25Z", "id": 1276012, "setter": "s.kaspari@gmail.com"}], "content_type": "text/x-review-board-request", "id": 8676365}, {"creator": "nalexander@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2015-10-21T14:17:51Z", "type_id": 4, "creation_date": "2015-10-20T17:34:29Z", "id": 1276013, "setter": "s.kaspari@gmail.com"}], "content_type": "text/x-review-board-request", "id": 8676366}, {"creator": "nalexander@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2015-10-21T14:15:04Z", "type_id": 4, "creation_date": "2015-10-20T17:34:31Z", "id": 1276016, "setter": "s.kaspari@gmail.com"}], "content_type": "text/x-review-board-request", "id": 8676367}, {"creator": "nalexander@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 8676371}, {"creator": "nalexander@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2015-10-21T14:24:33Z", "type_id": 4, "creation_date": "2015-10-20T22:47:22Z", "id": 1276271, "setter": "s.kaspari@gmail.com"}], "content_type": "text/x-review-board-request", "id": 8676531}, {"creator": "nalexander@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2015-10-21T14:26:52Z", "type_id": 4, "creation_date": "2015-10-20T22:47:24Z", "id": 1276272, "setter": "s.kaspari@gmail.com"}], "content_type": "text/x-review-board-request", "id": 8676532}], "classification": "Client Software", "creator": "nalexander@mozilla.com", "cc": ["margaret.leibovic@gmail.com", "rogelio.dominguez@gmail.com", "s.kaspari@gmail.com"], "depends_on": [], "creation_time": "2015-01-19T18:32:49Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "All", "cf_status_firefox58": "---", "cf_status_firefox59": "---", "keywords": [], "summary": "Root Gradle configuration in srcdir rather than objdir", "cf_last_resolved": "2015-10-22T09:46:36Z", "assigned_to_detail": {"email": "nalexander@mozilla.com", "id": 432887, "name": "nalexander@mozilla.com", "real_name": "Nick Alexander :nalexander"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "assigned_to": "nalexander@mozilla.com", "comment_count": 20, "comments": [{"text": "Right now, |mach gradle-install| arranges a Gradle configuration in $OBJDIR/mobile/android/gradle.  When IntelliJ imports that Gradle configuration, the .idea directory goes in the root, which is $OBJDIR/m/a/g.  That means we can't commit .idea into version control.  It also means we need to do /something/ before we can import the Gradle project into IJ (that something could be part of build-backend, or gradle-install, or ...).\n\nIt's possible that we could root the Gradle configuration in m/a/gradle and perhaps have some or all of the non-rootProject projects in the object directory.  We can certainly do the |mach gradle-install|-like operations in settings.gradle.\n\nThis ticket tracks implementing enough that we can import mobile/android or mobile/android/gradle into IJ directly.", "author": "nalexander@mozilla.com", "id": 9813598, "time": "2015-01-19T18:32:49Z"}, {"text": "I had a shot at doing this, just recording some outcomes here.\n\nI was able to put .idea in m/a/gradle, but the module .iml files were still in $OBJDIR.  IntelliJ doesn't handle missing .iml files gracefully -- you need to re-import.  This is perhaps better than having the .idea directory disappear entirely, since the project still exists in some sense?  Putting the .iml files in m/a/gradle/* will be very tricky.\n\nWe still require a large number of symlinks for paths only, including in mobile/android/base.  Without renaming a lot of things we're going to have a non-nested tree hierarchy in IntelliJ, which looks weird.  My expectation is that we can configure Gradle to copy files from $OBJDIR that are processed without too much difficulty.  (Of course, the build artifacts directory isn't a subdirectory of the src directory, so IJ shows it as a sibling, which looks weird too.  No way around that that I can think of.)", "author": "nalexander@mozilla.com", "id": 10224508, "time": "2015-05-02T17:28:51Z"}, {"text": "Created attachment 8676365\nMozReview Request: Bug 1123416 - Part 1: Make topsrcdir a valid Gradle project root. r?sebastian\n\nBug 1123416 - Make topsrcdir a valid Gradle project root. r?sebastian\n\nThe sub-project definitions are still in the object directory (and\nstill installed by |mach gradle-install); over time, we'll migrate\nthem out.\n\nThe Gradle wrapper and {settings,build}.gradle in topsrcdir are\nidentical to those in mobile/android/gradle.  I don't like the\nduplication, but I also don't want the burden of keeping the two\nconfigurations identical.  We'll move away from the configuration\nusing mobile/android/gradle as quickly as we can.", "author": "nalexander@mozilla.com", "id": 10856060, "time": "2015-10-20T17:34:25Z"}, {"text": "Created attachment 8676366\nMozReview Request: Bug 1123416 - Part 3: Limit IntelliJ objdir indexing. r?sebastian\n\nBug 1123416 - Limit IntelliJ objdir indexing. r?sebastian\n\nIntelliJ's exclusion mechanism (for Gradle-based projects) is not very\nflexible; we get just idea.module.excludeDirs.  This patch crawls the\nfile system to skip what we can.", "author": "nalexander@mozilla.com", "id": 10856062, "time": "2015-10-20T17:34:29Z"}, {"text": "Created attachment 8676367\nMozReview Request: Bug 1123416 - Part 2: Restrict $topsrcdir/build.gradle to Fennec. r?sebastian\n\nBug 1123416 - Restrict $topsrcdir/build.gradle to Fennec. r?sebastian", "author": "nalexander@mozilla.com", "id": 10856064, "time": "2015-10-20T17:34:31Z"}, {"text": "Created attachment 8676371\nScreen Shot 2015-10-20 at 10.36.46 AM.png\n\nsebastian: the sub-projects are still in the object directory.  For me, that yields a tree like this.\n\nMaking the sub-projects live in the source directory is surprisingly easy, now that we've laid the foundation; we just need to mass rename The Universe.", "author": "nalexander@mozilla.com", "id": 10856087, "time": "2015-10-20T17:39:18Z"}, {"text": "Comment on attachment 8676365\nMozReview Request: Bug 1123416 - Part 1: Make topsrcdir a valid Gradle project root. r?sebastian\n\nBug 1123416 - Part 1: Make topsrcdir a valid Gradle project root. r?sebastian\n\nThe sub-project definitions are still in the object directory (and\nstill installed by |mach gradle-install); over time, we'll migrate\nthem out.\n\nThe Gradle wrapper and {settings,build}.gradle in topsrcdir are\nidentical to those in mobile/android/gradle.  I don't like the\nduplication, but I also don't want the burden of keeping the two\nconfigurations identical.  We'll move away from the configuration\nusing mobile/android/gradle as quickly as we can.", "author": "nalexander@mozilla.com", "id": 10857377, "time": "2015-10-20T22:47:16Z"}, {"text": "Comment on attachment 8676367\nMozReview Request: Bug 1123416 - Part 2: Restrict $topsrcdir/build.gradle to Fennec. r?sebastian\n\nBug 1123416 - Part 2: Restrict $topsrcdir/build.gradle to Fennec. r?sebastian", "author": "nalexander@mozilla.com", "id": 10857378, "time": "2015-10-20T22:47:18Z"}, {"text": "Comment on attachment 8676366\nMozReview Request: Bug 1123416 - Part 3: Limit IntelliJ objdir indexing. r?sebastian\n\nBug 1123416 - Part 3: Limit IntelliJ objdir indexing. r?sebastian\nx\nIntelliJ's exclusion mechanism (for Gradle-based projects) is not very\nflexible; we get just idea.module.excludeDirs.  This patch crawls the\nfile system to skip what we can.", "author": "nalexander@mozilla.com", "id": 10857379, "time": "2015-10-20T22:47:20Z"}, {"text": "Created attachment 8676531\nMozReview Request: Bug 1174244 - Part 4: Remove 'thirdparty_adjust_sdk' Gradle project. r?sebastian\n\nBug 1174244 - Part 4: Remove 'thirdparty_adjust_sdk' Gradle project. r?sebastian", "author": "nalexander@mozilla.com", "id": 10857380, "time": "2015-10-20T22:47:22Z"}, {"text": "Created attachment 8676532\nMozReview Request: Bug 1123416 - Part 5: Make a 'thirdparty' Gradle project in the source directory. r?sebastian\n\nBug 1123416 - Part 5: Make a 'thirdparty' Gradle project in the source directory. r?sebastian\n\nI don't want to cut consumers of $OBJDIR/mobile/android/gradle over\nyet, so this doesn't remove the existing 'thirdparty' project.", "author": "nalexander@mozilla.com", "id": 10857381, "time": "2015-10-20T22:47:24Z"}, {"text": "Comment on attachment 8676365\nMozReview Request: Bug 1123416 - Part 1: Make topsrcdir a valid Gradle project root. r?sebastian\n\nhttps://reviewboard.mozilla.org/r/22677/#review20281", "author": "s.kaspari@gmail.com", "id": 10859240, "time": "2015-10-21T13:34:05Z"}, {"text": "Comment on attachment 8676367\nMozReview Request: Bug 1123416 - Part 2: Restrict $topsrcdir/build.gradle to Fennec. r?sebastian\n\nhttps://reviewboard.mozilla.org/r/22681/#review20293", "author": "s.kaspari@gmail.com", "id": 10859406, "time": "2015-10-21T14:15:04Z"}, {"text": "Comment on attachment 8676366\nMozReview Request: Bug 1123416 - Part 3: Limit IntelliJ objdir indexing. r?sebastian\n\nhttps://reviewboard.mozilla.org/r/22679/#review20297\n\nNice!\n\nBtw. there's a lonely \"x\" in the commit message.", "author": "s.kaspari@gmail.com", "id": 10859423, "time": "2015-10-21T14:17:51Z"}, {"text": "Comment on attachment 8676531\nMozReview Request: Bug 1174244 - Part 4: Remove 'thirdparty_adjust_sdk' Gradle project. r?sebastian\n\nhttps://reviewboard.mozilla.org/r/22743/#review20299", "author": "s.kaspari@gmail.com", "id": 10859453, "time": "2015-10-21T14:24:34Z"}, {"text": "Comment on attachment 8676532\nMozReview Request: Bug 1123416 - Part 5: Make a 'thirdparty' Gradle project in the source directory. r?sebastian\n\nhttps://reviewboard.mozilla.org/r/22745/#review20303", "author": "s.kaspari@gmail.com", "id": 10859470, "time": "2015-10-21T14:26:52Z"}, {"text": "This is pretty cool! I imported the root directory and it just works!\n\nAfter applying the patches |mach gradle-install| (Should not be needed, right?) and |mach gradle ...| yields an error (Symlink target path does not exist: /Users/sebastian/Projects/Mozilla/fx-team/mobile/android/gradle/thirdparty_adjust_sdk/build.gradle). But I can use |gradlew ..| without issues.", "author": "s.kaspari@gmail.com", "id": 10859500, "time": "2015-10-21T14:31:17Z"}, {"text": "Oh, and |hg st| now lists the following IntelliJ files:\n\n> TheSilence:fx-team sebastian$ hg st\n> ? fx-team.iml\n> ? mobile/android/thirdparty/thirdparty.iml\n\nShould we just add *.iml to .hgignore?", "author": "s.kaspari@gmail.com", "id": 10859557, "time": "2015-10-21T14:43:12Z"}, {"text": "https://hg.mozilla.org/integration/fx-team/rev/3fa48c9d205bc6628b74caf93716338935b48689\nBug 1123416 - Part 1: Make topsrcdir a valid Gradle project root. r=sebastian\n\nhttps://hg.mozilla.org/integration/fx-team/rev/fe2090d75defeed0132976b20b2f9d31a9d073eb\nBug 1123416 - Part 2: Restrict $topsrcdir/build.gradle to Fennec. r=sebastian\n\nhttps://hg.mozilla.org/integration/fx-team/rev/d8bf6eec26273b90f2a92c6d1e7a967ede086c2b\nBug 1123416 - Part 3: Limit IntelliJ objdir indexing. r=sebastian\n\nhttps://hg.mozilla.org/integration/fx-team/rev/479539a438420df4feddae381c74c61be108bf5a\nBug 1123416 - Part 5: Make a 'thirdparty' Gradle project in the source directory. r=sebastian", "author": "nalexander@mozilla.com", "id": 10862094, "time": "2015-10-22T02:21:51Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/3fa48c9d205b\nhttps://hg.mozilla.org/mozilla-central/rev/fe2090d75def\nhttps://hg.mozilla.org/mozilla-central/rev/d8bf6eec2627\nhttps://hg.mozilla.org/mozilla-central/rev/479539a43842", "author": "cbook@mozilla.com", "id": 10862860, "time": "2015-10-22T09:46:36Z"}], "id": 1123416, "priority": "--", "mentors_detail": [], "cf_crash_signature": "", "version": "unspecified", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox59": "---", "last_change_time": "2017-10-03T16:48:42Z", "cf_platform_rel": "---", "product": "Firefox for Android", "cf_status_firefox_esr52": "---", "blocks": [1041395, 1218935, 1219846, 1220887, 1228418, 1228430, 1230848, 1296146], "qa_contact": "", "see_also": [], "cf_fx_iteration": "---", "component": "Build Config & IDE Support", "votes": 0, "groups": [], "cf_status_firefox60": "---", "target_milestone": "---", "cf_status_firefox44": "fixed", "is_cc_accessible": true, "url": "", "creator_detail": {"email": "nalexander@mozilla.com", "id": 432887, "name": "nalexander@mozilla.com", "real_name": "Nick Alexander :nalexander"}, "whiteboard": "", "mentors": [], "cc_detail": [{"email": "margaret.leibovic@gmail.com", "id": 346894, "name": "margaret.leibovic@gmail.com", "real_name": ":Margaret Leibovic"}, {"email": "rogelio.dominguez@gmail.com", "id": 490873, "name": "rogelio.dominguez@gmail.com", "real_name": ""}, {"email": "s.kaspari@gmail.com", "id": 472516, "name": "s.kaspari@gmail.com", "real_name": "Sebastian Kaspari (:sebastian)"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "cf_tracking_firefox58": "---", "cf_rank": null, "is_open": false, "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "rogelio.dominguez@gmail.com"}], "who": "rogelio.dominguez@gmail.com", "when": "2015-01-19T20:24:57Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8676365, "added": "review?(s.kaspari@gmail.com)"}, {"removed": "", "field_name": "cc", "added": "s.kaspari@gmail.com"}], "who": "nalexander@mozilla.com", "when": "2015-10-20T17:34:25Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8676366, "added": "review?(s.kaspari@gmail.com)"}], "who": "nalexander@mozilla.com", "when": "2015-10-20T17:34:29Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8676367, "added": "review?(s.kaspari@gmail.com)"}], "who": "nalexander@mozilla.com", "when": "2015-10-20T17:34:31Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "ASSIGNED"}, {"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "nalexander@mozilla.com"}], "who": "nalexander@mozilla.com", "when": "2015-10-20T17:37:15Z"}, {"changes": [{"field_name": "attachments.description", "removed": "MozReview Request: Bug 1123416 - Make topsrcdir a valid Gradle project root. r?sebastian", "attachment_id": 8676365, "added": "MozReview Request: Bug 1123416 - Part 1: Make topsrcdir a valid Gradle project root. r?sebastian"}], "who": "nalexander@mozilla.com", "when": "2015-10-20T22:47:16Z"}, {"changes": [{"field_name": "attachments.description", "removed": "MozReview Request: Bug 1123416 - Restrict $topsrcdir/build.gradle to Fennec. r?sebastian", "attachment_id": 8676367, "added": "MozReview Request: Bug 1123416 - Part 2: Restrict $topsrcdir/build.gradle to Fennec. r?sebastian"}], "who": "nalexander@mozilla.com", "when": "2015-10-20T22:47:18Z"}, {"changes": [{"field_name": "attachments.description", "removed": "MozReview Request: Bug 1123416 - Limit IntelliJ objdir indexing. r?sebastian", "attachment_id": 8676366, "added": "MozReview Request: Bug 1123416 - Part 3: Limit IntelliJ objdir indexing. r?sebastian"}], "who": "nalexander@mozilla.com", "when": "2015-10-20T22:47:20Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8676531, "added": "review?(s.kaspari@gmail.com)"}], "who": "nalexander@mozilla.com", "when": "2015-10-20T22:47:22Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8676532, "added": "review?(s.kaspari@gmail.com)"}], "who": "nalexander@mozilla.com", "when": "2015-10-20T22:47:24Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(s.kaspari@gmail.com)", "attachment_id": 8676365, "added": "review+"}], "who": "s.kaspari@gmail.com", "when": "2015-10-21T13:34:05Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(s.kaspari@gmail.com)", "attachment_id": 8676367, "added": "review+"}], "who": "s.kaspari@gmail.com", "when": "2015-10-21T14:15:04Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(s.kaspari@gmail.com)", "attachment_id": 8676366, "added": "review+"}], "who": "s.kaspari@gmail.com", "when": "2015-10-21T14:17:51Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(s.kaspari@gmail.com)", "attachment_id": 8676531, "added": "review+"}], "who": "s.kaspari@gmail.com", "when": "2015-10-21T14:24:33Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(s.kaspari@gmail.com)", "attachment_id": 8676532, "added": "review+"}], "who": "s.kaspari@gmail.com", "when": "2015-10-21T14:26:52Z"}, {"changes": [{"removed": "ASSIGNED", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla44"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2015-10-22 02:46:36"}, {"removed": "---", "field_name": "cf_status_firefox44", "added": "fixed"}], "who": "cbook@mozilla.com", "when": "2015-10-22T09:46:36Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1218935"}], "who": "nalexander@mozilla.com", "when": "2015-10-27T18:44:58Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "margaret.leibovic@gmail.com"}], "who": "margaret.leibovic@gmail.com", "when": "2015-10-28T19:23:22Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1219846"}], "who": "nalexander@mozilla.com", "when": "2015-10-29T18:08:27Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1220887"}], "who": "nalexander@mozilla.com", "when": "2015-11-02T22:54:12Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1228418"}], "who": "nalexander@mozilla.com", "when": "2015-11-26T19:32:21Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1228430"}], "who": "nalexander@mozilla.com", "when": "2015-11-26T21:01:21Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1230848"}], "who": "nalexander@mozilla.com", "when": "2015-12-06T22:47:20Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1296146"}], "who": "bugspam.Callek@gmail.com", "when": "2016-08-18T00:43:20Z"}, {"changes": [{"removed": "Build Config", "field_name": "component", "added": "Build Config & IDE Support"}, {"removed": "Core", "field_name": "product", "added": "Firefox for Android"}, {"removed": "mozilla44", "field_name": "target_milestone", "added": "---"}], "who": "nalexander@mozilla.com", "when": "2017-10-03T16:48:42Z"}], "resolution": "FIXED", "op_sys": "Android", "cf_fx_points": "---", "cf_blocking_fennec": "---"}