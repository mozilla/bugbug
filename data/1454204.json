{"cf_tracking_thunderbird_esr52": "---", "status": "ASSIGNED", "cf_tracking_firefox60": "+", "cf_tracking_firefox61": "+", "cf_tracking_firefox62": "+", "creator": "ian@iangilman.com", "mentors_detail": [], "depends_on": [], "cf_status_firefox_esr60": "disabled", "cf_user_story": "", "cf_tracking_firefox_relnote": "60+", "platform": "x86", "cf_status_firefox59": "disabled", "keywords": ["regression"], "cc_detail": [{"email": "anthony.scavarelli@gmail.com", "id": 616006, "name": "anthony.scavarelli@gmail.com", "real_name": ""}, {"email": "emilio@crisal.io", "id": 546716, "name": "emilio@crisal.io", "real_name": "Emilio Cobos \u00c1lvarez [:emilio]"}, {"email": "jcristau@mozilla.com", "id": 580382, "name": "jcristau@mozilla.com", "real_name": "Julien Cristau [:jcristau]"}, {"email": "josh@joshmatthews.net", "id": 241497, "name": "josh@joshmatthews.net", "real_name": "Josh Matthews [:jdm]"}, {"email": "kgilbert@mozilla.com", "id": 499338, "name": "kgilbert@mozilla.com", "real_name": ":kip (Kearwood Gilbert)"}, {"email": "larsberg@mozilla.com", "id": 478660, "name": "larsberg@mozilla.com", "real_name": "Lars Bergstrom (:larsberg)"}, {"email": "mcastelluccio@mozilla.com", "id": 420453, "name": "mcastelluccio@mozilla.com", "real_name": "Marco Castelluccio [:marco]"}, {"email": "pascal.bayer@cubesoft.org", "id": 616004, "name": "pascal.bayer@cubesoft.org", "real_name": "pascal.bayer"}, {"email": "pascalc@gmail.com", "id": 24572, "name": "pascalc@gmail.com", "real_name": "Pascal Chevrel:pascalc"}, {"email": "ryanvm@gmail.com", "id": 75935, "name": "ryanvm@gmail.com", "real_name": "Ryan VanderMeulen [:RyanVM]"}], "cf_last_resolved": null, "attachments": [], "votes": 0, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "yes", "comment_count": 16, "comments": [{"text": "I'm running Mac OS 10.13.4 (17E199) with Steam VR beta version 1523560849 (built April 12, 2018) and Firefox Nightly 61.0a1 (2018-04-15) (64-bit). I can run Blobby Tennis from Steam, and I can run VR projects created in Unity 2018.1.0b13; those both present in the Vive without trouble and with smooth frame rate. WebVR in the Firefox Nightly, however, does not present in the Vive at all.\n\nRepro steps:\n\n1. Start Steam VR\n2. Open Firefox Nightly\n3. Go to https://webvr.info/samples/03-vr-presentation.html\n4. Hit the \"Enter VR\" button in the lower right\n\nExpected:\n\nThe VR scene would be shown in the Vive headset.\n\nActual result:\n\nThe headset remains in the default Vive \"white room\". The display in the browser updates to a split screen but otherwise remains unchanged. The FPS meter drops to one or zero.\n\nObservations:\n\nSome communication between the browser and the headset appears to be happening. For instance, when first loading the page in the browser, the scene shows up in the browser oriented to match the headset (straight on if the headset is sitting on a table, tilted if the headset is tilted, etc.). However, no additional changes to the headset are picked up (until next time you load the page). Also, if the headset has fallen asleep (the display has gone dim due to lack of activity), and you load the webpage, the display wakes up (even though it stays in the white room).\n\nBasically it appears we get a single frame of connection and then go back to disconnected.\n\nInterestingly, if you then refresh the webpage, you are informed \"WebVR supported, but no VRDisplays found.\" You have to actually restart the browser to even get the minimal (single frame) of connection you got before.\n\nI've tried a number of other WebVR pages and they all present more or less the same symptoms.", "author": "ian@iangilman.com", "id": 13206215, "time": "2018-04-15T03:11:20Z"}, {"text": "I have seen the same symptoms. Actually I had the exact same scenario happen before I updated to 10.13.4. Now the Vive no longer communicates at all (no first frame on mirrored display - has never displayed in headset). It just doesn't recognize the Vive connected at all. However, as above, I can build with the MacVR Unity build and see the default grey room.\n\n- Mac OSX 10.13.4\n- SteamVR Beta\n- Firefox Nightly\n- Akito Node w/ AMD Radeon 580 (Not a Sonnet yes, but seems to work fine in every other respect).\n- The entire setup works perfectly find in Windows Bootcamp\n\nEDIT: Just noticed a SteamVR update. Will try again tonight.", "author": "anthony.scavarelli@gmail.com", "id": 13206823, "time": "2018-04-15T16:46:21Z"}, {"text": "Reproducible on the following setup:\n\n- MacBookPro 14,3 \n- macOS 10.13.4 (17E199)\n- GPU Radeon Pro 560\n- eGPU GeForce GTX 1060 (via Sonnet eGFX Breakaway Box 550)\n- Vive\n- Vive Pro\n- Steam VR Beta - 2018-04-12 (1523560849)\n- Firefox Nightly - 61.0a1 (2018-04-15) (64-bit)\n\nUsing the same setup on Windows 10 with Bootcamp works fine (most of the times).\n\n\nObservations on Windows that might be related:\n\nIf SteamVR isn't launched on the same monitor the VR headset is mounted to (different outputs but same GPU), only motion tracking works on FF Nightly for Windows, but no WebVR stream is available only \"default room\" as on macOS. So maybe not picking up the correct display on macOS?", "author": "pascal.bayer@cubesoft.org", "id": 13206844, "time": "2018-04-15T18:06:14Z"}, {"text": "I know this combination (Firefox/Vive/Mac OS) has worked in the past. As far as identifying when the breakage happened, there's this tweet that suggests it started with 61.0a1(20180314102135):\n\nhttps://twitter.com/VRonMac/status/975901108378972160\n\nOf course we don't know if the change happened in Firefox or Steam or Mac OS or some combination. Still, having a sense for the timing might be a useful clue.", "author": "ian@iangilman.com", "id": 13206961, "time": "2018-04-15T23:18:02Z"}, {"text": "It occurred to me I could try an earlier Nightly, from before the breakage was first reported, to see if that would work. I tried 60.0a1 (2018-03-01) (64-bit):\n\nhttps://download-origin.cdn.mozilla.net/pub/firefox/nightly/2018/03/2018-03-01-02-47-24-mozilla-central/firefox-60.0a1.en-US.mac.dmg\n\n\u2026 which would have been a couple weeks before the tweet above. I got the same symptoms.\n\nI then tried 60.0a1 (2018-02-01) (64-bit) from a month before:\n\nhttps://download-origin.cdn.mozilla.net/pub/firefox/nightly/2018/02/2018-02-01-10-03-26-mozilla-central/firefox-60.0a1.en-US.mac.dmg\n\nIt doesn't work completely there, but it is different! Once you hit \"enter VR\" the scene in the browser responds properly to the position and orientation of the headset. The headset doesn't show the scene, but it does switch from the usual \"white room\" to an almost identical \"black room\" with a white square on the floor. Meanwhile the SteamVR status window says \"(unresponsive) Firefox\".\n\nI then tried 59.0a1 (2018-01-01) (64-bit):\n\nhttps://download-origin.cdn.mozilla.net/pub/firefox/nightly/2018/01/2018-01-01-10-04-04-mozilla-central/firefox-59.0a1.en-US.mac.dmg\n\nSure enough, it works! When you hit \"enter VR\" the browser shows \"put on your headset now\" and the scene plays in the headset. The SteamVR status window just says \"Firefox\". Everything is good.\n\nSo\u2026 It appears that something happened in the Firefox code between January 1 and now that broke the Mac WebVR support. This means the breakage isn't in Mac OS or SteamVR. I hope this helps track down the solution!", "author": "ian@iangilman.com", "id": 13217452, "time": "2018-04-19T04:27:02Z"}, {"text": "Nice find, that version works for me as well.", "author": "anthony.scavarelli@gmail.com", "id": 13220414, "time": "2018-04-20T02:30:30Z"}, {"text": "Thanks for narrowing the regression range.  I'm investigating this now, and hope to have a fix soon.", "author": "kgilbert@mozilla.com", "id": 13239219, "time": "2018-04-27T21:30:59Z"}, {"text": "WebVR is shipping for OSX with Fx60 next week, but we're already building RC builds for it :(. Seems highly unlikely we're going to have a fix ready in time, but let's keep this bug on the radar just in case.", "author": "ryanvm@gmail.com", "id": 13246221, "time": "2018-05-01T15:23:06Z"}, {"text": "I've narrowed the regression range further:\n\n59.0a1 (2018-01-01) (64-bit) - Good\n59.0a1 (2018-01-15) (64-bit) - Good\n59.0a1 (2018-01-20) (64-bit) - Good\n60.0a1 (2018-01-25) (64-bit) - Good\n60.0a1 (2018-01-29) (64-bit) - Good\n60.0a1 (2018-01-30) (64-bit) - Good\n60.0a1 (2018-01-31) (64-bit) - Good\nmozilla-central build built on 2018-01-31 23:56:04.850000, revision 17ade9f8 - Good\nautoland build built on 2018-01-31 21:33:19.335000, revision ba88f9cd - Good\n\nautoland build built on 2018-01-31 21:59:09.271000, revision 0936ba31 - Good\n\nautoland build built on 2018-01-31 22:10:39.707000, revision bf1efa16 - Bad\nautoland build built on 2018-01-31 23:11:15.403000, revision 982d1a88 - Bad\nautoland build built on 2018-02-01 00:18:21.032000, revision 26b03e4d - Bad\nmozilla-central build built on 2018-02-01 10:42:58.406000, revision 1fac52e0 - Bad\nmozilla-central build built on 2018-02-01 10:54:00.893000, revision 5201997e - Bad\nmozilla-central build built on 2018-02-01 18:46:03.611000, revision 946b943a - Bad\n60.0a1 (2018-02-01) (64-bit) - Bad", "author": "kgilbert@mozilla.com", "id": 13255707, "time": "2018-05-04T20:40:16Z"}, {"text": "Found the cause of the regression:\n\nLast good revision: 0936ba31843e4aab5dd76f9310d142db311b2f41\n19:09.94 INFO: First bad revision: bf1efa161edb20a83fe8db2f96c51f4e66880153\n19:09.94 INFO: Pushlog:\nhttps://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=0936ba31843e4aab5dd76f9310d142db311b2f41&tochange=bf1efa161edb20a83fe8db2f96c51f4e66880153\n\nThe \"Force disable OSX system nano allocator\" patch in Bug 1424709 has broken it.  Reversing the changes in the info.plist file allows WebVR to work again on macOS.", "author": "kgilbert@mozilla.com", "id": 13255710, "time": "2018-05-04T20:41:49Z"}, {"text": "FWIW, I've tried updating to OpenVR 1.0.14 client source, with the same effect.", "author": "kgilbert@mozilla.com", "id": 13255952, "time": "2018-05-04T22:30:46Z"}, {"text": "Added as a known issue in 60.0 release notes.  We'll likely disable in 60.0.1 (bug 1459362).", "author": "jcristau@mozilla.com", "id": 13264757, "time": "2018-05-09T09:02:29Z"}, {"text": "WebVR is verified disabled on OSX for 61 now, updating the flags accordingly.", "author": "ryanvm@gmail.com", "id": 13269374, "time": "2018-05-10T21:13:10Z"}, {"text": "Kip, any luck? Is this still something we're aiming to enable in 62?", "author": "lhenry@mozilla.com", "id": 13294567, "time": "2018-05-21T17:19:15Z"}, {"text": "(In reply to Liz Henry (:lizzard) (needinfo? me) from comment #13)\n> Kip, any luck? Is this still something we're aiming to enable in 62?\n\nI have found the cause of the regression and a work-around; however, the proper fix will be dependent on creating a separate process to isolate VR API access - Bug 1362578\n\nAs this will be dependent on a much bigger piece, I would plan on this slipping until 63.\n\n@daoshengmu will be tag-teaming with me to accelerate this work.", "author": "kgilbert@mozilla.com", "id": 13300015, "time": "2018-05-23T17:03:23Z"}, {"text": "A workaround until this is fixed:\n\n- Stop all Firefox processes\n- Use terminal to start Firefox with the MallocNanoZone environment variable set to \"1\":\n\nFor Firefox Release, run this:\n  export MallocNanoZone=1 && /Applications/Firefox.app/Contents/MacOS/firefox\n\nFor Firefox Nightly, run this:\n  export MallocNanoZone=1 && /Applications/Firefox\\ Nightly.app/Contents/MacOS/firefox\n\n- Be sure to flip \"dom.vr.enabled\" to \"true\" in about:config if using release firefox.\n\nDo not use if you use multiple macOS \"network locations\" due to remote risk of crashing", "author": "kgilbert@mozilla.com", "id": 13300474, "time": "2018-05-23T19:36:22Z"}], "id": 1454204, "priority": "--", "cc": ["anthony.scavarelli@gmail.com", "emilio@crisal.io", "jcristau@mozilla.com", "josh@joshmatthews.net", "kgilbert@mozilla.com", "larsberg@mozilla.com", "mcastelluccio@mozilla.com", "pascal.bayer@cubesoft.org", "pascalc@gmail.com", "ryanvm@gmail.com"], "cf_crash_signature": "", "version": "61 Branch", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_thunderbird_esr60": "---", "cf_platform_rel": "---", "product": "Core", "cf_fx_iteration": "---", "blocks": [1424709], "qa_contact": "", "creation_time": "2018-04-15T03:11:20Z", "cf_status_firefox_esr52": "unaffected", "component": "WebVR", "assigned_to_detail": {"email": "kgilbert@mozilla.com", "id": 499338, "name": "kgilbert@mozilla.com", "real_name": ":kip (Kearwood Gilbert)"}, "cf_tracking_firefox_esr60": "60+", "cf_status_firefox62": "affected", "cf_status_firefox61": "disabled", "cf_status_firefox60": "disabled", "target_milestone": "---", "cf_rank": null, "cf_qa_whiteboard": "", "severity": "major", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "ian@iangilman.com", "id": 377746, "name": "ian@iangilman.com", "real_name": "Ian Gilman [:iangilman]"}, "whiteboard": "", "mentors": [], "summary": "WebVR doesn't present in Vive on Mac OS", "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-05-23T19:36:22Z", "assigned_to": "kgilbert@mozilla.com", "is_open": true, "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "larsberg@mozilla.com"}], "who": "ian@iangilman.com", "when": "2018-04-15T03:12:00Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "anthony.scavarelli@gmail.com"}], "who": "anthony.scavarelli@gmail.com", "when": "2018-04-15T16:46:21Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "pascal.bayer@cubesoft.org"}], "who": "pascal.bayer@cubesoft.org", "when": "2018-04-15T18:06:14Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "pascalc@gmail.com"}], "who": "pascalc@gmail.com", "when": "2018-04-16T07:38:47Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "kgilbert@mozilla.com"}, {"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "kgilbert@mozilla.com"}], "who": "kgilbert@mozilla.com", "when": "2018-04-27T21:30:59Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "regression"}, {"removed": "", "field_name": "cc", "added": "mcastelluccio@mozilla.com"}], "who": "mcastelluccio@mozilla.com", "when": "2018-04-30T13:15:13Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "ryanvm@gmail.com"}, {"removed": "---", "field_name": "cf_status_firefox_esr52", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_firefox_esr60", "added": "wontfix"}, {"removed": "---", "field_name": "cf_status_firefox59", "added": "disabled"}, {"removed": "---", "field_name": "cf_tracking_firefox60", "added": "+"}, {"removed": "---", "field_name": "cf_status_firefox60", "added": "fix-optional"}], "who": "ryanvm@gmail.com", "when": "2018-05-01T15:23:06Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "josh@joshmatthews.net"}], "who": "josh@joshmatthews.net", "when": "2018-05-02T03:26:47Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "ASSIGNED"}], "who": "kgilbert@mozilla.com", "when": "2018-05-04T20:40:16Z"}, {"changes": [{"removed": "---", "field_name": "cf_has_regression_range", "added": "yes"}], "who": "kgilbert@mozilla.com", "when": "2018-05-04T20:42:51Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "emilio@crisal.io"}], "who": "emilio@crisal.io", "when": "2018-05-06T12:09:18Z"}, {"changes": [{"removed": "---", "field_name": "cf_tracking_firefox61", "added": "+"}], "who": "ryanvm@gmail.com", "when": "2018-05-07T14:35:49Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jcristau@mozilla.com"}, {"removed": "---", "field_name": "cf_tracking_firefox_relnote", "added": "60+"}], "who": "jcristau@mozilla.com", "when": "2018-05-09T09:02:29Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1424709"}], "who": "jcristau@mozilla.com", "when": "2018-05-09T09:02:42Z"}, {"changes": [{"removed": "wontfix", "field_name": "cf_status_firefox_esr60", "added": "disabled"}, {"removed": "affected", "field_name": "cf_status_firefox61", "added": "disabled"}, {"removed": "---", "field_name": "cf_tracking_firefox62", "added": "+"}, {"removed": "---", "field_name": "cf_status_firefox62", "added": "affected"}], "who": "ryanvm@gmail.com", "when": "2018-05-10T21:13:10Z"}, {"changes": [{"removed": "---", "field_name": "cf_tracking_firefox_esr60", "added": "60+"}, {"removed": "fix-optional", "field_name": "cf_status_firefox60", "added": "disabled"}], "who": "ryanvm@gmail.com", "when": "2018-05-14T12:28:51Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(kgilbert@mozilla.com)"}], "who": "lhenry@mozilla.com", "when": "2018-05-21T17:19:15Z"}, {"changes": [{"removed": "needinfo?(kgilbert@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "kgilbert@mozilla.com", "when": "2018-05-23T17:03:23Z"}], "resolution": "", "op_sys": "Mac OS X", "cf_fx_points": "---", "cf_blocking_fennec": "---"}