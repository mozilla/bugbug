{"status": "VERIFIED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "+", "classification": "Client Software", "creator": "itiel_yn8@walla.com", "cc": ["cdenizet@mozilla.com", "community@rtl.bugs", "francesco.lodolo@gmail.com", "gandalf@aviary.pl", "jaws@mozilla.com", "khaledhosny@eglug.org", "l10n@mozilla.com", "mcastelluccio@mozilla.com", "paolo.mozmail@amadzone.org", "reza.habibi2008@gmail.com", "ryanvm@gmail.com", "safa1996alfulaij@gmail.com", "timea.babos@softvision.ro", "tomer.moz.bugs@tomercohen.com"], "depends_on": [], "creation_time": "2018-04-28T20:00:09Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "cf_status_firefox59": "unaffected", "keywords": ["regression", "rtl"], "summary": "[RTL] Download folder text overlapping the folder's icon", "id": 1457720, "attachments": [{"creator": "itiel_yn8@walla.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 8971816}, {"creator": "paolo.mozmail@amadzone.org", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2018-05-01T17:03:43Z", "type_id": 748, "creation_date": "2018-05-01T16:14:15Z", "id": 1751205, "setter": "gandalf@aviary.pl"}], "content_type": "text/x-review-board-request", "id": 8972355}], "assigned_to_detail": {"email": "paolo.mozmail@amadzone.org", "id": 332229, "name": "paolo.mozmail@amadzone.org", "real_name": ":Paolo Amadini"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 28, "comments": [{"text": "Created attachment 8971816\nScreenshot\n\nThis started a few days ago, but for some reason I can't pinpoint it with mozregression (even after setting intl.uidirection pref to 1 the UI looks okay).\n\nSee attached.", "author": "itiel_yn8@walla.com", "id": 13240064, "time": "2018-04-28T20:00:09Z"}, {"text": "This is most likely fallout from bug 1452624. Flagging needinfo for Paolo.", "author": "jaws@mozilla.com", "id": 13243235, "time": "2018-04-30T14:36:56Z"}, {"text": "Is this happening only on final builds? I tested this after changing \"intl.uidirection\" and the result looks fine to me.", "author": "paolo.mozmail@amadzone.org", "id": 13243570, "time": "2018-04-30T16:18:26Z"}, {"text": "(In reply to :Paolo Amadini from comment #2)\n> Is this happening only on final builds? I tested this after changing\n> \"intl.uidirection\" and the result looks fine to me.\n\nMakes sense (see comment 0); any mozregression build I run with this pref set to 1 is working just fine.\nThe only factor I see that should be related to this issue is the locale being RTL, because fresh English Nightly builds work okay, but on the other hand new profiles with RTL locale & RTL turned on have this issue.\n\"Final builds\" = ?", "author": "itiel_yn8@walla.com", "id": 13243635, "time": "2018-04-30T16:38:00Z"}, {"text": "\"Final builds\" = the repackaged localized Nightly builds available on the website.\n\nSo, using the and the developer tools in Arabic was fun, and I located this \"intl.css\" declaration that is specific to this build:\n\nhttps://dxr.mozilla.org/l10n-central/rev/f1dd8aa91a57075e2ef117cfcd498f61849e8d90/ar/toolkit/chrome/global/intl.css#50\n\nDisabling these rules fixes the margin, but the \"/\" at the beginning of a custom path would appear at the end instead.\n\nApparently introduced in bug 289934, this solution isn't really scalable. What is the correct way to display the path correctly here, supporting all RTL builds including changing \"intl.uidirection\"? How can we then have the \"#downloadFolder\" selector removed from the localized repositories?\n\nI'm also not quite sure what the other IDs refer to, if anything.", "author": "paolo.mozmail@amadzone.org", "id": 13243762, "time": "2018-04-30T17:21:38Z"}, {"text": "(In reply to :Paolo Amadini from comment #4)\n> So, using the and the developer tools in Arabic was fun\n\nThe word \"browser\" was eaten by some Unicode bidirectional mark, I guess ;-)", "author": "paolo.mozmail@amadzone.org", "id": 13243771, "time": "2018-04-30T17:24:13Z"}, {"text": "I'm not sure how paths work in RTL, but generally speaking if it's HTML you can use `<bdi></bdi>` to isolate directionality. If it's an attribute and you can't use HTML elements, you can use FSI/PDI (that's what Fluent uses). http://unicode.org/reports/tr9/#Explicit_Directional_Overrides\n\nYou should be able to do `\\u2068${path}\\u2069`", "author": "gandalf@aviary.pl", "id": 13243875, "time": "2018-04-30T18:09:41Z"}, {"text": "(In reply to :Paolo Amadini from comment #2)\n> Is this happening only on final builds?\n> \"Final builds\" = the repackaged localized Nightly builds available on the\n> website.\n\nYes.", "author": "itiel_yn8@walla.com", "id": 13243904, "time": "2018-04-30T18:15:32Z"}, {"text": "(In reply to Zibi Braniecki [:gandalf][:zibi] from comment #6)\n> I'm not sure how paths work in RTL, but generally speaking if it's HTML you\n> can use `<bdi></bdi>` to isolate directionality. If it's an attribute and\n> you can't use HTML elements, you can use FSI/PDI (that's what Fluent uses).\n> You should be able to do `\\u2068${path}\\u2069`\n\nThanks! Since we know when we are displaying a localized folder name versus a custom path, for the latter I did some testing and it seems I should use LRI (\\u2066), otherwise if the first path component after the \"/\" is Arabic the whole paragraph is reversed. I think this matches the behavior of the current localized builds.\n\nI'll post a patch for this, but how do we go about having the \"#downloadFolder\" selector removed from the localized repositories?", "author": "paolo.mozmail@amadzone.org", "id": 13246434, "time": "2018-05-01T16:09:40Z"}, {"text": "Created attachment 8972355\nBug 1457720 - Force the left-to-right direction when displaying a custom download path.\n\nReview commit: https://reviewboard.mozilla.org/r/240980/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/240980/", "author": "paolo.mozmail@amadzone.org", "id": 13246441, "time": "2018-05-01T16:14:15Z"}, {"text": "Comment on attachment 8972355\nBug 1457720 - Force the left-to-right direction when displaying a custom download path.\n\nhttps://reviewboard.mozilla.org/r/240980/#review246756", "author": "gandalf@aviary.pl", "id": 13246549, "time": "2018-05-01T17:03:43Z"}, {"text": "This looks good! \n\n>  but how do we go about having the \"#downloadFolder\" selector removed from the localized repositories?\n\nI don't think I understand the question. Can you rephrase?", "author": "gandalf@aviary.pl", "id": 13246553, "time": "2018-05-01T17:04:24Z"}, {"text": "There is a \"toolkit/chrome/global/intl.css\" that is apparently specific to each localized build. Arabic and a few other locales have this rule that causes the bug:\n\nhttps://dxr.mozilla.org/l10n-central/rev/f1dd8aa91a57075e2ef117cfcd498f61849e8d90/ar/toolkit/chrome/global/intl.css#50", "author": "paolo.mozmail@amadzone.org", "id": 13246595, "time": "2018-05-01T17:23:31Z"}, {"text": "And what's the question? :)\n\nDo you want to remove `#downloadFolder` from that css? With the LRI/PDI you should be able to, no?", "author": "gandalf@aviary.pl", "id": 13246599, "time": "2018-05-01T17:25:06Z"}, {"text": "Do I need to post a patch for l10n-central? Does it need to be reviewed by individual locale owners? There are three locales affected:\n\nhttps://dxr.mozilla.org/l10n-central/search?q=%23downloadFolder&redirect=true", "author": "paolo.mozmail@amadzone.org", "id": 13246617, "time": "2018-05-01T17:31:59Z"}, {"text": "Ahh! Now I get your question. Sorry it took me so long! NI on :flod :)", "author": "gandalf@aviary.pl", "id": 13246634, "time": "2018-05-01T17:40:14Z"}, {"text": "(In reply to :Paolo Amadini from comment #14)\n> Do I need to post a patch for l10n-central? Does it need to be reviewed by\n> individual locale owners? There are three locales affected:\n> \n> https://dxr.mozilla.org/l10n-central/search?q=%23downloadFolder&redirect=true\n\nI've CCed the RTL alias, and a few localizers from ar/fa/he.\n\nThe request would be to remove the #downloadFolder selector from that rule? I can do it, and reference this bug in the landings, I'm only wondering if there are potential side effects.", "author": "francesco.lodolo@gmail.com", "id": 13246672, "time": "2018-05-01T17:53:54Z"}, {"text": "Thanks! This should work as expected when the other patch here also lands, because we now set the direction in the main code.\n\nIn general, the approach of using \"intl.css\" looks a little fragile and we should ideally replace it with code in mozilla-central. Also, as I noted in comment 4, it's not even clear what the other IDs refer to, if anything.", "author": "paolo.mozmail@amadzone.org", "id": 13246710, "time": "2018-05-01T18:06:28Z"}, {"text": "Let me know when you need the changes landed in l10n repos.\n\nLooking at Hebrew, which is only one with relatively recent changes, all the rest of the code is really ancient\nhttps://hg.mozilla.org/l10n-central/he/log/tip/toolkit/chrome/global/intl.css\n\nIt also came out of Persian (and Ehsan) at some point, so he might have an idea.", "author": "francesco.lodolo@gmail.com", "id": 13246720, "time": "2018-05-01T18:10:05Z"}, {"text": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=405f934227fdb9f5cb777e84e2fa990ff1823181", "author": "paolo.mozmail@amadzone.org", "id": 13246724, "time": "2018-05-01T18:10:43Z"}, {"text": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=11b74da1aa868e3151e310d022120be9517e9fea", "author": "paolo.mozmail@amadzone.org", "id": 13248529, "time": "2018-05-02T13:11:03Z"}, {"text": "Pushed by paolo.mozmail@amadzone.org:\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/cb3fb19eaeac\nForce the left-to-right direction when displaying a custom download path. r=gandalf", "author": "pulsebot@bots.tld", "id": 13248681, "time": "2018-05-02T14:00:55Z"}, {"text": "Paolo - do you plan to land the intl.css removal separately?", "author": "gandalf@aviary.pl", "id": 13249416, "time": "2018-05-02T16:36:22Z"}, {"text": "(In reply to Zibi Braniecki [:gandalf][:zibi] from comment #22)\n> Paolo - do you plan to land the intl.css removal separately?\n\nhttps://hg.mozilla.org/l10n-central/ar/rev/09127d0ec2ec16f07edb809977bfe6066dc4f5f6\nhttps://hg.mozilla.org/l10n-central/he/rev/afd7e27c4f017ea58a1c21524851065d98f2a8ec\nhttps://hg.mozilla.org/l10n-central/fa/rev/c386e67c521bb7b03f6720840fb5b7935a29ea5d", "author": "francesco.lodolo@gmail.com", "id": 13249501, "time": "2018-05-02T17:05:32Z"}, {"text": "Thanks flod!\n\nI'm marking this bug as qe-verify+. To test this, once the patch has landed in Nightly:\n\n1. Download the \"ar\", \"he\", and \"fa\" Nightly builds on either Linux or Mac\n2. On each build, open the Preferences and select a custom path for where to save files\n    - This should not be the Desktop or the Downloads folder\n3. Check that the path is read from left to right with the \"/\" at the beginning\n4. Check that the folder icon is on the right of the text, and does not overlap it", "author": "paolo.mozmail@amadzone.org", "id": 13249728, "time": "2018-05-02T18:01:20Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/cb3fb19eaeac", "author": "rgurzau@mozilla.com", "id": 13250584, "time": "2018-05-02T21:12:06Z"}, {"text": "Tested the new Hebrew build, looking good on all cases.", "author": "itiel_yn8@walla.com", "id": 13251781, "time": "2018-05-03T12:04:06Z"}, {"text": "Managed to reproduce the issue on Firefox Nightly (2018-04-30) on Windows 10 x64, Mac OS X 10.12 and Ubuntu 16.04 x64.\n\nThe issue cannot be reproduced on the latest Nightly Firefox 61.0a1. (20180503100146 / ar, he, fa) on Windows 10 x64, Mac OS X 10.12 and Ubuntu 16.04 x64, thus I will close it as VERIFIED FIXED.", "author": "timea.babos@softvision.ro", "id": 13254194, "time": "2018-05-04T09:43:10Z"}], "cf_last_resolved": "2018-05-02T21:12:06Z", "priority": "P1", "mentors_detail": [], "cf_crash_signature": "", "version": "unspecified", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox62": "---", "cf_platform_rel": "---", "product": "Firefox", "cf_status_firefox_esr52": "unaffected", "blocks": [1452624], "qa_contact": "", "see_also": ["https://bugzilla.mozilla.org/show_bug.cgi?id=1333138"], "cf_fx_iteration": "---", "component": "Preferences", "votes": 0, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "verified", "cf_status_firefox60": "unaffected", "target_milestone": "Firefox 61", "is_cc_accessible": true, "cf_rank": null, "groups": [], "url": "", "creator_detail": {"email": "itiel_yn8@walla.com", "id": 353822, "name": "itiel_yn8@walla.com", "real_name": "Itiel"}, "whiteboard": "", "mentors": [], "cc_detail": [{"email": "cdenizet@mozilla.com", "id": 560431, "name": "cdenizet@mozilla.com", "real_name": "Calixte Denizet (:calixte)"}, {"email": "community@rtl.bugs", "id": 4996, "name": "community@rtl.bugs", "real_name": "RTL hackers [:rtl]"}, {"email": "francesco.lodolo@gmail.com", "id": 130462, "name": "francesco.lodolo@gmail.com", "real_name": "Francesco Lodolo [:flod]"}, {"email": "gandalf@aviary.pl", "id": 41270, "name": "gandalf@aviary.pl", "real_name": "Zibi Braniecki [:gandalf][:zibi]"}, {"email": "jaws@mozilla.com", "id": 409754, "name": "jaws@mozilla.com", "real_name": "Jared Wein [:jaws] (please needinfo? me)"}, {"email": "khaledhosny@eglug.org", "id": 288083, "name": "khaledhosny@eglug.org", "real_name": "Khaled Hosny"}, {"email": "l10n@mozilla.com", "id": 215498, "name": "l10n@mozilla.com", "real_name": "Axel Hecht [:Pike]"}, {"email": "mcastelluccio@mozilla.com", "id": 420453, "name": "mcastelluccio@mozilla.com", "real_name": "Marco Castelluccio [:marco]"}, {"email": "paolo.mozmail@amadzone.org", "id": 332229, "name": "paolo.mozmail@amadzone.org", "real_name": ":Paolo Amadini"}, {"email": "reza.habibi2008@gmail.com", "id": 458929, "name": "reza.habibi2008@gmail.com", "real_name": "Reza Habibi (rehb)"}, {"email": "ryanvm@gmail.com", "id": 75935, "name": "ryanvm@gmail.com", "real_name": "Ryan VanderMeulen [:RyanVM]"}, {"email": "safa1996alfulaij@gmail.com", "id": 544761, "name": "safa1996alfulaij@gmail.com", "real_name": "Safa Alfulaij"}, {"email": "timea.babos@softvision.ro", "id": 615271, "name": "timea.babos@softvision.ro", "real_name": "Timea Babos"}, {"email": "tomer.moz.bugs@tomercohen.com", "id": 33744, "name": "tomer.moz.bugs@tomercohen.com", "real_name": "Tomer Cohen :tomer"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-05-04T09:43:10Z", "cf_status_firefox_esr60": "unaffected", "assigned_to": "paolo.mozmail@amadzone.org", "is_open": false, "resolution": "FIXED", "op_sys": "Unspecified", "cf_fx_points": "---", "history": [{"changes": [{"removed": "", "field_name": "keywords", "added": "regression"}, {"removed": "", "field_name": "cc", "added": "mcastelluccio@mozilla.com"}], "who": "mcastelluccio@mozilla.com", "when": "2018-04-30T13:17:34Z"}, {"changes": [{"removed": "--", "field_name": "priority", "added": "P1"}, {"removed": "", "field_name": "cc", "added": "jaws@mozilla.com, paolo.mozmail@amadzone.org"}, {"removed": "", "field_name": "blocks", "added": "1452624"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(paolo.mozmail@amadzone.org)"}, {"removed": "---", "field_name": "cf_status_firefox61", "added": "affected"}], "who": "jaws@mozilla.com", "when": "2018-04-30T14:36:56Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "rtl"}], "who": "itiel_yn8@walla.com", "when": "2018-04-30T15:14:48Z"}, {"changes": [{"removed": "needinfo?(paolo.mozmail@amadzone.org)", "field_name": "flagtypes.name", "added": "needinfo?(itiel_yn8@walla.com)"}], "who": "paolo.mozmail@amadzone.org", "when": "2018-04-30T16:18:26Z"}, {"changes": [{"removed": "needinfo?(itiel_yn8@walla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "itiel_yn8@walla.com", "when": "2018-04-30T16:38:00Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "gandalf@aviary.pl"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(gandalf@aviary.pl)"}], "who": "paolo.mozmail@amadzone.org", "when": "2018-04-30T17:21:38Z"}, {"changes": [{"removed": "needinfo?(gandalf@aviary.pl)", "field_name": "flagtypes.name", "added": ""}], "who": "gandalf@aviary.pl", "when": "2018-04-30T18:09:41Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "ryanvm@gmail.com"}, {"removed": "---", "field_name": "cf_status_firefox_esr52", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_firefox_esr60", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_firefox59", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_firefox60", "added": "unaffected"}, {"removed": "---", "field_name": "cf_tracking_firefox61", "added": "+"}], "who": "ryanvm@gmail.com", "when": "2018-05-01T15:30:21Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(gandalf@aviary.pl)"}], "who": "paolo.mozmail@amadzone.org", "when": "2018-05-01T16:09:40Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8972355, "added": "review?(gandalf@aviary.pl)"}], "who": "paolo.mozmail@amadzone.org", "when": "2018-05-01T16:14:15Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(gandalf@aviary.pl)", "attachment_id": 8972355, "added": "review+"}], "who": "gandalf@aviary.pl", "when": "2018-05-01T17:03:43Z"}, {"changes": [{"removed": "needinfo?(gandalf@aviary.pl)", "field_name": "flagtypes.name", "added": "needinfo?(paolo.mozmail@amadzone.org)"}], "who": "gandalf@aviary.pl", "when": "2018-05-01T17:04:24Z"}, {"changes": [{"removed": "needinfo?(paolo.mozmail@amadzone.org)", "field_name": "flagtypes.name", "added": "needinfo?(gandalf@aviary.pl)"}], "who": "paolo.mozmail@amadzone.org", "when": "2018-05-01T17:23:31Z"}, {"changes": [{"removed": "needinfo?(gandalf@aviary.pl)", "field_name": "flagtypes.name", "added": ""}], "who": "gandalf@aviary.pl", "when": "2018-05-01T17:25:06Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "francesco.lodolo@gmail.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(francesco.lodolo@gmail.com)"}], "who": "gandalf@aviary.pl", "when": "2018-05-01T17:40:14Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "community@rtl.bugs, khaledhosny@eglug.org, l10n@mozilla.com, reza.habibi2008@gmail.com, safa1996alfulaij@gmail.com"}, {"removed": "needinfo?(francesco.lodolo@gmail.com)", "field_name": "flagtypes.name", "added": ""}], "who": "francesco.lodolo@gmail.com", "when": "2018-05-01T17:53:54Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "qe-verify+"}], "who": "paolo.mozmail@amadzone.org", "when": "2018-05-02T18:01:20Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "Firefox 61"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2018-05-02 21:12:06"}, {"removed": "affected", "field_name": "cf_status_firefox61", "added": "fixed"}], "who": "rgurzau@mozilla.com", "when": "2018-05-02T21:12:06Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "cdenizet@mozilla.com"}, {"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "paolo.mozmail@amadzone.org"}], "who": "cdenizet@mozilla.com", "when": "2018-05-03T14:49:32Z"}, {"changes": [{"removed": "RESOLVED", "field_name": "status", "added": "VERIFIED"}, {"removed": "", "field_name": "cc", "added": "timea.babos@softvision.ro"}, {"removed": "qe-verify+", "field_name": "flagtypes.name", "added": ""}, {"removed": "fixed", "field_name": "cf_status_firefox61", "added": "verified"}], "who": "timea.babos@softvision.ro", "when": "2018-05-04T09:43:10Z"}]}