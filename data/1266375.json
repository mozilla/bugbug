{"status": "VERIFIED", "cf_tracking_firefox60": "---", "attachments": [{"creator": "arni2033@yandex.ru", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "video/webm", "id": 8743807}, {"creator": "adw@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2016-04-26T12:48:55Z", "type_id": 748, "creation_date": "2016-04-22T18:11:27Z", "id": 1381677, "setter": "mak77@bonardo.net"}], "content_type": "text/x-review-board-request", "id": 8743995}, {"creator": "adw@mozilla.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "approval-mozilla-aurora", "modification_date": "2016-05-03T19:28:46Z", "type_id": 720, "creation_date": "2016-04-28T01:19:51Z", "id": 1384478, "setter": "rkothari@mozilla.com"}], "content_type": "text/plain", "id": 8746323}], "classification": "Client Software", "creator": "arni2033@yandex.ru", "cc": ["adw@mozilla.com", "arni2033@yandex.ru", "cornel.ionce@softvision.ro", "mak77@bonardo.net", "past@mozilla.com", "rkothari@mozilla.com"], "depends_on": [1271094, 1278549, 1240217], "creation_time": "2016-04-21T13:00:12Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "cf_status_firefox58": "---", "cf_status_firefox59": "---", "keywords": ["regression"], "summary": "Suggestions twitch when I edit string in location bar", "cf_last_resolved": "2016-04-27T10:18:50Z", "assigned_to_detail": {"email": "adw@mozilla.com", "id": 334927, "name": "adw@mozilla.com", "real_name": "Drew Willcoxon :adw"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "assigned_to": "adw@mozilla.com", "comment_count": 19, "comments": [{"text": "Created attachment 8743807\nscreencast 1 - Suggestions twitch when I edit string in location bar.webm\n\n>>>   My Info:   Win7_64, Nightly 48, 32bit, ID 20160409030219\nSTR:\n1. Focus urlbar, keep typing some text (but don't _hold_ any key)\n\nAR:  The first suggestion is twitching enormously\nER:  Should not twitch\n\nNote:  This is especially bad when I edit long urls like \"data:text/html,...\" testcases.\n\nThis is regression from bug 1181078. Regression range:\n> https://hg.mozilla.org/integration/fx-team/pushloghtml?fromchange=c131636dae420773342d1439b6086b6c62b222f4&tochange=061165ac1ff9e076ec51ea268878efa751173511", "author": "arni2033@yandex.ru", "id": 11344467, "time": "2016-04-21T13:00:12Z"}, {"text": "Thank you for filing this.", "author": "adw@mozilla.com", "id": 11345646, "time": "2016-04-21T18:11:29Z"}, {"text": "Created attachment 8743995\nMozReview Request: Bug 1266375 - Don't remove max-width on awesomebar popup items when the popup is open. r?mak\n\nThe problem is that _adjustAcItem removes items' max-widths at the beginning and then handles overflow at the end -- while popup is open.  So the item visually overflows at the beginning and then gets visually truncated at the end.\n\nThis patch stops removing max-width when the popup is open.  That means that items can't grow bigger while the popup is open, but I don't think it's actually possible on any platform for the popup to grow wider while it's open, so that shouldn't matter.  Even if that were somehow possible I don't think that would be bad.\n\nWhile I'm changing truncation, I noticed that action items get truncated too soon.  They end up not wide enough.  It's especially noticable with the heuristic result.  The problem is the Math.max(urlRect.width, actionRect.width) calculation.  The URL rect is hidden with visibility:collapse, so its rect actually still has non-zero width (apparently).  Using display:none instead makes it zero, so the result is better.\n\nBut after I changed that, I noticed when pressing the Down arrow key in the urlbar, the heuristic result was incorrectly truncated, as if both the action and url rects had zero width.  And in fact that was what was happening, because when the popup first opens, no result is selected, and then a split second later the heuristic result is selected.\n\nSo, this also initializes selectedIndex=0 instead of -1 in urlbar-rich-result-popup's _openAutocompletePopup.  Not only does that fix the problem, it makes the popup look better overall because there's not a split second where nothing is selected.  (And it fixes bug 1266374.)  We can't remove the selectedIndex=0 in onResultsAdded though because the selectedIndex is reset whenever the popup changes.\n\nReview commit: https://reviewboard.mozilla.org/r/48227/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/48227/", "author": "adw@mozilla.com", "id": 11345784, "time": "2016-04-21T18:57:23Z"}, {"text": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=c57c798ad0e6", "author": "adw@mozilla.com", "id": 11345788, "time": "2016-04-21T18:58:21Z"}, {"text": "Comment on attachment 8743995\nMozReview Request: Bug 1266375 - Don't remove max-width on awesomebar popup items when the popup is open. r?mak\n\nhttps://reviewboard.mozilla.org/r/48227/#review45133\n\n::: browser/base/content/urlbarBindings.xml:1354\n(Diff revision 1)\n>  \n>            this.mInput = aInput;\n> -          this.selectedIndex = -1;\n> +\n> +          // Initialize the selected index to the heuristic result so that it's\n> +          // selected the moment the popup opens.\n> +          this.selectedIndex = 0;\n\nLooks like this breaks the default typed-history dropdown when nothing is typed in the location bar\n\n::: toolkit/content/widgets/autocomplete.xml:1837\n(Diff revision 1)\n>        </method>\n>  \n>        <method name=\"_adjustAcItem\">\n>          <body>\n>            <![CDATA[\n> +          if (!this.parentNode.parentNode.mPopupOpen) {\n\njust .popupOpen?", "author": "mak77@bonardo.net", "id": 11347494, "time": "2016-04-22T09:01:55Z"}, {"text": "What do you mean by broken?  All I see is that the first result is selected in that case when it shouldn't be.  This fixes it:\n\nthis.selectedIndex = this._isFirstResultHeuristic ? 0 : -1;\n\nOther than that there are some try failures I need to look at.", "author": "adw@mozilla.com", "id": 11348643, "time": "2016-04-22T16:19:04Z"}, {"text": "Comment on attachment 8743995\nMozReview Request: Bug 1266375 - Don't remove max-width on awesomebar popup items when the popup is open. r?mak\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/48227/diff/1-2/", "author": "adw@mozilla.com", "id": 11349016, "time": "2016-04-22T18:11:27Z"}, {"text": "https://treeherder.mozilla.org/#/jobs?repo=try&revision=a643ac598860", "author": "adw@mozilla.com", "id": 11349018, "time": "2016-04-22T18:11:40Z"}, {"text": "(In reply to Drew Willcoxon :adw from comment #5)\n> What do you mean by broken?  All I see is that the first result is selected\n> in that case when it shouldn't be.\n\nyeah sorry, I meant that. bad wording.", "author": "mak77@bonardo.net", "id": 11355464, "time": "2016-04-26T09:11:49Z"}, {"text": "Comment on attachment 8743995\nMozReview Request: Bug 1266375 - Don't remove max-width on awesomebar popup items when the popup is open. r?mak\n\nhttps://reviewboard.mozilla.org/r/48227/#review45803", "author": "mak77@bonardo.net", "id": 11355964, "time": "2016-04-26T12:48:55Z"}, {"text": "https://hg.mozilla.org/integration/fx-team/rev/597390d44c49", "author": "pulsebot@bots.tld", "id": 11358211, "time": "2016-04-26T19:47:08Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/597390d44c49", "author": "cbook@mozilla.com", "id": 11360474, "time": "2016-04-27T10:18:50Z"}, {"text": "Created attachment 8746323\nAurora 48 patch\n\nApproval Request Comment\n[Feature/regressing bug #]: New awesomebar popup design bug 1181078\n[User impact if declined]: Bad UX when typing very long strings into the urlbar\n[Describe test coverage new/current, TreeHerder]: Covered by existing tests\n[Risks and why]: Low risk, small patch, lots of time to ride Aurora and then Beta\n[String/UUID change made/needed]: None", "author": "adw@mozilla.com", "id": 11363399, "time": "2016-04-28T01:19:51Z"}, {"text": "Hello Arni2033, could you please verify this issue is fixed as expected on a latest Nightly build? Thanks!", "author": "rkothari@mozilla.com", "id": 11378771, "time": "2016-05-03T19:27:45Z"}, {"text": "Comment on attachment 8746323\nAurora 48 patch\n\nImproving awesome bar UX when typing long strings, Aurora48+", "author": "rkothari@mozilla.com", "id": 11378779, "time": "2016-05-03T19:28:46Z"}, {"text": "https://hg.mozilla.org/releases/mozilla-aurora/rev/71cb9d0e9968", "author": "kwierso@gmail.com", "id": 11379377, "time": "2016-05-03T21:47:28Z"}, {"text": ">>>   My Info:   Win7_64, Nightly 49, 32bit, ID 20160504043118\nIt is still possible for label \"Search with [default search]\" to promptly twitch to the right and left\n(twice per keypress) when the first suggestion overflows. There's no other issues.\nI don't like that twitching too, because in my view nothing should twitch twice per 1 user action and because \"Search with\" label promptly appears 5px to the right from the rightmost allowed position.\nIt's a question for Marco, whether this is expected behavior.\n\nFirst part of the video shows described twitching. Second part shows that label \"Search with...\" isn't affected by changing lenthg of suggestion if ellipsis is shown.\n> screencast:   https://dl.dropboxusercontent.com/s/9h0twmkrwen7sug/bug%201266375%20comment%2016.webm", "author": "arni2033@yandex.ru", "id": 11387280, "time": "2016-05-06T02:31:43Z"}, {"text": "(In reply to arni2033 from comment #16)\n> >>>   My Info:   Win7_64, Nightly 49, 32bit, ID 20160504043118\n> It is still possible for label \"Search with [default search]\" to promptly\n> twitch to the right and left\n> (twice per keypress) when the first suggestion overflows. There's no other\n> issues.\n> I don't like that twitching too, because in my view nothing should twitch\n> twice per 1 user action and because \"Search with\" label promptly appears 5px\n> to the right from the rightmost allowed position.\n> It's a question for Marco, whether this is expected behavior.\n\nClearly the fact the text flickers is never expected.\nOn the other side, the likely for the user to type a so long text to cause that issue is minimal, and the effect is not so annoying to cause big troubles.\nWhile it's a valid bug, I don't think we could spend time on it, cause the fix would be more expensive than the benefit, so it's more likely to stay unfixed (available for the community to fix) if filed.", "author": "mak77@bonardo.net", "id": 11387752, "time": "2016-05-06T09:04:34Z"}, {"text": "Verified issue fixed on Windows 10 x64 and Ubuntu 12.04 x86 using:\n- Aurora 48.0a2, build ID 20160508004021\n- Nightly 49.0a1, build ID 20160508030214.", "author": "cornel.ionce@softvision.ro", "id": 11392643, "time": "2016-05-09T11:43:53Z"}], "id": 1266375, "priority": "P3", "mentors_detail": [], "cf_crash_signature": "", "version": "Trunk", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox59": "---", "last_change_time": "2016-08-26T20:06:58Z", "cf_platform_rel": "---", "product": "Firefox", "cf_status_firefox_esr52": "---", "blocks": [1181078, 1266374], "qa_contact": "", "see_also": [], "cf_fx_iteration": "---", "component": "Address Bar", "votes": 0, "cf_status_firefox49": "verified", "cf_status_firefox48": "verified", "groups": [], "cf_status_firefox60": "---", "target_milestone": "Firefox 49", "is_cc_accessible": true, "url": "", "creator_detail": {"email": "arni2033@yandex.ru", "id": 540189, "name": "arni2033@yandex.ru", "real_name": "arni2033"}, "whiteboard": "[fxsearch]", "mentors": [], "cc_detail": [{"email": "adw@mozilla.com", "id": 334927, "name": "adw@mozilla.com", "real_name": "Drew Willcoxon :adw"}, {"email": "arni2033@yandex.ru", "id": 540189, "name": "arni2033@yandex.ru", "real_name": "arni2033"}, {"email": "cornel.ionce@softvision.ro", "id": 458186, "name": "cornel.ionce@softvision.ro", "real_name": "Cornel Ionce [:cornel_ionce], Desktop Release QA"}, {"email": "mak77@bonardo.net", "id": 240353, "name": "mak77@bonardo.net", "real_name": "Marco Bonardo [::mak]"}, {"email": "past@mozilla.com", "id": 363318, "name": "past@mozilla.com", "real_name": "Panos Astithas [:past] (please ni?)"}, {"email": "rkothari@mozilla.com", "id": 538805, "name": "rkothari@mozilla.com", "real_name": "Ritu Kothari (:ritu)"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "cf_tracking_firefox58": "---", "cf_rank": null, "is_open": false, "resolution": "FIXED", "op_sys": "Unspecified", "cf_fx_points": "---", "history": [{"changes": [{"removed": "--", "field_name": "priority", "added": "P3"}, {"removed": "", "field_name": "cc", "added": "past@mozilla.com"}, {"removed": "", "field_name": "whiteboard", "added": "[fxsearch]"}], "who": "past@mozilla.com", "when": "2016-04-21T13:35:31Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "ASSIGNED"}, {"removed": "", "field_name": "cc", "added": "adw@mozilla.com"}, {"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "adw@mozilla.com"}], "who": "adw@mozilla.com", "when": "2016-04-21T18:11:29Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8743995, "added": "review?(mak77@bonardo.net)"}, {"removed": "", "field_name": "cc", "added": "mak77@bonardo.net"}], "who": "adw@mozilla.com", "when": "2016-04-21T18:57:23Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(mak77@bonardo.net)", "attachment_id": 8743995, "added": ""}], "who": "mak77@bonardo.net", "when": "2016-04-22T09:01:55Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8743995, "added": "review?(mak77@bonardo.net)"}], "who": "adw@mozilla.com", "when": "2016-04-22T18:11:27Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(mak77@bonardo.net)", "attachment_id": 8743995, "added": "review+"}], "who": "mak77@bonardo.net", "when": "2016-04-26T12:48:55Z"}, {"changes": [{"removed": "ASSIGNED", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "Firefox 49"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2016-04-27 03:18:50"}, {"removed": "---", "field_name": "cf_status_firefox49", "added": "fixed"}], "who": "cbook@mozilla.com", "when": "2016-04-27T10:18:50Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8746323, "added": "approval-mozilla-aurora?"}], "who": "adw@mozilla.com", "when": "2016-04-28T01:19:51Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1266374"}], "who": "mak77@bonardo.net", "when": "2016-04-28T09:14:25Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "rkothari@mozilla.com"}, {"removed": "---", "field_name": "cf_status_firefox48", "added": "affected"}], "who": "rkothari@mozilla.com", "when": "2016-05-03T19:25:26Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "arni2033@yandex.ru"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(arni2033@yandex.ru)"}], "who": "rkothari@mozilla.com", "when": "2016-05-03T19:27:45Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "approval-mozilla-aurora?", "attachment_id": 8746323, "added": "approval-mozilla-aurora+"}], "who": "rkothari@mozilla.com", "when": "2016-05-03T19:28:46Z"}, {"changes": [{"removed": "affected", "field_name": "cf_status_firefox48", "added": "fixed"}], "who": "kwierso@gmail.com", "when": "2016-05-03T21:47:28Z"}, {"changes": [{"removed": "needinfo?(arni2033@yandex.ru)", "field_name": "flagtypes.name", "added": "needinfo?(mak77@bonardo.net)"}], "who": "arni2033@yandex.ru", "when": "2016-05-06T02:31:43Z"}, {"changes": [{"removed": "needinfo?(mak77@bonardo.net)", "field_name": "flagtypes.name", "added": ""}], "who": "mak77@bonardo.net", "when": "2016-05-06T09:04:34Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1271094"}], "who": "arni2033@yandex.ru", "when": "2016-05-08T02:57:38Z"}, {"changes": [{"removed": "RESOLVED", "field_name": "status", "added": "VERIFIED"}, {"removed": "", "field_name": "cc", "added": "cornel.ionce@softvision.ro"}, {"removed": "fixed", "field_name": "cf_status_firefox48", "added": "verified"}, {"removed": "fixed", "field_name": "cf_status_firefox49", "added": "verified"}], "who": "cornel.ionce@softvision.ro", "when": "2016-05-09T11:43:53Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1278549"}], "who": "arni2033@yandex.ru", "when": "2016-06-07T13:35:28Z"}, {"changes": [{"removed": "unspecified", "field_name": "version", "added": "Trunk"}], "who": "ryanvm@gmail.com", "when": "2016-07-08T21:32:02Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1240217"}], "who": "arni2033@yandex.ru", "when": "2016-08-26T20:06:58Z"}]}