{"cf_tracking_thunderbird_esr52": "---", "cf_tracking_firefox60": "---", "attachments": [], "cf_tracking_firefox62": "---", "creator": "lidel@lidel.org", "mentors_detail": [], "depends_on": [], "cf_status_firefox_esr60": "---", "cf_user_story": "", "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "lidel@lidel.org"}], "who": "lidel@lidel.org", "when": "2018-03-15T12:36:56Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "aswan@mozilla.com"}, {"removed": "Add-on Manager", "field_name": "component", "added": "WebExtensions: Android"}, {"removed": "Firefox 59", "field_name": "version", "added": "59 Branch"}, {"removed": "Firefox for Android", "field_name": "product", "added": "Toolkit"}], "who": "aswan@mozilla.com", "when": "2018-03-15T14:21:39Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jplatte+mozilla@posteo.de"}], "who": "jplatte+mozilla@posteo.de", "when": "2018-03-26T16:58:08Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "lgreco@mozilla.com, snorp@snorp.net"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(snorp@snorp.net)"}], "who": "lgreco@mozilla.com", "when": "2018-03-27T19:23:12Z"}, {"changes": [{"removed": "needinfo?(snorp@snorp.net)", "field_name": "flagtypes.name", "added": ""}], "who": "snorp@snorp.net", "when": "2018-04-09T18:48:20Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1435798"}], "who": "lidel@lidel.org", "when": "2018-04-11T19:18:05Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "dietrich@mozilla.com"}], "who": "dietrich@mozilla.com", "when": "2018-04-11T19:55:12Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "marsjaninzmarsa@gmail.com"}], "who": "marsjaninzmarsa@gmail.com", "when": "2018-05-08T23:31:36Z"}], "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "keywords": [], "cc_detail": [{"email": "aswan@mozilla.com", "id": 561655, "name": "aswan@mozilla.com", "real_name": "Andrew Swan [:aswan] (on PTO until 6/25)"}, {"email": "dietrich@mozilla.com", "id": 213632, "name": "dietrich@mozilla.com", "real_name": "Dietrich Ayala (:dietrich)"}, {"email": "jplatte+mozilla@posteo.de", "id": 531862, "name": "jplatte+mozilla@posteo.de", "real_name": "Jonas Platte"}, {"email": "lgreco@mozilla.com", "id": 339062, "name": "lgreco@mozilla.com", "real_name": "Luca Greco [:rpl]"}, {"email": "lidel@lidel.org", "id": 535729, "name": "lidel@lidel.org", "real_name": "Marcin Rataj"}, {"email": "marsjaninzmarsa@gmail.com", "id": 470481, "name": "marsjaninzmarsa@gmail.com", "real_name": "Kuba Niewiarowski"}, {"email": "snorp@snorp.net", "id": 227322, "name": "snorp@snorp.net", "real_name": "James Willcox (:snorp) (jwillcox@mozilla.com)"}], "cf_last_resolved": null, "cf_tracking_firefox61": "---", "votes": 2, "classification": "Components", "is_confirmed": false, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 3, "comments": [{"text": "User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:59.0) Gecko/20100101 Firefox/59.0\nBuild ID: 20180310025718\n\nSteps to reproduce:\n\nSupport for sugar-coating around nav.registerProtocolHandler was added to WebExtension in https://bugzilla.mozilla.org/show_bug.cgi?id=1310427 (Firefox 54).\nIt enabled browser extension to provide a simplified redirect-based handler via manifest.json\n\nSupport for use of `dweb`,`ipfs`,`ipns` and other protocols without `web-` prefix was added in Firefox 59 (https://bugzilla.mozilla.org/show_bug.cgi?id=1428446).\n\nBoth features work fine on desktop (tested with Firefox 59).\n\nUnfortunately Firefox for Android Beta (59) is does not seem to support `protocol_handlers` correctly.\n\nSteps to reproduce:\n\n1. Open Firefox for Android Beta (59) \n2. Load WebExtension with support for custom protocol in `protocol_handlers` listed in its `manifest.json`, lets call it `foo://`\n3. Type  `foo://bar`  in address bar and press ENTER\n\n\nActual results:\n\nNothing happened. No error, no UI change. \n\n\nExpected results:\n\nFirefox for Android should display a dialog in which user selects handler for the protocol.\nExample from desktop version: https://goo.gl/R8bgt7", "author": "lidel@lidel.org", "id": 13130546, "time": "2018-03-15T12:36:02Z"}, {"text": "Hi James,\nI have briefly looked if the protocol handlers specified in the manifest.json of a WebExtension are actually registered successfully on Firefox for Android and it seems that they are (the protocol handlers are registered from here: https://searchfox.org/mozilla-central/rev/49cc27555d5b7ed2eb06baf156693dd578daa06f/toolkit/components/extensions/ext-protocolHandlers.js#26-44).\n\nNevertheless they doesn't seem to be used anywhere on Firefox for Android (and I haven't found anything about them in the Fennec internals, on the contrary I found the ones coming from the OS, here: https://searchfox.org/mozilla-central/rev/49cc27555d5b7ed2eb06baf156693dd578daa06f/mobile/android/components/ContentDispatchChooser.js#50, which seems to be basically the intents on Android, at least if I'm reading it correctly).\n\nAnd so at a first glance, it seems that the WebExtensions protocol_handlers manifest property is not working on Firefox on Android because the registered handlers are not currently used anywhere yet.\n\nCan you confirm if I'm right and this is actually the case?\n\nIf it is, it would be great to block this issue on a \"Firefox for Android\" issue related to implementing the missing bits, at least if it is something that is going to be supported in the future.", "author": "lgreco@mozilla.com", "id": 13161063, "time": "2018-03-27T19:23:12Z"}, {"text": "(In reply to Luca Greco [:rpl] from comment #1)\n> \n> Can you confirm if I'm right and this is actually the case?\n> \n> If it is, it would be great to block this issue on a \"Firefox for Android\"\n> issue related to implementing the missing bits, at least if it is something\n> that is going to be supported in the future.\n\nYour analysis looks correct to me.", "author": "snorp@snorp.net", "id": 13192895, "time": "2018-04-09T18:48:20Z"}], "id": 1445924, "priority": "--", "cc": ["aswan@mozilla.com", "dietrich@mozilla.com", "jplatte+mozilla@posteo.de", "lgreco@mozilla.com", "lidel@lidel.org", "marsjaninzmarsa@gmail.com", "snorp@snorp.net"], "cf_crash_signature": "", "version": "59 Branch", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_thunderbird_esr60": "---", "status": "UNCONFIRMED", "product": "Toolkit", "cf_fx_iteration": "---", "blocks": [1435798], "qa_contact": "", "creation_time": "2018-03-15T12:36:02Z", "cf_status_firefox_esr52": "---", "component": "WebExtensions: Android", "assigned_to_detail": {"email": "nobody@mozilla.org", "id": 1, "name": "nobody@mozilla.org", "real_name": "Nobody; OK to take it and work on it"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "---", "cf_status_firefox60": "---", "target_milestone": "---", "cf_rank": null, "cf_qa_whiteboard": "", "severity": "normal", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "lidel@lidel.org", "id": 535729, "name": "lidel@lidel.org", "real_name": "Marcin Rataj"}, "whiteboard": "", "mentors": [], "summary": "Missing support for protocol_handlers in WebExtension manifest", "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-05-08T23:31:36Z", "assigned_to": "nobody@mozilla.org", "is_open": true, "cf_blocking_webextensions": "---", "resolution": "", "op_sys": "Unspecified", "cf_fx_points": "---", "cf_blocking_fennec": "---"}