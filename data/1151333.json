{"cf_status_firefox38": "unaffected", "cf_tracking_thunderbird_esr52": "---", "cf_tracking_firefox60": "---", "attachments": [{"creator": "bbouvier@mozilla.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2015-04-07T15:28:43Z", "type_id": 4, "creation_date": "2015-04-07T15:00:00Z", "id": 1140804, "setter": "sunfish@mozilla.com"}], "content_type": "text/plain", "id": 8589117}], "classification": "Components", "cf_status_firefox39": "unaffected", "mentors_detail": [], "depends_on": [], "cf_status_b2g_2_0m": "unaffected", "cf_has_str": "---", "cf_status_firefox37": "unaffected", "cf_user_story": "", "history": [{"changes": [{"removed": "", "field_name": "keywords", "added": "csectype-wildptr"}, {"removed": "[jsbugmon:update,bisect]", "field_name": "whiteboard", "added": "[jsbugmon:update,bisect][fuzzblocker]"}], "who": "choller@mozilla.com", "when": "2015-04-05T17:34:20Z"}, {"changes": [{"removed": "[jsbugmon:update,bisect][fuzzblocker]", "field_name": "whiteboard", "added": "[fuzzblocker] [jsbugmon:update]"}], "who": "choller@mozilla.com", "when": "2015-04-05T20:34:54Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "benj@benj.me"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(benj@benj.me)"}], "who": "choller@mozilla.com", "when": "2015-04-07T12:19:42Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "ASSIGNED"}, {"removed": "", "field_name": "cc", "added": "sunfish@mozilla.com"}, {"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "benj@benj.me"}, {"removed": "needinfo?(benj@benj.me)", "field_name": "flagtypes.name", "added": ""}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8589117, "added": "review?(sunfish@mozilla.com)"}], "who": "bbouvier@mozilla.com", "when": "2015-04-07T15:00:00Z"}, {"changes": [{"removed": "---", "field_name": "cf_status_firefox37", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_firefox38", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_firefox39", "added": "unaffected"}], "who": "bbouvier@mozilla.com", "when": "2015-04-07T15:10:04Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(sunfish@mozilla.com)", "attachment_id": 8589117, "added": "review+"}], "who": "sunfish@mozilla.com", "when": "2015-04-07T15:28:43Z"}, {"changes": [{"removed": "ASSIGNED", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla40"}, {"removed": "", "field_name": "flagtypes.name", "added": "in-testsuite+"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2015-04-07 13:10:22"}, {"removed": "affected", "field_name": "cf_status_firefox40", "added": "fixed"}, {"removed": "---", "field_name": "cf_status_firefox_esr31", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_firefox_esr38", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_b2g_1_4", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_b2g_2_0", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_b2g_2_0m", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_b2g_2_1", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_b2g_2_1_s", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_b2g_2_2", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_b2g_master", "added": "fixed"}], "who": "ryanvm@gmail.com", "when": "2015-04-07T20:10:22Z"}, {"changes": [{"removed": "RESOLVED", "field_name": "status", "added": "VERIFIED"}, {"removed": "fixed", "field_name": "cf_status_firefox40", "added": "verified"}], "who": "choller@mozilla.com", "when": "2015-04-08T14:13:36Z"}, {"changes": [{"removed": "core-security", "field_name": "groups", "added": ""}], "who": "dveditz@mozilla.com", "when": "2015-05-18T22:49:03Z"}], "cf_tracking_firefox_relnote": "---", "platform": "x86_64", "cf_status_firefox58": "---", "cf_status_firefox59": "---", "keywords": ["crash", "csectype-wildptr", "regression", "sec-critical", "testcase"], "summary": "Crash [@ ??] with SIMD swizzle", "cf_last_resolved": "2015-04-07T20:10:22Z", "cf_status_b2g_master": "fixed", "votes": 0, "severity": "critical", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 9, "comments": [{"text": "The following testcase crashes on mozilla-central revision 421548077f12 (build with --enable-optimize --enable-posix-nspr-emulation --enable-valgrind --enable-gczeal --disable-tests --disable-debug, run with --ion-offthread-compile=off --ion-eager):\n\nfunction assertEqX4(vec, arr, ...opts) {}\nvar i4 = SIMD.int32x4(1, 2, 3, 4);\nfor (var i = 0; i < 150; i++) {\n        assertEqX4(SIMD.int32x4.swizzle(i4, i, 3, 2, 0), [1, 4, 3, 1]);\n}\n\n\n\nBacktrace:\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x0000000200000001 in ?? ()\n#0  0x0000000200000001 in ?? ()\n#1  0x0000000400000003 in ?? ()\n#2  0x00007ffff4d5e12a in ?? ()\n#3  0x0000000000000000 in ?? ()\nrax\t0x7fff00000000\t140733193388032\nrbx\t0xfffc7ffff4d7ac40\t-985162605679552\nrcx\t0xfffa00000000000d\t-1688849860263923\nrdx\t0x0\t0\nrsi\t0x40000000\t1073741824\nrdi\t0x7fffffffc5c0\t140737488340416\nrbp\t0x7fffffffd0d0\t140737488343248\nrsp\t0x7fffffffd188\t140737488343432\nr8\t0x7ffff698d108\t140737330598152\nr9\t0x0\t0\nr10\t0x2\t2\nr11\t0x7ffff6958498\t140737330381976\nr12\t0x8\t8\nr13\t0x7fffffffd5a0\t140737488344480\nr14\t0x7ffff4d7ac40\t140737301163072\nr15\t0x7ffff7fe8640\t140737354040896\nrip\t0x200000001\t8589934593\n=> 0x200000001:\t\n\n\nMarking sec-critical due to invalid jump.", "author": "choller@mozilla.com", "id": 10119878, "time": "2015-04-05T17:33:57Z"}, {"text": "JSBugMon: Bisection requested, result:\n=== Treeherder Build Bisection Results by autoBisect ===\n\nThe \"good\" changeset has the timestamp \"20150320081439\" and the hash \"5dcff2ab60e6\".\nThe \"bad\" changeset has the timestamp \"20150320082235\" and the hash \"6abbe0f83479\".\n\nLikely regression window: https://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=5dcff2ab60e6&tochange=6abbe0f83479", "author": "choller@mozilla.com", "id": 10120016, "time": "2015-04-05T20:34:56Z"}, {"text": "Needinfo from Benjamin based on comment 1.", "author": "choller@mozilla.com", "id": 10125335, "time": "2015-04-07T12:19:42Z"}, {"text": "Created attachment 8589117\nGeneral shuffle should reserve space for numVectors + 1 vectors\n\nDuh, that's really weird we didn't catch it before, because it also affects correctness. Sorry for this silly issue, it probably appeared during the generalization of SimdGeneralShuffle...\n\nSo we were overwriting stack values, before this patch, which would lead to very undefined behavior. The only way I can think of, to avoid this in the future is, if that's doable, to have a RAII class that would mprotect the stack above the masm.framePushed() value at construct, and un-mprotect it at exit. Probably overkill for just this operation, but could be useful for other nodes...", "author": "bbouvier@mozilla.com", "id": 10126019, "time": "2015-04-07T15:00:00Z"}, {"text": "This is related to the SIMD global object, which is enabled only on nightlies, so other versions aren't affected.", "author": "bbouvier@mozilla.com", "id": 10126077, "time": "2015-04-07T15:10:04Z"}, {"text": "Comment on attachment 8589117\nGeneral shuffle should reserve space for numVectors + 1 vectors\n\nReview of attachment 8589117:\n-----------------------------------------------------------------\n\n::: js/src/jit-test/tests/SIMD/swizzle.js\n@@ +60,5 @@\n>      }\n>  }\n>  \n> +function testInt32x4SwizzleBailout() {\n> +    // Fuzz bug 1151333. Wrap function call in try/catch.\n\nInstead of referencing a non-public bug here, I think we can just describe what this test is testing. \"Test out-of-bounds non-constant indices. These are expected to throw.\"\n\n::: js/src/jit/x86-shared/CodeGenerator-x86-shared.cpp\n@@ +2395,5 @@\n>  \n>      // This won't generate fast code, but it's fine because we expect users\n>      // to have used constant indices (and thus MSimdGeneralShuffle to be fold\n>      // into MSimdSwizzle/MSimdShuffle, which are fast).\n> +    masm.reserveStack(Simd128DataSize * (numVectors + 1));\n\n\"Simd128DataSize * (numVectors + 1)\" is an interesting enough expression that, with 4 uses (1 here and 3 below), should get its own variable so that we can give it a name and a comment like \"we need space to store the input vectors, plus 1 to compute the result in\".", "author": "sunfish@mozilla.com", "id": 10126174, "time": "2015-04-07T15:28:43Z"}, {"text": "Thank you for the review. I've used a temporary variable for Simd128DataSize*(numVectors+1) and added a comment about it.\n\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/4cd0cd1e992a", "author": "bbouvier@mozilla.com", "id": 10126211, "time": "2015-04-07T15:39:37Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/4cd0cd1e992a", "author": "ryanvm@gmail.com", "id": 10127704, "time": "2015-04-07T20:10:22Z"}, {"text": "JSBugMon: This bug has been automatically verified fixed.", "author": "choller@mozilla.com", "id": 10130956, "time": "2015-04-08T14:13:37Z"}], "id": 1151333, "priority": "--", "cc": ["bbouvier@mozilla.com", "choller@mozilla.com", "fuzzing@mozilla.com", "jruderman@gmail.com", "nth10sd@gmail.com", "sunfish@mozilla.com"], "cf_crash_signature": "[@ ??]", "version": "Trunk", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_firefox59": "---", "cf_status_b2g_2_2": "unaffected", "last_change_time": "2015-05-18T22:49:03Z", "status": "VERIFIED", "product": "Core", "cf_fx_iteration": "---", "blocks": [676763], "qa_contact": "", "creation_time": "2015-04-05T17:33:57Z", "cf_status_firefox_esr52": "---", "component": "JavaScript Engine", "assigned_to_detail": {"email": "bbouvier@mozilla.com", "id": 468907, "name": "bbouvier@mozilla.com", "real_name": "Benjamin Bouvier [:bbouvier]"}, "cf_status_firefox_esr31": "unaffected", "groups": [], "cf_status_firefox60": "---", "cf_status_b2g_2_1_s": "unaffected", "cf_status_firefox40": "verified", "cf_status_firefox_esr38": "unaffected", "target_milestone": "mozilla40", "is_cc_accessible": true, "cf_rank": null, "cf_status_thunderbird_esr52": "---", "cf_status_b2g_1_4": "unaffected", "url": "", "resolution": "FIXED", "creator_detail": {"email": "choller@mozilla.com", "id": 395101, "name": "choller@mozilla.com", "real_name": "Christian Holler (:decoder)"}, "whiteboard": "[fuzzblocker] [jsbugmon:update]", "cf_status_b2g_2_1": "unaffected", "cf_status_b2g_2_0": "unaffected", "cc_detail": [{"email": "bbouvier@mozilla.com", "id": 468907, "name": "bbouvier@mozilla.com", "real_name": "Benjamin Bouvier [:bbouvier]"}, {"email": "choller@mozilla.com", "id": 395101, "name": "choller@mozilla.com", "real_name": "Christian Holler (:decoder)"}, {"email": "fuzzing@mozilla.com", "id": 469204, "name": "fuzzing@mozilla.com", "real_name": "Fuzzing Team"}, {"email": "jruderman@gmail.com", "id": 11608, "name": "jruderman@gmail.com", "real_name": "Jesse Ruderman"}, {"email": "nth10sd@gmail.com", "id": 132034, "name": "nth10sd@gmail.com", "real_name": "Gary Kwong [:gkw] [:nth10sd]"}, {"email": "sunfish@mozilla.com", "id": 468136, "name": "sunfish@mozilla.com", "real_name": "Dan Gohman [:sunfish]"}], "cf_platform_rel": "---", "alias": null, "dupe_of": null, "flags": [{"status": "+", "name": "in-testsuite", "modification_date": "2015-04-07T20:10:22Z", "type_id": 37, "creation_date": "2015-04-07T20:10:22Z", "id": 1141118, "setter": "ryanvm@gmail.com"}], "cf_tracking_firefox58": "---", "assigned_to": "bbouvier@mozilla.com", "is_open": false, "mentors": [], "creator": "choller@mozilla.com", "op_sys": "Linux", "cf_fx_points": "---", "cf_blocking_fennec": "---"}