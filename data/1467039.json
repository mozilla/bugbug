{"cf_tracking_thunderbird_esr52": "---", "status": "NEW", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "classification": "Components", "creator": "mh+mozilla@glandium.org", "cc": ["cmanchester@mozilla.com", "core-build-config-reviews@mozilla.bugs", "jld@mozilla.com", "mcastelluccio@mozilla.com", "mconley@mozilla.com", "nfroyd@mozilla.com", "sledru@mozilla.com", "VYV03354@nifty.ne.jp"], "depends_on": [1468646], "creation_time": "2018-06-06T06:59:07Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "keywords": ["regression"], "summary": "Local builds don't default to gold when it's available anymore", "cf_last_resolved": null, "attachments": [{"creator": "mh+mozilla@glandium.org", "is_obsolete": 0, "is_patch": 0, "flags": [{"requestee": "core-build-config-reviews@mozilla.bugs", "status": "?", "name": "review", "modification_date": "2018-06-13T22:47:51Z", "type_id": 4, "creation_date": "2018-06-13T22:47:51Z", "id": 1768760, "setter": "mh+mozilla@glandium.org"}], "content_type": "text/x-review-board-request", "id": 8983988}], "assigned_to_detail": {"email": "mh+mozilla@glandium.org", "id": 47192, "name": "mh+mozilla@glandium.org", "real_name": "Mike Hommey [:glandium]"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "comments": [{"text": "This is a regression from bug 1455767. Before that bug, building locally without e.g. --enable-release would build with gold if it's installed. After, gold is only picked if --enable-gold is explicitly passed.", "author": "mh+mozilla@glandium.org", "id": 13390131, "time": "2018-06-06T06:59:07Z"}, {"text": "Created attachment 8983988\nBug 1467039 - Default to gold on local builds.\n\nWe used to do that before bug 1455767. Taking a step back, what we want\n(and what this change implements) is to:\n- allow to specify a linker to use explicitly\n- check that using the corresponding linker flags makes us use that\n  linker\n- if no linker is specified, and developer options are enabled, we want\n  to try to use gold if it's available, otherwise, we want to detect\n  what kind of linker the default linker is\n\nReview commit: https://reviewboard.mozilla.org/r/249860/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/249860/", "author": "mh+mozilla@glandium.org", "id": 13392516, "time": "2018-06-07T00:35:19Z"}, {"text": "Comment on attachment 8983988\nBug 1467039 - Default to gold on local builds.\n\nhttps://reviewboard.mozilla.org/r/249860/#review256888", "author": "cmanchester@mozilla.com", "id": 13400300, "time": "2018-06-11T05:40:44Z"}, {"text": "Pushed by mh@glandium.org:\nhttps://hg.mozilla.org/integration/autoland/rev/0c800e84c991\nDefault to gold on local builds. r=chmanchester", "author": "pulsebot@bots.tld", "id": 13401971, "time": "2018-06-12T05:02:45Z"}, {"text": "Backed out changeset 0c800e84c991 (bug 1467039) for Spidermonkey failure. CLOSED TREE\n\nLog:\nhttps://treeherder.mozilla.org/logviewer.html#?job_id=182892222&repo=autoland&lineNumber=58758\n/usr/bin/ld.gold: error: prtime.o: unsupported reloc 42 against global symbol PR_LocalTimeParameters\n[task 2018-06-12T05:07:57.221Z] /builds/worker/workspace/gcc/bin/../lib/gcc/x86_64-pc-linux-gnu/6.4.0/crtbeginS.o(.text+0x1e): error: unsupported reloc 42\n[task 2018-06-12T05:07:57.221Z] /builds/worker/workspace/gcc/bin/../lib/gcc/x86_64-pc-linux-gnu/6.4.0/crtbeginS.o(.text+0x6b): error: unsupported reloc 42\n[task 2018-06-12T05:07:57.221Z] /builds/worker/workspace/gcc/bin/../lib/gcc/x86_64-pc-linux-gnu/6.4.0/crtbeginS.o(.text+0xeb): error: unsupported reloc 42\n[task 2018-06-12T05:07:57.221Z] /usr/bin/ld.gold: internal error in value_from_output_section, at ../../gold/reloc.cc:1549\n[task 2018-06-12T05:07:57.222Z] collect2: error: ld returned 1 exit status\n[task 2018-06-12T05:07:57.222Z] /builds/worker/workspace/sm-package/mozjs-62.0a1.0/config/rules.mk:679: recipe for target 'libnspr4.so' failed\n[task 2018-06-12T05:07:57.222Z] make[3]: *** [libnspr4.so] Error 1\n[task 2018-06-12T05:07:57.222Z] make[3]: Leaving directory '/builds/worker/workspace/sm-package/mozjs-62.0a1.0/obj-spider/config/external/nspr/pr'\n[task 2018-06-12T05:07:57.222Z] /builds/worker/workspace/sm-package/mozjs-62.0a1.0/config/recurse.mk:74: recipe for target 'config/external/nspr/pr/target' failed\n[task 2018-06-12T05:07:57.222Z] make[2]: *** [config/external/nspr/pr/target] Error 2\n[task 2018-06-12T05:07:57.222Z] make[2]: *** Waiting for unfinished jobs....\n[task 2018-06-12T05:07:57.222Z] /builds/worker/workspace/gcc/bin/g++ -o BinTokenReaderTester.o -c -I/builds/worker/workspace/sm-package/mozjs-62.0a1.0/obj-spider/dist/system_wrappers -include /builds/worker/workspace/sm-package/mozjs-62.0a1.0/config/gcc_hidden.h -DNDEBUG=1 -DTRIMMED=1 -DENABLE_BINARYDATA -DENABLE_SIMD -DENABLE_WASM_BULKMEM_OPS -DENABLE_WASM_SATURATING_TRUNC_OPS -DENABLE_WASM_THREAD_OPS -DENABLE_WASM_GC -DWASM_HUGE_MEMORY -DJS_CACHEIR_SPEW -DENABLE_SHARED_ARRAY_BUFFER -DEXPORT_JS_API -DMOZ_HAS_MOZGLUE -I/builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src -I/builds/worker/workspace/sm-package/mozjs-62.0a1.0/obj-spider/js/src -I/builds/worker/workspace/sm-package/mozjs-62.0a1.0/obj-spider/dist/include -I/builds/worker/workspace/sm-package/mozjs-62.0a1.0/obj-spider/dist/include/nspr -fPIC -DMOZILLA_CLIENT -include /builds/worker/workspace/sm-package/mozjs-62.0a1.0/obj-spider/js/src/js-confdefs.h -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -Wall -Wempty-body -Wignored-qualifiers -Woverloaded-virtual -Wpointer-arith -Wsign-compare -Wtype-limits -Wunreachable-code -Wwrite-strings -Wno-invalid-offsetof -Wduplicated-cond -Wno-error=maybe-uninitialized -Wno-error=deprecated-declarations -Wno-error=array-bounds -Wno-error=free-nonheap-object -Wformat -D_GLIBCXX_USE_CXX11_ABI=0 -fno-sized-deallocation -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -fno-rtti -fno-exceptions -fno-math-errno -pthread -pipe -g -freorder-blocks -O3 -fno-omit-frame-pointer -Wno-shadow -Werror=format -fno-strict-aliasing  -MD -MP -MF .deps/BinTokenReaderTester.o.pp   /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/BinTokenReaderTester.cpp\n[task 2018-06-12T05:07:57.316Z] /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/BinSource-auto.cpp: In member function 'JS::Result<js::frontend::ParseNode*> js::frontend::BinASTParser<Tok>::parseInterfaceBinaryExpression(size_t, js::frontend::BinKind, const BinFields&) [with Tok = js::frontend::BinTokenReaderTester]':\n[task 2018-06-12T05:07:57.316Z] /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/BinSource-auto.cpp:3531:27: warning: 'pnk' may be used uninitialized in this function [-Wmaybe-uninitialized]\n[task 2018-06-12T05:07:57.316Z]      if (left->isKind(pnk) &&\n[task 2018-06-12T05:07:57.316Z]                             \n[task 2018-06-12T05:07:57.429Z] In file included from /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/FullParseHandler.h:15:0,\n[task 2018-06-12T05:07:57.429Z]                  from /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/BCEParserHandle.h:11,\n[task 2018-06-12T05:07:57.429Z]                  from /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/BinSource.h:19,\n[task 2018-06-12T05:07:57.429Z]                  from /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/BinSource-auto.cpp:20:\n[task 2018-06-12T05:07:57.429Z] /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/ParseNode.h: In member function 'JS::Result<js::frontend::ParseNode*> js::frontend::BinASTParser<Tok>::parseInterfaceUnaryExpression(size_t, js::frontend::BinKind, const BinFields&) [with Tok = js::frontend::BinTokenReaderTester]':\n[task 2018-06-12T05:07:57.429Z] /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/ParseNode.h:494:24: warning: 'pnk' may be used uninitialized in this function [-Wmaybe-uninitialized]\n[task 2018-06-12T05:07:57.429Z]          pn_next(nullptr)\n[task 2018-06-12T05:07:57.429Z]                         ^\n[task 2018-06-12T05:07:57.429Z] /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/BinSource-auto.cpp:7363:19: note: 'pnk' was declared here\n[task 2018-06-12T05:07:57.429Z]      ParseNodeKind pnk;\n[task 2018-06-12T05:07:57.429Z]                    ^~~\n[task 2018-06-12T05:07:57.525Z] In file included from /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/FullParseHandler.h:15:0,\n[task 2018-06-12T05:07:57.525Z]                  from /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/BCEParserHandle.h:11,\n[task 2018-06-12T05:07:57.525Z]                  from /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/BinSource.h:19,\n[task 2018-06-12T05:07:57.525Z]                  from /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/BinSource-auto.cpp:20:\n[task 2018-06-12T05:07:57.525Z] /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/ParseNode.h: In member function 'JS::Result<js::frontend::ParseNode*> js::frontend::BinASTParser<Tok>::parseInterfaceVariableDeclaration(size_t, js::frontend::BinKind, const BinFields&) [with Tok = js::frontend::BinTokenReaderTester]':\n[task 2018-06-12T05:07:57.525Z] /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/ParseNode.h:510:17: warning: 'pnk' may be used uninitialized in this function [-Wmaybe-uninitialized]\n[task 2018-06-12T05:07:57.525Z]          pn_type = kind;\n[task 2018-06-12T05:07:57.525Z]          ~~~~~~~~^~~~~~\n[task 2018-06-12T05:07:57.525Z] /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/BinSource-auto.cpp:7527:19: note: 'pnk' was declared here\n[task 2018-06-12T05:07:57.525Z]      ParseNodeKind pnk;\n[task 2018-06-12T05:07:57.525Z]                    ^~~\n[task 2018-06-12T05:07:57.901Z] In file included from /builds/worker/workspace/sm-package/mozjs-62.0a1.0/obj-spider/dist/include/mozilla/Result.h:17:0,\n[task 2018-06-12T05:07:57.901Z]                  from /builds/worker/workspace/sm-package/mozjs-62.0a1.0/obj-spider/dist/include/js/Result.h:119,\n[task 2018-06-12T05:07:57.901Z]                  from /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/jspubtd.h:17,\n[task 2018-06-12T05:07:57.901Z]                  from /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/TokenStream.h:177,\n[task 2018-06-12T05:07:57.901Z]                  from /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/BinTokenReaderBase.h:11,\n[task 2018-06-12T05:07:57.901Z]                  from /builds/worker/workspace/sm-package/mozjs-62.0a1.0/js/src/frontend/BinTokenReaderBase.cpp:7:\n[task 2018-06-12T05:07:57.901Z] /builds/worker/workspace/sm-package/mozjs-62.0a1.0/obj-spider/dist/include/mozilla/Variant.h: In member function 'JS::Result<unsigned char> js::frontend::BinTokenReaderBase::readByte()':\n[task 2018-06-12T05:07:57.901Z] /builds/worker/workspace/sm-package/mozjs-62.0a1.0/obj-spider/dist/include/mozilla/Variant.h:531:5: warning: 'byte' may be used uninitialized in this function [-Wmaybe-uninitialized]\n[task 2018-06-12T05:07:57.901Z]      ::new (KnownNotNull, ptr()) T(std::forward<RefT>(aT));\n[task 2018-06-12T05:07:57.901Z]      ^~\n\nPush with failures:\nhttps://treeherder.mozilla.org/#/jobs?repo=autoland&revision=0c800e84c99172c583b2f818cb45e0bdb34e79a8&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception&filter-classifiedState=unclassified\n\nBackout:\nhttps://hg.mozilla.org/integration/autoland/rev/81c54e582e07179b34a9e7b8cd424fd210c94a4f", "author": "dluca@mozilla.com", "id": 13401997, "time": "2018-06-12T05:31:36Z"}, {"text": "Comment on attachment 8983988\nBug 1467039 - Default to gold on local builds.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/249860/diff/1-2/", "author": "mh+mozilla@glandium.org", "id": 13404434, "time": "2018-06-13T22:47:51Z"}, {"text": "(re-requesting review on purpose because of changes)", "author": "mh+mozilla@glandium.org", "id": 13404435, "time": "2018-06-13T22:48:27Z"}], "id": 1467039, "priority": "--", "mentors_detail": [], "comment_count": 7, "cf_status_thunderbird_esr52": "---", "cf_qa_whiteboard": "", "version": "unspecified", "cf_tracking_firefox62": "---", "cf_platform_rel": "---", "product": "Firefox Build System", "cf_fx_iteration": "---", "blocks": [1467337, 1455767], "qa_contact": "", "see_also": [], "cf_status_firefox_esr52": "---", "component": "General", "votes": 0, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "---", "cf_status_firefox60": "---", "target_milestone": "---", "is_cc_accessible": true, "cf_tracking_thunderbird_esr60": "---", "groups": [], "cf_tracking_firefox_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "mh+mozilla@glandium.org", "id": 47192, "name": "mh+mozilla@glandium.org", "real_name": "Mike Hommey [:glandium]"}, "whiteboard": "", "mentors": [], "cc_detail": [{"email": "cmanchester@mozilla.com", "id": 432261, "name": "cmanchester@mozilla.com", "real_name": "Chris Manchester (:chmanchester)"}, {"email": "core-build-config-reviews@mozilla.bugs", "id": 603852, "name": "core-build-config-reviews@mozilla.bugs", "real_name": "Reviewers for Core::Build Config Bugs (:build-peer)"}, {"email": "jld@mozilla.com", "id": 462836, "name": "jld@mozilla.com", "real_name": "Jed Davis [:jld] (\u23f0UTC-6)"}, {"email": "mcastelluccio@mozilla.com", "id": 420453, "name": "mcastelluccio@mozilla.com", "real_name": "Marco Castelluccio [:marco]"}, {"email": "mconley@mozilla.com", "id": 403756, "name": "mconley@mozilla.com", "real_name": "Mike Conley (:mconley) (:\u2699\ufe0f) (Catching up on needinfos / reviews)"}, {"email": "nfroyd@mozilla.com", "id": 417288, "name": "nfroyd@mozilla.com", "real_name": "Nathan Froyd [:froydnj]"}, {"email": "sledru@mozilla.com", "id": 495955, "name": "sledru@mozilla.com", "real_name": "Sylvestre Ledru [:sylvestre]"}, {"email": "VYV03354@nifty.ne.jp", "id": 5842, "name": "VYV03354@nifty.ne.jp", "real_name": "Masatoshi Kimura [:emk]"}], "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-06-13T22:50:12Z", "cf_status_firefox_esr60": "---", "assigned_to": "mh+mozilla@glandium.org", "is_open": true, "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "nfroyd@mozilla.com"}], "who": "nfroyd@mozilla.com", "when": "2018-06-06T10:51:25Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jld@mozilla.com"}], "who": "jld@mozilla.com", "when": "2018-06-06T21:00:17Z"}, {"changes": [{"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "mh+mozilla@glandium.org"}], "who": "mh+mozilla@glandium.org", "when": "2018-06-06T23:46:24Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8983988, "added": "review?(core-build-config-reviews@mozilla.bugs)"}, {"removed": "", "field_name": "cc", "added": "core-build-config-reviews@mozilla.bugs"}], "who": "mh+mozilla@glandium.org", "when": "2018-06-07T00:35:19Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1467041"}], "who": "mh+mozilla@glandium.org", "when": "2018-06-07T01:13:20Z"}, {"changes": [{"removed": "1467041", "field_name": "depends_on", "added": ""}], "who": "mh+mozilla@glandium.org", "when": "2018-06-07T01:23:48Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mconley@mozilla.com"}], "who": "mconley@mozilla.com", "when": "2018-06-07T02:26:42Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1467337"}], "who": "mh+mozilla@glandium.org", "when": "2018-06-07T04:10:40Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "regression"}, {"removed": "", "field_name": "cc", "added": "mcastelluccio@mozilla.com"}], "who": "mcastelluccio@mozilla.com", "when": "2018-06-07T13:24:40Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(core-build-config-reviews@mozilla.bugs)", "attachment_id": 8983988, "added": "review?(cmanchester@mozilla.com)"}, {"removed": "", "field_name": "cc", "added": "cmanchester@mozilla.com"}], "who": "cmanchester@mozilla.com", "when": "2018-06-11T05:40:34Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(cmanchester@mozilla.com)", "attachment_id": 8983988, "added": "review+"}], "who": "cmanchester@mozilla.com", "when": "2018-06-11T05:40:44Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(mh+mozilla@glandium.org)"}], "who": "dluca@mozilla.com", "when": "2018-06-12T05:31:36Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "VYV03354@nifty.ne.jp"}], "who": "VYV03354@nifty.ne.jp", "when": "2018-06-12T14:31:54Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review+", "attachment_id": 8983988, "added": "review?(core-build-config-reviews@mozilla.bugs)"}], "who": "mh+mozilla@glandium.org", "when": "2018-06-13T22:47:51Z"}, {"changes": [{"removed": "needinfo?(mh+mozilla@glandium.org)", "field_name": "flagtypes.name", "added": ""}], "who": "mh+mozilla@glandium.org", "when": "2018-06-13T22:48:27Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1468646"}], "who": "mh+mozilla@glandium.org", "when": "2018-06-13T22:50:12Z"}], "resolution": "", "op_sys": "Unspecified", "cf_fx_points": "---", "cf_blocking_fennec": "---"}