{"status": "ASSIGNED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "classification": "Client Software", "creator": "mcastelluccio@mozilla.com", "cc": ["jhorak@redhat.com", "jonas@thiem.email", "paolo.mozmail@amadzone.org"], "depends_on": [], "creation_time": "2018-05-23T17:30:51Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "keywords": ["regression"], "summary": "When downloading a RAR blob, Firefox no longer asks if you want to save the file or open it", "cf_last_resolved": null, "attachments": [{"creator": "jhorak@redhat.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2018-05-25T14:18:38Z", "type_id": 748, "creation_date": "2018-05-24T13:55:57Z", "id": 1761157, "setter": "paolo.mozmail@amadzone.org"}], "content_type": "text/x-review-board-request", "id": 8980297}], "assigned_to_detail": {"email": "jhorak@redhat.com", "id": 328198, "name": "jhorak@redhat.com", "real_name": "Jan Horak [:jhorak]"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 10, "comments": [{"text": "Not sure if this is the right component.", "author": "mcastelluccio@mozilla.com", "id": 13300089, "time": "2018-05-23T17:30:51Z"}, {"text": "https://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=9dd8b6f551abb9d1e3ecb3b68eba4ee683371376&tochange=e933d5d558ec8e57bdb1e6f302a180d68ae850c5", "author": "mcastelluccio@mozilla.com", "id": 13300130, "time": "2018-05-23T17:42:29Z"}, {"text": "Just as an end user, I suggest that firefox should guess based on file extension for application/octet-stream - or alternatively by downloading parts of the file and peeking at the file header.", "author": "jonas@thiem.email", "id": 13300380, "time": "2018-05-23T19:07:25Z"}, {"text": "Hm, for me the Firefox 60 has same behaviour as nightly, for both I see:\n\nYou have chosen to open:\n   ...\n   ...\nWould you like to save this file?", "author": "jhorak@redhat.com", "id": 13329509, "time": "2018-05-24T07:58:59Z"}, {"text": "Okay, the problem is that content-type has higher priority than file extension [1]. Before the bug 1427700 landed we could return invalid (but some) mimeinfo for the application/octet-stream content type, so Open with dialog showed. After the fix landed we return generic mimeinfo which leads to Save/Cancel dialog.\n\nWhat I believe we need to do is to use file extension to determine the right mimeinfo in case of application/octet-stream content type (like win does [2]).\n\n[1] https://searchfox.org/mozilla-central/rev/dc6d85680539cb7e5fe2843d38a30a0581bfefe1/uriloader/exthandler/unix/nsOSHelperAppService.cpp#1453\n[2] https://searchfox.org/mozilla-central/rev/dc6d85680539cb7e5fe2843d38a30a0581bfefe1/uriloader/exthandler/win/nsOSHelperAppService.cpp#402", "author": "jhorak@redhat.com", "id": 13347057, "time": "2018-05-24T13:54:36Z"}, {"text": "Created attachment 8980297\nBug 1463809 - Don't lookup mimeinfo of application/octet-stream;\n\nMimeinfo returned for the generic application/octet-stream content\ntype is usually irrelevant to the file extension, getting mimeinfo\nfrom extension itself is more reliable.\n\nReview commit: https://reviewboard.mozilla.org/r/246462/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/246462/", "author": "jhorak@redhat.com", "id": 13347128, "time": "2018-05-24T13:55:57Z"}, {"text": "Comment on attachment 8980297\nBug 1463809 - Don't lookup mimeinfo of application/octet-stream;\n\nhttps://reviewboard.mozilla.org/r/246462/#review252886", "author": "paolo.mozmail@amadzone.org", "id": 13363907, "time": "2018-05-25T14:18:38Z"}, {"text": "This leads to failures in \"browser_unknownContentType_dialog_layout.js\". Jan, do you have time to look into these?\n\nGiven the merge day is getting closer, and system integration issues generally require more time to get sufficient testing in the field, we should either land this soon or revert bug 1427700 in the meantime.", "author": "paolo.mozmail@amadzone.org", "id": 13382125, "time": "2018-06-02T11:59:55Z"}, {"text": "I've noticed the test failure but I'm not able to reproduce it in Fedora ATM. I'm curious about the test environment because it looks like the .pif file extension is associated with some mimetype.\n\nI've made the test to trying to download .bin file and that seems to be okay for linux [2], but obviously bad for Windows. Any suggestions how to fix this?\n\n[1] https://searchfox.org/mozilla-central/source/toolkit/mozapps/downloads/tests/browser/browser_unknownContentType_dialog_layout.js#15\n\n[2] https://treeherder.mozilla.org/#/jobs?repo=try&revision=51f36ccc736a9f988e98efd6033364b9fc0e0850&selectedJob=181747574", "author": "jhorak@redhat.com", "id": 13386007, "time": "2018-06-04T18:39:17Z"}, {"text": "Recent regression (from bug 1427700), tracking for 62. We could probably still take an uplift during beta.", "author": "lhenry@mozilla.com", "id": 13401082, "time": "2018-06-11T20:28:56Z"}], "id": 1463809, "priority": "P1", "mentors_detail": [], "cf_crash_signature": "", "version": "unspecified", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox62": "+", "cf_platform_rel": "---", "product": "Firefox", "cf_status_firefox_esr52": "unaffected", "blocks": [1427700], "qa_contact": "", "see_also": [], "cf_fx_iteration": "---", "component": "File Handling", "votes": 0, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "affected", "cf_status_firefox61": "unaffected", "cf_status_firefox60": "unaffected", "target_milestone": "---", "is_cc_accessible": true, "cf_rank": null, "groups": [], "url": "https://mega.nz/#!lPgGkLTB!LBNZ5vw0xfGg9G8CaKy7yEAUehflTg1UXINLkVndp8E", "creator_detail": {"email": "mcastelluccio@mozilla.com", "id": 420453, "name": "mcastelluccio@mozilla.com", "real_name": "Marco Castelluccio [:marco]"}, "whiteboard": "", "mentors": [], "cc_detail": [{"email": "jhorak@redhat.com", "id": 328198, "name": "jhorak@redhat.com", "real_name": "Jan Horak [:jhorak]"}, {"email": "jonas@thiem.email", "id": 580221, "name": "jonas@thiem.email", "real_name": ""}, {"email": "paolo.mozmail@amadzone.org", "id": 332229, "name": "paolo.mozmail@amadzone.org", "real_name": ":Paolo Amadini"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [{"requestee": "paolo.mozmail@amadzone.org", "status": "?", "name": "needinfo", "modification_date": "2018-06-04T18:39:17Z", "type_id": 800, "creation_date": "2018-06-04T18:39:17Z", "id": 1765526, "setter": "jhorak@redhat.com"}], "last_change_time": "2018-06-11T20:28:56Z", "cf_status_firefox_esr60": "unaffected", "assigned_to": "jhorak@redhat.com", "is_open": true, "resolution": "", "op_sys": "Unspecified", "cf_fx_points": "---", "history": [{"changes": [{"removed": "", "field_name": "keywords", "added": "regression"}, {"removed": "Downloads API", "field_name": "component", "added": "File Handling"}, {"removed": "", "field_name": "blocks", "added": "1427700"}, {"removed": "Toolkit", "field_name": "product", "added": "Firefox"}], "who": "mcastelluccio@mozilla.com", "when": "2018-05-23T17:42:29Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jonas@thiem.email"}], "who": "jonas@thiem.email", "when": "2018-05-23T19:07:25Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jhorak@redhat.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(mcastelluccio@mozilla.com)"}], "who": "jhorak@redhat.com", "when": "2018-05-24T07:58:59Z"}, {"changes": [{"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "jhorak@redhat.com"}], "who": "jhorak@redhat.com", "when": "2018-05-24T08:13:39Z"}, {"changes": [{"removed": "needinfo?(mcastelluccio@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "jhorak@redhat.com", "when": "2018-05-24T13:54:36Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8980297, "added": "review?(paolo.mozmail@amadzone.org)"}, {"removed": "", "field_name": "cc", "added": "paolo.mozmail@amadzone.org"}], "who": "jhorak@redhat.com", "when": "2018-05-24T13:55:57Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(paolo.mozmail@amadzone.org)", "attachment_id": 8980297, "added": "review+"}], "who": "paolo.mozmail@amadzone.org", "when": "2018-05-25T14:18:38Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(jhorak@redhat.com)"}], "who": "paolo.mozmail@amadzone.org", "when": "2018-06-02T11:59:55Z"}, {"changes": [{"removed": "--", "field_name": "priority", "added": "P1"}], "who": "paolo.mozmail@amadzone.org", "when": "2018-06-02T12:00:27Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "ASSIGNED"}], "who": "paolo.mozmail@amadzone.org", "when": "2018-06-02T12:00:34Z"}, {"changes": [{"removed": "needinfo?(jhorak@redhat.com)", "field_name": "flagtypes.name", "added": "needinfo?(paolo.mozmail@amadzone.org)"}], "who": "jhorak@redhat.com", "when": "2018-06-04T18:39:17Z"}, {"changes": [{"removed": "---", "field_name": "cf_status_firefox_esr52", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_firefox_esr60", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_firefox60", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_firefox61", "added": "unaffected"}, {"removed": "---", "field_name": "cf_tracking_firefox62", "added": "?"}, {"removed": "---", "field_name": "cf_status_firefox62", "added": "affected"}], "who": "mcastelluccio@mozilla.com", "when": "2018-06-09T18:32:40Z"}, {"changes": [{"removed": "?", "field_name": "cf_tracking_firefox62", "added": "+"}], "who": "lhenry@mozilla.com", "when": "2018-06-11T20:28:56Z"}]}