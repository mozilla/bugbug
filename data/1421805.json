{"status": "UNCONFIRMED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "classification": "Other", "creator": "thee.chicago.wolf@gmail.com", "cc": ["astevenson@mozilla.com", "oana.arbuzov@softvision.ro", "sean_gale@symantec.com", "stone123456@gmail.com"], "depends_on": [], "creation_time": "2017-11-29T22:06:47Z", "cf_user_story": "", "cf_status_firefox56": "---", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "cf_status_firefox58": "---", "assigned_to": "stone123456@gmail.com", "keywords": [], "cf_status_firefox57": "---", "summary": "When typing anything into a VM (virtual machine) launched in a browser window, extra characters appear", "id": 1421805, "attachments": [], "assigned_to_detail": {"email": "stone123456@gmail.com", "id": 559389, "name": "stone123456@gmail.com", "real_name": "Ming-Chou Shih [:stone]"}, "severity": "normal", "is_confirmed": false, "is_creator_accessible": true, "comment_count": 31, "comments": [{"text": "User Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0 SeaMonkey/2.53\nBuild ID: 20171119140653\n\nSteps to reproduce:\n\nI have FF 57.0 x64 installed in Win 7 x64, fully updated. Connection is 70mb/6mb, Asus RT-AC68U, fully updated to latest firmware. I log into a VMware session and launched a VM in a pop-up window. Thought it was related to VMWare bug https://kb.vmware.com/s/article/196 but after applying the fix to my VMs, it made no difference.\n\nI went back to test some earlier x64 FF57 Nightlies and found that using the nightly from 2017-09-07-10-03-18-mozilla-central/ worked ok. I then found things to be broken when using the build from 2017-09-07-22-02-12-mozilla-central/.\n\nI tested with Portable Chrome 62.0.3202.94 and didn't see the issue. I tested with Portable FF 56 and didn't see the issue. I also tested with 57b3 and the issue was present. I lowered my typematic rate to the lowest it can go and it made no difference, issue still present.\n\n\nActual results:\n\nI attempted to log into the VM via \"Send CTRL-ALT-DEL\" command and when entering the password, I can see it is adding repeat characters. I eventually am able to log into the VM by using the \"reveal password\" feature and open notepad. When I type into notepad (or anywhere in the VM), I see characters repeating such as aabcdeefgghhijkkl. It is adding duplicate characters though I am not pressing the keyboard twice, only once.\n\n\nExpected results:\n\nTyping should not repeat characters.", "author": "thee.chicago.wolf@gmail.com", "id": 12884709, "time": "2017-11-29T22:06:47Z"}, {"text": "I had a moment to run Mozgression and this is what I found:\n\nLast good:\napp_name: firefox\nbuild_date: 2017-09-07 13:24:50.916000\nbuild_file: C:\\Users\\Art\\.mozilla\\mozregression\\persist\\6aa1cc819058--mozilla-inbound--target.zip\nbuild_type: inbound\nbuild_url: https://queue.taskcluster.net/v1/task/erLrmQIcR8yGUZZXW5lK2g/runs/0/artifacts/public%2Fbuild%2Ftarget.zip\nchangeset: 6aa1cc819058deaa13f85278e2f5970b8ced0998\npushlog_url: https://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=6aa1cc819058deaa13f85278e2f5970b8ced0998&tochange=52433c05f30628771e15d72f87f51c9383f8372f\nrepo_name: mozilla-inbound\nrepo_url: https://hg.mozilla.org/integration/mozilla-inbound\ntask_id: erLrmQIcR8yGUZZXW5lK2g\n\nFirst bad:\napp_name: firefox\nbuild_date: 2017-09-07 14:34:59.499000\nbuild_file: C:\\Users\\Art\\.mozilla\\mozregression\\persist\\7e21f710ecec--mozilla-inbound--target.zip\nbuild_type: inbound\nbuild_url: https://queue.taskcluster.net/v1/task/Qpvi9EOZReyJf2YT2Fub9Q/runs/0/artifacts/public%2Fbuild%2Ftarget.zip\nchangeset: 7e21f710ecec4a16f1f23e7489bbb0eb3e45e462\npushlog_url: https://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=6aa1cc819058deaa13f85278e2f5970b8ced0998&tochange=7e21f710ecec4a16f1f23e7489bbb0eb3e45e462\nrepo_name: mozilla-inbound\nrepo_url: https://hg.mozilla.org/integration/mozilla-inbound\ntask_id: Qpvi9EOZReyJf2YT2Fub9Q\n\nNothing in the pushlog jumps out at me. Maybe bug 1390044 - Enable the input event queue on nightly", "author": "thee.chicago.wolf@gmail.com", "id": 12886878, "time": "2017-11-30T16:10:45Z"}, {"text": "I can confirm that flipping pref input_event_queue.supported\" to false and restarting the browser fixes this for me. SO bug 1390044 seems to be it.", "author": "thee.chicago.wolf@gmail.com", "id": 12886922, "time": "2017-11-30T16:26:31Z"}, {"text": "Just for the purposes of testing, I set input_event_queue.duration.max to 128 thinking the default of 8 was too short but it didn't help.", "author": "thee.chicago.wolf@gmail.com", "id": 12886980, "time": "2017-11-30T16:42:46Z"}, {"text": "So, I did further testing of the values of input_event_queue.duration.max and input_event_queue.duration.min. I initially set both max and min to 256 and things worked. I then set max to 64 and min to 32 and this seems to work for the VM I'm using. So, perhaps the default value of 1 for min and 8 for max may be too aggressive and not accounting for lag / latency in a VM or network? Just thinking out loud.", "author": "thee.chicago.wolf@gmail.com", "id": 12887050, "time": "2017-11-30T17:01:13Z"}, {"text": "Things worked with max @ 32 and @ 16 but broke when I tried max @ 16 and min @ 8. OMMV (Other's Mileage May Vary).", "author": "thee.chicago.wolf@gmail.com", "id": 12887125, "time": "2017-11-30T17:25:12Z"}, {"text": "(In reply to Arthur K. from comment #5)\n> Things worked with max @ 32 and @ 16 but broke when I tried max @ 16 and min\n> @ 8. OMMV (Other's Mileage May Vary).\n\nSorry, I meant to say things worked with max @ 32 and min @ 16.", "author": "thee.chicago.wolf@gmail.com", "id": 12887131, "time": "2017-11-30T17:27:00Z"}, {"text": "This does affect 58 as well. Track for 58?", "author": "thee.chicago.wolf@gmail.com", "id": 12887383, "time": "2017-11-30T18:54:08Z"}, {"text": "Thanks for testing and providing the information.", "author": "stone123456@gmail.com", "id": 12888338, "time": "2017-11-30T23:43:19Z"}, {"text": "Do you know how to set up an environment as you use for testing? It seems I have to find a machine with Windows server and install 'VMware vCenter Server' on it?", "author": "stone123456@gmail.com", "id": 12888359, "time": "2017-11-30T23:55:03Z"}, {"text": "(In reply to Ming-Chou Shih [:stone] from comment #9)\n> Do you know how to set up an environment as you use for testing? It seems I\n> have to find a machine with Windows server and install 'VMware vCenter\n> Server' on it?\n\nTherein lies the rub. I am doing a Symantec ITMS training session and it uses some VMs running on labs.partnercloudlab.com's site. I can ask my instructor to reach out to the techs of this site who manage the VMs and see if they can do anything but no guarantee. Additionally, doesn't have to be Windows Server. One of the VMs is a Win 10 x64 VM. Anything you want me to try on my end while I have access to the VMs?", "author": "thee.chicago.wolf@gmail.com", "id": 12888469, "time": "2017-12-01T01:06:24Z"}, {"text": "(In reply to Arthur K. from comment #10)\n> Therein lies the rub. I am doing a Symantec ITMS training session and it\n> uses some VMs running on labs.partnercloudlab.com's site. I can ask my\n> instructor to reach out to the techs of this site who manage the VMs and see\n> if they can do anything but no guarantee. Additionally, doesn't have to be\n> Windows Server. One of the VMs is a Win 10 x64 VM. Anything you want me to\n> try on my end while I have access to the VMs?\n\nSo far I'm still trying to figure out what's going on and I may need your help if I found something that might cause this problem. Many thanks for your help.\n\nI'm also wondering that when the problem happened, there are some extra repeated characters and no characters missing, right?", "author": "stone123456@gmail.com", "id": 12888504, "time": "2017-12-01T01:35:46Z"}, {"text": "(In reply to Ming-Chou Shih [:stone] from comment #11)\n> (In reply to Arthur K. from comment #10)\n> > Therein lies the rub. I am doing a Symantec ITMS training session and it\n> > uses some VMs running on labs.partnercloudlab.com's site. I can ask my\n> > instructor to reach out to the techs of this site who manage the VMs and see\n> > if they can do anything but no guarantee. Additionally, doesn't have to be\n> > Windows Server. One of the VMs is a Win 10 x64 VM. Anything you want me to\n> > try on my end while I have access to the VMs?\n> \n> So far I'm still trying to figure out what's going on and I may need your\n> help if I found something that might cause this problem. Many thanks for\n> your help.\n> \n> I'm also wondering that when the problem happened, there are some extra\n> repeated characters and no characters missing, right?\n\nYes, that's exactly right. No missing characters, just extra of the same character (i.e. aa, 11, ##, etc.).\n\nSo, the setting input_event_queue.duration.min, does it take precedence / order of operation before input_event_queue.duration.max? I only ask because in comment 3 I stated that I set input_event_queue.duration.max to 128 and it didn't make any difference. It was only when I increased input_event_queue.duration.min that the issue went away. Makes me think that we're never even making it to input_event_queue.duration.max at all? In which case, input_event_queue.duration=<min value> would seem to make sense. Again, just thinking out loud.", "author": "thee.chicago.wolf@gmail.com", "id": 12888521, "time": "2017-12-01T01:43:50Z"}, {"text": "(In reply to Ming-Chou Shih [:stone] from comment #9)\n> Do you know how to set up an environment as you use for testing? It seems I\n> have to find a machine with Windows server and install 'VMware vCenter\n> Server' on it?\n\nSo my instructor did send a message to the managers of the VMs. We'll see what, if anything, comes of it.", "author": "thee.chicago.wolf@gmail.com", "id": 12888532, "time": "2017-12-01T01:44:53Z"}, {"text": "(In reply to Arthur K. from comment #12)\n> So, the setting input_event_queue.duration.min, does it take precedence /\n> order of operation before input_event_queue.duration.max? I only ask because\n> in comment 3 I stated that I set input_event_queue.duration.max to 128 and\n> it didn't make any difference. It was only when I increased\n> input_event_queue.duration.min that the issue went away. Makes me think that\n> we're never even making it to input_event_queue.duration.max at all? In\n> which case, input_event_queue.duration=<min value> would seem to make sense.\n> Again, just thinking out loud.\n\ninput_event_queue.duration.max and min control the at most/least time which we reserved for handling input events before the next paint. Enlarging input_event_queue.duration.min means we could handle the pending input events earlier.", "author": "stone123456@gmail.com", "id": 12888540, "time": "2017-12-01T01:53:21Z"}, {"text": "(In reply to Ming-Chou Shih [:stone] from comment #14)\n> (In reply to Arthur K. from comment #12)\n> > So, the setting input_event_queue.duration.min, does it take precedence /\n> > order of operation before input_event_queue.duration.max? I only ask because\n> > in comment 3 I stated that I set input_event_queue.duration.max to 128 and\n> > it didn't make any difference. It was only when I increased\n> > input_event_queue.duration.min that the issue went away. Makes me think that\n> > we're never even making it to input_event_queue.duration.max at all? In\n> > which case, input_event_queue.duration=<min value> would seem to make sense.\n> > Again, just thinking out loud.\n> \n>Enlarging input_event_queue.duration.min means we could handle the pending input\n> events earlier.\n\nTaken from the change in the code commit:\n\n// The maximum and minimum time (milliseconds) we reserve for handling input\n// events in each frame.\npref(\"input_event_queue.duration.max\", 8);\npref(\"input_event_queue.duration.min\", 1);\n\nIt seems contrary to what you're saying. As I read it, it would seem that *increasing* the input_event_queue.duration.min value adds milliseconds to time before a new paint is done and therefore we handle pending input events later, not earlier. Which makes logical sense as to why adding milliseconds fixed this for me.", "author": "thee.chicago.wolf@gmail.com", "id": 12890041, "time": "2017-12-01T16:22:26Z"}, {"text": "(In reply to Arthur K. from comment #10)\n> (In reply to Ming-Chou Shih [:stone] from comment #9)\n> > Do you know how to set up an environment as you use for testing? It seems I\n> > have to find a machine with Windows server and install 'VMware vCenter\n> > Server' on it?\n> \n> Therein lies the rub. I am doing a Symantec ITMS training session and it\n> uses some VMs running on labs.partnercloudlab.com's site. I can ask my\n> instructor to reach out to the techs of this site who manage the VMs and see\n> if they can do anything but no guarantee. Additionally, doesn't have to be\n> Windows Server. One of the VMs is a Win 10 x64 VM. Anything you want me to\n> try on my end while I have access to the VMs?\n\nGoo news. I am in touch with a Symantec tech person who should be able to help! Please stay tuned.", "author": "thee.chicago.wolf@gmail.com", "id": 12891092, "time": "2017-12-02T01:17:17Z"}, {"text": "(In reply to Arthur K. from comment #16)\n> (In reply to Arthur K. from comment #10)\n> > (In reply to Ming-Chou Shih [:stone] from comment #9)\n> > > Do you know how to set up an environment as you use for testing? It seems I\n> > > have to find a machine with Windows server and install 'VMware vCenter\n> > > Server' on it?\n> > \n> > Therein lies the rub. I am doing a Symantec ITMS training session and it\n> > uses some VMs running on labs.partnercloudlab.com's site. I can ask my\n> > instructor to reach out to the techs of this site who manage the VMs and see\n> > if they can do anything but no guarantee. Additionally, doesn't have to be\n> > Windows Server. One of the VMs is a Win 10 x64 VM. Anything you want me to\n> > try on my end while I have access to the VMs?\n> \n> Goo news. I am in touch with a Symantec tech person who should be able to\n> help! Please stay tuned.\n\nThat's great. Thanks for your help.", "author": "stone123456@gmail.com", "id": 12891289, "time": "2017-12-02T06:34:24Z"}, {"text": "Probably no point tracking for 57.", "author": "thee.chicago.wolf@gmail.com", "id": 12899907, "time": "2017-12-05T21:33:02Z"}, {"text": "Ming-Chou,\n\nReach out to me privately, and I can send you credentials to access this specific lab environment to reproduce the issue.", "author": "sean_gale@symantec.com", "id": 12899911, "time": "2017-12-05T21:35:15Z"}, {"text": "(In reply to Sean Gale from comment #19)\n> Ming-Chou,\n> \n> Reach out to me privately, and I can send you credentials to access this\n> specific lab environment to reproduce the issue.\n\nHi Sean,\nI had sent an email to you and my email account is sshih@mozilla.com. Many thanks for your help.", "author": "stone123456@gmail.com", "id": 12900866, "time": "2017-12-06T04:33:19Z"}, {"text": "Hi Sean,\nPlease remind me when you send me the credentials, in case I miss it. Thanks.", "author": "stone123456@gmail.com", "id": 12907301, "time": "2017-12-08T04:05:50Z"}, {"text": "Clear ni request since I already got credentials and can reproduce this bug now.", "author": "stone123456@gmail.com", "id": 12914919, "time": "2017-12-12T13:01:41Z"}, {"text": "This bug is related to the implementation of the web VM console. I can't find any difference of dispatched keyboard events when the problem has happened. Guessing this may be related to the content, which posts async events when handling keyboard events.", "author": "stone123456@gmail.com", "id": 12914940, "time": "2017-12-12T13:27:22Z"}, {"text": "It seems the content setups a timer and appends the character when timeout. If the keypress event is handled after the timeout, then there are double characters.", "author": "stone123456@gmail.com", "id": 12918174, "time": "2017-12-14T12:57:57Z"}, {"text": "Wondering maybe someone knows the contact window of VMWare and could help to contact them for this bug?", "author": "stone123456@gmail.com", "id": 12926253, "time": "2017-12-19T10:05:48Z"}, {"text": "Reaching out to a friend that used to work for VMware. Will update when I hear back.", "author": "astevenson@mozilla.com", "id": 12955924, "time": "2018-01-09T20:05:50Z"}, {"text": "(In reply to Adam Stevenson [:adamopenweb] from comment #26)\n> Reaching out to a friend that used to work for VMware. Will update when I\n> hear back.\n\nSo, 2 months later and no response?", "author": "thee.chicago.wolf@gmail.com", "id": 13121172, "time": "2018-03-12T02:04:01Z"}, {"text": "Sorry, didn't hear back from the contact at VMWare.", "author": "astevenson@mozilla.com", "id": 13121182, "time": "2018-03-12T02:18:29Z"}, {"text": "Can you still reproduce the issue?", "author": "oana.arbuzov@softvision.ro", "id": 13284569, "time": "2018-05-17T14:55:13Z"}, {"text": "I don't have access to the system with the VM since last year so I cannot tell you.", "author": "thee.chicago.wolf@gmail.com", "id": 13284770, "time": "2018-05-17T15:49:10Z"}], "cf_last_resolved": null, "priority": "P3", "mentors_detail": [], "cf_crash_signature": "", "version": "Firefox 58", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox62": "---", "cf_platform_rel": "---", "product": "Tech Evangelism", "cf_status_firefox_esr52": "---", "blocks": [], "qa_contact": "", "see_also": ["https://bugzilla.mozilla.org/show_bug.cgi?id=1419376"], "cf_fx_iteration": "---", "component": "Desktop", "votes": 0, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "---", "cf_status_firefox60": "---", "target_milestone": "---", "is_cc_accessible": true, "groups": [], "url": "", "creator_detail": {"email": "thee.chicago.wolf@gmail.com", "id": 393183, "name": "thee.chicago.wolf@gmail.com", "real_name": "Arthur K."}, "whiteboard": "", "mentors": [], "cc_detail": [{"email": "astevenson@mozilla.com", "id": 489339, "name": "astevenson@mozilla.com", "real_name": "Adam Stevenson [:adamopenweb]"}, {"email": "oana.arbuzov@softvision.ro", "id": 594780, "name": "oana.arbuzov@softvision.ro", "real_name": "Oana Arbuzov [:oanaarbuzov]"}, {"email": "sean_gale@symantec.com", "id": 607690, "name": "sean_gale@symantec.com", "real_name": "Sean Gale"}, {"email": "stone123456@gmail.com", "id": 559389, "name": "stone123456@gmail.com", "real_name": "Ming-Chou Shih [:stone]"}], "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-05-17T15:49:10Z", "cf_status_firefox_esr60": "---", "cf_rank": null, "is_open": true, "history": [{"changes": [{"removed": "Untriaged", "field_name": "component", "added": "Widget: Win32"}, {"removed": "Firefox", "field_name": "product", "added": "Core"}], "who": "kohei.yoshino@gmail.com", "when": "2017-11-29T23:21:11Z"}, {"changes": [{"removed": "56 Branch", "field_name": "version", "added": "57 Branch"}], "who": "thee.chicago.wolf@gmail.com", "when": "2017-11-30T16:15:19Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "sshih@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(sshih@mozilla.com)"}], "who": "thee.chicago.wolf@gmail.com", "when": "2017-11-30T16:26:31Z"}, {"changes": [{"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "sshih@mozilla.com"}, {"removed": "needinfo?(sshih@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "stone123456@gmail.com", "when": "2017-11-30T23:38:56Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(thee.chicago.wolf@gmail.com)"}], "who": "stone123456@gmail.com", "when": "2017-11-30T23:55:03Z"}, {"changes": [{"removed": "needinfo?(thee.chicago.wolf@gmail.com)", "field_name": "flagtypes.name", "added": ""}], "who": "thee.chicago.wolf@gmail.com", "when": "2017-12-01T01:06:24Z"}, {"changes": [{"removed": "57 Branch", "field_name": "version", "added": "58 Branch"}], "who": "thee.chicago.wolf@gmail.com", "when": "2017-12-05T21:33:02Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "sean_gale@symantec.com"}], "who": "sean_gale@symantec.com", "when": "2017-12-05T21:35:15Z"}, {"changes": [{"removed": "--", "field_name": "priority", "added": "P2"}], "who": "jmathies@mozilla.com", "when": "2017-12-06T20:42:05Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(sean_gale@symantec.com)"}], "who": "stone123456@gmail.com", "when": "2017-12-08T04:05:50Z"}, {"changes": [{"removed": "needinfo?(sean_gale@symantec.com)", "field_name": "flagtypes.name", "added": ""}], "who": "stone123456@gmail.com", "when": "2017-12-12T13:01:41Z"}, {"changes": [{"removed": "", "field_name": "see_also", "added": "https://bugzilla.mozilla.org/show_bug.cgi?id=1419376"}], "who": "stone123456@gmail.com", "when": "2017-12-12T13:28:02Z"}, {"changes": [{"removed": "Widget: Win32", "field_name": "component", "added": "Desktop"}, {"removed": "58 Branch", "field_name": "version", "added": "Firefox 58"}, {"removed": "Core", "field_name": "product", "added": "Tech Evangelism"}], "who": "stone123456@gmail.com", "when": "2017-12-19T10:05:48Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "astevenson@mozilla.com"}], "who": "astevenson@mozilla.com", "when": "2018-01-09T20:05:50Z"}, {"changes": [{"removed": "P2", "field_name": "priority", "added": "P3"}, {"removed": "", "field_name": "cc", "added": "oana.arbuzov@softvision.ro"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(thee.chicago.wolf@gmail.com)"}], "who": "oana.arbuzov@softvision.ro", "when": "2018-05-17T14:55:13Z"}, {"changes": [{"removed": "needinfo?(thee.chicago.wolf@gmail.com)", "field_name": "flagtypes.name", "added": ""}], "who": "thee.chicago.wolf@gmail.com", "when": "2018-05-17T15:49:10Z"}], "resolution": "", "op_sys": "Unspecified", "cf_fx_points": "---", "cf_blocking_fennec": "---"}