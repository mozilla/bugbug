{"cf_tracking_thunderbird_esr52": "---", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "cf_tracking_firefox62": "---", "creator": "dtownsend@mozilla.com", "mentors_detail": [], "depends_on": [1463198, 1466568], "cf_status_firefox_esr60": "---", "cf_user_story": "As a Firefox user starting a profile that last ran with a newer build, I want to be made aware of the risks and decide what to do next, so I can avoid profile corruption.\r\n\r\nAcceptance criteria:\r\nWhen a user runs Firefox version X after having run Firefox version Y, where X<Y, display the following a UI informing the user with Windows title \"You've launched an older version of Firefox\" and body text \"If you use your profile with this older version, you may experience problems with Firefox and may not have full access to your bookmarks and browsing history.\":\r\n1 If the previous instance was detected and the profile we attempted to use was not signed in to sync\r\nDisplay message \"To launch this version safely, open Profile Manager and choose a different profile.\"\r\n---Options are [Open profile manager] [Exit and launch newer version] (Default)\r\n\r\n2 If the previous instance was detected and the profile we attempted to use was signed in to sync\r\n---Display message \"To launch this version safely, open Profile Manager and choose a different profile. Afterwards, sign into Firefox Account and perform a sync to restore your bookmarks and browsing history.\"\r\n---Options are [Open Profile Manager]   [Exit and launch newer version] (Default)\r\n-----If [Open Profile Manager] is selected, after opening a new profile from the profile manager display the firstrunpage that onboards users into sync (https://mozilla.org/firefox/60.0.1/firstrun)\r\n\r\n3 If the previous instance is gone or overwritten and the existing profile was not signed in to sync\r\n---Display message \"To launch this version safely, open Profile Manager and choose a different profile.\"\r\n---Options are [Open Profile Manager] [Exit] (Default)\r\n\r\n4 If the previous instance is gone or overwritten and the existing profile was signed in to sync\r\n---Display message \"To launch this version safely, open Profile Manager and choose a different profile. Afterwards, sign into Firefox Account and perform a sync to restore your bookmarks and browsing history.\"\r\n---Options are [Open Profile Manager] [Exit] (Default)\r\n-----If [Open Profile Manager] is selected, after opening a new profile from the profile manager display the firstrunpage that onboards users into sync (https://mozilla.org/firefox/60.0.1/firstrun)\r\n\r\n- The window-level close button on the UI should close everything.\r\n- A command line option can force an override of the new dialog (developers)\r\n- Implement an MVP of telemetry as a base to iterate towards answering the following questions:\r\n---What percentage of startups see each variation of the UI?\r\n---What is the version/channel distribution of users who see each variation of the UI?\r\n---What percentage of displays result in a click on each of the 2 options offered?\r\n---What is the impact on retention for users coming across each of the UIs?\r\n\r\n\r\nSUMO article draft: https://docs.google.com/document/d/1Ys4wNQk_gIei_EzAi2yMbXDXGvXZLX1em-hdSNr8Rk0/edit\r\n\r\nLeft to clarify\r\n- Copy validation\r\n\r\nFor later:\r\n- Great telemetry\r\n- Ability to detect whether there is already a unique profile associated with that version of Firefox and adapt UI to either display no UI or creation of a new profile (Comment 43)?", "cf_tracking_firefox_relnote": "?", "platform": "Unspecified", "keywords": ["feature"], "cc_detail": [{"email": "adavis@mozilla.com", "id": 540033, "name": "adavis@mozilla.com", "real_name": "Alex Davis [:adavis] [PM FxA+Sync]"}, {"email": "bgrinstead@mozilla.com", "id": 476442, "name": "bgrinstead@mozilla.com", "real_name": "Brian Grinstead [:bgrins]"}, {"email": "bram@mozilla.com", "id": 401666, "name": "bram@mozilla.com", "real_name": "Bram Pitoyo [:bram]"}, {"email": "bugmail@asutherland.org", "id": 151407, "name": "bugmail@asutherland.org", "real_name": "Andrew Sutherland [:asuth]"}, {"email": "gijskruitbosch+bugs@gmail.com", "id": 159069, "name": "gijskruitbosch+bugs@gmail.com", "real_name": ":Gijs (he/him)"}, {"email": "glob@mozilla.com", "id": 13647, "name": "glob@mozilla.com", "real_name": "Byron Jones \u2039:glob\u203a"}, {"email": "jcristau@mozilla.com", "id": 580382, "name": "jcristau@mozilla.com", "real_name": "Julien Cristau [:jcristau]"}, {"email": "joe-bugzilla@cursive.net", "id": 582586, "name": "joe-bugzilla@cursive.net", "real_name": "Joe Hildebrand  [:hildjj] (UTC-6)"}, {"email": "markh@mozilla.com", "id": 16943, "name": "markh@mozilla.com", "real_name": "Mark Hammond [:markh]"}, {"email": "MattN+bmo@mozilla.com", "id": 305228, "name": "MattN+bmo@mozilla.com", "real_name": "Matthew N. [:MattN] (PM if requests are blocking you)"}, {"email": "mcastelluccio@mozilla.com", "id": 420453, "name": "mcastelluccio@mozilla.com", "real_name": "Marco Castelluccio [:marco]"}, {"email": "mheubusch@mozilla.com", "id": 563864, "name": "mheubusch@mozilla.com", "real_name": ""}, {"email": "mverdi@mozilla.com", "id": 368084, "name": "mverdi@mozilla.com", "real_name": "Verdi [:verdi]"}, {"email": "myk@mykzilla.org", "id": 27300, "name": "myk@mykzilla.org", "real_name": "Myk Melez [:myk] [@mykmelez]"}, {"email": "nfroyd@mozilla.com", "id": 417288, "name": "nfroyd@mozilla.com", "real_name": "Nathan Froyd [:froydnj]"}, {"email": "paolo.mozmail@amadzone.org", "id": 332229, "name": "paolo.mozmail@amadzone.org", "real_name": ":Paolo Amadini"}, {"email": "pascalc@gmail.com", "id": 24572, "name": "pascalc@gmail.com", "real_name": "Pascal Chevrel:pascalc"}, {"email": "pdolanjski@mozilla.com", "id": 455532, "name": "pdolanjski@mozilla.com", "real_name": "Peter Dolanjski [:pdol]"}, {"email": "rtestard@mozilla.com", "id": 486264, "name": "rtestard@mozilla.com", "real_name": "Romain Testard [:RT]"}, {"email": "sguha@mozilla.com", "id": 407777, "name": "sguha@mozilla.com", "real_name": "\"Saptarshi Guha[:joy]\""}, {"email": "sledru@mozilla.com", "id": 495955, "name": "sledru@mozilla.com", "real_name": "Sylvestre Ledru [:sylvestre]"}], "cf_last_resolved": null, "attachments": [{"creator": "dtownsend@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2018-05-23T18:09:00Z", "type_id": 4, "creation_date": "2018-05-23T18:09:00Z", "id": 1760689, "setter": "gijskruitbosch+bugs@gmail.com"}], "content_type": "text/x-review-board-request", "id": 8969760}, {"creator": "dtownsend@mozilla.com", "is_obsolete": 1, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 8969761}, {"creator": "dtownsend@mozilla.com", "is_obsolete": 1, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 8971323}, {"creator": "dtownsend@mozilla.com", "is_obsolete": 1, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 8976003}, {"creator": "dtownsend@mozilla.com", "is_obsolete": 1, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 8976004}, {"creator": "dtownsend@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2018-05-23T13:18:19Z", "type_id": 4, "creation_date": "2018-05-22T16:13:47Z", "id": 1760055, "setter": "nfroyd@mozilla.com"}], "content_type": "text/x-review-board-request", "id": 8979391}, {"creator": "dtownsend@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2018-05-30T20:13:05Z", "type_id": 4, "creation_date": "2018-05-22T16:13:47Z", "id": 1760056, "setter": "nfroyd@mozilla.com"}], "content_type": "text/x-review-board-request", "id": 8979639}, {"creator": "dtownsend@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 8980016}, {"creator": "dtownsend@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 8980017}, {"creator": "dtownsend@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 8980018}, {"creator": "dtownsend@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 8980019}], "votes": 0, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 88, "comments": [{"text": "", "author": "dtownsend@mozilla.com", "id": 13222120, "time": "2018-04-20T18:05:42Z"}, {"text": "Created attachment 8969760\nBug 1455707: Add UI allowing the user to choose what to do when a downgrade is detected.\n\nReview commit: https://reviewboard.mozilla.org/r/238568/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/238568/", "author": "dtownsend@mozilla.com", "id": 13222232, "time": "2018-04-20T18:51:53Z"}, {"text": "Created attachment 8969761\nScreenshot\n\nThis is a screenshot of the current implementation. It triggers whenever an older version (including build ID) is run with the selected profile. What are your thoughts on this?", "author": "dtownsend@mozilla.com", "id": 13222236, "time": "2018-04-20T18:53:26Z"}, {"text": "I am fine with this as a starting point.  Do we need to gather metrics?  I'm also very interested in pdol's opinion on whether \"subtly corrupt my profile\" is an ok option, or whether we'd like to replace that with \"create a new profile\" or \"start profile manager\" or both.", "author": "joe-bugzilla@cursive.net", "id": 13222311, "time": "2018-04-20T19:39:39Z"}, {"text": "I think I can give us some metrics with a little more work. Counting the case where the user quits is a little tricky!", "author": "dtownsend@mozilla.com", "id": 13222326, "time": "2018-04-20T19:45:47Z"}, {"text": "I'm more interested in counting the case where the users says \"I don't care if my browser is corrupted.\"  There's an argument that if we let them take that choice, some of their other telemetry on stability (e.g.) is suspect.", "author": "joe-bugzilla@cursive.net", "id": 13222333, "time": "2018-04-20T19:49:03Z"}, {"text": "(In reply to Joe Hildebrand  [:hildjj] (UTC-6) from comment #5)\n> I'm more interested in counting the case where the users says \"I don't care\n> if my browser is corrupted.\"  There's an argument that if we let them take\n> that choice, some of their other telemetry on stability (e.g.) is suspect.\n\nThat's true. I was mostly thinking that without instrumenting the other case we wouldn't know relative numbers.", "author": "dtownsend@mozilla.com", "id": 13222376, "time": "2018-04-20T20:00:52Z"}, {"text": "Saptarshi, could you please help understand how frequently users would see this?\nIt's somehow similar to the analysis you did on profile switching although this now ignores whether you're a cross profile user:\n- How many unique profiles (regardless of the channel used) are used on an older Firefox version when compared to the previous session daily?\n\nThis previous analysis done by Benjamin showed 2.19% of users reverting to an older version while staying on the release channel. Is this still up to date and indeed reflective of how frequently this prompt would be see by users?\nhttps://gist.github.com/bsmedberg/1af70857106bfe29128a0e8d0b656804", "author": "rtestard@mozilla.com", "id": 13226375, "time": "2018-04-23T13:01:06Z"}, {"text": "(In reply to Dave Townsend [:mossop] from comment #2)\n> Created attachment 8969761\n> Screenshot\n> \n> This is a screenshot of the current implementation. It triggers whenever an\n> older version (including build ID) is run with the selected profile. What\n> are your thoughts on this?\n\nMy thoughts:\n- New profile creation and profile manager are likely too complicated concepts for average users to make informed decisions. Hitting \"Create a new profile\" would effectively hide the user data from himself without an easy way to recover. I NI Bram here who we discussed these concepts with before to see if he has thoughts on the UX.\n- How harder would it be for the \"Quit\" button to be \"Quit and instead run most up to date Firefox\"?\n- I agree Telemetry would be valuable. It would have to be run on release since Beta data would be likely non representative\n- Per previous data we had on cross channel usage where most downgrades occured for ESR users, I'd assume this feature would be would be most frequently used on the next ESR", "author": "rtestard@mozilla.com", "id": 13226480, "time": "2018-04-23T13:52:38Z"}, {"text": "(In reply to Romain Testard [:RT] from comment #8)\n> - How harder would it be for the \"Quit\" button to be \"Quit and instead run\n> most up to date Firefox\"?\n\n\"Most up to date\" is very difficult, we don't have a definitive list on the machine for all the installed Firefoxes and their versions. What we can do though is offer to launch with the last install that ran this profile (assuming it's not the current instance already and it still exists on disk).", "author": "dtownsend@mozilla.com", "id": 13226829, "time": "2018-04-23T15:48:50Z"}, {"text": "I've confirmed that we have a path for recording telemetry data from this UI. It's a bit more complex than normal since we always restart the app after showing this UI but it is doable.\n\nWhat questions about this UI do we want to answer with data here? Some thoughts:\n\nWhat percentage of startups see this UI?\nWhat percentage of displays result in a click on Quit and on Continue?", "author": "dtownsend@mozilla.com", "id": 13227241, "time": "2018-04-23T17:58:30Z"}, {"text": "My initial reaction, seeing the screenshot, is for a given release profile\n- inspect the times series of appBuildID contained in their Unified telemetry profile\n- sort by calendar date\n- see if any of the appbuildids are \"out of order\" i.e. goes back in time (substr(appbuildid,1,8) is YYYYMMDD) which would correspond to someone getting that prompt\n\nDoes that make sense?", "author": "sguha@mozilla.com", "id": 13227374, "time": "2018-04-23T18:43:14Z"}, {"text": "(In reply to \"Saptarshi Guha[:joy]\" from comment #11)\n> My initial reaction, seeing the screenshot, is for a given release profile\n> - inspect the times series of appBuildID contained in their Unified\n> telemetry profile\n> - sort by calendar date\n> - see if any of the appbuildids are \"out of order\" i.e. goes back in time\n> (substr(appbuildid,1,8) is YYYYMMDD) which would correspond to someone\n> getting that prompt\n> \n> Does that make sense?\n\nI don't know if that might have some false positives because we compare both the version and build ID, so: 59.0_20180404 -> 60.0a1_20180303 would be considered an upgrade as the version number increased but your proposal considers it a downgrade based on the build ID.", "author": "dtownsend@mozilla.com", "id": 13227401, "time": "2018-04-23T18:53:19Z"}, {"text": "good point. Sort \n\n- inspect the times series of appBuildID contained in their Unified telemetry profile\n- sort by calendar date and version major\n- within version major, see if any of the appbuildids are \"out of order\" i.e. goes back in time (substr(appbuildid,1,8) is YYYYMMDD) which would correspond to someone getting that prompt\n\nThough is downgrading within a major version a case for the above prompt? if not, and we only want to consider downgrading a major version the above would change to\n\n- inspect the times series of appBuildID contained in their Unified telemetry profile\n- sort by calendar date \n- see if major versions are out of order", "author": "sguha@mozilla.com", "id": 13227442, "time": "2018-04-23T19:07:50Z"}, {"text": "(In reply to \"Saptarshi Guha[:joy]\" from comment #13)\n> good point. Sort \n> \n> - inspect the times series of appBuildID contained in their Unified\n> telemetry profile\n> - sort by calendar date and version major\n> - within version major, see if any of the appbuildids are \"out of order\"\n> i.e. goes back in time (substr(appbuildid,1,8) is YYYYMMDD) which would\n> correspond to someone getting that prompt\n\nIf I'm reading this right it will only catch build-id downgrades within a major version (what does major version mean here?)\n\nSo would this count as a downgrade?\n\n60.0 20180404\n59.0 20180405\n60.0 20180406\n\n> Though is downgrading within a major version a case for the above prompt?\n\nYes the UI will show if the version (61.0a1 f.e.) remains the same but the build id drops.\n\n> if not, and we only want to consider downgrading a major version the\n> above would change to\n>\n> - inspect the times series of appBuildID contained in their Unified\n> telemetry profile\n> - sort by calendar date \n> - see if major versions are out of order\n\nDo we happen to have an implementation of the toolkit version comparison code in a place that telemetry can use it? What the code is actually doing is building a version number as <version>_<buildid> for the previous build to run against the profile and the current build, then doing a version comparison based on that. If the last build is newer by that metric then we show the UI. If we can just do that in the same way in telemetry then it should give a perfect comparison.", "author": "dtownsend@mozilla.com", "id": 13227569, "time": "2018-04-23T19:49:25Z"}, {"text": "(In reply to Dave Townsend [:mossop] from comment #14)\n> (In reply to \"Saptarshi Guha[:joy]\" from comment #13)\n> > good point. Sort \n> > \n> > - inspect the times series of appBuildID contained in their Unified\n> > telemetry profile\n> > - sort by calendar date and version major\n> > - within version major, see if any of the appbuildids are \"out of order\"\n> > i.e. goes back in time (substr(appbuildid,1,8) is YYYYMMDD) which would\n> > correspond to someone getting that prompt\n> \n> If I'm reading this right it will only catch build-id downgrades within a\n> major version (what does major version mean here?)\n> \n\nmajor is the prefix before the decimal i.e. 60.0 -> 60\n\n> So would this count as a downgrade?\n> \n> 60.0 20180404\n> 59.0 20180405\n> 60.0 20180406\n> \n\nit depends on whether your example is sorted by calendar\nassuming you have\n\n201800501 60.0 20180404\n201800502 59.0 20180405\n201800502 60.0 20180406\n\nthen sorting by calendar and version produces\n\n201800501 60.0 20180404\n201800502 59.0 20180405\n201800502 60.0 20180406\n\nthen this is a downgrade because it went from 60 -> 59\n\ndowngrades, as i'm understanding it is \n\nthe profile went to an older version e.g. 60.* -> 59.* or 60.x to 60.y where y was 60.y was released *before* 60.x.\nI am assuming this prompt is shown iff these conditions occur.\n\n\n> Do we happen to have an implementation of the toolkit version comparison\n> code in a place that telemetry can use it? What the code is actually doing\n> is building a version number as <version>_<buildid> for the previous build\n> to run against the profile and the current build, then doing a version\n> comparison based on that. If the last build is newer by that metric then we\n> show the UI. If we can just do that in the same way in telemetry then it\n> should give a perfect comparison.\n\n\nThis would be perfect. Who ever does the analysis can just implement the same logic used by the UI prompt uses\nbypassing the need of me trying to infer the logic above!", "author": "sguha@mozilla.com", "id": 13227617, "time": "2018-04-23T20:03:41Z"}, {"text": "(In reply to \"Saptarshi Guha[:joy]\" from comment #15)\n> (In reply to Dave Townsend [:mossop] from comment #14)\n> > (In reply to \"Saptarshi Guha[:joy]\" from comment #13)\n> > > good point. Sort \n> > > \n> > > - inspect the times series of appBuildID contained in their Unified\n> > > telemetry profile\n> > > - sort by calendar date and version major\n> > > - within version major, see if any of the appbuildids are \"out of order\"\n> > > i.e. goes back in time (substr(appbuildid,1,8) is YYYYMMDD) which would\n> > > correspond to someone getting that prompt\n> > \n> > If I'm reading this right it will only catch build-id downgrades within a\n> > major version (what does major version mean here?)\n> > \n> \n> major is the prefix before the decimal i.e. 60.0 -> 60\n\nDo we need to see cases where someone goes from 60.0 -> 60.0a1?\n\n> > Do we happen to have an implementation of the toolkit version comparison\n> > code in a place that telemetry can use it? What the code is actually doing\n> > is building a version number as <version>_<buildid> for the previous build\n> > to run against the profile and the current build, then doing a version\n> > comparison based on that. If the last build is newer by that metric then we\n> > show the UI. If we can just do that in the same way in telemetry then it\n> > should give a perfect comparison.\n> \n> \n> This would be perfect. Who ever does the analysis can just implement the\n> same logic used by the UI prompt uses\n> bypassing the need of me trying to infer the logic above!\n\nI'm not sure I follow, is this a yes or a no?", "author": "dtownsend@mozilla.com", "id": 13233602, "time": "2018-04-25T20:14:22Z"}, {"text": "Im asking if there exists code in place that determines when to show the UI and can this be replicated using the Unified Telemetry variables. If such a code exists, i can confirm whether this can be implemented using the telemetry data.\n\nIf such code exists, then we wont need to create the logic im trying to describe above.", "author": "sguha@mozilla.com", "id": 13233780, "time": "2018-04-25T21:22:26Z"}, {"text": "(In reply to \"Saptarshi Guha[:joy]\" from comment #17)\n> Im asking if there exists code in place that determines when to show the UI\n> and can this be replicated using the Unified Telemetry variables. If such a\n> code exists, i can confirm whether this can be implemented using the\n> telemetry data.\n> \n> If such code exists, then we wont need to create the logic im trying to\n> describe above.\n\nRight, and I was asking if the toolkit version comparison code has been implemented in whatever we use to get telemetry data, this thing: https://developer.mozilla.org/en-US/docs/Mozilla/Toolkit_version_format", "author": "dtownsend@mozilla.com", "id": 13233835, "time": "2018-04-25T21:42:52Z"}, {"text": "I see, not that i'm aware of. Rather than trying to implement this, do we have python code available? \nI'm hoping it will have a function that can order two versions.", "author": "sguha@mozilla.com", "id": 13233853, "time": "2018-04-25T21:48:53Z"}, {"text": "(In reply to \"Saptarshi Guha[:joy]\" from comment #19)\n> I see, not that i'm aware of. Rather than trying to implement this, do we\n> have python code available? \n> I'm hoping it will have a function that can order two versions.\n\nHow about this: https://github.com/kmaglione/amo-validator/blob/master/validator/version.py", "author": "dtownsend@mozilla.com", "id": 13233876, "time": "2018-04-25T21:57:30Z"}, {"text": "Yes this looks good.", "author": "sguha@mozilla.com", "id": 13233931, "time": "2018-04-25T22:20:48Z"}, {"text": "Created attachment 8971323\nScreenshot for launch previous\n\nThis is what it looks like when we detect that the previous Firefox to run with this profile is different to the current one and still exists on disk. Look ok?", "author": "dtownsend@mozilla.com", "id": 13236106, "time": "2018-04-26T17:20:44Z"}, {"text": "Comment on attachment 8969760\nBug 1455707: Add UI allowing the user to choose what to do when a downgrade is detected.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/238568/diff/1-2/", "author": "dtownsend@mozilla.com", "id": 13236190, "time": "2018-04-26T17:46:59Z"}, {"text": "Removing my NI - I'll defer to :rtestard", "author": "pdolanjski@mozilla.com", "id": 13236941, "time": "2018-04-26T22:06:13Z"}, {"text": "(In reply to Peter Dolanjski [:pdol] from comment #24)\n> Removing my NI - I'll defer to :rtestard\n\nLooks like Romain is on PTO till May 9th and we'd like to get something moving before then. Specific questions I'm looking to get answered:\n\n* Should we proceed with this at all?\n* Should we be offering a way to continue anyway (may cause profile corruption)?\n* Should we offer a way to create a new profile or launch the profile manager instead?", "author": "dtownsend@mozilla.com", "id": 13243804, "time": "2018-04-30T17:45:01Z"}, {"text": "Sorry for the late response to the NI, as I was away on a user research trip.\n\nTL;DR\n\n* If we know that starting a profile on an older build doesn\u2019t cause too much brokenness, or has relatively low risk, then we don\u2019t need to show a UI.\n* If we know that it can potentially cause a lot of problem, then show the UI, but which action should be the default? See below.\n\n\n\nFrom my very limited (but daily) experience of running Nightly and release using the same profile, it seems as if opening a profile in an older version of Firefox doesn\u2019t cause any brokenness. All my data and settings remained intact so far.\n\nThis is an experience mirrored by Verdi, quoted below:\n\n> \u2026I've done that kind of thing all the time for years on both Windows and Mac and have never run into an issue from what I can tell.\n\nIf we assume that both of our experiences are \u2013 in some ways \u2013 representative of the experiences of many other users who like to switch versions, we wonder: assuming we show a notification UI, then of all the users who would see that notification, how many of them would actually run into an issue?\n\nIf there aren\u2019t many, then we don\u2019t need to have a UI. Because whatever option they pick in that UI, they will probably not run into any issue.\n\n\n\nOk. Now let\u2019s assume that corrupted profiles is a real risk for us, so we want to show the UI to be absolutely safe. Which option do we want to highlight as a recommended path for most users to take?\n\n* Run the newer version of Firefox, or\n* Run the older version, understanding that there may be risk involved?\n\n\n\nQuoting Verdi again:\n\n> I'm trying to think of the big cases where this would happen outside of Mozillians switching between Nightly and Release.\n> \n> It would happen if you try out beta and switch back to release (maybe the largest group?).\n> \n> It would happen if you use the same profile for dev-edition and release (though you\u2019d have to jump through a lot of hoops to make that happen).\n> \n> And I guess this happens if you are switching between ESR and release (maybe that's the one with the most potential for something to go wrong?)\n\n\nReading those scenarios, it seems that the largest potential group, other than users who run Nightly and Release, would be users who run Beta and want to switch back to Release \u2013\u00a0maybe because Beta had broken something. We can reasonably infer this fact, because beta has a significant number of users (second only to release). So the logic goes that some of our beta users must want to switch back to release, or have regretted their decision to run the Beta version.\n\nIn that case, if the dialogue UI is shown, then the preferred action to take should be \u201cRun the older version\u201d.\n\n\n\nBut instead of emphasising the risk and the things that could go wrong, I recommend changing our tone a bit to be more reassuring, and to provide a troubleshooting step should anything happens.\n\nFor example, it can be something like this (caveat: strawman message \u2013\u00a0feedback welcome):\n\n> Older version detected\n> \n> Your Firefox profile was previously used to run a newer version of Firefox, but the version you are trying to run is older.\n> \n> While there may be a risk of Firefox behaving unexpectedly if you run this version, Firefox Reset can help fix anything that may go wrong.\n> \n> [Quit and launch newer version] [Continue launching older (this) version]\n\n\n\nWhat do you think?", "author": "bram@mozilla.com", "id": 13248073, "time": "2018-05-02T09:05:31Z"}, {"text": "The main challenge here is that we (currently) don't know if a given downgrade will cause a problem. We know the recent indexed-db change caused problems, it made websites unable to save data which showed up, probably well after the user downgraded, as broken websites. I'm not convinced that users will remember at that point to try a profile reset. Additionally a profile reset may not work in this circumstance if, for example, we've significantly changed their bookmarks/history database.", "author": "dtownsend@mozilla.com", "id": 13249380, "time": "2018-05-02T16:21:06Z"}, {"text": "(In reply to \"Saptarshi Guha[:joy]\" from comment #21)\n> Yes this looks good.\n\nIs there anything further you need from me to do the analysis from comment 7?", "author": "dtownsend@mozilla.com", "id": 13249387, "time": "2018-05-02T16:23:45Z"}, {"text": "(In reply to Dave Townsend [:mossop] from comment #27)\n> [\u2026] We know the recent indexed-db change caused\n> problems, it made websites unable to save data which showed up, probably\n> well after the user downgraded, as broken websites.\n\nThis sounds like a big problem. Based on this data, maybe we should offer the UI, and have the least potentially destructive choice \u2013\u00a0\u201cRun newer version\u201d \u2013\u00a0as a preferred/highlighted option.", "author": "bram@mozilla.com", "id": 13251061, "time": "2018-05-03T02:01:13Z"}, {"text": "(In reply to Dave Townsend [:mossop] from comment #28)\n> (In reply to \"Saptarshi Guha[:joy]\" from comment #21)\n> > Yes this looks good.\n> \n> Is there anything further you need from me to do the analysis from comment 7?\n\n\n- There were 824,858,600 release profiles active between 2017-11-14 and 2018-04-01(nearly 6 months)\n- of which there were 581,145,700 profiles who were active for more than one day (70.454%)\n    - of these, 29,939,300 profiles were seen on an older version compared to the version observed on their previous day of use (5.152% )\n    - for the profiles who did \u2018downgrade\u2019, the average number of times we saw this happen is 2.665 (75% percentile is 2)\n\n\nCode: https://metrics.mozilla.com/protected/sguha/version_switch.html (behind lDAP but i can keep it on my personal website if you would like this public).", "author": "sguha@mozilla.com", "id": 13255360, "time": "2018-05-04T18:02:56Z"}, {"text": "I'm now back from leave, apologies for the delay here.\nMy recollection of the thread:\n- A significant share of users downgrade. We cannot predict the impact of downgrades but the impact can be bad enough that we want to warn users.\n- We know from previous analysis that most downgrades happen between ESR and release (*see below). Given the proposed UI would be displayed on the older version, this allows testing at lower scale until the next ESR hits release in 1 year.\n- We technically can offer the option to launch the last install that ran this profile\n- We can collect telemetry to address the following questions:\n---What percentage of startups see this UI?\n---What percentage of displays result in a click on Quit and on Continue?\n---What is the impact on retention of the UI?\n- The least destructive UI seems to be:\n> Older version detected\n> \n> Your Firefox profile was previously used to run a newer version of Firefox, but the version you are trying to run is older.\n> \n> While there may be a risk of Firefox behaving unexpectedly if you run this version, Firefox Reset can help fix anything that may go wrong.\n> \n> [Quit and launch newer version](referred/highlighted option) [Continue launching older (this) version]\nFirefox reset is although hard to find and may be not useful at all. I think it also makes the message hard to read and I feel like not confusing users with Firefox reset will get more of them to select the default provided option. I would propose the following variation based on this:\n\n> Older version detected\n> \n> Your Firefox profile was previously used to run a newer version of Firefox, but the version you are trying to run is older.\n> \n> There may be a risk of Firefox behaving unexpectedly if you run this version.\n> \n> [Quit and launch newer version](referred/highlighted option) [Continue launching older (this) version]\n\nI updated the user story field accordingly.\n\nBram - what do you think?\n\n*Data Saptarshi shared before on profile switching between channels:\n- 17.34% of Nightly profiles switch\n- 3.28% of Beta profiles switch\n- 2.24% of ESR profiles switch\n- 0.36% of release profiles switch\nFor example, 17.34% of nightly users switched greater than 3 times (e.g. nightly -> release -> nightly -> release) in a 60 day period. A profile is nightly if it ever was on nightly during that 60 day period.\nGiven relative user numbers on different channels, ESR users are the largest switchers", "author": "rtestard@mozilla.com", "id": 13265339, "time": "2018-05-09T13:52:50Z"}, {"text": "My initial thought is that your proposed solution looks good.\n\nHowever, I will NI Michelle for advise on wording, since mine may run too long.\n\n---\n\nMichelle, here\u2019s our background story of why we needed your team\u2019s help:\n\nWhen you install a different Firefox product\u00a0(Nightly, Beta or ESR), that product doesn\u2019t always create a fresh new profile for you. As a result, two or more products can all share the same profile.\n\nThe problem: when you run a product with a newer version number, your profile will be \u201cupgraded\u201d. Once \u201cupgraded\u201d, running the same profile in an older version may cause significant problems like altered bookmarks/history.\n\nOur users revert to older versions for many reasons. A lot of it is due to the fact that rolling back is a legitimate way to solve issues. Websites or features may work properly on an experimental version like Nightly. The solution? Revert to Release, where things are guaranteed to work.\n\nBecause altered bookmarks/history is a problem, we\u2019d like to warn our users who switch to an older version. We\u2019d like to say\u00a0\u201cIf you\u2019re rolling back to fix issue, be aware of the risk. If you\u2019re rolling back unintentionally, it\u2019s best to run the newest version.\n\nThis warning will appear before our users start the older version. At the moment, we\u2019ve come up with:\n\n> Title: Older version detected\n> \n> Your Firefox profile was previously used to run a newer version of Firefox, but the version you are trying to run is older.\n> \n> There may be a risk of Firefox behaving unexpectedly if you run this version.\n> \n> [Quit and launch newer version] -> highlighted    [Continue launching older (this) version]\n\nDoes this sound okay as a warning dialogue, and would you recommend a better, more accurate wording? We can afford to write a more technical explanation.\n\n---\n\nI will also CC Verdi on the issue because he\u2019s interested in seeing some numbers and may have some insights to offer. As expected, most of the use is to switch between Nightly and Release versions. However, I didn\u2019t expect switching more than 3 times. This may indicate the fact that some users continually run both versions deliberately\u00a0\u2013 for testing purposes?", "author": "bram@mozilla.com", "id": 13267250, "time": "2018-05-10T02:28:45Z"}, {"text": "@bram - what do you think of: \nTitle: You\u2019ve launched an older version of Firefox\n> \n> Your Firefox profile is designed to work with a newer version of Firefox, but you are about to use it with an older version. \nIf you use your profile with this older version, you may experience problems with Firefox and may not have full access to your bookmarks and browsing history. \n\n\n> [Cancel and launch newer version] -> highlighted    [Launch this version anyway]\n\nObviously we cant include a link to SUMO to learn more about how to safely downgrade b/c they don't have a browser open yet, but does it make sense to include a note that says: Search support.mozilla.org for more information on using older versions of Firefox safely", "author": "mheubusch@mozilla.com", "id": 13268339, "time": "2018-05-10T15:03:29Z"}, {"text": "The likelihood of having problems is not \"may\".  It's \"almost certainly\".  We need this restriction to be pretty adamant if we're going to depend on it going forward.  For example, when we change the storage mechanism for things in your profile, do we have to keep both versions around for multiple ESR releases?  How do we keep them in sync?  Which one do we read?\n\nThe only rational way to make forward progress on storage is to make it nearly-impossible (e.g. require a command line flag) to use a profile on an older version, and to use FxS to sync data that people really need in their new profile.", "author": "joe-bugzilla@cursive.net", "id": 13268913, "time": "2018-05-10T17:44:14Z"}, {"text": "(In reply to mheubusch from comment #33)\n> [\u2026] does it make sense to\n> include a note that says: Search support.mozilla.org for more information on\n> using older versions of Firefox safely\n\nThanks for your very quick reply, Michelle!\n\nAs far as I know, we don\u2019t have a SUMO article explaining this issue.\n\nBut if, as Joe wrote in comment #34,\n> The likelihood of having problems is not \"may\".  It's \"almost certainly\".\n\nThen we definitely want this article. And we want it to explain a few things:\n\n1. Why it\u2019s nearly impossible to run profile in an older version. There should be something here about version incompatibility.\n2. What happens if you choose to do so. No access to bookmarks and history, what else?\n3. How to solve the problem\n   * Export bookmarks, start new profile on older version, import bookmarks? But your history won\u2019t be restored.\n   * Use the command line if you really know what you\u2019re doing (not recommended)?\n\nJoe\u2019s comment also made me think that we want another option that will provide a \u201cclean\u201d way out, which is:\n> Launch this version using a new profile\n\nOr, even better:\n> Launch this version using a new profile (your bookmarks will be restored)\n\nEither way, our two options become:\n> [Cancel and launch newer version] -> highlighted   [Launch this version using a new profile]\n\nAnd if we still want to provide a way of doing the unsafe action, we can include it as a note:\n> Launching this version using your existing profile is possible but will almost certainly corrupt your bookmarks and history.\n\nWhat are your thoughts, Romain?", "author": "bram@mozilla.com", "id": 13273274, "time": "2018-05-13T22:46:23Z"}, {"text": "We also have sync as an option.  If you use FxS, bookmarks, history, open tabs, logins, addresses, credit cards, add-ons, and preferences can all be restored easily.\n\nHere is a list of all of the incompatibilities we know about as of 57: https://public.etherpad-mozilla.org/p/quota-manager-schema-change-log\n\nNote that there is at least one per version, that we don't have any process for keeping these from happening, and that the doc hasn't been updated since 57.", "author": "joe-bugzilla@cursive.net", "id": 13276079, "time": "2018-05-14T15:56:28Z"}, {"text": "(In reply to Romain Testard [:RT] from comment #31)\n> - We technically can offer the option to launch the last install that ran\n> this profile\n\nThis is not always the case. The previous install may no longer be present on the system or may have been overwritten with the current, older version. We can detect both those cases before offering this option to the user though.\n\n(In reply to Joe Hildebrand  [:hildjj] (UTC-6) from comment #34)\n> The likelihood of having problems is not \"may\".  It's \"almost certainly\".\n\nIn the case of a full version downgrade this is true. Currently though the patch shows the UI even for minor version downgrades or even a simple build ID change (meaning if you switch from one Nightly to the previous day's Nightly it will trigger). In these cases I think the likelihood is much lower, I would expect Nightly users switching around to be one of the main cases too. Do we want to show the UI in those cases and do we want it to have an easier bypass option in those cases? I'm a little worried that we'll really burn some nightly users with this as it stands.\n\n(In reply to Bram Pitoyo [:bram] from comment #35)\n> Either way, our two options become:\n> > [Cancel and launch newer version] -> highlighted   [Launch this version using a new profile]\n\nOne concern here is that if users are doing this switching frequently and keep launching with a new profile they could end up with a lot of unused profiles sitting around on their disk, and profiles can get quite large. We might need some kind of way to expire unused profiles in the future.", "author": "dtownsend@mozilla.com", "id": 13276493, "time": "2018-05-14T18:01:20Z"}, {"text": "(In reply to Dave Townsend [:mossop] from comment #37)\n> In the case of a full version downgrade this is true. Currently though the\n> patch shows the UI even for minor version downgrades or even a simple build\n> ID change (meaning if you switch from one Nightly to the previous day's\n> Nightly it will trigger). In these cases I think the likelihood is much\n> lower, I would expect Nightly users switching around to be one of the main\n> cases too. Do we want to show the UI in those cases and do we want it to\n> have an easier bypass option in those cases? I'm a little worried that we'll\n> really burn some nightly users with this as it stands.\n\nI'd be ok with having a command line option to force an overrides to this dialog. Firefox developers might want that when doing a bisect, for example.  Any Nightly user that might be switching back and forth will either welcome the warning (crud!  I launched the wrong binary!) or will know what they're doing enough to use the flag.\n\n> One concern here is that if users are doing this switching frequently and\n> keep launching with a new profile they could end up with a lot of unused\n> profiles sitting around on their disk, and profiles can get quite large. We\n> might need some kind of way to expire unused profiles in the future.\n\nPushing the user into the Profile Manager might make that more clear, as would ensuring that the total size of each profile was shown in the Profile Manager.", "author": "joe-bugzilla@cursive.net", "id": 13277261, "time": "2018-05-14T22:01:55Z"}, {"text": "Sounds like a solution is emerging: run the older version with a new profile, then sync it to restore data.\n\nIf that\u2019s the case, what if we do something like this?\n\n> Title: You\u2019ve launched an older version of Firefox\n>\n> To avoid problem accessing your bookmarks and browsing history, this version will start with a new profile.\n>\n> You can restore your bookmarks and browsing history by signing into Firefox Account and performing a sync.\n>\n> [Cancel and launch newer version] -> highlighted   [Launch this version using a new profile]\n\nThe older version can start with about:preferences#sync open in the first tab.\n\n\n(In reply to Dave Townsend [:mossop] from comment #37)\n> One concern here is that if users are doing this switching frequently and\n> keep launching with a new profile they could end up with a lot of unused\n> profiles sitting around on their disk, and profiles can get quite large.\n\nIs there a way for us to detect whether there is already a unique profile associated with that version of Firefox?\n\nIf the older version is already running a profile that\u2019s different from the one running in the newer version, then we don\u2019t need to show any warning dialogue.\n\nIf the older version doesn\u2019t have a unique profile yet, then show the warning.", "author": "bram@mozilla.com", "id": 13277747, "time": "2018-05-15T03:48:33Z"}, {"text": "(In reply to Bram Pitoyo [:bram] from comment #39)\n\n> If that\u2019s the case, what if we do something like this?\n> \n> > Title: You\u2019ve launched an older version of Firefox\n> >\n> > To avoid problem accessing your bookmarks and browsing history, this version will start with a new profile.\n> >\n> > You can restore your bookmarks and browsing history by signing into Firefox Account and performing a sync.\n> >\n> > [Cancel and launch newer version] -> highlighted   [Launch this version using a new profile]\n> \n> The older version can start with about:preferences#sync open in the first\n> tab.\n\nReally like that.", "author": "joe-bugzilla@cursive.net", "id": 13279481, "time": "2018-05-15T18:41:55Z"}, {"text": "Created attachment 8976003\nScreenshot with previous instance detected\n\nHere is the current implementation where a previous instance was detected and the profile we attempted to use was signed in to sync.", "author": "dtownsend@mozilla.com", "id": 13280248, "time": "2018-05-15T23:22:10Z"}, {"text": "Created attachment 8976004\nScreenshot with no previous instance\n\nHere is a shot where the previous instance is gone or overwritten and the existing profile was not signed in to sync.", "author": "dtownsend@mozilla.com", "id": 13280250, "time": "2018-05-15T23:23:00Z"}, {"text": "You'll note that I've sent the users to the profile manager rather than simply creating a new profile, it was somewhat easier and I think gives users more insight into what is going on.\n\n(In reply to Bram Pitoyo [:bram] from comment #39)\n> Is there a way for us to detect whether there is already a unique profile\n> associated with that version of Firefox?\n> \n> If the older version is already running a profile that\u2019s different from the\n> one running in the newer version, then we don\u2019t need to show any warning\n> dialogue.\n> \n> If the older version doesn\u2019t have a unique profile yet, then show the\n> warning.\n\nThis is challenging to implement but its something I want to do later as it is really part of a better solution.", "author": "dtownsend@mozilla.com", "id": 13280253, "time": "2018-05-15T23:24:26Z"}, {"text": "Comment 41:\n> attachment 8976003\n> Screenshot with previous instance detected\n\nThis looks great.\n\nWould it be possible to avoid doubling up the window title and copy heading?\n\nSecondly, let\u2019s amend the body copy. It will still explain the same thing, but stresses the safety of the procedure:\n\n> If you use your profile with this older version, you may experience problems with Firefox and may not have full access to your bookmarks and browsing history.\n>\n> To launch this version safely, open Profile Manager and choose a different profile. Afterwards, sign into Firefox Account and perform a sync to restore your bookmarks and browsing history.\n> \n> [Open Profile Manager]   [Exit and launch newer version]\n\n\nComment 43:\n> attachment 8976004\n> Screenshot with no previous instance\n\nEven in this situation, is it still a good idea to promote FxA Sync in the copy?\n\nIf not, we can keep the strings above and just cut the last sentence out.", "author": "bram@mozilla.com", "id": 13280435, "time": "2018-05-16T02:06:19Z"}, {"text": "(In reply to Bram Pitoyo [:bram] from comment #44)\n> Comment 41:\n> > attachment 8976003\n> > Screenshot with previous instance detected\n> \n> This looks great.\n> \n> Would it be possible to avoid doubling up the window title and copy heading?\n\nI need to investigate. So early in startup we're a little limited with what we can do but I think I can make it work.\n\n> Secondly, let\u2019s amend the body copy. It will still explain the same thing,\n> but stresses the safety of the procedure:\n> \n> > If you use your profile with this older version, you may experience problems with Firefox and may not have full access to your bookmarks and browsing history.\n> >\n> > To launch this version safely, open Profile Manager and choose a different profile. Afterwards, sign into Firefox Account and perform a sync to restore your bookmarks and browsing history.\n> > \n> > [Open Profile Manager]   [Exit and launch newer version]\n\nEasy enough!\n\n> Comment 43:\n> > attachment 8976004\n> > Screenshot with no previous instance\n> \n> Even in this situation, is it still a good idea to promote FxA Sync in the\n> copy?\n> \n> If not, we can keep the strings above and just cut the last sentence out.\n\nWe can promote sync but it doesn't get them their bookmarks and history back, so I'm not sure it's a good sell IMO. I'll do it without that for now.", "author": "dtownsend@mozilla.com", "id": 13280523, "time": "2018-05-16T03:58:58Z"}, {"text": "Sounds like a plan. At this point, the design is in a good place, and its most important goal have been reached: to get users where they want to go without losing data (FxA sync), and to default to the least destructive action (run newer version). Thank you, Dave!", "author": "bram@mozilla.com", "id": 13280534, "time": "2018-05-16T04:10:55Z"}, {"text": "Alex, can you please help clarify the share of our users on desktop who are signed into Sync? My understanding is that this share is marginal. This would imply that the majority of our users will see \n> > attachment 8976004 [details]\n\nAre we not missing the most frequent scenario that is \"a previous instance was detected and the profile we attempted to use was NOT signed in to sync\"? Options would be \"Cancel and launch newer version\" (default) and \"Launch profile manager\"\n\nI agree that \"Launch profile manager\" is not ideal as a fall-back given it's not very user friendly though it sounds better than what we currently offer to users. Given ESR/release switching is what drives most downgrades, we have until the next ESR to get this message right for most switching scenarios and telemetry is probably critical, here is what I think is valuable to collect along with this implementation:\n---What percentage of startups see each variation of the UI?\n---What is the version/channel distribution of users who see each variation of the UI?\n---What percentage of displays result in a click on each of the 2 options offered?\n---What is the impact on retention for users coming across each of the UIs?", "author": "rtestard@mozilla.com", "id": 13281245, "time": "2018-05-16T12:57:30Z"}, {"text": "(In reply to Romain Testard [:RT] from comment #47)\n> Are we not missing the most frequent scenario that is \"a previous instance\n> was detected and the profile we attempted to use was NOT signed in to sync\"?\n> Options would be \"Cancel and launch newer version\" (default) and \"Launch\n> profile manager\"\n\n\"Cancel and launch newer version\" doesn't always work.  I'm ok with having a third button in the unlikely event that the newer version still exists on their machine and that we can find it.", "author": "joe-bugzilla@cursive.net", "id": 13281477, "time": "2018-05-16T14:24:23Z"}, {"text": "(In reply to Romain Testard [:RT] from comment #47)\n> Alex, can you please help clarify the share of our users on desktop who are\n> signed into Sync? My understanding is that this share is marginal. This\n> would imply that the majority of our users will see \n> > > attachment 8976004\n> \n> Are we not missing the most frequent scenario that is \"a previous instance\n> was detected and the profile we attempted to use was NOT signed in to sync\"?\n> Options would be \"Cancel and launch newer version\" (default) and \"Launch\n> profile manager\"\n\nYeah, this is supported now, I just didn't do a screenshot of it.\n\n> I agree that \"Launch profile manager\" is not ideal as a fall-back given it's\n> not very user friendly though it sounds better than what we currently offer\n> to users. Given ESR/release switching is what drives most downgrades, we\n> have until the next ESR to get this message right for most switching\n> scenarios and telemetry is probably critical, here is what I think is\n> valuable to collect along with this implementation:\n> ---What percentage of startups see each variation of the UI?\n> ---What is the version/channel distribution of users who see each variation\n> of the UI?\n> ---What percentage of displays result in a click on each of the 2 options\n> offered?\n> ---What is the impact on retention for users coming across each of the UIs?\n\nI'll get working on telemetry next.", "author": "dtownsend@mozilla.com", "id": 13281676, "time": "2018-05-16T15:14:37Z"}, {"text": "Bram, the UI currently has a window-level close button. At the moment it launches the profile manager but that doesn't seem right to me. Should it just cancel launching anything?", "author": "dtownsend@mozilla.com", "id": 13281682, "time": "2018-05-16T15:16:10Z"}, {"text": "(In reply to Romain Testard [:RT] from comment #47)\n> Given ESR/release switching is what drives most downgrades, we\n> have until the next ESR to get this message right for most switching\n> scenarios and telemetry is probably critical, here is what I think is\n> valuable to collect along with this implementation:\n> ---What percentage of startups see each variation of the UI?\n> ---What is the version/channel distribution of users who see each variation\n> of the UI?\n> ---What percentage of displays result in a click on each of the 2 options\n> offered?\n> ---What is the impact on retention for users coming across each of the UIs?\n\nSome of the telemetry might be more difficult than others (since we won't finish starting up the bad version, and we can't count on the good version having hooks to report any hints we leave behind).  Can we look at gathering the easy stuff first, so we have a shot of getting this landed more quickly?", "author": "joe-bugzilla@cursive.net", "id": 13282541, "time": "2018-05-16T19:55:12Z"}, {"text": "(In reply to Dave Townsend [:mossop] from comment #50)\n> Bram, the UI currently has a window-level close button. At the moment it\n> launches the profile manager but that doesn't seem right to me. Should it\n> just cancel launching anything?\n\nYes. The window-level close button should close everything. It shouldn\u2019t launch the profile manager or the newer version of Firefox.", "author": "bram@mozilla.com", "id": 13283505, "time": "2018-05-17T04:20:21Z"}, {"text": "(In reply to Joe Hildebrand  [:hildjj] (UTC-6) from comment #51)\n> (In reply to Romain Testard [:RT] from comment #47)\n> > Given ESR/release switching is what drives most downgrades, we\n> > have until the next ESR to get this message right for most switching\n> > scenarios and telemetry is probably critical, here is what I think is\n> > valuable to collect along with this implementation:\n> > ---What percentage of startups see each variation of the UI?\n> > ---What is the version/channel distribution of users who see each variation\n> > of the UI?\n> > ---What percentage of displays result in a click on each of the 2 options\n> > offered?\n> > ---What is the impact on retention for users coming across each of the UIs?\n> \n> Some of the telemetry might be more difficult than others (since we won't\n> finish starting up the bad version, and we can't count on the good version\n> having hooks to report any hints we leave behind).  Can we look at gathering\n> the easy stuff first, so we have a shot of getting this landed more quickly?\n\nSure, that makes sense.\nI summarized where I think we are now in the user story field. Dave, do you have all you need?\nPlease clarify if this would make it to 62 or 63 and I'll follow-up with EPM for tracking and PI for testing accordingly.\nBram, is the copy I summarized in the US field final?", "author": "rtestard@mozilla.com", "id": 13284112, "time": "2018-05-17T11:53:28Z"}, {"text": "I have what I need and would expect to be able to get this landed for 62 assuming QA has the ability to sign-off for that version. Going to talk to the telemetry folks to understand what is straightforward to collect first.\n\nOne addition to the story: After opening a new profile from the profile manager we can show the sync preferences if that is desirable.", "author": "dtownsend@mozilla.com", "id": 13284807, "time": "2018-05-17T16:00:18Z"}, {"text": "(In reply to Dave Townsend [:mossop] from comment #54)\n> I have what I need and would expect to be able to get this landed for 62\n> assuming QA has the ability to sign-off for that version. \n\nI'll send a PI request and get this on the program management Trello board for 62 since it's best to get it early on their radar even if they cannot start testing now.\nGoing to talk to\n> the telemetry folks to understand what is straightforward to collect first.\n> \n> One addition to the story: After opening a new profile from the profile\n> manager we can show the sync preferences if that is desirable.\nI like the idea of making it easier to sign into Sync for scenarios 2 and 4 of the user story.\nHow about using the current firstrunpage (new profiles currently open https://mozilla.org/firefox/60.0.1/firstrun) that is a more user friendly way to get users to sign into sync?", "author": "rtestard@mozilla.com", "id": 13286621, "time": "2018-05-18T09:29:38Z"}, {"text": "> ---What is the version/channel distribution of users who see each variation of the UI?\n\nIs this the version/channel of the Firefox they are attempting to launch? That is easy. Getting the version/channel that previously ran the profile is very difficult and impossible in the case that it has been uninstalled/overwritten.", "author": "dtownsend@mozilla.com", "id": 13288467, "time": "2018-05-18T22:07:23Z"}, {"text": "(In reply to Dave Townsend [:mossop] from comment #56)\n> > ---What is the version/channel distribution of users who see each variation of the UI?\n> \n> Is this the version/channel of the Firefox they are attempting to launch?\n> That is easy. Getting the version/channel that previously ran the profile is\n> very difficult and impossible in the case that it has been\n> uninstalled/overwritten.\n\nI was mostly thinking about the version/channel of the Firefox they are attempting to launch to categorize ESR users (likely switching from release, likely an enterprise user) VS Release users (likely switching from a pre-release build, likely someone who'd find it easier to use the profile manager) to understand if behaviors are different based on why you switch versions.\n\nIf collecting the newer version/channel as well is possible in the scenario where it was not uninstalled/overwritten it sounds like it could give us further insights and your comment also makes me think that quantifying the scenario where the newer build was uninstalled/overwritten would be valuable (technical issue troubleshooting).\n\nHow about changing this to:\n---What is the version/channel distribution of the Firefox being launched for each variation of the UI?\n---What is the version/channel distribution of the Firefox that previously ran the profile (version and channel being marked as null in case it was uninstalled/overwritten) for each variation of the UI?", "author": "rtestard@mozilla.com", "id": 13294245, "time": "2018-05-21T15:04:18Z"}, {"text": "(In reply to Romain Testard [:RT] from comment #57)\n> (In reply to Dave Townsend [:mossop] from comment #56)\n> > > ---What is the version/channel distribution of users who see each variation of the UI?\n> > \n> > Is this the version/channel of the Firefox they are attempting to launch?\n> > That is easy. Getting the version/channel that previously ran the profile is\n> > very difficult and impossible in the case that it has been\n> > uninstalled/overwritten.\n> \n> I was mostly thinking about the version/channel of the Firefox they are\n> attempting to launch to categorize ESR users (likely switching from release,\n> likely an enterprise user) VS Release users (likely switching from a\n> pre-release build, likely someone who'd find it easier to use the profile\n> manager) to understand if behaviors are different based on why you switch\n> versions.\n> \n> If collecting the newer version/channel as well is possible in the scenario\n> where it was not uninstalled/overwritten it sounds like it could give us\n> further insights and your comment also makes me think that quantifying the\n> scenario where the newer build was uninstalled/overwritten would be valuable\n> (technical issue troubleshooting).\n> \n> How about changing this to:\n> ---What is the version/channel distribution of the Firefox being launched\n> for each variation of the UI?\n> ---What is the version/channel distribution of the Firefox that previously\n> ran the profile (version and channel being marked as null in case it was\n> uninstalled/overwritten) for each variation of the UI?\n\nI can get the version string easily enough, the channel is very difficult so I'm going to put together the patch without that for now. We can often infer the channel from the version number.", "author": "dtownsend@mozilla.com", "id": 13294323, "time": "2018-05-21T15:33:51Z"}, {"text": "Created attachment 8979391\nBug 1455707: Remove CanShowProfileManager().\n\nReview commit: https://reviewboard.mozilla.org/r/245550/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/245550/", "author": "dtownsend@mozilla.com", "id": 13295209, "time": "2018-05-21T21:46:48Z"}, {"text": "Comment on attachment 8969760\nBug 1455707: Add UI allowing the user to choose what to do when a downgrade is detected.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/238568/diff/2-3/", "author": "dtownsend@mozilla.com", "id": 13295210, "time": "2018-05-21T21:46:48Z"}, {"text": "Created attachment 8979639\nBug 1455707: Detect when running an older version than previously ran with the selected profile.\n\nUse the information in compatibility.ini to detect that the current running\napplication is an older version than previously ran with the profile and in\nthat cause open a UI allowing the user to launch the profile manager, launch\nthe previous instance of the application or quit.\n\nReview commit: https://reviewboard.mozilla.org/r/245776/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/245776/", "author": "dtownsend@mozilla.com", "id": 13297059, "time": "2018-05-22T16:11:54Z"}, {"text": "Comment on attachment 8969760\nBug 1455707: Add UI allowing the user to choose what to do when a downgrade is detected.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/238568/diff/3-4/", "author": "dtownsend@mozilla.com", "id": 13297060, "time": "2018-05-22T16:11:54Z"}, {"text": "Comment on attachment 8969760\nBug 1455707: Add UI allowing the user to choose what to do when a downgrade is detected.\n\nhttps://reviewboard.mozilla.org/r/238568/#review252084\n\nClearing review because I think it'd be easier if we could just use the prompt service. Does that not work? If it did, all the logic could be in one place (the C++) and we wouldn't need custom styling and a bunch of MOZ_BUILD_APP goop to make all the pieces fit together - I didn't see a note in the bug when skimming through it to indicate you'd tried this and it didn't work for some reason; apologies if I missed it...\n\nIn case we do need to stick with this approach, some review comments follow...\n\n::: toolkit/profile/content/profileDowngrade.js:5\n(Diff revision 4)\n> +/* This Source Code Form is subject to the terms of the Mozilla Public\n> + * License, v. 2.0. If a copy of the MPL was not distributed with this\n> + * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n> +\n> +let params;\n\nNit: prefix to indicate this is a global (gParams?) please.\n\n::: toolkit/profile/content/profileDowngrade.js:8\n(Diff revision 4)\n> +  params = window.arguments[0].QueryInterface(Ci.nsIDialogParamBlock);\n> +  let hasSync = params.GetInt(0) == 1;\n> +  let hasBinary = params.GetInt(1) == 1;\n\nWhile it's obvious to me reading the rest of the commits on this bug, for posterity it's probably a good idea to add a few lines of comment here indicating what's going on. The C++ code passes an nsIDialogParamBlock, the first 2 values contain input and the third is used as output by this dialog to tell compiled code what to do when the dialog closes.\n\n::: toolkit/profile/content/profileDowngrade.js:17\n(Diff revision 4)\n> +  // By default cancel if the user clicks the window close button\n> +  params.SetInt(2, 0);\n> +\n> +  let button = document.getElementById(hasBinary ? \"launchLast\" : \"cancel\");\n> +  button.hidden = false;\n> +  button.setAttribute(\"default\", \"true\");\n\nNot being in a position to try this out myself, I'm a little concerned about how this works with keyboard access. Convention is that [return] accepts the default action on the dialog on macOS, and on all other platforms activates the focused button (I think), whereas [esc] should \"cancel\" the dialog on all platforms.\n\nSo making a cancel button the default may be confusing... and I don't see any handling for [esc] (or [return]).\n\nThinking about this more generally, is it not possible to use the prompt service this early in startup, or something? Its `confirmEx` helper should allow you to pick arbitrary strings for the buttons and pass a message, and would probably make things more straightforward in that you wouldn't need custom styling or manual passing of results...\n\n::: toolkit/profile/content/profileDowngrade.xul:20\n(Diff revision 4)\n> +<!ENTITY % profileDTD SYSTEM \"chrome://mozapps/locale/profile/profileDowngrade.dtd\">\n> +%profileDTD;\n> +]>\n> +\n> +<window xmlns=\"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul\"\n> +        title=\"&window.title;\" onload=\"init()\" style=\"&window.style;\">\n\nCan we avoid the localized-width hack in this case, and use `sizeToContent()` instead?\n\n::: toolkit/themes/shared/profileDowngrade.css:6\n(Diff revision 4)\n> +/* This Source Code Form is subject to the terms of the Mozilla Public\n> + * License, v. 2.0. If a copy of the MPL was not distributed with this\n> + * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n> +\n> +window {\n> +  padding: 14px;\n\nShould this be in em?\n\n::: toolkit/themes/shared/profileDowngrade.css:7\n(Diff revision 4)\n> + * License, v. 2.0. If a copy of the MPL was not distributed with this\n> + * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n> +\n> +window {\n> +  padding: 14px;\n> +  font: menu;\n\nThis is an interesting choice for what I assume just needs to be body text for the window. I think we generally use message-box for text, and sometimes (e.g. https://dxr.mozilla.org/mozilla-central/source/toolkit/themes/windows/global/dialog.css#23 ) menu for buttons (!?). Could we avoid this bit of styling by using <dialog> instead of <window> (which might simplify some other stuff anyway)?", "author": "gijskruitbosch+bugs@gmail.com", "id": 13298860, "time": "2018-05-23T09:21:18Z"}, {"text": "Comment on attachment 8979391\nBug 1455707: Remove CanShowProfileManager().\n\nhttps://reviewboard.mozilla.org/r/245550/#review252180\n\nMakes sense.", "author": "nfroyd@mozilla.com", "id": 13299316, "time": "2018-05-23T13:18:19Z"}, {"text": "Comment on attachment 8969760\nBug 1455707: Add UI allowing the user to choose what to do when a downgrade is detected.\n\nhttps://reviewboard.mozilla.org/r/238568/#review252084\n\n> Can we avoid the localized-width hack in this case, and use `sizeToContent()` instead?\n\nThis makes the window as wide as the widest string which won't look good in localized builds. the size is to force wrapping.", "author": "dtownsend@mozilla.com", "id": 13300000, "time": "2018-05-23T16:56:18Z"}, {"text": "Comment on attachment 8969760\nBug 1455707: Add UI allowing the user to choose what to do when a downgrade is detected.\n\nhttps://reviewboard.mozilla.org/r/238568/#review252084\n\nWe discussed this on IRC, the prompt service doesn't give the sorts of layout options we need here so we're going to clean this up and land with a follow-up to maybe make this easier with the common dialog stuff.", "author": "dtownsend@mozilla.com", "id": 13300003, "time": "2018-05-23T16:57:00Z"}, {"text": "Comment on attachment 8969760\nBug 1455707: Add UI allowing the user to choose what to do when a downgrade is detected.\n\nhttps://reviewboard.mozilla.org/r/238568/#review252084\n\n> Not being in a position to try this out myself, I'm a little concerned about how this works with keyboard access. Convention is that [return] accepts the default action on the dialog on macOS, and on all other platforms activates the focused button (I think), whereas [esc] should \"cancel\" the dialog on all platforms.\n> \n> So making a cancel button the default may be confusing... and I don't see any handling for [esc] (or [return]).\n> \n> Thinking about this more generally, is it not possible to use the prompt service this early in startup, or something? Its `confirmEx` helper should allow you to pick arbitrary strings for the buttons and pass a message, and would probably make things more straightforward in that you wouldn't need custom styling or manual passing of results...\n\nI've switched to using a <dialog> which I think solves this.", "author": "dtownsend@mozilla.com", "id": 13300068, "time": "2018-05-23T17:23:53Z"}, {"text": "Created attachment 8980016\nno-sync binary.png", "author": "dtownsend@mozilla.com", "id": 13300108, "time": "2018-05-23T17:37:03Z"}, {"text": "Created attachment 8980017\nno-sync no-binary.png", "author": "dtownsend@mozilla.com", "id": 13300110, "time": "2018-05-23T17:37:17Z"}, {"text": "Created attachment 8980018\nsync binary.png", "author": "dtownsend@mozilla.com", "id": 13300111, "time": "2018-05-23T17:37:28Z"}, {"text": "Created attachment 8980019\nsync no-binary.png", "author": "dtownsend@mozilla.com", "id": 13300115, "time": "2018-05-23T17:37:41Z"}, {"text": "Comment on attachment 8979391\nBug 1455707: Remove CanShowProfileManager().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/245550/diff/1-2/", "author": "dtownsend@mozilla.com", "id": 13300119, "time": "2018-05-23T17:38:54Z"}, {"text": "Comment on attachment 8979639\nBug 1455707: Detect when running an older version than previously ran with the selected profile.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/245776/diff/1-2/", "author": "dtownsend@mozilla.com", "id": 13300120, "time": "2018-05-23T17:38:54Z"}, {"text": "Comment on attachment 8969760\nBug 1455707: Add UI allowing the user to choose what to do when a downgrade is detected.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/238568/diff/4-5/", "author": "dtownsend@mozilla.com", "id": 13300121, "time": "2018-05-23T17:38:54Z"}, {"text": "Comment on attachment 8969760\nBug 1455707: Add UI allowing the user to choose what to do when a downgrade is detected.\n\nhttps://reviewboard.mozilla.org/r/238568/#review252282\n\nLGTM, thanks!\n\n::: toolkit/locales/en-US/chrome/mozapps/profile/profileDowngrade.dtd:6\n(Diff revision 5)\n> +<!-- This Source Code Form is subject to the terms of the Mozilla Public\n> +   - License, v. 2.0. If a copy of the MPL was not distributed with this\n> +   - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->\n> +\n> +<!ENTITY window.title \"You\u2019ve launched an older version of &brandShortName;\">\n> +<!ENTITY window.style \"width: 40em;\">\n\nNit: this should have an l10n comment, I guess.", "author": "gijskruitbosch+bugs@gmail.com", "id": 13300213, "time": "2018-05-23T18:09:00Z"}, {"text": "Romain, \n\nHere are the desktop Sync/FxA MAU:\nhttps://analytics.amplitude.com/org/31251/chart/4lb6o01\n\nIt's a non-trivial proportion of desktop users.\n\nNote that these are very active users too and you can see it by looking at WAU which is very similar to MAU:\nhttps://analytics.amplitude.com/org/31251/chart/4lb6o01/edit/ajwzfgm", "author": "adavis@mozilla.com", "id": 13354373, "time": "2018-05-24T16:43:45Z"}, {"text": "Comment on attachment 8979391\nBug 1455707: Remove CanShowProfileManager().\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/245550/diff/2-3/", "author": "dtownsend@mozilla.com", "id": 13362376, "time": "2018-05-24T22:40:04Z"}, {"text": "Comment on attachment 8979639\nBug 1455707: Detect when running an older version than previously ran with the selected profile.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/245776/diff/2-3/", "author": "dtownsend@mozilla.com", "id": 13362377, "time": "2018-05-24T22:40:04Z"}, {"text": "Comment on attachment 8969760\nBug 1455707: Add UI allowing the user to choose what to do when a downgrade is detected.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/238568/diff/5-6/", "author": "dtownsend@mozilla.com", "id": 13362378, "time": "2018-05-24T22:40:04Z"}, {"text": "(In reply to Romain Testard [:RT] from comment #53)\n> Bram, is the copy I summarized in the US field final?\n\nI have checked out attachment 8980016, attachment 8980017, attachment 8980018 and attachment 8980019.\n\nThere are only two very small amendments:\n\n1. There\u2019s a comma in the middle of the first sentence.\n\n> To avoid problem accessing your bookmarks and history, you must choose a different profile.\n\n2. The button captions should be capitalised: [Launch Profile Manager], [Exit and Launch Newer Version].\n\nThat\u2019s all!", "author": "bram@mozilla.com", "id": 13368258, "time": "2018-05-28T01:41:54Z"}, {"text": "(In reply to Alex Davis [:adavis] [PM FxA+Sync] from comment #76)\n> Romain, \n> \n> Here are the desktop Sync/FxA MAU:\n> https://analytics.amplitude.com/org/31251/chart/4lb6o01\n> \n> It's a non-trivial proportion of desktop users.\n> \n> Note that these are very active users too and you can see it by looking at\n> WAU which is very similar to MAU:\n> https://analytics.amplitude.com/org/31251/chart/4lb6o01/edit/ajwzfgm\nThanks Alex, I agree, definitely a use case worth supporting. We're covered here per the description in the user story where users who were signed into sync are told to sign-in again to FxA to restore bookmarks and browsing history.", "author": "rtestard@mozilla.com", "id": 13368608, "time": "2018-05-28T07:55:09Z"}, {"text": "Markh: any objections or flags here around the instructions given to Sync users?\n\nWhile I'm not fond of the flow, it is better than nothing and is prob an edge case experienced by power users going back and forth with Nightly, Dev Edition and Release.", "author": "adavis@mozilla.com", "id": 13369401, "time": "2018-05-28T16:41:34Z"}, {"text": "(In reply to Alex Davis [:adavis] [PM FxA+Sync] from comment #82)\n> Markh: any objections or flags here around the instructions given to Sync\n> users?\n\nAs a grammar nit, attachment 8980018 says \"sign into Firefox Account\" - it seems as though it should say \"sign in with a Firefox Account\". There's also no real need to say \"and perform a sync\" as that happens automatically after signing in.\n\nSo maybe something like \"Afterwards, sign in with a Firefox Account to sync your bookmarks and browsing history between these profiles\" is better?\n\nAlso, the wording also doesn't make it particularly clear that they need to sign in to their account on *both* the old profile and any new profiles they create, but that's going to be tricky to convey in this kind of dialog.\n\n> While I'm not fond of the flow, it is better than nothing and is prob an\n> edge case experienced by power users going back and forth with Nightly, Dev\n> Edition and Release.\n\nYeah - all in all, this seems like significantly worse UX than bug 1373244 would offer, but I'm sure that's not news to anyone. Apart from nits over the wording, I see no engineering issues with having this operate as described.", "author": "markh@mozilla.com", "id": 13369872, "time": "2018-05-28T22:49:17Z"}, {"text": "Comment on attachment 8979639\nBug 1455707: Detect when running an older version than previously ran with the selected profile.\n\nhttps://reviewboard.mozilla.org/r/245776/#review252186\n\nI guess this all works, even if this is some gnarly code.  I don't suppose there's any way that some of this (new) code can be refactored so we could add some gtests on it?  The logic in `CheckCompatibility`, at least; `CheckDowngrade` is a little harder to test.\n\n::: commit-message-2126f:5\n(Diff revision 3)\n> +Bug 1455707: Detect when running an older version than previously ran with the selected profile. r?froydnj\n> +\n> +Use the information in compatibility.ini to detect that the current running\n> +application is an older version than previously ran with the profile and in\n> +that cause open a UI allowing the user to launch the profile manager, launch\n\nNit: \"that case\".\n\n::: toolkit/xre/nsAppRunner.cpp:1587\n(Diff revision 3)\n>           \"  --no-remote        Do not accept or send remote commands; implies\\n\"\n>           \"                     --new-instance.\\n\"\n>           \"  --new-instance     Open new instance, not a new window in running instance.\\n\"\n>           \"  --UILocale <locale> Start with <locale> resources as UI Locale.\\n\"\n>           \"  --safe-mode        Disables extensions and themes for this session.\\n\"\n> +         \"  --allow-downgrade  Allows downgrading a profile.\\n\"\n\nDo we want this option to be available at all?  My impression is that things like indexedDB can break horribly in downgrade scenarios.\n\n::: toolkit/xre/nsAppRunner.cpp:2731\n(Diff revision 3)\n>   * Checks the compatibility.ini file to see if we have updated our application\n>   * or otherwise invalidated our caches. If the application has been updated,\n>   * we return false; otherwise, we return true. We also write the status\n>   * of the caches (valid/invalid) into the return param aCachesOK. The aCachesOK\n>   * is always invalid if the application has been updated.\n\nPerhaps we should update this comment for the new outparams?", "author": "nfroyd@mozilla.com", "id": 13375621, "time": "2018-05-30T20:13:05Z"}, {"text": "(In reply to Nathan Froyd [:froydnj] from comment #84)\n> Comment on attachment 8979639\n> ::: toolkit/xre/nsAppRunner.cpp:1587\n> (Diff revision 3)\n> >           \"  --no-remote        Do not accept or send remote commands; implies\\n\"\n> >           \"                     --new-instance.\\n\"\n> >           \"  --new-instance     Open new instance, not a new window in running instance.\\n\"\n> >           \"  --UILocale <locale> Start with <locale> resources as UI Locale.\\n\"\n> >           \"  --safe-mode        Disables extensions and themes for this session.\\n\"\n> > +         \"  --allow-downgrade  Allows downgrading a profile.\\n\"\n> \n> Do we want this option to be available at all?  My impression is that things\n> like indexedDB can break horribly in downgrade scenarios.\n\nI think so? It will allow tools like mozregression to easily handle this. Without it it is still possible to bypass the checks by just deleting compatibility.ini from the profile folder.", "author": "dtownsend@mozilla.com", "id": 13375742, "time": "2018-05-30T21:08:03Z"}, {"text": "Comment on attachment 8979639\nBug 1455707: Detect when running an older version than previously ran with the selected profile.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/245776/diff/3-4/", "author": "dtownsend@mozilla.com", "id": 13378560, "time": "2018-05-31T19:47:57Z"}, {"text": "Comment on attachment 8969760\nBug 1455707: Add UI allowing the user to choose what to do when a downgrade is detected.\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/238568/diff/6-7/", "author": "dtownsend@mozilla.com", "id": 13378561, "time": "2018-05-31T19:47:57Z"}], "id": 1455707, "priority": "P1", "cc": ["adavis@mozilla.com", "bgrinstead@mozilla.com", "bram@mozilla.com", "bugmail@asutherland.org", "gijskruitbosch+bugs@gmail.com", "glob@mozilla.com", "jcristau@mozilla.com", "joe-bugzilla@cursive.net", "markh@mozilla.com", "MattN+bmo@mozilla.com", "mcastelluccio@mozilla.com", "mheubusch@mozilla.com", "mverdi@mozilla.com", "myk@mykzilla.org", "nfroyd@mozilla.com", "paolo.mozmail@amadzone.org", "pascalc@gmail.com", "pdolanjski@mozilla.com", "rtestard@mozilla.com", "sguha@mozilla.com", "sledru@mozilla.com"], "cf_crash_signature": "", "version": "unspecified", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_thunderbird_esr60": "---", "status": "ASSIGNED", "product": "Toolkit", "cf_fx_iteration": "---", "blocks": [1464127], "qa_contact": "", "creation_time": "2018-04-20T18:05:42Z", "cf_status_firefox_esr52": "---", "component": "Startup and Profile System", "assigned_to_detail": {"email": "dtownsend@mozilla.com", "id": 91159, "name": "dtownsend@mozilla.com", "real_name": "Dave Townsend [:mossop]"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "---", "cf_status_firefox60": "---", "target_milestone": "---", "cf_rank": null, "cf_qa_whiteboard": "", "severity": "normal", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "dtownsend@mozilla.com", "id": 91159, "name": "dtownsend@mozilla.com", "real_name": "Dave Townsend [:mossop]"}, "whiteboard": "", "mentors": [], "summary": "Warn when starting a profile that last ran with a newer build", "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-06-08T07:16:12Z", "assigned_to": "dtownsend@mozilla.com", "is_open": true, "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "joe-bugzilla@cursive.net, pdolanjski@mozilla.com, rtestard@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(rtestard@mozilla.com), needinfo?(joe-bugzilla@cursive.net), needinfo?(pdolanjski@mozilla.com)"}], "who": "dtownsend@mozilla.com", "when": "2018-04-20T18:53:26Z"}, {"changes": [{"removed": "needinfo?(joe-bugzilla@cursive.net)", "field_name": "flagtypes.name", "added": ""}], "who": "joe-bugzilla@cursive.net", "when": "2018-04-20T19:39:39Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "sguha@mozilla.com"}, {"removed": "needinfo?(rtestard@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(sguha@mozilla.com)"}], "who": "rtestard@mozilla.com", "when": "2018-04-23T13:01:06Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bram@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(bram@mozilla.com)"}], "who": "rtestard@mozilla.com", "when": "2018-04-23T13:52:38Z"}, {"changes": [{"removed": "needinfo?(sguha@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(dtownsend@mozilla.com), needinfo?(rtestard@mozilla.com)"}], "who": "sguha@mozilla.com", "when": "2018-04-23T18:43:14Z"}, {"changes": [{"removed": "needinfo?(dtownsend@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "dtownsend@mozilla.com", "when": "2018-04-23T18:53:19Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(dtownsend@mozilla.com)"}], "who": "sguha@mozilla.com", "when": "2018-04-23T19:07:50Z"}, {"changes": [{"removed": "needinfo?(dtownsend@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "dtownsend@mozilla.com", "when": "2018-04-23T19:49:25Z"}, {"changes": [{"removed": "needinfo?(rtestard@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "sguha@mozilla.com", "when": "2018-04-23T20:03:41Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(rtestard@mozilla.com)"}], "who": "dtownsend@mozilla.com", "when": "2018-04-26T17:20:44Z"}, {"changes": [{"removed": "needinfo?(pdolanjski@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "pdolanjski@mozilla.com", "when": "2018-04-26T22:06:13Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(pdolanjski@mozilla.com)"}], "who": "dtownsend@mozilla.com", "when": "2018-04-30T17:45:01Z"}, {"changes": [{"removed": "needinfo?(bram@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "bram@mozilla.com", "when": "2018-05-02T09:05:31Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(sguha@mozilla.com)"}], "who": "dtownsend@mozilla.com", "when": "2018-05-02T16:23:45Z"}, {"changes": [{"removed": "needinfo?(sguha@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "sguha@mozilla.com", "when": "2018-05-04T18:02:56Z"}, {"changes": [{"removed": "", "field_name": "cf_user_story", "added": "@@ -0,0 +1,16 @@\n+As a Firefox user starting a profile that last ran with a newer build, I want to be made aware of the risks and decide what to do next, so I can avoid profile corruption.\r\n+\r\n+Acceptance criteria:\r\n+- When a user runs Firefox version X after having run Firefox version Y, where X<Y, display the following UI:\r\n+> Older version detected\r\n+> \r\n+> Your Firefox profile was previously used to run a newer version of Firefox, but the version you are trying to run is older.\r\n+> \r\n+> There may be a risk of Firefox behaving unexpectedly if you run this version.\r\n+> \r\n+> [Quit and launch newer version](referred/highlighted option) [Continue launching older (this) version]\r\n+\r\n+- Collect telemetry to address the following questions:\r\n+---What percentage of startups see this UI?\r\n+---What percentage of displays result in a click on Quit and on Continue?\r\n+---What is the impact on retention of the UI?\n\\ No newline at end of file\n"}, {"removed": "needinfo?(rtestard@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(bram@mozilla.com)"}], "who": "rtestard@mozilla.com", "when": "2018-05-09T13:52:50Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mheubusch@mozilla.com"}, {"removed": "needinfo?(bram@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(mheubusch@mozilla.com)"}], "who": "bram@mozilla.com", "when": "2018-05-10T02:28:45Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "mverdi@mozilla.com"}], "who": "bram@mozilla.com", "when": "2018-05-10T02:29:06Z"}, {"changes": [{"removed": "needinfo?(mheubusch@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(bram@mozilla.com)"}], "who": "mheubusch@mozilla.com", "when": "2018-05-10T15:03:29Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "MattN+bmo@mozilla.com"}], "who": "MattN+bmo@mozilla.com", "when": "2018-05-10T17:09:13Z"}, {"changes": [{"removed": "needinfo?(bram@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(rtestard@mozilla.com)"}], "who": "bram@mozilla.com", "when": "2018-05-13T22:46:23Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bugmail@asutherland.org"}], "who": "bugmail@asutherland.org", "when": "2018-05-14T15:26:55Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8969761, "added": "1"}, {"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8971323, "added": "1"}], "who": "dtownsend@mozilla.com", "when": "2018-05-15T23:22:10Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "adavis@mozilla.com"}, {"removed": "needinfo?(rtestard@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(adavis@mozilla.com)"}], "who": "rtestard@mozilla.com", "when": "2018-05-16T12:57:30Z"}, {"changes": [{"removed": "needinfo?(pdolanjski@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(bram@mozilla.com)"}], "who": "dtownsend@mozilla.com", "when": "2018-05-16T15:16:10Z"}, {"changes": [{"removed": "needinfo?(bram@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "bram@mozilla.com", "when": "2018-05-17T04:20:21Z"}, {"changes": [{"removed": "", "field_name": "cf_user_story", "added": "@@ -4,8 +4,4 @@\n-- When a user runs Firefox version X after having run Firefox version Y, where X<Y, display the following UI:\r\n-> Older version detected\r\n-> \r\n-> Your Firefox profile was previously used to run a newer version of Firefox, but the version you are trying to run is older.\r\n-> \r\n-> There may be a risk of Firefox behaving unexpectedly if you run this version.\r\n-> \r\n-> [Quit and launch newer version](referred/highlighted option) [Continue launching older (this) version]\r\n+When a user runs Firefox version X after having run Firefox version Y, where X<Y, display the following a UI informing the user with Windows title \"You've launched an older version of Firefox\" and body text \"If you use your profile with this older version, you may experience problems with Firefox and may not have full access to your bookmarks and browsing history.\":\r\n+- If the previous instance was detected and the profile we attempted to use was not signed in to sync\r\n+Display message \"To launch this version safely, open Profile Manager and choose a different profile.\"\r\n+---Options are [Open profile manager] [Exit and launch newer version] (Default)\r\n@@ -13,4 +9,27 @@\n-- Collect telemetry to address the following questions:\r\n+- If the previous instance was detected and the profile we attempted to use was signed in to sync\r\n----What percentage of startups see this UI?\r\n+---Display message \"To launch this version safely, open Profile Manager and choose a different profile. Afterwards, sign into Firefox Account and perform a sync to restore your bookmarks and browsing history.\"\r\n----What percentage of displays result in a click on Quit and on Continue?\r\n+---Options are [Open Profile Manager]   [Exit and launch newer version] (Default)\r\n----What is the impact on retention of the UI?\n\\ No newline at end of file\n+\r\n+- If the previous instance is gone or overwritten and the existing profile was not signed in to sync\r\n+---Display message \"To launch this version safely, open Profile Manager and choose a different profile.\"\r\n+---Options are [Open Profile Manager] [Exit] (Default)\r\n+\r\n+- If the previous instance is gone or overwritten and the existing profile was signed in to sync\r\n+---Display message \"To launch this version safely, open Profile Manager and choose a different profile. Afterwards, sign into Firefox Account and perform a sync to restore your bookmarks and browsing history.\"\r\n+---Options are [Open Profile Manager] [Exit] (Default)\r\n+\r\n+- The window-level close button on the UI should close everything.\r\n+- A command line option can force an override of the new dialog (developers)\r\n+- Implement an MVP of telemetry as a base to iterate towards answering the following questions:\r\n+---What percentage of startups see each variation of the UI?\r\n+---What is the version/channel distribution of users who see each variation of the UI?\r\n+---What percentage of displays result in a click on each of the 2 options offered?\r\n+---What is the impact on retention for users coming across each of the UIs?\r\n+\r\n+Left to clarify\r\n+- Sumo article explaining what's going on\r\n+- Copy validation\r\n+\r\n+For later:\r\n+- Great telemetry\r\n+- Ability to detect whether there is already a unique profile associated with that version of Firefox and adapt UI to either display no UI or creation of a new profile (Comment 43)?\n\\ No newline at end of file\n"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(bram@mozilla.com), needinfo?(dtownsend@mozilla.com)"}], "who": "rtestard@mozilla.com", "when": "2018-05-17T11:53:28Z"}, {"changes": [{"removed": "needinfo?(dtownsend@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "dtownsend@mozilla.com", "when": "2018-05-17T16:00:18Z"}, {"changes": [{"removed": "", "field_name": "cf_user_story", "added": "@@ -5 +5 @@\n-- If the previous instance was detected and the profile we attempted to use was not signed in to sync\r\n+1 If the previous instance was detected and the profile we attempted to use was not signed in to sync\r\n@@ -9 +9 @@\n-- If the previous instance was detected and the profile we attempted to use was signed in to sync\r\n+2 If the previous instance was detected and the profile we attempted to use was signed in to sync\r\n@@ -11,0 +12 @@\n+-----If [Open Profile Manager] is selected, after opening a new profile from the profile manager display the firstrunpage that onboards users into sync (https://mozilla.org/firefox/60.0.1/firstrun)\r\n@@ -13 +14 @@\n-- If the previous instance is gone or overwritten and the existing profile was not signed in to sync\r\n+3 If the previous instance is gone or overwritten and the existing profile was not signed in to sync\r\n@@ -17 +18 @@\n-- If the previous instance is gone or overwritten and the existing profile was signed in to sync\r\n+4 If the previous instance is gone or overwritten and the existing profile was signed in to sync\r\n@@ -19,0 +21 @@\n+-----If [Open Profile Manager] is selected, after opening a new profile from the profile manager display the firstrunpage that onboards users into sync (https://mozilla.org/firefox/60.0.1/firstrun)\r\n"}], "who": "rtestard@mozilla.com", "when": "2018-05-18T09:29:38Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(rtestard@mozilla.com)"}], "who": "dtownsend@mozilla.com", "when": "2018-05-18T22:07:23Z"}, {"changes": [{"removed": "needinfo?(rtestard@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "rtestard@mozilla.com", "when": "2018-05-21T15:04:18Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "bgrinstead@mozilla.com"}], "who": "bgrinstead@mozilla.com", "when": "2018-05-21T15:45:17Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "glob@mozilla.com"}], "who": "glob@mozilla.com", "when": "2018-05-21T15:48:15Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "myk@mykzilla.org"}], "who": "myk@mykzilla.org", "when": "2018-05-21T16:04:59Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1463198"}], "who": "dtownsend@mozilla.com", "when": "2018-05-21T17:13:39Z"}, {"changes": [{"removed": "--", "field_name": "priority", "added": "P1"}, {"removed": "NEW", "field_name": "status", "added": "ASSIGNED"}, {"removed": "", "field_name": "cc", "added": "paolo.mozmail@amadzone.org"}], "who": "paolo.mozmail@amadzone.org", "when": "2018-05-21T17:24:17Z"}, {"changes": [{"field_name": "attachments.description", "removed": "Bug 1455707: Warn when starting with an older version of Firefox than last ran on the selected profile.", "attachment_id": 8969760, "added": "Bug 1455707: Add UI allowing the user to choose what to do when a downgrade is detected."}], "who": "dtownsend@mozilla.com", "when": "2018-05-22T16:11:54Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8979391, "added": "review?(nfroyd@mozilla.com)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8979639, "added": "review?(nfroyd@mozilla.com)"}, {"field_name": "flagtypes.name", "removed": "", "attachment_id": 8969760, "added": "review?(gijskruitbosch+bugs@gmail.com)"}, {"removed": "", "field_name": "cc", "added": "gijskruitbosch+bugs@gmail.com, nfroyd@mozilla.com"}], "who": "dtownsend@mozilla.com", "when": "2018-05-22T16:13:47Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(gijskruitbosch+bugs@gmail.com)", "attachment_id": 8969760, "added": ""}], "who": "gijskruitbosch+bugs@gmail.com", "when": "2018-05-23T09:21:18Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(nfroyd@mozilla.com)", "attachment_id": 8979391, "added": "review+"}], "who": "nfroyd@mozilla.com", "when": "2018-05-23T13:18:19Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8976003, "added": "1"}], "who": "dtownsend@mozilla.com", "when": "2018-05-23T17:24:14Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8976004, "added": "1"}], "who": "dtownsend@mozilla.com", "when": "2018-05-23T17:24:26Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8969760, "added": "review+"}], "who": "gijskruitbosch+bugs@gmail.com", "when": "2018-05-23T18:09:00Z"}, {"changes": [{"removed": "needinfo?(adavis@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "adavis@mozilla.com", "when": "2018-05-24T16:43:45Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(rtestard@mozilla.com)"}], "who": "adavis@mozilla.com", "when": "2018-05-24T16:44:03Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1464127"}], "who": "dtownsend@mozilla.com", "when": "2018-05-24T17:25:42Z"}, {"changes": [{"removed": "needinfo?(bram@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "bram@mozilla.com", "when": "2018-05-28T01:41:54Z"}, {"changes": [{"removed": "needinfo?(rtestard@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "rtestard@mozilla.com", "when": "2018-05-28T07:55:09Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "markh@mozilla.com"}], "who": "adavis@mozilla.com", "when": "2018-05-28T16:35:03Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(markh@mozilla.com)"}], "who": "adavis@mozilla.com", "when": "2018-05-28T16:41:49Z"}, {"changes": [{"removed": "needinfo?(markh@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "markh@mozilla.com", "when": "2018-05-28T22:49:17Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(nfroyd@mozilla.com)", "attachment_id": 8979639, "added": "review+"}], "who": "nfroyd@mozilla.com", "when": "2018-05-30T20:13:05Z"}, {"changes": [{"removed": "", "field_name": "cf_user_story", "added": "@@ -30,0 +31,3 @@\n+\r\n+SUMO article draft: https://docs.google.com/document/d/1Ys4wNQk_gIei_EzAi2yMbXDXGvXZLX1em-hdSNr8Rk0/edit\r\n+\r\n@@ -32 +34,0 @@\n-- Sumo article explaining what's going on\r\n"}], "who": "rtestard@mozilla.com", "when": "2018-06-04T15:29:54Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1466568"}], "who": "rtestard@mozilla.com", "when": "2018-06-04T16:00:54Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "feature"}, {"removed": "", "field_name": "cc", "added": "mcastelluccio@mozilla.com"}, {"removed": "---", "field_name": "cf_tracking_firefox_relnote", "added": "?"}], "who": "mcastelluccio@mozilla.com", "when": "2018-06-07T14:34:49Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "sledru@mozilla.com"}], "who": "sledru@mozilla.com", "when": "2018-06-07T14:41:09Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "pascalc@gmail.com"}], "who": "pascalc@gmail.com", "when": "2018-06-07T14:41:44Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jcristau@mozilla.com"}], "who": "jcristau@mozilla.com", "when": "2018-06-08T07:16:12Z"}], "resolution": "", "op_sys": "Unspecified", "cf_fx_points": "---", "cf_blocking_fennec": "---"}