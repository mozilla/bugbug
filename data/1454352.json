{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "cf_tracking_firefox62": "---", "creator": "dteller@mozilla.com", "mentors_detail": [], "depends_on": [1409815], "cf_status_firefox_esr60": "---", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "keywords": [], "cc_detail": [{"email": "efaustbmo@gmail.com", "id": 442736, "name": "efaustbmo@gmail.com", "real_name": "Eric Faust [:efaust]"}, {"email": "jcoppeard@mozilla.com", "id": 443194, "name": "jcoppeard@mozilla.com", "real_name": "Jon Coppeard (:jonco)"}, {"email": "jorendorff@mozilla.com", "id": 281791, "name": "jorendorff@mozilla.com", "real_name": "Jason Orendorff [:jorendorff]"}, {"email": "nfroyd@mozilla.com", "id": 417288, "name": "nfroyd@mozilla.com", "real_name": "Nathan Froyd [:froydnj]"}], "cf_last_resolved": "2018-05-10T16:48:33Z", "attachments": [{"creator": "efaustbmo@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [{"status": "+", "name": "feedback", "modification_date": "2018-05-02T14:28:36Z", "type_id": 607, "creation_date": "2018-05-01T23:11:04Z", "id": 1751406, "setter": "jcoppeard@mozilla.com"}], "content_type": "text/plain", "id": 8972472}, {"creator": "efaustbmo@gmail.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 8973061}, {"creator": "jcoppeard@mozilla.com", "is_obsolete": 0, "is_patch": 1, "flags": [{"status": "+", "name": "review", "modification_date": "2018-05-10T10:32:26Z", "type_id": 4, "creation_date": "2018-05-10T10:32:26Z", "id": 1755143, "setter": "jcoppeard@mozilla.com"}], "content_type": "text/plain", "id": 8974653}], "votes": 0, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 13, "comments": [{"text": "List provided by jonco:\n\nJS::Compile\n\nJS::CompileForNonSyntacticScope\n\nJS::CompileOffThread   \n\nJS::FinishOffThreadScript", "author": "dteller@mozilla.com", "id": 13209366, "time": "2018-04-16T12:29:03Z"}, {"text": "efaust, it looks to me like these functions fall in your lap, right?", "author": "dteller@mozilla.com", "id": 13209378, "time": "2018-04-16T12:34:58Z"}, {"text": "Yeah, that sounds reasonable. I have enough for JS::Compile already as part of my musings. Off-thread stuff should be pretty easy, though I haven't looked into it yet. I'm imagining (read: assuming.) that most of the stuff we want to use from frontend:: uses the appropriate main thread checks already.", "author": "efaustbmo@gmail.com", "id": 13210461, "time": "2018-04-16T18:27:59Z"}, {"text": "(In reply to David Teller [:Yoric] (please use \"needinfo\") from comment #0)\n> JS::CompileForNonSyntacticScope\n\nI don't think we need this one - although it's called by the generic nsJSUtils class it's not used by the script loader so we can just assert that this case doesn't arise.", "author": "jcoppeard@mozilla.com", "id": 13226900, "time": "2018-04-23T16:18:57Z"}, {"text": "Created attachment 8972472\noffThreadParse.patch\n\nThis looks right to me, and would provide the other two, but it seems like it must be supposed to be more complicated. Does this look plausible, Jon?", "author": "efaustbmo@gmail.com", "id": 13247401, "time": "2018-05-01T23:11:04Z"}, {"text": "Comment on attachment 8972472\noffThreadParse.patch\n\nReview of attachment 8972472:\n-----------------------------------------------------------------\n\nYes this looks fine.  I'm still working hooking up a test to use this path.  I'll let you know if things don't work out.\n\nCan you add JS::CanDecodeBinASTOffThread() (along the same lines as the existing versions) and add a case for BinAST in CanDoOffThread()?", "author": "jcoppeard@mozilla.com", "id": 13248752, "time": "2018-05-02T14:28:36Z"}, {"text": "(In reply to Jon Coppeard (:jonco) from comment #5)\nTesting was successful.", "author": "jcoppeard@mozilla.com", "id": 13249456, "time": "2018-05-02T16:50:57Z"}, {"text": "Created attachment 8973061\nupdate, apply on top of other patch.", "author": "efaustbmo@gmail.com", "id": 13253510, "time": "2018-05-03T22:16:15Z"}, {"text": "Created attachment 8974653\noff-thread-decode-binast\n\nI combined the patches and rebased.", "author": "jcoppeard@mozilla.com", "id": 13267782, "time": "2018-05-10T10:14:42Z"}, {"text": "Comment on attachment 8974653\noff-thread-decode-binast\n\nReview of attachment 8974653:\n-----------------------------------------------------------------\n\nLGTM.\n\n::: js/src/frontend/BytecodeCompiler.h\n@@ +41,5 @@\n>  JSScript*\n>  CompileGlobalBinASTScript(JSContext *cx, LifoAlloc& alloc,\n>                            const ReadOnlyCompileOptions& options,\n> +                          const uint8_t* src, size_t len,\n> +                          ScriptSourceObject** sourceObjectOut = nullptr);\n\nThe last parameter should probably be a |RootedScriptSourceObject*|.  If it wasn't optional you could use a MutableHandle, but I don't think we have a way of making that optional.", "author": "jcoppeard@mozilla.com", "id": 13267805, "time": "2018-05-10T10:32:26Z"}, {"text": "(In reply to Jon Coppeard (:jonco) from comment #9)\n> The last parameter should probably be a |RootedScriptSourceObject*|.  If it\n> wasn't optional you could use a MutableHandle, but I don't think we have a\n> way of making that optional.\n\nOh we already do this in a bunch of places.  Never mind, I'll file a separate bug.", "author": "jcoppeard@mozilla.com", "id": 13267910, "time": "2018-05-10T12:07:55Z"}, {"text": "Pushed by jcoppeard@mozilla.com:\nhttps://hg.mozilla.org/integration/mozilla-inbound/rev/91ced8101f99\nAdd APIs for parallel decoding of BinAST data r=jonco", "author": "pulsebot@bots.tld", "id": 13267940, "time": "2018-05-10T12:27:51Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/91ced8101f99", "author": "ncsoregi@mozilla.com", "id": 13268722, "time": "2018-05-10T16:48:33Z"}], "id": 1454352, "priority": "P2", "cc": ["efaustbmo@gmail.com", "jcoppeard@mozilla.com", "jorendorff@mozilla.com", "nfroyd@mozilla.com"], "cf_crash_signature": "", "version": "unspecified", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_thunderbird_esr60": "---", "cf_platform_rel": "---", "product": "Core", "cf_fx_iteration": "---", "blocks": [1444956], "qa_contact": "", "creation_time": "2018-04-16T12:29:03Z", "cf_status_firefox_esr52": "---", "component": "JavaScript Engine", "assigned_to_detail": {"email": "efaustbmo@gmail.com", "id": 442736, "name": "efaustbmo@gmail.com", "real_name": "Eric Faust [:efaust]"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "fixed", "cf_status_firefox61": "---", "cf_status_firefox60": "---", "target_milestone": "mozilla62", "cf_rank": null, "cf_qa_whiteboard": "", "severity": "normal", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "dteller@mozilla.com", "id": 181388, "name": "dteller@mozilla.com", "real_name": "David Teller [:Yoric] (please use \"needinfo\")"}, "whiteboard": "", "mentors": [], "summary": "[BinAST] Expose the APIs necessary for <script> loading", "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-05-10T16:48:33Z", "assigned_to": "efaustbmo@gmail.com", "is_open": false, "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "efaustbmo@gmail.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(efaustbmo@gmail.com)"}], "who": "dteller@mozilla.com", "when": "2018-04-16T12:34:58Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "nfroyd@mozilla.com"}], "who": "nfroyd@mozilla.com", "when": "2018-04-16T13:06:20Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jcoppeard@mozilla.com"}], "who": "jcoppeard@mozilla.com", "when": "2018-04-16T13:26:43Z"}, {"changes": [{"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "efaustbmo@gmail.com"}, {"removed": "needinfo?(efaustbmo@gmail.com)", "field_name": "flagtypes.name", "added": ""}], "who": "efaustbmo@gmail.com", "when": "2018-04-16T18:27:59Z"}, {"changes": [{"removed": "--", "field_name": "priority", "added": "P2"}, {"removed": "", "field_name": "cc", "added": "jorendorff@mozilla.com"}], "who": "jorendorff@mozilla.com", "when": "2018-04-18T22:29:02Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1409815"}], "who": "jcoppeard@mozilla.com", "when": "2018-05-01T10:47:27Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8972472, "added": "feedback?(jcoppeard@mozilla.com)"}], "who": "efaustbmo@gmail.com", "when": "2018-05-01T23:11:04Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "ASSIGNED"}], "who": "efaustbmo@gmail.com", "when": "2018-05-01T23:11:12Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "feedback?(jcoppeard@mozilla.com)", "attachment_id": 8972472, "added": "feedback+"}], "who": "jcoppeard@mozilla.com", "when": "2018-05-02T14:28:36Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8972472, "added": "1"}, {"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8973061, "added": "1"}], "who": "jcoppeard@mozilla.com", "when": "2018-05-10T10:14:42Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8974653, "added": "review+"}], "who": "jcoppeard@mozilla.com", "when": "2018-05-10T10:32:26Z"}, {"changes": [{"removed": "ASSIGNED", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla62"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2018-05-10 16:48:33"}, {"removed": "---", "field_name": "cf_status_firefox62", "added": "fixed"}], "who": "ncsoregi@mozilla.com", "when": "2018-05-10T16:48:33Z"}], "resolution": "FIXED", "op_sys": "Unspecified", "cf_fx_points": "---", "cf_blocking_fennec": "---"}