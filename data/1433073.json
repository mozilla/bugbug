{"cf_tracking_thunderbird_esr52": "---", "status": "NEW", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "cf_tracking_firefox62": "---", "creator": "matteo.sindona@yahoo.it", "mentors_detail": [], "depends_on": [], "cf_status_firefox_esr60": "---", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "cf_status_firefox58": "wontfix", "cf_status_firefox59": "wontfix", "keywords": ["regression"], "summary": "Copying Tables in Firefox 58.0 problem", "cf_last_resolved": null, "attachments": [{"creator": "matteo.sindona@yahoo.it", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 8945382}, {"creator": "matteo.sindona@yahoo.it", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 8947502}, {"creator": "matteo.sindona@yahoo.it", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "image/png", "id": 8947507}], "votes": 0, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "yes", "comment_count": 28, "comments": [{"text": "Created attachment 8945382\nImmagine.png\n\nUser Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:58.0) Gecko/20100101 Firefox/58.0\nBuild ID: 20180118215408\n\nSteps to reproduce:\n\nThere is a huge problem with Firefox 58.0 version.\n\nWhen I copy a table from a website into another, the table is copied in the wrong way, because everything is in one single row. All the columns are merged together and they are not taken into consideration.\n\nThe software used in the website I have the problem is Discuz!, but I guess the problem also appears with other softwares. \n\n\nActual results:\n\nAll the columns are merged together and they are not taken into consideration. (see attachment)\n\n\nExpected results:\n\nAttached is the comparison of right (up to Firefox 57.0.4) and wrong (Firefox 58.0)", "author": "matteo.sindona@yahoo.it", "id": 12994102, "time": "2018-01-25T10:26:27Z"}, {"text": "Hi Matteo and thanks for reporting this.\n\nSince I don't have the tool you mentioned in comment 0, it would be very helpful if you could help us with some information.\n\nCould you please retest this with the latest Nightly version and report back the results? When doing this, please use a new clean Firefox profile (https://goo.gl/AWo6h8), maybe even safe mode (https://goo.gl/AR5o9d), to eliminate custom settings as a possible cause.\n\nAlso, it would be very helpful if you could use mozregression (https://mozilla.github.io/mozregression/) in order to identify the specific commits which regressed this. Please let me know if you have any question regarding this.\n\nThanks!", "author": "carmen.fat@softvision.ro", "id": 13005552, "time": "2018-01-30T17:01:45Z"}, {"text": "(In reply to Carmen Fat [:carmenf] from comment #1)\n> Hi Matteo and thanks for reporting this.\n> \n> Since I don't have the tool you mentioned in comment 0, it would be very\n> helpful if you could help us with some information.\n> \n> Could you please retest this with the latest Nightly version and report back\n> the results? When doing this, please use a new clean Firefox profile\n> (https://goo.gl/AWo6h8), maybe even safe mode (https://goo.gl/AR5o9d), to\n> eliminate custom settings as a possible cause.\n> \n> Also, it would be very helpful if you could use mozregression\n> (https://mozilla.github.io/mozregression/) in order to identify the specific\n> commits which regressed this. Please let me know if you have any question\n> regarding this.\n> \n> Thanks!\n\n\nHello Carmen,\n\nI tried it using the latest Nightly version and using the safe mode, and unfortunately I still get the problem.\n\nI have no idea how to use mozregression, but I remember that the same problem happened some years ago (some versions between Firefox 10 and 20) with one or two Firefox versions and then disappeared with the newer version. If you think that would help to track and solve the problem, I can try to figure out which of the oldest versions had the same problem.\n\nAlso, if you want to test yourself, I created a test account in my website, you can login with it and try youself.\n\nGo here and login: http://results.totallympics.com/forum.php?mod=post&action=newthread&fid=37\n\nUsername: test \npassword: test123\n\nNow open this link in another tab and copy the table (whole table or just some cells, it's not important): https://data.fis-ski.com/dynamic/results.html?sector=NK&raceid=2189\n\nYou will get the problem with Firefox 58.0. With all the previous versions of Firefox (at least from 20.0 on, as I said around 2012-2013 some versions had the same problem) the table was copied correctly in the box.\n\nLet me know if I can help you with some more information.\n\nThank you!\n\nMatteo", "author": "matteo.sindona@yahoo.it", "id": 13005832, "time": "2018-01-30T18:16:35Z"}, {"text": "Edit: I have tried to install all the previous versions of Firefox and this problem appeared in Firefox versions until the version 14.0.1. From version 15.0 on (until version 57.0.4) the problem did not appear, and now is back in version 58.0 (and 58.0.1 is still the same).\n\nLet me know if I can give you some additional information.\n\nThank you!\n\nMatteo", "author": "matteo.sindona@yahoo.it", "id": 13007601, "time": "2018-01-31T08:24:32Z"}, {"text": "Hi Matteo,\n\nThanks for the information and the test case you provided, it is appreciated.\n\nI followed the steps you mentioned in comment 2 and logged into the test account. However, the table is copied and pasted correctly into the editable area.\nI tried this with both Firefox Release v. 58.0.1 and an older release on which should have also been reproducible (Firefox v. 3.6), using two distinct machines with Windows 10 x64. I didn't reproduce the issue on the previously mentioned builds and machines.\n\t\nSince I can't reproduce the issue, it would be great if you could use the mozregression in order to find out exactly what caused the regression.\n\nHere are the steps to install and use the mozregression tool:\n1. Install mozregression tools from here: http://mozilla.github.io/mozregression/install.html \n2. Use the terminal commands mentioned in the tutorial and after that, use the next command (without commas) to start testing:\n\"mozregression --good year-month-day --bad year-month-day\".  So in your case, you have to run the following command: mozregression --good 2017-08-02 --bad 2018-01-16\n3. When a Firefox window is opened, try to reproduce the issue. \n4. If the issue is reproducible, type \"bad\" in the terminal and hit \"Enter\", if is good type \"good\". \n5. Please provide us the pushlog link after no more builds are opened by the tool.\n\nPlease let me know if you have any question regarding this and thanks for your patience.", "author": "carmen.fat@softvision.ro", "id": 13011402, "time": "2018-02-01T15:27:25Z"}, {"text": "Hello Carmen,\n\nI am sorry but I have no idea what a \"terminal commands\" are, so I can not use Mozregression.\n\nAre you sure you are not facing the problem with Firefox 58.0.1 ?\n\nI keep getting it and all the users who are using my website are getting the same problem, so it seems very strange to me that the problem is not appearing on your device.\n\n\nI have tried with version 3.6 and everything was ok, the issue was appearing between Firefox versions 8 up to 14. From version 15 on, everything was ok again.\n\nThe problem with version 58 is that the table is copied into the text box with the correct data, but everything is on one single row. \n\nSo for example if I copy a table made of 3 rows and 3 columns, when I paste it in the text area I get a table with 9 columns and 1 row, instead of 3 rows and 3 columns.\n\nI will try to upload two new files here to show you the difference between version 57 and version 58.\n\nPlease let me know if you see a different table when you copy the same data from the same website with version 58.\n\nThank you,\n\nMatteo", "author": "matteo.sindona@yahoo.it", "id": 13011505, "time": "2018-02-01T15:56:47Z"}, {"text": "Created attachment 8947502\nCORRECT.png\n\nCorrect (Firefox version 57)", "author": "matteo.sindona@yahoo.it", "id": 13011511, "time": "2018-02-01T15:58:41Z"}, {"text": "Created attachment 8947507\nWRONG.png\n\nWrong (Firefox 58.0.1)", "author": "matteo.sindona@yahoo.it", "id": 13011531, "time": "2018-02-01T16:05:41Z"}, {"text": "Here are the two attachments.\n\nI did exactly the same thing, and you can see the two different outcomes.\n\nI copied the first 10 rows of the table you can find here https://data.fis-ski.com/dynamic/results.html?sector=NK&raceid=2189, selecting 10 rows and all the 8 columns, keeping CTRL pressed on my keyboard while selecting.\n\nThen I paste it in the text box here http://results.totallympics.com/forum.php?mod=post&action=newthread&fid=37\n\nIn the correct version (Firefox 57), you can see that the table has 10 rows and 8 columnns.\n\nin the wrong version (Firefox 58.0.1), you can see that the table has just 1 row and a lot of columns (probably 80, because it's 10x8). It's like the system doesn't recognize when a new row starts so everything is in the same row.\n\nCan you please show me a screenshot of the table you get when you paste the content with Firefox 58 ?\n\n\nThank you!\n\nMatteo", "author": "matteo.sindona@yahoo.it", "id": 13011545, "time": "2018-02-01T16:10:13Z"}, {"text": "Hi again Matteo,\n\nNo wonder I wasn't able to reproduce the issue since I only tried copying through the old fashioned ways (by shortcut and context menu). \nI was able to reproduce the issue after pressing the \"Ctrl\" key while manually selecting the table. \nSometimes a small detail like that can make huge difference :)\n\nSince it was reproducible on my side, I performed a regression using mozregression tools.\nHere are the results:\n14:59.60 INFO: Last good revision: 63747de53588638215ecab23650625595ede4e61\n14:59.60 INFO: First bad revision: b0a3a621f5c85b5e9a4eb97de77fcb2558ac17c6\n14:59.60 INFO: Pushlog:\nhttps://hg.mozilla.org/integration/mozilla-inbound/pushloghtml?fromchange=63747de53588638215ecab23650625595ede4e61&tochange=b0a3a621f5c85b5e9a4eb97de77fcb2558ac17c6\n\nHenri, as the author of the patch included in the push above, can you please take a look at this issue?", "author": "carmen.fat@softvision.ro", "id": 13013500, "time": "2018-02-02T09:21:03Z"}, {"text": "That's a great news !\n\nI hope a Firefox developer can fix this problem.\n\nIt is very important for our website because all the contributors are working with Firefox, which is the best browser to deal with tables, and we use tables a lot around the website.\n\nUnfortunately this problem is huge for us, so right now we have blocked the Firefox updates and we are all still using Firefox 57, but I really hope the problem can be fixed so we can start updating Firefox again very soon.\n\nLet me know if I can help you with more information.\n\nThank you,\n\nMatteo", "author": "matteo.sindona@yahoo.it", "id": 13013535, "time": "2018-02-02T09:49:47Z"}, {"text": "Works for me on Linux, so I expect this is specifically about the \"context\" part in the Windows clipboard format.", "author": "hsivonen@hsivonen.fi", "id": 13013546, "time": "2018-02-02T10:01:22Z"}, {"text": "(In reply to Henri Sivonen (:hsivonen) from comment #11)\n> Works for me on Linux, so I expect this is specifically about the \"context\"\n> part in the Windows clipboard format.\n\nI was going by the earlier steps to reproduce.\n\nThe ctrl selection described in comment 8 is indeed broken on Linux, too, so this isn't about the Windows clipboard format.", "author": "hsivonen@hsivonen.fi", "id": 13013573, "time": "2018-02-02T10:14:39Z"}, {"text": "Hello Henri,\n\nsorry for not specifying about the CTRL selection before.\n\nIs there any way this problem can be fixed in the next Firefox updates ?\n\nThank you,\n\nMatteo", "author": "matteo.sindona@yahoo.it", "id": 13013593, "time": "2018-02-02T10:28:50Z"}, {"text": "On Linux when copying the first 8 rows using ctrl selection, I see the plain-text clipboard flavor generate line breaks and I see this for the HTML flavor:\n<table class=\"footable table-datas table-withpadding\" cellspacing=\"0\" cellpadding=\"0\"><tbody><tr><td class=\"i0\" align=\"right\">\u00a01</td><td class=\"i0\" align=\"right\">\u00a07</td><td class=\"i0\" align=\"right\">\u00a0100323</td><td class=\"i0\"><a href=\"https://data.fis-ski.com/dynamic/athlete-biography.html?sector=NK&amp;competitorid=171541&amp;type=result\">GERARD Antoine</a>\u00a0</td><td class=\"i0\" align=\"center\">1995\u00a0</td><td class=\"i0\" align=\"center\">FRA\u00a0</td><td class=\"i0\" align=\"right\">\u00a012:00.2</td><td class=\"i0\" align=\"right\">\u00a0\u00a0</td></tr><tr><td class=\"i1\" align=\"right\">\u00a02</td><td class=\"i1\" align=\"right\">\u00a01</td><td class=\"i1\" align=\"right\">\u00a0100300</td><td class=\"i1\"><a href=\"https://data.fis-ski.com/dynamic/athlete-biography.html?sector=NK&amp;competitorid=170578&amp;type=result\">SOETVIK Sindre Ure</a>\u00a0</td><td class=\"i1\" align=\"center\">1992\u00a0</td><td class=\"i1\" align=\"center\">NOR\u00a0</td><td class=\"i1\" align=\"right\">\u00a012:07.3</td><td class=\"i1\" align=\"right\">\u00a0+7.1</td></tr><tr><td class=\"i0\" align=\"right\">\u00a03</td><td class=\"i0\" align=\"right\">\u00a09</td><td class=\"i0\" align=\"right\">\u00a0609</td><td class=\"i0\"><a href=\"https://data.fis-ski.com/dynamic/athlete-biography.html?sector=NK&amp;competitorid=69283&amp;type=result\">LAHEURTE Maxime</a>\u00a0</td><td class=\"i0\" align=\"center\">1985\u00a0</td><td class=\"i0\" align=\"center\">FRA\u00a0</td><td class=\"i0\" align=\"right\">\u00a012:10.0</td><td class=\"i0\" align=\"right\">\u00a0+9.8</td></tr><tr><td class=\"i1\" align=\"right\">\u00a04</td><td class=\"i1\" align=\"right\">\u00a06</td><td class=\"i1\" align=\"right\">\u00a01706</td><td class=\"i1\"><a href=\"https://data.fis-ski.com/dynamic/athlete-biography.html?sector=NK&amp;competitorid=137790&amp;type=result\">REHRL Franz-Josef</a>\u00a0</td><td class=\"i1\" align=\"center\">1993\u00a0</td><td class=\"i1\" align=\"center\">AUT\u00a0</td><td class=\"i1\" align=\"right\">\u00a012:10.7</td><td class=\"i1\" align=\"right\">\u00a0+10.5</td></tr><tr><td class=\"i0\" align=\"right\">\u00a05</td><td class=\"i0\" align=\"right\">\u00a03</td><td class=\"i0\" align=\"right\">\u00a0100167</td><td class=\"i0\"><a href=\"https://data.fis-ski.com/dynamic/athlete-biography.html?sector=NK&amp;competitorid=161576&amp;type=result\">ILVES Kristjan</a>\u00a0</td><td class=\"i0\" align=\"center\">1996\u00a0</td><td class=\"i0\" align=\"center\">EST\u00a0</td><td class=\"i0\" align=\"right\">\u00a012:16.4</td><td class=\"i0\" align=\"right\">\u00a0+16.2</td></tr><tr><td class=\"i1\" align=\"right\">\u00a06</td><td class=\"i1\" align=\"right\">\u00a02</td><td class=\"i1\" align=\"right\">\u00a0100314</td><td class=\"i1\"><a href=\"https://data.fis-ski.com/dynamic/athlete-biography.html?sector=NK&amp;competitorid=171251&amp;type=result\">RIIBER Harald Johnas</a>\u00a0</td><td class=\"i1\" align=\"center\">1995\u00a0</td><td class=\"i1\" align=\"center\">NOR\u00a0</td><td class=\"i1\" align=\"right\">\u00a012:19.9</td><td class=\"i1\" align=\"right\">\u00a0+19.7</td></tr><tr><td class=\"i0\" align=\"right\">\u00a07</td><td class=\"i0\" align=\"right\">\u00a04</td><td class=\"i0\" align=\"right\">\u00a0100529</td><td class=\"i0\"><a href=\"https://data.fis-ski.com/dynamic/athlete-biography.html?sector=NK&amp;competitorid=185784&amp;type=result\">BJOERNSTAD Espen</a>\u00a0</td><td class=\"i0\" align=\"center\">1993\u00a0</td><td class=\"i0\" align=\"center\">NOR\u00a0</td><td class=\"i0\" align=\"right\">\u00a012:27.4</td><td class=\"i0\" align=\"right\">\u00a0+27.2</td></tr><tr><td class=\"i1\" align=\"right\">\u00a08</td><td class=\"i1\" align=\"right\">\u00a011</td><td class=\"i1\" align=\"right\">\u00a0606</td><td class=\"i1\"><a href=\"https://data.fis-ski.com/dynamic/athlete-biography.html?sector=NK&amp;competitorid=69280&amp;type=result\">BRAUD Francois</a>\u00a0</td><td class=\"i1\" align=\"center\">1986\u00a0</td><td class=\"i1\" align=\"center\">FRA\u00a0</td><td class=\"i1\" align=\"right\">\u00a012:35.5</td><td class=\"i1\" align=\"right\">\u00a0+35.3</td></tr></tbody></table>\n\nWhen using non-ctrl selection, I get:\n<table class=\"footable table-datas table-withpadding\" cellspacing=\"0\" cellpadding=\"0\"><tbody><tr><td class=\"i0\" align=\"right\">\u00a01</td>\n<td class=\"i0\" align=\"right\">\u00a07</td>\n<td class=\"i0\" align=\"right\">\u00a0100323</td>\n<td class=\"i0\"><a href=\"https://data.fis-ski.com/dynamic/athlete-biography.html?sector=NK&amp;competitorid=171541&amp;type=result\">GERARD Antoine</a>\u00a0</td>\n<td class=\"i0\" align=\"center\">1995\u00a0</td>\n<td class=\"i0\" align=\"center\">FRA\u00a0</td>\n<td class=\"i0\" align=\"right\">\u00a012:00.2</td>\n<td class=\"i0\" align=\"right\">\u00a0\u00a0</td>\n        </tr>\n        \n\n        <tr>\n<td class=\"i1\" align=\"right\">\u00a02</td>\n<td class=\"i1\" align=\"right\">\u00a01</td>\n<td class=\"i1\" align=\"right\">\u00a0100300</td>\n<td class=\"i1\"><a href=\"https://data.fis-ski.com/dynamic/athlete-biography.html?sector=NK&amp;competitorid=170578&amp;type=result\">SOETVIK Sindre Ure</a>\u00a0</td>\n<td class=\"i1\" align=\"center\">1992\u00a0</td>\n<td class=\"i1\" align=\"center\">NOR\u00a0</td>\n<td class=\"i1\" align=\"right\">\u00a012:07.3</td>\n<td class=\"i1\" align=\"right\">\u00a0+7.1</td>\n        </tr>\n        \n\n        <tr>\n<td class=\"i0\" align=\"right\">\u00a03</td>\n<td class=\"i0\" align=\"right\">\u00a09</td>\n<td class=\"i0\" align=\"right\">\u00a0609</td>\n<td class=\"i0\"><a href=\"https://data.fis-ski.com/dynamic/athlete-biography.html?sector=NK&amp;competitorid=69283&amp;type=result\">LAHEURTE Maxime</a>\u00a0</td>\n<td class=\"i0\" align=\"center\">1985\u00a0</td>\n<td class=\"i0\" align=\"center\">FRA\u00a0</td>\n<td class=\"i0\" align=\"right\">\u00a012:10.0</td>\n<td class=\"i0\" align=\"right\">\u00a0+9.8</td>\n        </tr>\n        \n\n        <tr>\n<td class=\"i1\" align=\"right\">\u00a04</td>\n<td class=\"i1\" align=\"right\">\u00a06</td>\n<td class=\"i1\" align=\"right\">\u00a01706</td>\n<td class=\"i1\"><a href=\"https://data.fis-ski.com/dynamic/athlete-biography.html?sector=NK&amp;competitorid=137790&amp;type=result\">REHRL Franz-Josef</a>\u00a0</td>\n<td class=\"i1\" align=\"center\">1993\u00a0</td>\n<td class=\"i1\" align=\"center\">AUT\u00a0</td>\n<td class=\"i1\" align=\"right\">\u00a012:10.7</td>\n<td class=\"i1\" align=\"right\">\u00a0+10.5</td>\n        </tr>\n        \n\n        <tr>\n<td class=\"i0\" align=\"right\">\u00a05</td>\n<td class=\"i0\" align=\"right\">\u00a03</td>\n<td class=\"i0\" align=\"right\">\u00a0100167</td>\n<td class=\"i0\"><a href=\"https://data.fis-ski.com/dynamic/athlete-biography.html?sector=NK&amp;competitorid=161576&amp;type=result\">ILVES Kristjan</a>\u00a0</td>\n<td class=\"i0\" align=\"center\">1996\u00a0</td>\n<td class=\"i0\" align=\"center\">EST\u00a0</td>\n<td class=\"i0\" align=\"right\">\u00a012:16.4</td>\n<td class=\"i0\" align=\"right\">\u00a0+16.2</td>\n        </tr>\n        \n\n        <tr>\n<td class=\"i1\" align=\"right\">\u00a06</td>\n<td class=\"i1\" align=\"right\">\u00a02</td>\n<td class=\"i1\" align=\"right\">\u00a0100314</td>\n<td class=\"i1\"><a href=\"https://data.fis-ski.com/dynamic/athlete-biography.html?sector=NK&amp;competitorid=171251&amp;type=result\">RIIBER Harald Johnas</a>\u00a0</td>\n<td class=\"i1\" align=\"center\">1995\u00a0</td>\n<td class=\"i1\" align=\"center\">NOR\u00a0</td>\n<td class=\"i1\" align=\"right\">\u00a012:19.9</td>\n<td class=\"i1\" align=\"right\">\u00a0+19.7</td>\n        </tr>\n        \n\n        <tr>\n<td class=\"i0\" align=\"right\">\u00a07</td>\n<td class=\"i0\" align=\"right\">\u00a04</td>\n<td class=\"i0\" align=\"right\">\u00a0100529</td>\n<td class=\"i0\"><a href=\"https://data.fis-ski.com/dynamic/athlete-biography.html?sector=NK&amp;competitorid=185784&amp;type=result\">BJOERNSTAD Espen</a>\u00a0</td>\n<td class=\"i0\" align=\"center\">1993\u00a0</td>\n<td class=\"i0\" align=\"center\">NOR\u00a0</td>\n<td class=\"i0\" align=\"right\">\u00a012:27.4</td>\n<td class=\"i0\" align=\"right\">\u00a0+27.2</td>\n        </tr>\n        \n\n        <tr>\n<td class=\"i1\" align=\"right\">\u00a08</td>\n<td class=\"i1\" align=\"right\">\u00a011</td>\n<td class=\"i1\" align=\"right\">\u00a0606</td>\n<td class=\"i1\"><a href=\"https://data.fis-ski.com/dynamic/athlete-biography.html?sector=NK&amp;competitorid=69280&amp;type=result\">BRAUD Francois</a>\u00a0</td>\n<td class=\"i1\" align=\"center\">1986\u00a0</td>\n<td class=\"i1\" align=\"center\">FRA\u00a0</td>\n<td class=\"i1\" align=\"right\">\u00a012:35.5</td>\n<td class=\"i1\" align=\"right\">\u00a0+35.3</td></tr></tbody></table>", "author": "hsivonen@hsivonen.fi", "id": 13018320, "time": "2018-02-05T08:41:31Z"}, {"text": "These serializations differ only in whitespace in places where whitespace should be insignificant. Furthermore, ctrl-selecting, copying and pasting into LibreOffice works.\n\nThis suggests the bug is really in our *paste* handing.", "author": "hsivonen@hsivonen.fi", "id": 13018332, "time": "2018-02-05T08:46:17Z"}, {"text": "Upon pasting (in the ctrl selection case), we end up with \"tr\" as the fragment parsing context.", "author": "hsivonen@hsivonen.fi", "id": 13018363, "time": "2018-02-05T09:08:51Z"}, {"text": "So the problem is in context creation after all:\n\nctrl-select context:\n<html class=\"js csspositionsticky\" lang=\"en\"><body class=\" \"><div class=\"dcm-w\" id=\"container\"><div id=\"main\"><div class=\"row\"><div class=\"large-12 columns\"><div class=\"bloc-tab\"><table class=\"footable table-datas table-withpadding\" cellspacing=\"0\" cellpadding=\"0\"><tbody><tr></tr></tbody></table></div></div></div></div></div></body></html>\n\nnormal-select context:\n<html class=\"js csspositionsticky\" lang=\"en\"><body class=\" \"><div class=\"dcm-w\" id=\"container\"><div id=\"main\"><div class=\"row\"><div class=\"large-12 columns\"><div class=\"bloc-tab\"><table class=\"footable table-datas table-withpadding\" cellspacing=\"0\" cellpadding=\"0\"><tbody></tbody></table></div></div></div></div></div></body></html>\n\nBoth are wrong, but the other causes less trouble.\n\nEhsan, what value is there in exporting a context other than <html><body></body></html> (for compatibility with other apps that want to see a context)?\n\n1) Except for <select>, the HTML fragment parsing algorithm never cares about the ancestors beyond the immediate context node, so serializing the deep context seems useless.\n\n2) The HTML elements that exhibit non-default behavior as context nodes are relatively few and the most clipboard-relevant ones are table-related. Yet, when selecting a part of the table, we always export markup representing a full table (with the few cells that were selected) to the clipboard, so as far as context generation goes, AFAICT, we never actually need to export more context than <html><body></body></html>.\n\n3) For incoming HTML, it would probably be more robust to always ignore the incoming context and to run the HTML parser with \"template\" as the context element. This way the tree builder state is set based on the first start tag token.", "author": "hsivonen@hsivonen.fi", "id": 13018637, "time": "2018-02-05T12:56:58Z"}, {"text": "(In reply to matteo.sindona from comment #13)\n> Is there any way this problem can be fixed in the next Firefox updates ?\n\nWe aren't in a position to promise any specific schedule at this point. This bug needs fixing soon, though.", "author": "hsivonen@hsivonen.fi", "id": 13018639, "time": "2018-02-05T12:58:23Z"}, {"text": "(In reply to Henri Sivonen (:hsivonen) from comment #18)\n> (In reply to matteo.sindona from comment #13)\n> > Is there any way this problem can be fixed in the next Firefox updates ?\n> \n> We aren't in a position to promise any specific schedule at this point. This\n> bug needs fixing soon, though.\n\n\nHello Henri,\n\nthank you very much for your time. I really hope the problem can be fixed as soon as possible.\n\nI also have some other minor things I would like to be changed in the tables features using Firefox, can I also report them to you?\n\nThank you,\n\nMatteo", "author": "matteo.sindona@yahoo.it", "id": 13021734, "time": "2018-02-06T15:23:36Z"}, {"text": "For those who helped me with this and who got familiar with those websites, I have posted another issue for which I have used the same example. You can find it here: https://bugzilla.mozilla.org/show_bug.cgi?id=1438756\n\nThank you in advance for the time you will spend on it and I really hope you can fix those issues soon.", "author": "matteo.sindona@yahoo.it", "id": 13046848, "time": "2018-02-16T05:44:41Z"}, {"text": "(In reply to Henri Sivonen (:hsivonen) from comment #17)\n> So the problem is in context creation after all:\n> \n> ctrl-select context:\n> <html class=\"js csspositionsticky\" lang=\"en\"><body class=\" \"><div\n> class=\"dcm-w\" id=\"container\"><div id=\"main\"><div class=\"row\"><div\n> class=\"large-12 columns\"><div class=\"bloc-tab\"><table class=\"footable\n> table-datas table-withpadding\" cellspacing=\"0\"\n> cellpadding=\"0\"><tbody><tr></tr></tbody></table></div></div></div></div></\n> div></body></html>\n> \n> normal-select context:\n> <html class=\"js csspositionsticky\" lang=\"en\"><body class=\" \"><div\n> class=\"dcm-w\" id=\"container\"><div id=\"main\"><div class=\"row\"><div\n> class=\"large-12 columns\"><div class=\"bloc-tab\"><table class=\"footable\n> table-datas table-withpadding\" cellspacing=\"0\"\n> cellpadding=\"0\"><tbody></tbody></table></div></div></div></div></div></\n> body></html>\n\nOK, so we are getting a <tr> in the ctrl-click case but not in the normal selection case.  But what changed after the regression compared to before?\n\n> Both are wrong, but the other causes less trouble.\n\nWrong how?  Can you explain please?\n\n> Ehsan, what value is there in exporting a context other than\n> <html><body></body></html> (for compatibility with other apps that want to\n> see a context)?\n\nI'm not quite sure if I understand your question.  The obvious answer is of course compatibility with the said apps that you mention but I think you're alluding to a different point that I'm not following?  I'd be cautious changing what context we export to the clipboard, changing how we consume the context ourselves is less questionable.\n\n(But please note that I still don't understand where the regression comes from, so my first preference in the abstract is finding the root cause of the regression and fixing that, so that we go back to exporting the exact same context we used to before bug 1409951 landed.  Since I can't see that bug, and you haven't explained the regression itself, I don't feel like I can say much here with any confidence yet...)\n\n> 1) Except for <select>, the HTML fragment parsing algorithm never cares\n> about the ancestors beyond the immediate context node, so serializing the\n> deep context seems useless.\n> \n> 2) The HTML elements that exhibit non-default behavior as context nodes are\n> relatively few and the most clipboard-relevant ones are table-related. Yet,\n> when selecting a part of the table, we always export markup representing a\n> full table (with the few cells that were selected) to the clipboard, so as\n> far as context generation goes, AFAICT, we never actually need to export\n> more context than <html><body></body></html>.\n> \n> 3) For incoming HTML, it would probably be more robust to always ignore the\n> incoming context and to run the HTML parser with \"template\" as the context\n> element. This way the tree builder state is set based on the first start tag\n> token.\n\nI _think_ that makes sense based on my limited understand of how the parser works, but I think you know that side a lot better than I do.  Still this doesn't require us changing what context we put on the clipboard...", "author": "ehsan@mozilla.com", "id": 13073263, "time": "2018-02-27T18:45:22Z"}, {"text": "Once the problem will be identified and fixed, which will be the first version of Firefox which will not have this issue ? Can the problem be fixed immediately for the next release or it will be first fixed in the beta releases ?\n\nThank you,\n\nMatteo", "author": "matteo.sindona@yahoo.it", "id": 13075237, "time": "2018-02-28T13:25:01Z"}, {"text": "(In reply to :Ehsan Akhgari from comment #21)\n> (In reply to Henri Sivonen (:hsivonen) from comment #17)\n> > So the problem is in context creation after all:\n> > \n> > ctrl-select context:\n> > <html class=\"js csspositionsticky\" lang=\"en\"><body class=\" \"><div\n> > class=\"dcm-w\" id=\"container\"><div id=\"main\"><div class=\"row\"><div\n> > class=\"large-12 columns\"><div class=\"bloc-tab\"><table class=\"footable\n> > table-datas table-withpadding\" cellspacing=\"0\"\n> > cellpadding=\"0\"><tbody><tr></tr></tbody></table></div></div></div></div></\n> > div></body></html>\n> > \n> > normal-select context:\n> > <html class=\"js csspositionsticky\" lang=\"en\"><body class=\" \"><div\n> > class=\"dcm-w\" id=\"container\"><div id=\"main\"><div class=\"row\"><div\n> > class=\"large-12 columns\"><div class=\"bloc-tab\"><table class=\"footable\n> > table-datas table-withpadding\" cellspacing=\"0\"\n> > cellpadding=\"0\"><tbody></tbody></table></div></div></div></div></div></\n> > body></html>\n> \n> OK, so we are getting a <tr> in the ctrl-click case but not in the normal\n> selection case.  But what changed after the regression compared to before?\n\nBefore the regression, the context for the ctrl-select case was exactly the same as the above-quoted normal-select context.\n\n> > Both are wrong, but the other causes less trouble.\n> \n> Wrong how?  Can you explain please?\n\nThe content string contains the tags <table class=\"footable table-datas table-withpadding\" cellspacing=\"0\" cellpadding=\"0\"><tbody> and the context contains them, too. They overlap and due to tables being special, the overlapping tags get ignored when parsing the content string.\n\nIs generating stuff to be ignored by the consumer by design to accommodate different consumers?\n\n> > Ehsan, what value is there in exporting a context other than\n> > <html><body></body></html> (for compatibility with other apps that want to\n> > see a context)?\n> \n> I'm not quite sure if I understand your question.  The obvious answer is of\n> course compatibility with the said apps that you mention but I think you're\n> alluding to a different point that I'm not following?  I'd be cautious\n> changing what context we export to the clipboard, changing how we consume\n> the context ourselves is less questionable.\n\nFirst, let's ignore everything except the table internals, select internals, xmp and plaintext. The parsing of the rest of HTML that can be copied from the content area shouldn't (per spec) change depending on what the context node is. Therefore, it should be sufficient to give <body> as the context and <html> in case other apps want to see the ancestor of <body> explicitly.\n\nSecond, when we export a partial table range, we export the content string in a form that fills in the tags to make it a full table. Is the expectation that the consumers parse out a full table, or is it some weird compat feature that content string contains markup for a full table, but if the consumer takes into account the context, the outer parts of the content string get ignored? (I.e. if context is <html><body><table><tbody></tbody></table></body></html> the <table> and <tbody> tags included in the context string get ignored.)\n\nIf exporting a full table but causing the outer bits to be ignored is a feature, can we special-case context generation for the small number of table-related elements instead of walking up the actual DOM for context generation? Generating the context from the actual DOM seems to be a continuous source of bugs.\n\nThat is, can we replace the current context generation logic with the following?\n\nIf the nearest common ancestor of the range end points is:\n<xmp> or <plaintext>, don't export the HTML flavor to the clipboard--only plain text\n<tr>, generate the context <html><body><table><tbody><tr></tr></tbody></table></body></html>\n<tbody>, <thead> or <tfoot>, generate the context <html><body><table><tbody></tbody></table></body></html>\n<table>, generate the context <html><body><table></table></body></html>\n<table>, generate the context <html><body><table></table></body></html>\n<select>, generate the context <html><body><select></select></body></html>\notherwise, generate the context <html><body></body></html>\n\n(Can we even select stuff inside a <select>?)\n\n> (But please note that I still don't understand where the regression comes\n> from\n\nThe change in bug 1409951 was not supposed to change the generation of context start--only the generation of context end. Yet, as we see here, the context start acquired an extra <tr> tag in the ctrl-select case. I don't understand why.\n\n> bug 1409951 landed.  Since I can't see that\n> bug\n\nCC added.", "author": "hsivonen@hsivonen.fi", "id": 13079280, "time": "2018-03-01T13:30:13Z"}, {"text": "(In reply to matteo.sindona from comment #22)\n> Once the problem will be identified and fixed, which will be the first\n> version of Firefox which will not have this issue ? Can the problem be fixed\n> immediately for the next release or it will be first fixed in the beta\n> releases ?\n\nWhether it will be uplifted to beta is a decision that can be made only after we see how invasive the fix ends up being.", "author": "hsivonen@hsivonen.fi", "id": 13079283, "time": "2018-03-01T13:32:22Z"}, {"text": "(In reply to Henri Sivonen (:hsivonen) from comment #24)\n> (In reply to matteo.sindona from comment #22)\n> > Once the problem will be identified and fixed, which will be the first\n> > version of Firefox which will not have this issue ? Can the problem be fixed\n> > immediately for the next release or it will be first fixed in the beta\n> > releases ?\n> \n> Whether it will be uplifted to beta is a decision that can be made only\n> after we see how invasive the fix ends up being.\n\n\nThank you Henri.\nPlease keep me updated because unfortunately I do not understand much about what you guys have posted in the previous messages.\n\nI really hope this problem can be fixed as soon as possible.\n\nThanks!", "author": "matteo.sindona@yahoo.it", "id": 13110553, "time": "2018-03-07T10:20:11Z"}, {"text": "Also, I don't know if this is useful for you, but doing some tests I have found out that the problem is caused from copying the table and not from pasting it.\n\nIn fact, if I copy the table with Firefox 58.0 and I paste it in Firefox 57.0 (or any previous version), the issue appears anyway, but the issue does not appear if I copy and paste the table from Firefox 57.0 (or any previous version). So the problem should be in copying from Firefox 58.0, pasting is not the problem.\n\nI hope this helps.", "author": "matteo.sindona@yahoo.it", "id": 13110625, "time": "2018-03-07T11:04:30Z"}, {"text": "Hello,\n\nany news about this issue?\n\nThank you!", "author": "matteo.sindona@yahoo.it", "id": 13272554, "time": "2018-05-12T13:00:05Z"}], "id": 1433073, "priority": "--", "cc": ["carmen.fat@softvision.ro", "ehsan@mozilla.com", "hsivonen@hsivonen.fi", "mcastelluccio@mozilla.com"], "cf_crash_signature": "", "version": "58 Branch", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": [], "cf_tracking_thunderbird_esr60": "---", "cf_platform_rel": "---", "product": "Core", "cf_fx_iteration": "---", "blocks": [], "qa_contact": "", "creation_time": "2018-01-25T10:26:27Z", "cf_status_firefox_esr52": "---", "component": "Editor", "assigned_to_detail": {"email": "nobody@mozilla.org", "id": 1, "name": "nobody@mozilla.org", "real_name": "Nobody; OK to take it and work on it"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "fix-optional", "cf_status_firefox60": "wontfix", "target_milestone": "---", "cf_rank": null, "cf_qa_whiteboard": "", "severity": "normal", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "matteo.sindona@yahoo.it", "id": 610651, "name": "matteo.sindona@yahoo.it", "real_name": ""}, "whiteboard": "", "mentors": [], "cc_detail": [{"email": "carmen.fat@softvision.ro", "id": 581789, "name": "carmen.fat@softvision.ro", "real_name": "Carmen Fat [:carmenf]"}, {"email": "ehsan@mozilla.com", "id": 251051, "name": "ehsan@mozilla.com", "real_name": ":Ehsan Akhgari"}, {"email": "hsivonen@hsivonen.fi", "id": 5490, "name": "hsivonen@hsivonen.fi", "real_name": "Henri Sivonen (:hsivonen)"}, {"email": "mcastelluccio@mozilla.com", "id": 420453, "name": "mcastelluccio@mozilla.com", "real_name": "Marco Castelluccio [:marco]"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [{"requestee": "ehsan@mozilla.com", "status": "?", "name": "needinfo", "modification_date": "2018-03-01T13:30:13Z", "type_id": 800, "creation_date": "2018-03-01T13:30:13Z", "id": 1723426, "setter": "hsivonen@hsivonen.fi"}], "last_change_time": "2018-06-13T20:01:07Z", "assigned_to": "nobody@mozilla.org", "is_open": true, "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "carmen.fat@softvision.ro"}, {"removed": "Untriaged", "field_name": "component", "added": "Editor"}, {"removed": "Firefox", "field_name": "product", "added": "Core"}], "who": "carmen.fat@softvision.ro", "when": "2018-01-30T17:01:45Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(matteo.sindona@yahoo.it)"}], "who": "carmen.fat@softvision.ro", "when": "2018-02-01T15:27:25Z"}, {"changes": [{"removed": "needinfo?(matteo.sindona@yahoo.it)", "field_name": "flagtypes.name", "added": ""}], "who": "matteo.sindona@yahoo.it", "when": "2018-02-01T15:56:47Z"}, {"changes": [{"removed": "UNCONFIRMED", "field_name": "status", "added": "NEW"}, {"removed": "", "field_name": "cc", "added": "hsivonen@hsivonen.fi"}, {"removed": "0", "field_name": "is_confirmed", "added": "1"}, {"removed": "---", "field_name": "cf_has_regression_range", "added": "yes"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(hsivonen@hsivonen.fi)"}, {"removed": "---", "field_name": "cf_status_firefox58", "added": "affected"}, {"removed": "---", "field_name": "cf_status_firefox59", "added": "affected"}, {"removed": "---", "field_name": "cf_status_firefox60", "added": "affected"}], "who": "carmen.fat@softvision.ro", "when": "2018-02-02T09:21:03Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "ehsan@mozilla.com"}, {"removed": "needinfo?(hsivonen@hsivonen.fi)", "field_name": "flagtypes.name", "added": "needinfo?(ehsan@mozilla.com)"}], "who": "hsivonen@hsivonen.fi", "when": "2018-02-05T12:56:58Z"}, {"changes": [{"removed": "needinfo?(ehsan@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "ehsan@mozilla.com", "when": "2018-02-27T18:45:22Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(ehsan@mozilla.com)"}], "who": "hsivonen@hsivonen.fi", "when": "2018-03-01T13:30:13Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "regression"}, {"removed": "", "field_name": "cc", "added": "mcastelluccio@mozilla.com"}], "who": "mcastelluccio@mozilla.com", "when": "2018-05-14T13:39:33Z"}, {"changes": [{"removed": "affected", "field_name": "cf_status_firefox58", "added": "wontfix"}, {"removed": "affected", "field_name": "cf_status_firefox59", "added": "wontfix"}, {"removed": "affected", "field_name": "cf_status_firefox60", "added": "wontfix"}, {"removed": "---", "field_name": "cf_status_firefox61", "added": "fix-optional"}], "who": "m_kato@ga2.so-net.ne.jp", "when": "2018-06-13T20:01:07Z"}], "resolution": "", "op_sys": "Unspecified", "cf_fx_points": "---", "cf_blocking_fennec": "---"}