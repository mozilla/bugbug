{"status": "RESOLVED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "classification": "Client Software", "creator": "bgrinstead@mozilla.com", "cc": ["gandalf@aviary.pl", "jaws@mozilla.com", "myk@mykzilla.org", "richard.marti@gmail.com"], "depends_on": [1419547], "creation_time": "2017-11-27T18:13:35Z", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "keywords": [], "summary": "Remove the preference 'container' XBL binding and instead build the DOM directly in gContainersPane._rebuildView", "cf_last_resolved": "2018-04-13T09:50:08Z", "attachments": [{"creator": "bgrinstead@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2018-04-12T18:14:42Z", "type_id": 748, "creation_date": "2018-04-02T19:22:44Z", "id": 1738120, "setter": "jaws@mozilla.com"}], "content_type": "text/x-review-board-request", "id": 8932161}], "assigned_to_detail": {"email": "bgrinstead@mozilla.com", "id": 476442, "name": "bgrinstead@mozilla.com", "real_name": "Brian Grinstead [:bgrins]"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 14, "comments": [{"text": "There's a binding \"container\" in the prefs UI that adds content inside a richlistitem in about:preferences#containers\n\n- https://dxr.mozilla.org/mozilla-central/rev/da90245d47b17c750560dedb5cbe1973181166e3/browser/components/preferences/handlers.xml#74-95\n- https://dxr.mozilla.org/mozilla-central/rev/da90245d47b17c750560dedb5cbe1973181166e3/browser/components/preferences/handlers.css#13-15\n\nThe richlist item is created here:\n\nhttps://dxr.mozilla.org/mozilla-central/rev/da90245d47b17c750560dedb5cbe1973181166e3/browser/components/preferences/in-content/containers.js#29-43\n\nBecause it uses entities it's causing some extra work in Bug 1419547. But since it's only adding content, I suspect that the DOM can be built directly in containers.js as an alternative.", "author": "bgrinstead@mozilla.com", "id": 12877284, "time": "2017-11-27T18:13:35Z"}, {"text": "Created attachment 8932161\nBug 1420990 - Build the DOM for container items directly in containers.js instead of with XBL;\n\nReview commit: https://reviewboard.mozilla.org/r/203204/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/203204/", "author": "bgrinstead@mozilla.com", "id": 12877291, "time": "2017-11-27T18:15:43Z"}, {"text": "Comment on attachment 8932161\nBug 1420990 - Build the DOM for container items directly in containers.js instead of with XBL;\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/203204/diff/1-2/", "author": "bgrinstead@mozilla.com", "id": 12877316, "time": "2017-11-27T18:23:39Z"}, {"text": "Comment on attachment 8932161\nBug 1420990 - Build the DOM for container items directly in containers.js instead of with XBL;\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/203204/diff/2-3/", "author": "bgrinstead@mozilla.com", "id": 13174238, "time": "2018-04-02T17:05:01Z"}, {"text": "Comment on attachment 8932161\nBug 1420990 - Build the DOM for container items directly in containers.js instead of with XBL;\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/203204/diff/3-4/", "author": "bgrinstead@mozilla.com", "id": 13174280, "time": "2018-04-02T17:19:43Z"}, {"text": "Comment on attachment 8932161\nBug 1420990 - Build the DOM for container items directly in containers.js instead of with XBL;\n\nI don't love the extra verbosity here. I wish we had some way other that innerHTML to be more declarative with how the markup will be in JS - going to look into that for when we start shipping Custom Elements in chrome.\n\nBut IMO it ends up more straightforward with the change (due to no more attribute mapping via `inherits` and no <children> in XBL), and it gets rid of one more binding. Let me know if you have ideas on how to make this better.", "author": "bgrinstead@mozilla.com", "id": 13174594, "time": "2018-04-02T19:22:44Z"}, {"text": "Comment on attachment 8932161\nBug 1420990 - Build the DOM for container items directly in containers.js instead of with XBL;\n\nhttps://reviewboard.mozilla.org/r/203204/#review240866\n\n::: browser/components/preferences/in-content/containers.js:35\n(Diff revision 4)\n> +      let outer = document.createElement(\"hbox\");\n> +      outer.setAttribute(\"flex\", 1);\n> +      outer.setAttribute(\"equalsize\", \"always\");\n> +      item.appendChild(outer);\n> +\n> +      let inner = document.createElement(\"hbox\");\n> +      inner.setAttribute(\"flex\", 1);\n> +      inner.setAttribute(\"align\", \"center\");\n> +      outer.appendChild(inner);\n\nYou might want to look into combining outer with inner to simplify the markup. It would make it less verbose.\n\nI used bug 1437230 as an opportunity to also simplify the markup there too.", "author": "ntim.bugs@gmail.com", "id": 13194218, "time": "2018-04-10T08:24:44Z"}, {"text": "Comment on attachment 8932161\nBug 1420990 - Build the DOM for container items directly in containers.js instead of with XBL;\n\nhttps://reviewboard.mozilla.org/r/203204/#review241874", "author": "jaws@mozilla.com", "id": 13201649, "time": "2018-04-12T18:14:42Z"}, {"text": "Comment on attachment 8932161\nBug 1420990 - Build the DOM for container items directly in containers.js instead of with XBL;\n\nhttps://reviewboard.mozilla.org/r/203204/#review241886\n\n::: browser/components/preferences/in-content/containers.js:35\n(Diff revision 4)\n> +      let outer = document.createElement(\"hbox\");\n> +      outer.setAttribute(\"flex\", 1);\n> +      outer.setAttribute(\"equalsize\", \"always\");\n> +      item.appendChild(outer);\n> +\n> +      let inner = document.createElement(\"hbox\");\n> +      inner.setAttribute(\"flex\", 1);\n> +      inner.setAttribute(\"align\", \"center\");\n> +      outer.appendChild(inner);\n\nGood point. I checked locally and moving `align=center` up to outer and removing `equalsize=always` then removing `inner` renders the same", "author": "bgrinstead@mozilla.com", "id": 13201688, "time": "2018-04-12T18:30:30Z"}, {"text": "Comment on attachment 8932161\nBug 1420990 - Build the DOM for container items directly in containers.js instead of with XBL;\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/203204/diff/4-5/", "author": "bgrinstead@mozilla.com", "id": 13201703, "time": "2018-04-12T18:35:54Z"}, {"text": "Comment on attachment 8932161\nBug 1420990 - Build the DOM for container items directly in containers.js instead of with XBL;\n\nhttps://reviewboard.mozilla.org/r/203204/#review241896\n\n::: browser/components/preferences/handlers.css:9\n(Diff revision 5)\n>  #containersView > richlistitem {\n> -  -moz-binding: url(\"chrome://browser/content/preferences/handlers.xml#container\");\n> +  -moz-binding: none;\n>  }\n\nYou can avoid this by using a vbox/hbox instead.", "author": "ntim.bugs@gmail.com", "id": 13201711, "time": "2018-04-12T18:39:38Z"}, {"text": "(In reply to Tim Nguyen :ntim from comment #10)\n> Comment on attachment 8932161\n> Bug 1420990 - Build the DOM for container items directly in containers.js\n> instead of with XBL;\n> \n> https://reviewboard.mozilla.org/r/203204/#review241896\n> \n> ::: browser/components/preferences/handlers.css:9\n> (Diff revision 5)\n> >  #containersView > richlistitem {\n> > -  -moz-binding: url(\"chrome://browser/content/preferences/handlers.xml#container\");\n> > +  -moz-binding: none;\n> >  }\n> \n> You can avoid this by using a vbox/hbox instead.\n\nI thought about that, but didn't want to lose any styling or make it inconsistent with other lists in prefs. If we were OK with that we could also turn this into a Custom Element.", "author": "bgrinstead@mozilla.com", "id": 13201819, "time": "2018-04-12T19:20:13Z"}, {"text": "Pushed by bgrinstead@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/19dfac734e3e\nBuild the DOM for container items directly in containers.js instead of with XBL;r=jaws", "author": "pulsebot@bots.tld", "id": 13202400, "time": "2018-04-12T22:15:19Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/19dfac734e3e", "author": "aiakab@mozilla.com", "id": 13203337, "time": "2018-04-13T09:50:08Z"}], "id": 1420990, "priority": "P3", "mentors_detail": [], "cf_crash_signature": "", "version": "unspecified", "cf_qa_whiteboard": "", "cf_tracking_firefox_esr52": "---", "cf_tracking_firefox62": "---", "cf_platform_rel": "---", "product": "Firefox", "cf_status_firefox_esr52": "---", "blocks": [1397874], "qa_contact": "", "see_also": ["https://bugzilla.mozilla.org/show_bug.cgi?id=1457027"], "cf_fx_iteration": "---", "component": "Preferences", "votes": 0, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "fixed", "cf_status_firefox60": "---", "target_milestone": "Firefox 61", "is_cc_accessible": true, "cf_rank": null, "groups": [], "url": "", "creator_detail": {"email": "bgrinstead@mozilla.com", "id": 476442, "name": "bgrinstead@mozilla.com", "real_name": "Brian Grinstead [:bgrins]"}, "whiteboard": "", "mentors": [], "cc_detail": [{"email": "gandalf@aviary.pl", "id": 41270, "name": "gandalf@aviary.pl", "real_name": "Zibi Braniecki [:gandalf][:zibi]"}, {"email": "jaws@mozilla.com", "id": 409754, "name": "jaws@mozilla.com", "real_name": "Jared Wein [:jaws] (please needinfo? me)"}, {"email": "myk@mykzilla.org", "id": 27300, "name": "myk@mykzilla.org", "real_name": "Myk Melez [:myk] [@mykmelez]"}, {"email": "richard.marti@gmail.com", "id": 282357, "name": "richard.marti@gmail.com", "real_name": "Richard Marti (:Paenglab)"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-04-26T15:17:32Z", "cf_status_firefox_esr60": "---", "assigned_to": "bgrinstead@mozilla.com", "is_open": false, "resolution": "FIXED", "op_sys": "Unspecified", "cf_fx_points": "---", "history": [{"changes": [{"removed": "https://bugzilla.mozilla.org/show_bug.cgi?id=1419547", "field_name": "see_also", "added": ""}, {"removed": "", "field_name": "blocks", "added": "419547"}], "who": "gandalf@aviary.pl", "when": "2017-11-27T18:14:56Z"}, {"changes": [{"removed": "419547", "field_name": "blocks", "added": "1419547"}], "who": "gandalf@aviary.pl", "when": "2017-11-27T18:15:16Z"}, {"changes": [{"removed": "--", "field_name": "priority", "added": "P5"}, {"removed": "", "field_name": "cc", "added": "jaws@mozilla.com"}, {"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "bgrinstead@mozilla.com"}], "who": "jaws@mozilla.com", "when": "2017-11-27T19:11:45Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "ASSIGNED"}], "who": "jaws@mozilla.com", "when": "2017-11-27T19:11:51Z"}, {"changes": [{"removed": "P5", "field_name": "priority", "added": "P4"}], "who": "jaws@mozilla.com", "when": "2017-11-27T19:12:02Z"}, {"changes": [{"removed": "P4", "field_name": "priority", "added": "P3"}], "who": "jaws@mozilla.com", "when": "2017-11-27T19:12:12Z"}, {"changes": [{"removed": "1419547", "field_name": "blocks", "added": ""}, {"removed": "", "field_name": "depends_on", "added": "1419547"}], "who": "bgrinstead@mozilla.com", "when": "2018-03-15T21:09:30Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8932161, "added": "review?(jaws@mozilla.com)"}], "who": "bgrinstead@mozilla.com", "when": "2018-04-02T19:22:44Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(jaws@mozilla.com)", "attachment_id": 8932161, "added": "review+"}], "who": "jaws@mozilla.com", "when": "2018-04-12T18:14:42Z"}, {"changes": [{"field_name": "attachments.description", "removed": "Bug 1420990 - Build the DOM for container items directly in containers.js instead of with XBL", "attachment_id": 8932161, "added": "Bug 1420990 - Build the DOM for container items directly in containers.js instead of with XBL;"}], "who": "bgrinstead@mozilla.com", "when": "2018-04-12T18:35:54Z"}, {"changes": [{"removed": "ASSIGNED", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "Firefox 61"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2018-04-13 09:50:08"}, {"removed": "---", "field_name": "cf_status_firefox61", "added": "fixed"}], "who": "aiakab@mozilla.com", "when": "2018-04-13T09:50:08Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "richard.marti@gmail.com"}], "who": "richard.marti@gmail.com", "when": "2018-04-13T10:00:22Z"}, {"changes": [{"removed": "", "field_name": "see_also", "added": "https://bugzilla.mozilla.org/show_bug.cgi?id=1457027"}], "who": "bgrinstead@mozilla.com", "when": "2018-04-26T15:17:32Z"}]}