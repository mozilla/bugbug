{"attachments": [], "classification": "Other", "creator": "mcastelluccio@mozilla.com", "mentors_detail": [], "depends_on": [], "creation_time": "2018-03-12T13:56:47Z", "cf_user_story": "", "is_open": false, "keywords": [], "summary": "Enable codecov.io for mozilla/gecko-dev", "cf_last_resolved": "2018-04-27T10:24:23Z", "assigned_to_detail": {"email": "nobody@mozilla.org", "id": 1, "name": "nobody@mozilla.org", "real_name": "Nobody; OK to take it and work on it"}, "severity": "normal", "is_confirmed": true, "is_creator_accessible": true, "cf_crash_signature": "", "comments": [{"text": "So far, I've been uploading coverage data for my fork marco-c/gecko-dev, which is obviously not great.\nI'd like to enable codecov.io for mozilla/gecko-dev and start uploading the coverage data there.\n\ncodecov.io is already used in the mozilla org.\n\nIn order to enable codecov.io for mozilla/gecko-dev, write access to the repository is needed.\nOnce it is enabled, an upload token is generated.\n\nFor my purposes, I don't need write access to mozilla/gecko-dev but just need the upload token.", "author": "mcastelluccio@mozilla.com", "id": 13121995, "time": "2018-03-12T13:56:47Z"}, {"text": "Marco,\n a) this will have to be done by giving someone temporary write access to the repo (not an owner)\n b) this needs to be approved by dev services -- they own gecko-dev and it's processed differently than a normal repo\n\n:dhouse -- how will this interact with vcs-sync? (he's PTO until Mar 20 -- you might want to find someone else on his team)", "author": "hwine@mozilla.com", "id": 13122305, "time": "2018-03-12T15:57:28Z"}, {"text": "Maybe :dividehex can help?", "author": "mcastelluccio@mozilla.com", "id": 13122360, "time": "2018-03-12T16:14:59Z"}, {"text": "Gene: we've arrived at answers for OAuth apps on public repos. Do you think the situation is different with private repos?\n\nI believe codecov asks for repo write scope.", "author": "hwine@mozilla.com", "id": 13122553, "time": "2018-03-12T17:23:42Z"}, {"text": "comment 3 was on wrong bug :( removing NI", "author": "hwine@mozilla.com", "id": 13122633, "time": "2018-03-12T17:45:13Z"}, {"text": "302 to :fubar", "author": "jwatkins@mozilla.com", "id": 13125411, "time": "2018-03-13T16:15:47Z"}, {"text": ":dhouse should be back too.", "author": "mcastelluccio@mozilla.com", "id": 13171440, "time": "2018-04-01T20:31:51Z"}, {"text": "Chris, Greg, and Kendall: can I get approval for adding an \"upload token\" for codecov to be pushed to github mozilla/gecko-dev?", "author": "dhouse@mozilla.com", "id": 13174360, "time": "2018-04-02T17:45:43Z"}, {"text": ":marco what will codecov be uploading to the repo? Or does it use something else in the github api? vcs-sync pushes the converted hg commits to gecko-dev without any checking of what is on github, but I'm assuming that codecov is not pushing to the repo files and that there will not be a conflict.", "author": "dhouse@mozilla.com", "id": 13174377, "time": "2018-04-02T17:50:00Z"}, {"text": "(In reply to Dave House [:dhouse] from comment #8)\n> :marco what will codecov be uploading to the repo? Or does it use something\n> else in the github api? vcs-sync pushes the converted hg commits to\n> gecko-dev without any checking of what is on github, but I'm assuming that\n> codecov is not pushing to the repo files and that there will not be a\n> conflict.\n\nI think it will never upload anything, but it might use some GitHub API: https://github.com/codecov/support/blob/master/site/security.md#when-does-codecov-write-to-my-repository.", "author": "mcastelluccio@mozilla.com", "id": 13175806, "time": "2018-04-03T09:32:14Z"}, {"text": "(In reply to Marco Castelluccio [:marco] from comment #9)\n> (In reply to Dave House [:dhouse] from comment #8)\n> > :marco what will codecov be uploading to the repo? Or does it use something\n> > else in the github api? vcs-sync pushes the converted hg commits to\n> > gecko-dev without any checking of what is on github, but I'm assuming that\n> > codecov is not pushing to the repo files and that there will not be a\n> > conflict.\n> \n> I think it will never upload anything, but it might use some GitHub API:\n> https://github.com/codecov/support/blob/master/site/security.md#when-does-\n> codecov-write-to-my-repository.\n\nThx :marco. This looks good to me; We don't accept PR's, but I expect we'll see the commit status updates from codecov.\n```\nWhen does Codecov write to my repository?\n\nThe only times Codecov will \"write\" to your repository is in the following processes:\n\n    Create/Update a Webhook\n    Create/Update/Delete a Pull Request Comment\n    Create/Update the Commit Status\n\n    Codecov never adjusts source code, deletes branches, closes pull requests, or performs any other 'write' action.\n```(https://github.com/codecov/support/blob/master/site/security.md#when-does-codecov-write-to-my-repository)", "author": "dhouse@mozilla.com", "id": 13176990, "time": "2018-04-03T16:37:07Z"}, {"text": "I don't see a problem with this offhand; reverting is simply removing the token/webhook, yes?", "author": "klibby@mozilla.com", "id": 13180858, "time": "2018-04-04T19:23:19Z"}, {"text": "I'm not thrilled that it needs write access to work. But this seems reasonable. Nobody should be using gecko-dev for anything canonical. So while there is a small risk here to giving a tool write access to the source code, it shouldn't matter much in reality.\n\nWe may want to run this by someone on Julien's team so we have a rubber stamp from them though.\n\nhwine: what say you?", "author": "gps@mozilla.com", "id": 13195785, "time": "2018-04-10T18:56:49Z"}, {"text": "Chris said in IRC that he's okay with this too. Thanks!", "author": "dhouse@mozilla.com", "id": 13195798, "time": "2018-04-10T18:59:12Z"}, {"text": "There aren't any security concerns unless gecko-dev ever becomes a 2-way sync. That's a \"new service\" and would need a complete review.\n\nWhen vcs-sync was designed, we decided to always do a force push to GitHub, to overwrite any accidental (or deliberate) corruption of the gecko-dev repo. There might be some workflow gotchas due to that, but that's not a sec issue :)\n\nThe operational challenge will be to see if you can give _just_ codecov write access to the repo. (I suspect you can't, and the access will be tied to someone's personal GitHub login, and thus be susceptible to confusing breakage.)", "author": "hwine@mozilla.com", "id": 13198743, "time": "2018-04-11T18:00:24Z"}, {"text": "Thanks Hal. Could you give my account temporary admin access to add Codecov to mozilla/gecko-dev? It will get the scopes \"user:email, read:org, repo:status, write:repo_hook\" (https://github.com/codecov/support/blob/master/site/security.md#what-scope-is-used-when-signing-up-using-github). Once I confirm with Marco that it is working, I'll ask you remove my temporary access (is that the right process?).", "author": "dhouse@mozilla.com", "id": 13212971, "time": "2018-04-17T16:44:23Z"}, {"text": "Dave - you're in the vcs2vcs team now, which has 'admin' scope on gecko-dev.\n\nLet me know when you're done. In the olden days, I thought that group only had 'write' scope, so let me know if I should reset the access to 'write' as well. (:fubar & :gps are also in that team)", "author": "hwine@mozilla.com", "id": 13213986, "time": "2018-04-17T23:20:47Z"}, {"text": "(In reply to Hal Wine [:hwine] (use NI) from comment #16)\n> Dave - you're in the vcs2vcs team now, which has 'admin' scope on gecko-dev.\n> \n> Let me know when you're done. In the olden days, I thought that group only\n> had 'write' scope, so let me know if I should reset the access to 'write' as\n> well. (:fubar & :gps are also in that team)\n\nHi Hal, I checked on github and I don't see myself in the vcs2vcs team, https://github.com/orgs/mozilla/teams/vcs2vcs. Could you add me again? (id:davehouse) I'm sorry I'm just today looking into setting this up.", "author": "dhouse@mozilla.com", "id": 13222408, "time": "2018-04-20T20:11:06Z"}, {"text": "My bad -- I invited 'dhouse' & fortunately they had not accepted.\n\nYou're in now and :fubar is the team maintainer.", "author": "hwine@mozilla.com", "id": 13222702, "time": "2018-04-20T22:08:23Z"}, {"text": "Thx, and +1 fortunately ;)", "author": "dhouse@mozilla.com", "id": 13223070, "time": "2018-04-21T03:18:59Z"}, {"text": "The link is set up now. Marco will confirm everything and let me know if there is a problem.", "author": "dhouse@mozilla.com", "id": 13226796, "time": "2018-04-23T15:34:26Z"}, {"text": "It's working well: https://codecov.io/github/mozilla/gecko-dev.", "author": "mcastelluccio@mozilla.com", "id": 13237849, "time": "2018-04-27T10:24:23Z"}, {"text": "Hi Hal, would you please remove the admin access from my account?", "author": "dhouse@mozilla.com", "id": 13238155, "time": "2018-04-27T13:36:05Z"}, {"text": "(In reply to Dave House [:dhouse] from comment #22)\n> Hi Hal, would you please remove the admin access from my account?\n\nDone -- in the future, :fubar can handle as well :)", "author": "hwine@mozilla.com", "id": 13238916, "time": "2018-04-27T18:52:35Z"}], "id": 1444892, "priority": "--", "platform": "Unspecified", "comment_count": 24, "version": "other", "is_cc_accessible": true, "status": "RESOLVED", "product": "mozilla.org", "blocks": [], "qa_contact": "", "see_also": [], "cf_fx_iteration": "---", "component": "Github: Administration", "votes": 0, "groups": [], "target_milestone": "---", "cc": ["catlee@mozilla.com", "dhouse@mozilla.com", "gps@mozilla.com", "hwine@mozilla.com", "jwatkins@mozilla.com", "klibby@mozilla.com", "sledru@mozilla.com"], "url": "", "creator_detail": {"email": "mcastelluccio@mozilla.com", "id": 420453, "name": "mcastelluccio@mozilla.com", "real_name": "Marco Castelluccio [:marco]"}, "whiteboard": "", "mentors": [], "cc_detail": [{"email": "catlee@mozilla.com", "id": 20203, "name": "catlee@mozilla.com", "real_name": "Chris AtLee [:catlee]"}, {"email": "dhouse@mozilla.com", "id": 578965, "name": "dhouse@mozilla.com", "real_name": "Dave House [:dhouse]"}, {"email": "gps@mozilla.com", "id": 420446, "name": "gps@mozilla.com", "real_name": "Gregory Szorc [:gps]"}, {"email": "hwine@mozilla.com", "id": 429623, "name": "hwine@mozilla.com", "real_name": "Hal Wine [:hwine] (use NI)"}, {"email": "jwatkins@mozilla.com", "id": 428430, "name": "jwatkins@mozilla.com", "real_name": "Jake Watkins [:dividehex]"}, {"email": "klibby@mozilla.com", "id": 466247, "name": "klibby@mozilla.com", "real_name": "Kendall Libby [:fubar]"}, {"email": "sledru@mozilla.com", "id": 495955, "name": "sledru@mozilla.com", "real_name": "Sylvestre Ledru [:sylvestre]"}], "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-04-27T18:52:35Z", "assigned_to": "nobody@mozilla.org", "cf_qa_whiteboard": "", "resolution": "FIXED", "op_sys": "Unspecified", "cf_fx_points": "---", "history": [{"changes": [{"removed": "", "field_name": "cc", "added": "dhouse@mozilla.com"}], "who": "hwine@mozilla.com", "when": "2018-03-12T15:57:28Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jwatkins@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(jwatkins@mozilla.com)"}], "who": "mcastelluccio@mozilla.com", "when": "2018-03-12T16:14:59Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(gene@mozilla.com)"}], "who": "hwine@mozilla.com", "when": "2018-03-12T17:23:42Z"}, {"changes": [{"removed": "needinfo?(gene@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "hwine@mozilla.com", "when": "2018-03-12T17:45:13Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "klibby@mozilla.com"}, {"removed": "needinfo?(jwatkins@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(klibby@mozilla.com)"}], "who": "jwatkins@mozilla.com", "when": "2018-03-13T16:15:47Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(dhouse@mozilla.com)"}], "who": "mcastelluccio@mozilla.com", "when": "2018-04-01T20:31:51Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "catlee@mozilla.com, gps@mozilla.com"}, {"removed": "needinfo?(dhouse@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(catlee@mozilla.com), needinfo?(gps@mozilla.com)"}], "who": "dhouse@mozilla.com", "when": "2018-04-02T17:45:43Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(mcastelluccio@mozilla.com)"}], "who": "dhouse@mozilla.com", "when": "2018-04-02T17:50:00Z"}, {"changes": [{"removed": "needinfo?(mcastelluccio@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "mcastelluccio@mozilla.com", "when": "2018-04-03T09:32:14Z"}, {"changes": [{"removed": "needinfo?(klibby@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "klibby@mozilla.com", "when": "2018-04-04T19:23:19Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "hwine@mozilla.com"}, {"removed": "needinfo?(gps@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(hwine@mozilla.com)"}], "who": "gps@mozilla.com", "when": "2018-04-10T18:56:49Z"}, {"changes": [{"removed": "needinfo?(catlee@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "dhouse@mozilla.com", "when": "2018-04-10T18:59:12Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "sledru@mozilla.com"}], "who": "sledru@mozilla.com", "when": "2018-04-11T13:22:46Z"}, {"changes": [{"removed": "needinfo?(hwine@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "hwine@mozilla.com", "when": "2018-04-11T18:00:24Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(hwine@mozilla.com)"}], "who": "dhouse@mozilla.com", "when": "2018-04-17T16:44:23Z"}, {"changes": [{"removed": "needinfo?(hwine@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(dhouse@mozilla.com)"}], "who": "hwine@mozilla.com", "when": "2018-04-17T23:20:47Z"}, {"changes": [{"removed": "needinfo?(dhouse@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(hwine@mozilla.com)"}], "who": "dhouse@mozilla.com", "when": "2018-04-20T20:11:06Z"}, {"changes": [{"removed": "needinfo?(hwine@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(dhouse@mozilla.com)"}], "who": "hwine@mozilla.com", "when": "2018-04-20T22:08:23Z"}, {"changes": [{"removed": "needinfo?(dhouse@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "dhouse@mozilla.com", "when": "2018-04-23T15:34:26Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(mcastelluccio@mozilla.com)"}], "who": "mcastelluccio@mozilla.com", "when": "2018-04-24T18:57:16Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "needinfo?(mcastelluccio@mozilla.com)", "field_name": "flagtypes.name", "added": ""}, {"removed": "", "field_name": "cf_last_resolved", "added": "2018-04-27 10:24:23"}], "who": "mcastelluccio@mozilla.com", "when": "2018-04-27T10:24:23Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(hwine@mozilla.com)"}], "who": "dhouse@mozilla.com", "when": "2018-04-27T13:36:05Z"}, {"changes": [{"removed": "gene@mozilla.com", "field_name": "cc", "added": ""}], "who": "gene@mozilla.com", "when": "2018-04-27T16:51:40Z"}, {"changes": [{"removed": "needinfo?(hwine@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "hwine@mozilla.com", "when": "2018-04-27T18:52:35Z"}]}