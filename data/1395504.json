{"cf_tracking_thunderbird_esr52": "---", "status": "RESOLVED", "cf_tracking_firefox60": "---", "cf_tracking_firefox61": "---", "cf_tracking_firefox62": "---", "creator": "hskupin@gmail.com", "mentors_detail": [], "depends_on": [1041474], "cf_status_firefox_esr60": "wontfix", "cf_user_story": "", "cf_tracking_firefox_relnote": "---", "platform": "Unspecified", "cf_status_firefox58": "wontfix", "cf_status_firefox59": "wontfix", "keywords": ["hang", "regression"], "cf_status_firefox57": "wontfix", "summary": "Infinite hang of web content process when parent process crashes [@ CrashStatsLogForwarder::Log() | mozilla::dom::PContentChild::SendGraphicsError()]", "cf_last_resolved": "2018-04-24T01:16:57Z", "attachments": [{"creator": "hskupin@gmail.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "text/plain", "id": 8903086}, {"creator": "hskupin@gmail.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "text/plain", "id": 8905198}, {"creator": "hskupin@gmail.com", "is_obsolete": 1, "is_patch": 0, "flags": [], "content_type": "text/plain", "id": 8905402}, {"creator": "hskupin@gmail.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "text/plain", "id": 8940318}, {"creator": "hskupin@gmail.com", "is_obsolete": 0, "is_patch": 0, "flags": [], "content_type": "text/plain", "id": 8957496}, {"creator": "haftandilian@mozilla.com", "is_obsolete": 1, "is_patch": 1, "flags": [], "content_type": "text/plain", "id": 8967193}, {"creator": "haftandilian@mozilla.com", "is_obsolete": 0, "is_patch": 0, "flags": [{"status": "+", "name": "review", "modification_date": "2018-04-23T20:48:06Z", "type_id": 4, "creation_date": "2018-04-12T23:58:19Z", "id": 1743442, "setter": "gsvelto@mozilla.com"}], "content_type": "text/x-review-board-request", "id": 8967597}], "votes": 0, "classification": "Components", "is_confirmed": true, "is_creator_accessible": true, "cf_has_regression_range": "---", "comment_count": 75, "comments": [{"text": "Created attachment 8903086\nactivity monitor sample (mozilla::layers::PCompositorManagerChild::OnChannelError())\n\n[Tracking Requested - why for this release]:\n\nFor one of our Marionette unit tests which is forcing a crash of Firefox by just executing the following code in chrome scope, the Firefox process never exits due to a still running web content process. The latter doesn't even get killed by the background monitor thread.\n\nCode to crash Firefox:\n\n\n              Components.utils.import(\"resource://gre/modules/ctypes.jsm\");\n\n              // ctypes checks for NULL pointer derefs, so just go near-NULL.\n              var zero = new ctypes.intptr_t(8);\n              var badptr = ctypes.cast(zero, ctypes.PointerType(ctypes.int32_t));\n              var crash = badptr.contents;\n\nThe test:\n\nhttps://dxr.mozilla.org/mozilla-central/rev/db7f19e26e571ae1dd309f5d2f387b06ba670c30/testing/marionette/harness/marionette_harness/tests/unit/test_crash.py#164\n\nHere an excerpt of the output from the Activity Monitor sample:\n\nSampling process 866 for 3 seconds with 1 millisecond of run time between samples\nSampling completed, processing symbols...\n2017-08-31 02:28:36.749 sample[881:63819] Metadata.framework [Error]: couldn't get the client port\nAnalysis of sampling plugin-container (pid 866) every 1 millisecond\nProcess:         plugin-container [866]\nPath:            /Users/cltbld/build/Nightly.app/Contents/MacOS/plugin-container.app/Contents/MacOS/plugin-container\n\nCall graph:\n    2610 Thread_62643   DispatchQueue_1: com.apple.main-thread  (serial)\n    + 2610 start  (in plugin-container) + 52  [0x10657ee84]\n    +   2610 main  (in plugin-container) + 89  [0x10657eee9]\n    +     2610 XRE_InitChildProcess(int, char**, XREChildData const*)  (in XUL) + 1778  [0x109d18f92]\n    +       2610 MessageLoop::Run()  (in XUL) + 73  [0x106d8e2c9]\n    +         2610 XRE_RunAppShell()  (in XUL) + 270  [0x109d1924e]\n    +           2610 nsAppShell::Run()  (in XUL) + 259  [0x10890fe73]\n    +             2610 nsBaseAppShell::Run()  (in XUL) + 46  [0x1088b8c5e]\n    +               2610 MessageLoop::Run()  (in XUL) + 73  [0x106d8e2c9]\n    +                 2610 mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*)  (in XUL) + 291  [0x106dc50a3]\n    +                   2610 NS_ProcessNextEvent(nsIThread*, bool)  (in XUL) + 39  [0x1069632e7]\n    +                     2610 nsThread::ProcessNextEvent(bool, bool*)  (in XUL) + 1685  [0x106961a05]\n    +                       2610 mozilla::detail::RunnableMethodImpl<mozilla::ipc::MessageChannel*, void (mozilla::ipc::MessageChannel::*)(), false, (mozilla::RunnableKind)1>::Run()  (in XUL) + 44  [0x106dca7cc]\n    +                         2610 mozilla::layers::PCompositorManagerChild::OnChannelError()  (in XUL) + 19  [0x107058673]\n    +                           2610 mozilla::layers::PCompositorManagerChild::DestroySubtree(mozilla::ipc::IProtocol::ActorDestroyReason)  (in XUL) + 154  [0x10705848a]\n    +                             2610 mozilla::layers::PCompositorBridgeChild::DestroySubtree(mozilla::ipc::IProtocol::ActorDestroyReason)  (in XUL) + 1663  [0x10704b39f]\n    +                               2610 mozilla::layers::CompositorBridgeChild::ActorDestroy(mozilla::ipc::IProtocol::ActorDestroyReason)  (in XUL) + 79  [0x1074ea51f]\n    +                                 2610 mozilla::gfx::Log<1, mozilla::gfx::CriticalLogger>::Flush()  (in XUL) + 168  [0x1072d0508]\n    +                                   2610 mozilla::gfx::CriticalLogger::OutputMessage(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool)  (in XUL) + 48  [0x1072d5b40]\n    +                                     2610 CrashStatsLogForwarder::Log(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&)  (in XUL) + 164  [0x1075215b4]\n    +                                       2610 mozilla::dom::PContentChild::SendGraphicsError(nsCString const&)  (in XUL) + 30  [0x10707881e]\n    +                                         2610 mozilla::dom::PContent::Msg_GraphicsError(int)  (in XUL) + 24  [0x10705d138]\n\n\nAs it looks like it's trying to send the crash stats logs and specifically a graphics error, but it isn't successful. It would be interesting to know why this process cannot be killed and Firefox hangs forever.", "author": "hskupin@gmail.com", "id": 12616452, "time": "2017-08-31T09:50:54Z"}, {"text": "So I can see this hang for various of our crash tests, and it only happens for those tests which actually crash the chrome (parent) process. It's not happening for the content crash tests. For a list of affected tests please have a look at the blocking list of bug 1376795.\n\nI will try if I can narrow down the range a bit so we can figure out what could have caused this problem.\n\nIn the meantime would you have an idea, Cervantes? Or is that more a question to GFX people?", "author": "hskupin@gmail.com", "id": 12616861, "time": "2017-08-31T12:46:37Z"}, {"text": "Looks like Milan is also back from PTO... so setting ni? for him too.", "author": "hskupin@gmail.com", "id": 12616870, "time": "2017-08-31T12:47:16Z"}, {"text": "Checking more on the code it looks like that George added all that via bug 1297828 already a while ago.", "author": "hskupin@gmail.com", "id": 12616909, "time": "2017-08-31T12:56:21Z"}, {"text": "For info this crash is happening quite a lot in our Marionette unit test test_crash.py. There is a list of around 30 failures for each of bug 1377030, bug 1376773, and bug 1326124 per week. So they have a high impact for us.\n\nGetting someone to actually look at this would be great.", "author": "hskupin@gmail.com", "id": 12631081, "time": "2017-09-05T21:24:32Z"}, {"text": "This is actually also reproducible with the crash tests and Firefox 56.0a1. I'm currently checking if I can narrow down the range. Interestingly I only see the crashes for opt builds made in CI but not for Nightly builds.", "author": "hskupin@gmail.com", "id": 12633776, "time": "2017-09-06T15:29:33Z"}, {"text": "Created attachment 8905198\nminimized testcase\n\nTestcase to be used to reproduce the problem. Pick the correct CI build and run the following command:\n\nmach marionette test --binary %path% -vv --run-until-failure testcase.py\n\nThis will run the test in a loop of 30 iterations by default. Usually the hang should be visible within that range. If not, just run it again.", "author": "hskupin@gmail.com", "id": 12634746, "time": "2017-09-06T19:08:01Z"}, {"text": "Created attachment 8905402\nactivity monitor sample (ImageLoader::recursiveUpdateDepth)\n\nWhen I'm using an older build like here the last CI build from June 17th (316014448e427486cce211217e2aee2f18ee3d69), I get a different call stack for the hanging webcontent process.", "author": "hskupin@gmail.com", "id": 12636560, "time": "2017-09-07T08:02:18Z"}, {"text": "Roughly this infinite hang seem to have started between 2017-04-01 and 2017-05-01. Here the changeset list which is still huge:\n\nhttps://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=7a3f514cf8490d271ee373a1d2999e4ea4dee2d7&tochange=2e7c10a9b86e30691f67855f6c8f98d984508d7c\n\nI'm currently working on narrowing the regression range down. In the meantime I had a look at the changesets and noticed bug 1356365. Maybe this is a related issue, which simply masked the crash? Is there a way to disable the GPU process?", "author": "hskupin@gmail.com", "id": 12638783, "time": "2017-09-07T19:46:26Z"}, {"text": "(In reply to Henrik Skupin (:whimboo) from comment #8)\n> Roughly this infinite hang seem to have started between 2017-04-01 and\n> 2017-05-01. Here the changeset list which is still huge:\n> \n> https://hg.mozilla.org/mozilla-central/\n> pushloghtml?fromchange=7a3f514cf8490d271ee373a1d2999e4ea4dee2d7&tochange=2e7c\n> 10a9b86e30691f67855f6c8f98d984508d7c\n> \n> I'm currently working on narrowing the regression range down. In the\n> meantime I had a look at the changesets and noticed bug 1356365. Maybe this\n> is a related issue, which simply masked the crash? Is there a way to disable\n> the GPU process?\n\nOn OSX, there is no GPU process. I will try to setup the environment to run the test in comment 6.", "author": "howareyou322@gmail.com", "id": 12640311, "time": "2017-09-08T07:13:11Z"}, {"text": "Please note that I had to request a loaner from RelEng to get it reproduced. I wasn't able to with my local machine. But maybe your setup is different.\n\nI continued to further nail down the regression range. Here is the range I have so far:\n\nhttps://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=ce69b6e1773e9e0d0a190ce899f34b1658e66ca4&tochange=a374c35469935a874fefe64d3e07003fc5bc8884\n\nGiven that it happens really rarely it takes a while to prove that a build is not affected. Maybe there is something in the list which looks suspicious to you.", "author": "hskupin@gmail.com", "id": 12640362, "time": "2017-09-08T07:35:29Z"}, {"text": "(In reply to Henrik Skupin (:whimboo) from comment #10)\n> Please note that I had to request a loaner from RelEng to get it reproduced.\n> I wasn't able to with my local machine. But maybe your setup is different.\n> \n> I continued to further nail down the regression range. Here is the range I\n> have so far:\n> \n> https://hg.mozilla.org/mozilla-central/\n> pushloghtml?fromchange=ce69b6e1773e9e0d0a190ce899f34b1658e66ca4&tochange=a374\n> c35469935a874fefe64d3e07003fc5bc8884\n> \n> Given that it happens really rarely it takes a while to prove that a build\n> is not affected. Maybe there is something in the list which looks suspicious\n> to you.\n\nFrom the push log, I only saw the following bug was related to gfx IPC. Could you try to reproduce with/without the follwoing patch? \n\n1574c02ea13f\tvincentliu \u2014 Bug 1350330 - Make sure IPC channel still Open before sending IPC message. r=dvander", "author": "howareyou322@gmail.com", "id": 12640632, "time": "2017-09-08T09:22:18Z"}, {"text": "Sorry, the last mentioned pushlog was not correct. I was able now to reproduce with a build from April 15th, which I originally used. So please give me some more time to run those tests.", "author": "hskupin@gmail.com", "id": 12640920, "time": "2017-09-08T11:12:43Z"}, {"text": "I can track this for 56 and 57, sounds complex enough that a fix for 56 may be unlikely. Sounds like 55 was affected, if you can reproduce from nightly build from April 15.", "author": "lhenry@mozilla.com", "id": 12642257, "time": "2017-09-08T18:30:38Z"}, {"text": "So this is actually a merge commit from autoland which started the regression on mozilla-central. Sadly it contains itself a merge from m-c to autoland, so that it clearly needs further work.\n\nhttps://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=8dd662ed33876fc7d86882fd19bc9f56d96ffa41&tochange=3243c8fc3ce7831dda843b60d6bb2d7e4acf1fd4\n\nI will continue.", "author": "hskupin@gmail.com", "id": 12644364, "time": "2017-09-10T09:19:58Z"}, {"text": "So I got this final regression range which I cannot further bisect because the builds of all three commits have the same source revision 8fbfe8c77eaa.\n\nhttps://hg.mozilla.org/integration/autoland/pushloghtml?fromchange=3f13d894a371f3bcc84dfdbc732f00d428cb8f97&tochange=8fbfe8c77eaa41c79aaf48a07666986d300dd0cf\n\nSurprisingly there is a breakpad client patch which got landed at this time. Given that this problem only appears for forced crashes, I could really see a relationship to bug 1350917.\n\nTed, Mike, and Georg, could at least one of you have a look at this broken behavior?", "author": "hskupin@gmail.com", "id": 12648961, "time": "2017-09-11T17:54:32Z"}, {"text": "I don't *think* bug 1350917 would be likely to cause this issue, but it's certainly the most suspicious out of the changes in that regression range. It looks to me (per your stack in comment 0) like this is simply the graphics logger code not realizing that it shouldn't try to flush its log when the connection has already terminated.", "author": "ted@mielczarek.org", "id": 12649212, "time": "2017-09-11T18:48:18Z"}, {"text": "Not sure either why bug 1350917 might cause this. On the other hand, perhaps the graphics changes in that commit (bug 1351426) are causing the logging to be attempted.\n\nI agree that we should be avoiding the log flush after the IPC teardown.", "author": "mconley@mozilla.com", "id": 12649224, "time": "2017-09-11T18:52:54Z"}, {"text": "I ran the tests multiple times for the builds on the last pushlog, and it clearly shows this range. With bug 1350917 it fails, but maybe as my other attachment shows there is some other cause which results in the same/similar behavior? I could run again and to another trace.", "author": "hskupin@gmail.com", "id": 12649235, "time": "2017-09-11T18:55:59Z"}, {"text": "I will try with https://tools.taskcluster.net/index/artifacts/gecko.v2.autoland.pushdate.2017.04.13.20170413014424.firefox/macosx64-opt now which seems to be the build for the graphics change which I didn't find before.", "author": "hskupin@gmail.com", "id": 12649242, "time": "2017-09-11T18:58:11Z"}, {"text": "The hang is clearly not reproducible for the build with the changeset 5f4e3982c169. I ran the crash test 1200 times without a single hang during shutdown. But once I use the build for 8fbfe8c77eaa it hung after 197 iterations. And this with the exactly same output as attachment 8903086 for GFX/layers.\n\nI backed out 8fbfe8c77eaa locally from recent mozilla-central, and pushed a try build:\nhttps://treeherder.mozilla.org/#/jobs?repo=try&revision=98b7c5ece7941651d482ab8c031dc0c512310145\n\nI will check if the hang is gone and report back soon.", "author": "hskupin@gmail.com", "id": 12650863, "time": "2017-09-12T07:31:29Z"}, {"text": "I accidentally pushed an artifact build, so here the new try build with --no-artifact:\nhttps://treeherder.mozilla.org/#/jobs?repo=try&revision=85e6b908fa3d6cc10e8338509bf677f43ddafec1", "author": "hskupin@gmail.com", "id": 12650881, "time": "2017-09-12T07:36:19Z"}, {"text": "So even without the breakpad change the hang is visible. It means I'm out of ideas here, and we maybe should just fix the GFX part here. Not sure if other threads could cause similar behavior.\n\nIf there is something else you would like to know. Otherwise I will hand back the loaner to RelEng tomorrow.", "author": "hskupin@gmail.com", "id": 12650986, "time": "2017-09-12T08:31:01Z"}, {"text": "I'm going to hand back the one-click loaner given the low capacity of MacOS machines. If more testing is needed we might have to request another one.", "author": "hskupin@gmail.com", "id": 12654663, "time": "2017-09-13T07:25:36Z"}, {"text": "Henrik, what's the actual patch that \"fixes\" this that you mention above?", "author": "milaninbugzilla@gmail.com", "id": 12667349, "time": "2017-09-14T21:02:30Z"}, {"text": "(In reply to Milan Sreckovic [:milan] from comment #24)\n> Henrik, what's the actual patch that \"fixes\" this that you mention above?\n\nThere is no patch available. Also not sure which comment you are referring to. Sorry, if something was unclear, but this bug clearly needs a dev to get this fixed.", "author": "hskupin@gmail.com", "id": 12668995, "time": "2017-09-15T05:51:28Z"}, {"text": "I was referencing comment 20 \"The hang is clearly not reproducible for the build with the changeset 5f4e3982c169\".", "author": "milaninbugzilla@gmail.com", "id": 12670681, "time": "2017-09-15T16:22:50Z"}, {"text": "We are about to build 56 RC. This might be too late for 56. Mark 56 as won't fix.", "author": "gchang@mozilla.com", "id": 12676082, "time": "2017-09-18T02:42:34Z"}, {"text": "(In reply to Milan Sreckovic [:milan] from comment #26)\n> I was referencing comment 20 \"The hang is clearly not reproducible for the\n> build with the changeset 5f4e3982c169\".\n\nSo that was the last working commit which didn't produce a test failure when running the test hundreds of times. As mentioned in comment 21, the backout of it didn't chagne anything for recent builds where it is still failing. Means there is no patch/fix available, and I'm out of ideas here. We really need someone from the GFX team here.", "author": "hskupin@gmail.com", "id": 12676398, "time": "2017-09-18T07:29:00Z"}, {"text": "This doesn't really seem like a gfx bug, it is lower level, and GFX is the first thing to trigger it. Some questions:\n\nDoes commenting out the message at [1] fix the problem, or do we just hang somewhere else instead?\n\nIs the stack in comment #0 hanging? Is the parent process fully destroyed at that point? I wonder if the OS is not marking the pipe as closed, or if the parent process is somehow still alive in some kind of zombie state.\n\n[1] http://searchfox.org/mozilla-central/rev/05c4c3bc0cfb9b0fc66bdfc8c47cac674e45f151/gfx/layers/ipc/CompositorBridgeChild.cpp#557", "author": "dvander@alliedmods.net", "id": 12677698, "time": "2017-09-18T16:36:33Z"}, {"text": "Sorry that I cannot answer this but I do not have the knowledge in that area. If there is someone going to work on it, it might be good to request a MacOS loaner again which makes it easier to reproduce.", "author": "hskupin@gmail.com", "id": 12678446, "time": "2017-09-18T19:24:24Z"}, {"text": "This is one of the most occurring crashes for Marionette tests at the moment. David, what can be done to make progress on this bug?", "author": "hskupin@gmail.com", "id": 12698396, "time": "2017-09-25T07:26:14Z"}, {"text": "Hi Milan, I am reviewing 57+ tracked bugs and wondering if this one will be fixed in 57 or not. Should I just wontfix this for 57 now? If a fix is ready in time and low risk, we can consider uplifting to beta57.", "author": "rkothari@mozilla.com", "id": 12712443, "time": "2017-09-28T23:27:59Z"}, {"text": "I wouldn't track this for 57.", "author": "milaninbugzilla@gmail.com", "id": 12714990, "time": "2017-09-29T18:42:45Z"}, {"text": "Tracking ? to flag :ritu", "author": "milaninbugzilla@gmail.com", "id": 12715038, "time": "2017-09-29T18:59:24Z"}, {"text": "Not tracking for 57 per comment 33.  This still needs more investigation and might not make 57.", "author": "jcristau@mozilla.com", "id": 12735456, "time": "2017-10-06T15:23:44Z"}, {"text": "Milan, this hang is most likely the cause of all the crash issues we get for Marionette unit tests on MacOS. If we cannot fix it, those useful tests will be disabled soon. This would be kinda sad to see, because those offered us a couple of other Firefox misbehavior in the past. I don't know how difficult and complex it would be to get fixed, but maybe you can give some feedback in regards the latest finding?\n\nMaybe some hints in how to get this fixed would be welcome too, so that someone could contribute to it?", "author": "hskupin@gmail.com", "id": 12740771, "time": "2017-10-09T11:39:10Z"}, {"text": "David, who do you think would be a good person to answer the questions about \"low level\" issues mentioned in comment 29?  So that we can keep this going.", "author": "milaninbugzilla@gmail.com", "id": 12744967, "time": "2017-10-10T14:51:29Z"}, {"text": "this has 251 failures associated with it in the last week (assuming the 4 bugs that depend on this have 100% failures being the same root cause).\n\n:milan, :dvander doesn't seem to be responding- can you help find someone else to look into this?", "author": "jmaher@mozilla.com", "id": 12769649, "time": "2017-10-18T13:09:36Z"}, {"text": "Yeah, we're stuck with some higher priority 57 issues, this one will have to wait for some bandwidth.  I understand it's tracked for 57, but it is a theoretical crash based on the testing.  In the meantime, maybe Bill can answer some of the questions on how to keep this going.", "author": "milaninbugzilla@gmail.com", "id": 12769665, "time": "2017-10-18T13:14:36Z"}, {"text": "I don't really have time to look at this, but it would help if someone could answer David's question in comment 29:\n\"Does commenting out the message at [1] fix the problem, or do we just hang somewhere else instead?\"\n\nIf commenting out that line makes the hangs go away, then we know what to do. Otherwise, this will take a lot of time to track down and understand.\n\n[1] http://searchfox.org/mozilla-central/rev/05c4c3bc0cfb9b0fc66bdfc8c47cac674e45f151/gfx/layers/ipc/CompositorBridgeChild.cpp#557", "author": "bill.mccloskey@gmail.com", "id": 12783934, "time": "2017-10-23T22:49:13Z"}, {"text": "I pushed to try for marionette on osx and got some of the other failures that are \"dependent\" upon this bug:\nhttps://treeherder.mozilla.org/#/jobs?repo=try&revision=8878da4a67da740afa89ce8998ebfc351df57f26\n\nI am not sure where this crash is at, I see assertions in failures looking back for a few days on trunk branches, not crashes.  Maybe I need to look deeper in the logs.\n\nIn summary, I don't know what the real problem is here or how to see it, so I am not sure if my try push using the hack suggested in comment 40 fixed it or not.", "author": "jmaher@mozilla.com", "id": 12793564, "time": "2017-10-26T19:06:06Z"}, {"text": "The patch attached or not doesn't make a difference to me for hangs during shutdown I see locally. In my case the parent process is gone, but the content process is still around and doesn't close. Looks like those days the underlying issue for the Marionette unit test is more related to bug 1404190. \n\nGiven that we have seen a hang like this also outside of Marionette the bug should still be valid.", "author": "hskupin@gmail.com", "id": 12947011, "time": "2018-01-05T12:48:23Z"}, {"text": "I actually just seem to have hit this bug with the crash test. Sampling the process showed me:\n\n>    +                                                     2511 mozilla::gfx::Log<1, mozilla::gfx::CriticalLogger>::Flush()  (in XUL) + 168  [0x108bdd9e8]\n>    +                                                       2511 mozilla::gfx::CriticalLogger::OutputMessage(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool)  (in XUL) + 48  [0x108be2ea0]\n>    +                                                         2511 CrashStatsLogForwarder::Log(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&)  (in XUL) + 164  [0x108e46b04]\n>    +                                                           2511 mozilla::dom::PContentChild::SendGraphicsError(nsTString<char> const&)  (in XUL) + 107  [0x1088f5c8b]\n\nIt could just be a single case happening once in a while beside the problem on bug 1404190.\n\nOr well, the content process here is trying to send a graphics error to the parent, right? But what happens when the parent is no longer around, as it happened in this case? Does the content process wait forever for a reply or confirmation?", "author": "hskupin@gmail.com", "id": 12947046, "time": "2018-01-05T13:10:46Z"}, {"text": "Created attachment 8940318\nactivity monitor sample (without gfx critical notice)\n\nAs I was informed by Andrew McCreight bug 1404190 only covers debug and ASan builds, but not opt builds. So it would clearly be a different issue.\n\nThat said I continued to run tests and made a lot of samples. In all the cases so far always the same stack is visible for the content process. It can be seen in this new attachment. Here an excerpt:\n\n    +                                           8045 mozilla::detail::RunnableMethodImpl<mozilla::ipc::MessageChannel*, void (mozilla::ipc::MessageChannel::*)(), false, (mozilla::RunnableKind)1>::Run()  (in XUL) + 44  [0x10588dccc]\n    +                                             8045 mozilla::ipc::PBackgroundChild::OnChannelError()  (in XUL) + 27  [0x1059de48b]\n    +                                               8045 mozilla::ipc::PBackgroundChild::DeallocSubtree()  (in XUL) + 1892  [0x1059dd774]\n    +                                                 8045 mozilla::dom::DeallocClientManagerChild(mozilla::dom::PClientManagerChild*)  (in XUL) + 18  [0x106bec752]\n    +                                                   8045 arena_dalloc(void*, unsigned long, arena_t*)  (in libmozglue.dylib) + 117  [0x102243045]\n    +                                                     8045 arena_t::DallocSmall(arena_chunk_t*, void*, arena_chunk_map_t*)  (in \n\nMaybe Jim also has an idea what could go on here.", "author": "hskupin@gmail.com", "id": 12948101, "time": "2018-01-05T20:13:35Z"}, {"text": "Btw the tests in the last comment have all been done with a build which has the line commented out:\n\nhttp://searchfox.org/mozilla-central/rev/05c4c3bc0cfb9b0fc66bdfc8c47cac674e45f151/gfx/layers/ipc/CompositorBridgeChild.cpp#557", "author": "hskupin@gmail.com", "id": 12948113, "time": "2018-01-05T20:14:50Z"}, {"text": "(In reply to Henrik Skupin (:whimboo) from comment #12)\n> Sorry, the last mentioned pushlog was not correct. I was able now to\n> reproduce with a build from April 15th, which I originally used. So please\n> give me some more time to run those tests.\n\nThis comment may have been wrong given that this might actually be a crash...\n\n(In reply to Peter Chang[:pchang] from comment #11)\n> > https://hg.mozilla.org/mozilla-central/\n> > pushloghtml?fromchange=ce69b6e1773e9e0d0a190ce899f34b1658e66ca4&tochange=a374\n> > c35469935a874fefe64d3e07003fc5bc8884\n> \n> From the push log, I only saw the following bug was related to gfx IPC.\n> Could you try to reproduce with/without the follwoing patch? \n> \n> 1574c02ea13f\tvincentliu \u2014 Bug 1350330 - Make sure IPC channel still Open\n> before sending IPC message. r=dvander\n\n... which this patch fixed. At least the description of the bug makes sense to the situation which we have here. The parent process crashes, and the content process wants to send an IPC message to the parent, which no longer exists. I'm not that sure if backing out this patch would be that helpful.\n\nIt would be great to get some feedback in how to proceed.", "author": "hskupin@gmail.com", "id": 12949019, "time": "2018-01-06T12:18:08Z"}, {"text": "Asking Haik to take a look when he has free cycles.", "author": "jmathies@mozilla.com", "id": 12980071, "time": "2018-01-18T19:28:50Z"}, {"text": "Since yesterday all the crashes we have seen in test_crash.py on MacOS for debug builds are gone. Did something important land for IPC since March 7th which could have fixed that?", "author": "hskupin@gmail.com", "id": 13116244, "time": "2018-03-09T08:50:24Z"}, {"text": "So I tried my testcase with the most recent Nightly build of Firefox and I can still reproduce it. By checking the activity monitor sample I feel that this hang is actually something which seem to be relevant for bug 1435343 (RuntimeService::CrashIfHanging) but we never even crash here.\n\nAndrea, would you mind to have a look at the attached activity monitor sample? I would appreciate. Thanks.", "author": "hskupin@gmail.com", "id": 13116309, "time": "2018-03-09T09:38:17Z"}, {"text": "Moving the NI to jimm again.", "author": "amarchesini@mozilla.com", "id": 13116334, "time": "2018-03-09T09:59:06Z"}, {"text": "Created attachment 8957496\nUpdated activity monitor sample\n\nJust in case something has changed in the last 2 months here an updated sample from the activity monitor.", "author": "hskupin@gmail.com", "id": 13116372, "time": "2018-03-09T10:18:42Z"}, {"text": "(In reply to Andrea Marchesini [:baku] from comment #50)\n> Moving the NI to jimm again.\n\nWhat's this ni about please?", "author": "jmathies@mozilla.com", "id": 13116877, "time": "2018-03-09T15:08:59Z"}, {"text": "This is on my radar. I'll assign myself the bug for now. So far I've done some testing and was able to reproduce a hang that looked like the bug, but for the me the test automatically cleaned it up. I tried getting this running in a loop on my secondary machine, but ran into failures I haven't resolved yet. I will try to make some progress on this next week. Sorry for the delay.", "author": "haftandilian@mozilla.com", "id": 13117377, "time": "2018-03-09T17:51:29Z"}, {"text": "Haik, it is good to hear that you were able to reproduce the hang. And yes, the Marionette harness kills the process after a timeout of 120s by default. As best you modify the following line and replace the argument for wait with None:\n\nhttps://dxr.mozilla.org/mozilla-central/rev/55d91695f4bb951c224005155baef054a786c1f7/testing/marionette/client/marionette_driver/marionette.py#807\n\nThen Marionette will wait forever, and you should have enough time to investigate.", "author": "hskupin@gmail.com", "id": 13117608, "time": "2018-03-09T19:24:59Z"}, {"text": "Haik, another 20 days passed by. Could you please have a look at this bug? Please check my last comment 54 in how to prevent Marionette from shutting down the browser.", "author": "hskupin@gmail.com", "id": 13162799, "time": "2018-03-28T10:02:03Z"}, {"text": "I'm using your tip to disable the timeout. I've been trying to reproduce this today. I had to change the testcase to expect a different error message:\n\n  > with self.assertRaisesRegexp(IOError, \"unexpectedly closed\"):\n  < with self.assertRaisesRegexp(IOError, \"crashed\"):\n\nI've been running it for a few hours so far and haven't hit the problem. I've set this to run on my spare system so I can keep the test running.", "author": "haftandilian@mozilla.com", "id": 13165080, "time": "2018-03-28T22:11:40Z"}, {"text": "(In reply to Haik Aftandilian [:haik] from comment #56)\n> I'm using your tip to disable the timeout. I've been trying to reproduce\n> this today. I had to change the testcase to expect a different error message:\n> \n>   > with self.assertRaisesRegexp(IOError, \"unexpectedly closed\"):\n>   < with self.assertRaisesRegexp(IOError, \"crashed\"):\n\nNo, you should not make this change. Having it different means you experience an abnormal behavior and that no minidump files have been created. Please revert that.\n\n> I've been running it for a few hours so far and haven't hit the problem.\n> I've set this to run on my spare system so I can keep the test running.\n\nInteresting. I can clearly reproduce with a build from 03-09 but don't see it either with a build from 03-29. I will try myself later today. Maybe it got fixed by something else. I will let you know.", "author": "hskupin@gmail.com", "id": 13166365, "time": "2018-03-29T12:52:43Z"}, {"text": "The test failure here appears to be a deadlock which is caused by a bug in the Mac breakpad exception handling. The affected content process never exits because the breakpad exception handler running in the process is waiting for a lock held by a thread that is suspended.\n\nIn the test, when a content process is being shutdown, the breakpad ExceptionHandler runs and attempts to uninstall itself. Here's the stack showing ExceptionHandler::UninstallHandler() stuck trying to acquire a memory allocator lock due to an object deletion. It is a bug for ExceptionHandler::UninstallHandler() to be freeing memory when its argument |bool in_exception| is true and in this case it is true. The call old_handler_.reset(), where old_handler_ is a scoped pointer, causes the free.\n\n  thread #5 (breakpad thread)\n    frame #0 libsystem_kernel.dylib`syscall_thread_switch() \n    frame #1 libsystem_platform.dylib`_OSSpinLockLockYield() \n    frame #2 libmozglue.dylib`Mutex::Lock() at Mutex.h:66\n    frame #3 libmozglue.dylib`AutoLock<Mutex>::AutoLock() at Mutex.h:129\n    frame #4 libmozglue.dylib`AutoLock<Mutex>::AutoLock() at Mutex.h:127\n    frame #5 libmozglue.dylib`arena_dalloc() at mozjemalloc.cpp:3498\n    frame #6 libmozglue.dylib`BaseAllocator::free() at mozjemalloc.cpp:4238\n    frame #7 libmozglue.dylib`Allocator<MozJemallocBase>::free() at malloc_decls.h:40\n    frame #8 libmozglue.dylib`Allocator<ReplaceMallocBase>::free() at malloc_decls.h:40\n    frame #9 libmozglue.dylib`::free(void *)() at malloc_decls.h:40\n    frame #10 libmozglue.dylib`zone_free_definite_size() at zone.c:200\n    frame #11 XUL`google_breakpad::scoped_ptr<sigaction>::reset() at scoped_ptr.h:107\n    frame #12 XUL`google_breakpad::ExceptionHandler::UninstallHandler() at exception_handler.cc:697\n    frame #13 XUL`google_breakpad::ExceptionHandler::WaitForMessage() at exception_handler.cc:585\n    frame #14 libsystem_pthread.dylib`_pthread_body() \n    frame #15 libsystem_pthread.dylib`_pthread_start() \n    frame #16 libsystem_pthread.dylib`thread_start()\n    \n  thread #1 (main thread, holding the lock, suspended)\n    frame #0 libmozglue.dylib`arena_run_reg_dalloc() at mozjemalloc.cpp:2298\n    frame #1 libmozglue.dylib`arena_t::DallocSmall() at mozjemalloc.cpp:3418\n    frame #2 libmozglue.dylib`arena_dalloc() at mozjemalloc.cpp:3504\n    frame #3 libmozglue.dylib`BaseAllocator::free() at mozjemalloc.cpp:4238\n    frame #4 libmozglue.dylib`Allocator<MozJemallocBase>::free() at malloc_decls.h:40\n    frame #5 libmozglue.dylib`Allocator<ReplaceMallocBase>::free() at malloc_decls.h:40\n    frame #6 libmozglue.dylib`::free(void *)() at malloc_decls.h:40\n    frame #7 XUL`nsTArrayInfallibleAllocator::Free() at nsTArray.h:215\n    frame #8 XUL`nsTArray_base<nsTArrayInfallibleAllocator, nsTArray_CopyWithMemutils>::~nsTArray_base() at nsTArray-inl.h:22\n    frame #9 XUL`nsTArray_Impl<mozilla::layout::PVsyncChild*, nsTArrayInfallibleAllocator>::~nsTArray_Impl() at nsTArray.h:868\n    frame #10 XUL`nsTArray<mozilla::layout::PVsyncChild*>::~nsTArray() at nsTArray.h:2322\n    frame #11 XUL`nsTArray<mozilla::layout::PVsyncChild*>::~nsTArray() at nsTArray.h:2322\n    frame #12 XUL`mozilla::ipc::PBackgroundChild::DestroySubtree() at PBackgroundChild.cpp:2859\n    frame #13 XUL`mozilla::ipc::PBackgroundChild::OnChannelError() at PBackgroundChild.cpp:2497\n    frame #14 XUL`mozilla::ipc::MessageChannel::NotifyMaybeChannelError() at MessageChannel.cpp:2597\n    frame #15 XUL`mozilla::ipc::MessageChannel::OnNotifyMaybeChannelError() at MessageChannel.cpp:2630\n    \nThe hang happens because another thread is holding the lock needed by the ExceptionHandler thread. The thread holding the lock (and all other threads except the ExceptionHandler thread) doesn't make progress and release the lock because it is suspended.\n\nMost of the time this is hit, the main thread is holding a mozjemalloc arena lock and is executing PBackgroundChild::DestroySubtree(), but this could be caused by any thread holding a lock that is needed by memory freeing code.\n\nAll of the activity monitor samples Henrik posted are instances of this bug, but I never noticed the ExceptionHandler stack.\n\nWithout the fix, I can normally hit the hang after about ~10 iterations of the test case on a MacBook Pro (Retina, 15-inch, Mid 2015). With the fix installed, I've run a the test for 536 iterations without a hang. I'm running more tests on the other machine I have available.\n\nI'll post the fix for the breakpad code and see about upstreaming it. The breakpad issue was introduced back in 2012 with https://github.com/google/breakpad/commit/b1f858f26b136044922eeae0d86488b17b54efff", "author": "haftandilian@mozilla.com", "id": 13199472, "time": "2018-04-11T22:13:42Z"}, {"text": "Created attachment 8967193\nBreakpad patch to avoid deadlock triggered by ExceptionHandler::UninstallHandler() freeing memory", "author": "haftandilian@mozilla.com", "id": 13199482, "time": "2018-04-11T22:18:02Z"}, {"text": "Ted, assuming this fix is correct, would we upstream it or land it in central?", "author": "haftandilian@mozilla.com", "id": 13199502, "time": "2018-04-11T22:33:49Z"}, {"text": "The code under breakpad-client has been forked, so you can land there directly.", "author": "ted@mielczarek.org", "id": 13199670, "time": "2018-04-12T00:14:57Z"}, {"text": "The posted fix intentionally leaks a sigaction struct, which is 16 bytes, but this only occurs when a breakpad exception is being handled and a minidump is being written before shutting down. And ExceptionHandler::UninstallHandler() already leaks some memory in this situation. All other threads have been suspended so it is not safe to run code that could try to acquire a lock. See comment 58 for details.\n\nMore explanation can be found here <https://chromium.googlesource.com/breakpad/breakpad/+/master/docs/client_design.md>:\n\"Library code, including runtime library code, must be avoided unless it provably meets the above guidelines. For example, this means that the STL string class may not be used, because it performs operations that attempt to allocate and use heap memory. It also means that many C runtime functions must be avoided, particularly on Windows, because of heap operations that they may perform.\"", "author": "haftandilian@mozilla.com", "id": 13202598, "time": "2018-04-12T23:28:25Z"}, {"text": "Created attachment 8967597\nBug 1395504 - Infinite hang of web content process when parent process crashes\n\nDon't free memory in exception handling context to avoid deadlocks\nand process state corruption. Replace old_handler_.reset() with\nold_handler_.release() to intentionally leak the sigaction struct instead.\n\nReview commit: https://reviewboard.mozilla.org/r/236294/diff/#index_header\nSee other reviews: https://reviewboard.mozilla.org/r/236294/", "author": "haftandilian@mozilla.com", "id": 13202650, "time": "2018-04-12T23:58:19Z"}, {"text": "Ted, if you find the time for the review I would appreciate given that we still see a lot of crashes for Marionette tests due to that problem. Thanks.", "author": "hskupin@gmail.com", "id": 13225954, "time": "2018-04-23T07:56:23Z"}, {"text": "I can also review this if Ted's busy, just redirect the request to me.", "author": "gsvelto@mozilla.com", "id": 13225960, "time": "2018-04-23T08:06:49Z"}, {"text": "Comment on attachment 8967597\nBug 1395504 - Infinite hang of web content process when parent process crashes\n\nReview request updated; see interdiff: https://reviewboard.mozilla.org/r/236294/diff/1-2/", "author": "haftandilian@mozilla.com", "id": 13226833, "time": "2018-04-23T15:49:31Z"}, {"text": "(In reply to Gabriele Svelto [:gsvelto] from comment #65)\n> I can also review this if Ted's busy, just redirect the request to me.\n\nThanks. I redirected this to Gabriele since Ted has a full review queue.", "author": "haftandilian@mozilla.com", "id": 13226846, "time": "2018-04-23T15:53:34Z"}, {"text": "Apologies. I've been doing better at keeping my review queue down but I was at a work week last week so I didn't keep on top of it (and a fairly large patch series snuck in there as well).", "author": "ted@mielczarek.org", "id": 13226860, "time": "2018-04-23T15:59:48Z"}, {"text": "Comment on attachment 8967597\nBug 1395504 - Infinite hang of web content process when parent process crashes\n\nhttps://reviewboard.mozilla.org/r/236294/#review244780\n\nReally glad you fixed this, it's been plaguing us for months. Did we open an upstream bug too? While this is the part of breakpad we forked it's not a bad idea to play nice with upstream.", "author": "gsvelto@mozilla.com", "id": 13227741, "time": "2018-04-23T20:48:06Z"}, {"text": "Comment on attachment 8967597\nBug 1395504 - Infinite hang of web content process when parent process crashes\n\nhttps://reviewboard.mozilla.org/r/236294/#review244780\n\nThanks. I'll try and get it landed upstream too. I saw some comments indicating it wasn't maintained anymore but I'll try.", "author": "haftandilian@mozilla.com", "id": 13227785, "time": "2018-04-23T21:09:18Z"}, {"text": "IIRC the Windows and Mac parts of Breakpad aren't actively maintained, but they'll accept patches.", "author": "gsvelto@mozilla.com", "id": 13227833, "time": "2018-04-23T21:31:48Z"}, {"text": "Pushed by haftandilian@mozilla.com:\nhttps://hg.mozilla.org/integration/autoland/rev/933eb0b6a922\nInfinite hang of web content process when parent process crashes r=gsvelto", "author": "pulsebot@bots.tld", "id": 13227856, "time": "2018-04-23T21:41:20Z"}, {"text": "https://hg.mozilla.org/mozilla-central/rev/933eb0b6a922", "author": "aciure@mozilla.com", "id": 13228261, "time": "2018-04-24T01:16:57Z"}, {"text": "(In reply to Haik Aftandilian [:haik] from comment #70)\n> Thanks. I'll try and get it landed upstream too. I saw some comments\n> indicating it wasn't maintained anymore but I'll try.\n\nI wouldn't bother, TBH. Chrome is using crashpad for exception handling on macOS.", "author": "ted@mielczarek.org", "id": 13229399, "time": "2018-04-24T12:58:47Z"}], "id": 1395504, "priority": "P1", "cc": ["amarchesini@mozilla.com", "bill.mccloskey@gmail.com", "cervantes.yu@gmail.com", "dburns@mozilla.com", "dvander@alliedmods.net", "ehsan@mozilla.com", "gchang@mozilla.com", "gsvelto@mozilla.com", "gw@gwright.org.uk", "haftandilian@mozilla.com", "howareyou322@gmail.com", "hskupin@gmail.com", "jcristau@mozilla.com", "jmaher@mozilla.com", "mcastelluccio@mozilla.com", "mconley@mozilla.com", "milaninbugzilla@gmail.com", "rkothari@mozilla.com", "ted@mielczarek.org"], "cf_crash_signature": "", "version": "57 Branch", "is_cc_accessible": true, "cf_tracking_firefox_esr52": "---", "see_also": ["https://bugzilla.mozilla.org/show_bug.cgi?id=1457545", "https://bugs.chromium.org/p/google-breakpad/issues/detail?id=763"], "cf_tracking_thunderbird_esr60": "---", "cf_platform_rel": "---", "product": "Core", "cf_fx_iteration": "---", "blocks": [1326124, 1376773, 1377030, 1376795, 1396803], "qa_contact": "", "creation_time": "2017-08-31T09:50:54Z", "cf_status_firefox_esr52": "unaffected", "component": "Graphics", "assigned_to_detail": {"email": "haftandilian@mozilla.com", "id": 558190, "name": "haftandilian@mozilla.com", "real_name": "Haik Aftandilian [:haik]"}, "cf_tracking_firefox_esr60": "---", "cf_status_firefox62": "---", "cf_status_firefox61": "fixed", "cf_status_firefox60": "wontfix", "target_milestone": "mozilla61", "cf_rank": null, "cf_qa_whiteboard": "", "severity": "critical", "groups": [], "cf_status_thunderbird_esr52": "---", "url": "", "cf_status_thunderbird_esr60": "---", "creator_detail": {"email": "hskupin@gmail.com", "id": 76551, "name": "hskupin@gmail.com", "real_name": "Henrik Skupin (:whimboo)"}, "whiteboard": "gfx-noted", "mentors": [], "cc_detail": [{"email": "amarchesini@mozilla.com", "id": 446257, "name": "amarchesini@mozilla.com", "real_name": "Andrea Marchesini [:baku]"}, {"email": "bill.mccloskey@gmail.com", "id": 389993, "name": "bill.mccloskey@gmail.com", "real_name": "Bill McCloskey [inactive unless it's an emergency] (:billm)"}, {"email": "cervantes.yu@gmail.com", "id": 434958, "name": "cervantes.yu@gmail.com", "real_name": "Cervantes Yu [:cyu] [:cervantes]"}, {"email": "dburns@mozilla.com", "id": 397261, "name": "dburns@mozilla.com", "real_name": "David Burns :automatedtester"}, {"email": "dvander@alliedmods.net", "id": 309316, "name": "dvander@alliedmods.net", "real_name": "David Anderson [:dvander] - inactive, e-mail if emergency"}, {"email": "ehsan@mozilla.com", "id": 251051, "name": "ehsan@mozilla.com", "real_name": ":Ehsan Akhgari"}, {"email": "gchang@mozilla.com", "id": 506302, "name": "gchang@mozilla.com", "real_name": "Gerry Chang [:gchang]"}, {"email": "gsvelto@mozilla.com", "id": 448747, "name": "gsvelto@mozilla.com", "real_name": "Gabriele Svelto [:gsvelto]"}, {"email": "gw@gwright.org.uk", "id": 432425, "name": "gw@gwright.org.uk", "real_name": "George Wright (:gw280) (needinfo me!)"}, {"email": "haftandilian@mozilla.com", "id": 558190, "name": "haftandilian@mozilla.com", "real_name": "Haik Aftandilian [:haik]"}, {"email": "howareyou322@gmail.com", "id": 452554, "name": "howareyou322@gmail.com", "real_name": "Peter Chang[:pchang]"}, {"email": "hskupin@gmail.com", "id": 76551, "name": "hskupin@gmail.com", "real_name": "Henrik Skupin (:whimboo)"}, {"email": "jcristau@mozilla.com", "id": 580382, "name": "jcristau@mozilla.com", "real_name": "Julien Cristau [:jcristau]"}, {"email": "jmaher@mozilla.com", "id": 324370, "name": "jmaher@mozilla.com", "real_name": "Joel Maher ( :jmaher ) (UTC-4)"}, {"email": "mcastelluccio@mozilla.com", "id": 420453, "name": "mcastelluccio@mozilla.com", "real_name": "Marco Castelluccio [:marco]"}, {"email": "mconley@mozilla.com", "id": 403756, "name": "mconley@mozilla.com", "real_name": "Mike Conley (:mconley) (:\u2699\ufe0f) (Catching up on needinfos / reviews)"}, {"email": "milaninbugzilla@gmail.com", "id": 456486, "name": "milaninbugzilla@gmail.com", "real_name": "Milan Sreckovic [:milan] (needinfo for best results)"}, {"email": "rkothari@mozilla.com", "id": 538805, "name": "rkothari@mozilla.com", "real_name": "Ritu Kothari (:ritu)"}, {"email": "ted@mielczarek.org", "id": 39022, "name": "ted@mielczarek.org", "real_name": "Ted Mielczarek [:ted.mielczarek]"}], "cf_has_str": "---", "alias": null, "dupe_of": null, "flags": [], "last_change_time": "2018-05-01T21:34:28Z", "assigned_to": "haftandilian@mozilla.com", "is_open": false, "history": [{"changes": [{"removed": "", "field_name": "blocks", "added": "1376795"}], "who": "hskupin@gmail.com", "when": "2017-08-31T12:42:43Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "hskupin@gmail.com"}, {"removed": "IPC", "field_name": "component", "added": "Graphics"}, {"removed": "Infinite hang of web content process when Firefox crashes [@ CrashStatsLogForwarder::Log() | mozilla::dom::PContentChild::SendGraphicsError()]", "field_name": "summary", "added": "Infinite hang of web content process when parent process crashes [@ CrashStatsLogForwarder::Log() | mozilla::dom::PContentChild::SendGraphicsError()]"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(cyu@mozilla.com)"}], "who": "hskupin@gmail.com", "when": "2017-08-31T12:46:37Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(milan@mozilla.com)"}], "who": "hskupin@gmail.com", "when": "2017-08-31T12:47:16Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "gw@gwright.org.uk"}, {"removed": "needinfo?(cyu@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(gw@gwright.org.uk)"}], "who": "hskupin@gmail.com", "when": "2017-08-31T12:56:21Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "dvander@alliedmods.net"}, {"removed": "needinfo?(milan@mozilla.com), needinfo?(gw@gwright.org.uk)", "field_name": "flagtypes.name", "added": "needinfo?(dvander@alliedmods.net)"}], "who": "milaninbugzilla@gmail.com", "when": "2017-08-31T17:45:06Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jmaher@mozilla.com"}, {"removed": "", "field_name": "blocks", "added": "1377030, 1376773, 1326124"}], "who": "hskupin@gmail.com", "when": "2017-09-05T21:24:32Z"}, {"changes": [{"removed": "---", "field_name": "cf_tracking_firefox56", "added": "?"}, {"removed": "?", "field_name": "cf_status_firefox56", "added": "affected"}], "who": "hskupin@gmail.com", "when": "2017-09-06T15:29:33Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1396803"}], "who": "hskupin@gmail.com", "when": "2017-09-07T06:17:53Z"}, {"changes": [{"field_name": "attachments.description", "removed": "activity monitor sample", "attachment_id": 8903086, "added": "activity monitor sample (mozilla::layers::PCompositorManagerChild::OnChannelError())"}], "who": "hskupin@gmail.com", "when": "2017-09-07T07:59:47Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "wmccloskey@mozilla.com"}], "who": "hskupin@gmail.com", "when": "2017-09-07T19:46:26Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "howareyou322@gmail.com"}], "who": "howareyou322@gmail.com", "when": "2017-09-08T07:13:11Z"}, {"changes": [{"removed": "---", "field_name": "cf_status_firefox55", "added": "wontfix"}, {"removed": "?", "field_name": "cf_tracking_firefox56", "added": "+"}, {"removed": "?", "field_name": "cf_tracking_firefox57", "added": "+"}], "who": "lhenry@mozilla.com", "when": "2017-09-08T18:30:38Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "gfritzsche@mozilla.com, mconley@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(ted@mielczarek.org), needinfo?(mconley@mozilla.com), needinfo?(gfritzsche@mozilla.com)"}], "who": "hskupin@gmail.com", "when": "2017-09-11T17:54:32Z"}, {"changes": [{"removed": "needinfo?(ted@mielczarek.org)", "field_name": "flagtypes.name", "added": ""}], "who": "ted@mielczarek.org", "when": "2017-09-11T18:48:18Z"}, {"changes": [{"removed": "needinfo?(mconley@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "mconley@mozilla.com", "when": "2017-09-11T18:52:54Z"}, {"changes": [{"removed": "", "field_name": "whiteboard", "added": "gfx-noted"}], "who": "howareyou322@gmail.com", "when": "2017-09-12T02:16:03Z"}, {"changes": [{"removed": "needinfo?(gfritzsche@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "gfritzsche@mozilla.com", "when": "2017-09-12T11:31:14Z"}, {"changes": [{"removed": "--", "field_name": "priority", "added": "P3"}, {"removed": "needinfo?(dvander@alliedmods.net)", "field_name": "flagtypes.name", "added": "needinfo?(hskupin@gmail.com)"}], "who": "milaninbugzilla@gmail.com", "when": "2017-09-14T21:02:30Z"}, {"changes": [{"removed": "needinfo?(hskupin@gmail.com)", "field_name": "flagtypes.name", "added": "needinfo?(milan@mozilla.com)"}], "who": "hskupin@gmail.com", "when": "2017-09-15T05:51:28Z"}, {"changes": [{"removed": "needinfo?(milan@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "milaninbugzilla@gmail.com", "when": "2017-09-15T16:22:50Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "gchang@mozilla.com"}, {"removed": "affected", "field_name": "cf_status_firefox56", "added": "wontfix"}], "who": "gchang@mozilla.com", "when": "2017-09-18T02:42:34Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(dvander@alliedmods.net)"}, {"removed": "---", "field_name": "cf_tracking_firefox58", "added": "?"}, {"removed": "---", "field_name": "cf_status_firefox58", "added": "affected"}], "who": "hskupin@gmail.com", "when": "2017-09-25T07:26:14Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "rkothari@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(milan@mozilla.com)"}], "who": "rkothari@mozilla.com", "when": "2017-09-28T23:27:59Z"}, {"changes": [{"removed": "needinfo?(milan@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "milaninbugzilla@gmail.com", "when": "2017-09-29T18:42:45Z"}, {"changes": [{"removed": "+", "field_name": "cf_tracking_firefox57", "added": "?"}], "who": "milaninbugzilla@gmail.com", "when": "2017-09-29T18:59:24Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "jcristau@mozilla.com"}, {"removed": "?", "field_name": "cf_tracking_firefox57", "added": "-"}, {"removed": "affected", "field_name": "cf_status_firefox57", "added": "fix-optional"}, {"removed": "?", "field_name": "cf_tracking_firefox58", "added": "+"}], "who": "jcristau@mozilla.com", "when": "2017-10-06T15:23:44Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(milan@mozilla.com)"}], "who": "hskupin@gmail.com", "when": "2017-10-09T11:39:10Z"}, {"changes": [{"removed": "needinfo?(dvander@alliedmods.net)", "field_name": "flagtypes.name", "added": ""}], "who": "milaninbugzilla@gmail.com", "when": "2017-10-10T14:50:32Z"}, {"changes": [{"removed": "needinfo?(milan@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(dvander@alliedmods.net)"}], "who": "milaninbugzilla@gmail.com", "when": "2017-10-10T14:51:29Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(milan@mozilla.com)"}], "who": "jmaher@mozilla.com", "when": "2017-10-18T13:09:36Z"}, {"changes": [{"removed": "needinfo?(dvander@alliedmods.net), needinfo?(milan@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(wmccloskey@mozilla.com)"}], "who": "milaninbugzilla@gmail.com", "when": "2017-10-18T13:14:36Z"}, {"changes": [{"removed": "needinfo?(wmccloskey@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "bill.mccloskey@gmail.com", "when": "2017-10-23T22:49:13Z"}, {"changes": [{"removed": "gfritzsche@mozilla.com", "field_name": "cc", "added": ""}], "who": "gfritzsche@mozilla.com", "when": "2017-12-18T19:23:17Z"}, {"changes": [{"removed": "1376773", "field_name": "blocks", "added": ""}], "who": "hskupin@gmail.com", "when": "2018-01-05T12:50:24Z"}, {"changes": [{"removed": "", "field_name": "blocks", "added": "1376773"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(wmccloskey@mozilla.com), needinfo?(dvander@alliedmods.net)"}], "who": "hskupin@gmail.com", "when": "2018-01-05T13:10:46Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8905402, "added": "1"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(jmathies@mozilla.com)"}], "who": "hskupin@gmail.com", "when": "2018-01-05T20:13:35Z"}, {"changes": [{"removed": "needinfo?(bill.mccloskey@gmail.com)", "field_name": "flagtypes.name", "added": ""}], "who": "bill.mccloskey@gmail.com", "when": "2018-01-05T22:06:48Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "haftandilian@mozilla.com"}, {"removed": "needinfo?(dvander@alliedmods.net), needinfo?(jmathies@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(haftandilian@mozilla.com)"}], "who": "jmathies@mozilla.com", "when": "2018-01-18T19:28:50Z"}, {"changes": [{"removed": "fix-optional", "field_name": "cf_status_firefox57", "added": "wontfix"}, {"removed": "affected", "field_name": "cf_status_firefox58", "added": "wontfix"}], "who": "jcristau@mozilla.com", "when": "2018-02-19T16:51:18Z"}, {"changes": [{"removed": "", "field_name": "cc", "added": "amarchesini@mozilla.com"}, {"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(amarchesini@mozilla.com)"}], "who": "hskupin@gmail.com", "when": "2018-03-09T09:38:17Z"}, {"changes": [{"removed": "needinfo?(amarchesini@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(jmathies@mozilla.com)"}], "who": "amarchesini@mozilla.com", "when": "2018-03-09T09:59:06Z"}, {"changes": [{"removed": "needinfo?(jmathies@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "jmathies@mozilla.com", "when": "2018-03-09T15:08:59Z"}, {"changes": [{"removed": "needinfo?(haftandilian@mozilla.com)", "field_name": "flagtypes.name", "added": "needinfo?(jmathies@mozilla.com)"}], "who": "jmathies@mozilla.com", "when": "2018-03-09T15:09:17Z"}, {"changes": [{"removed": "nobody@mozilla.org", "field_name": "assigned_to", "added": "haftandilian@mozilla.com"}, {"removed": "needinfo?(jmathies@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "haftandilian@mozilla.com", "when": "2018-03-09T17:51:29Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(haftandilian@mozilla.com)"}], "who": "hskupin@gmail.com", "when": "2018-03-28T10:02:03Z"}, {"changes": [{"removed": "needinfo?(haftandilian@mozilla.com)", "field_name": "flagtypes.name", "added": ""}], "who": "haftandilian@mozilla.com", "when": "2018-03-28T22:11:40Z"}, {"changes": [{"removed": "P3", "field_name": "priority", "added": "P1"}], "who": "haftandilian@mozilla.com", "when": "2018-04-11T22:13:42Z"}, {"changes": [{"field_name": "attachments.description", "removed": "Breakpad patch to avoid triggered by ExceptionHandler::UninstallHandler() freeing memory", "attachment_id": 8967193, "added": "Breakpad patch to avoid deadlock triggered by ExceptionHandler::UninstallHandler() freeing memory"}], "who": "haftandilian@mozilla.com", "when": "2018-04-11T22:18:29Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(ted@mielczarek.org)"}], "who": "haftandilian@mozilla.com", "when": "2018-04-11T22:33:49Z"}, {"changes": [{"removed": "needinfo?(ted@mielczarek.org)", "field_name": "flagtypes.name", "added": ""}], "who": "ted@mielczarek.org", "when": "2018-04-12T00:14:57Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "", "attachment_id": 8967597, "added": "review?(ted@mielczarek.org)"}], "who": "haftandilian@mozilla.com", "when": "2018-04-12T23:58:19Z"}, {"changes": [{"field_name": "attachments.isobsolete", "removed": "0", "attachment_id": 8967193, "added": "1"}], "who": "haftandilian@mozilla.com", "when": "2018-04-12T23:58:48Z"}, {"changes": [{"removed": "", "field_name": "depends_on", "added": "1041474"}], "who": "jmathies@mozilla.com", "when": "2018-04-16T18:15:52Z"}, {"changes": [{"removed": "", "field_name": "flagtypes.name", "added": "needinfo?(ted@mielczarek.org)"}], "who": "hskupin@gmail.com", "when": "2018-04-23T07:56:23Z"}, {"changes": [{"field_name": "attachments.description", "removed": "Bug 1395504 - Infinite hang of web content process when parent process crashes .mielczarek", "attachment_id": 8967597, "added": "Bug 1395504 - Infinite hang of web content process when parent process crashes"}, {"field_name": "flagtypes.name", "removed": "review?(ted@mielczarek.org)", "attachment_id": 8967597, "added": "review?(gsvelto@mozilla.com)"}], "who": "haftandilian@mozilla.com", "when": "2018-04-23T15:49:31Z"}, {"changes": [{"removed": "needinfo?(ted@mielczarek.org)", "field_name": "flagtypes.name", "added": ""}], "who": "ted@mielczarek.org", "when": "2018-04-23T15:59:48Z"}, {"changes": [{"field_name": "flagtypes.name", "removed": "review?(gsvelto@mozilla.com)", "attachment_id": 8967597, "added": "review+"}], "who": "gsvelto@mozilla.com", "when": "2018-04-23T20:48:06Z"}, {"changes": [{"removed": "NEW", "field_name": "status", "added": "RESOLVED"}, {"removed": "", "field_name": "resolution", "added": "FIXED"}, {"removed": "---", "field_name": "target_milestone", "added": "mozilla61"}, {"removed": "", "field_name": "cf_last_resolved", "added": "2018-04-24 01:16:57"}, {"removed": "---", "field_name": "cf_status_firefox61", "added": "fixed"}], "who": "aciure@mozilla.com", "when": "2018-04-24T01:16:57Z"}, {"changes": [{"removed": "", "field_name": "keywords", "added": "regression"}, {"removed": "", "field_name": "cc", "added": "mcastelluccio@mozilla.com"}], "who": "mcastelluccio@mozilla.com", "when": "2018-04-25T23:28:15Z"}, {"changes": [{"removed": "---", "field_name": "cf_status_firefox_esr52", "added": "unaffected"}, {"removed": "---", "field_name": "cf_status_firefox_esr60", "added": "wontfix"}, {"removed": "---", "field_name": "cf_status_firefox59", "added": "wontfix"}, {"removed": "---", "field_name": "cf_status_firefox60", "added": "wontfix"}], "who": "ryanvm@gmail.com", "when": "2018-04-26T13:06:01Z"}, {"changes": [{"removed": "", "field_name": "see_also", "added": "https://bugzilla.mozilla.org/show_bug.cgi?id=1457545"}], "who": "haftandilian@mozilla.com", "when": "2018-04-27T20:09:12Z"}, {"changes": [{"removed": "", "field_name": "see_also", "added": "https://bugs.chromium.org/p/google-breakpad/issues/detail?id=763"}], "who": "haftandilian@mozilla.com", "when": "2018-05-01T21:34:28Z"}], "resolution": "FIXED", "op_sys": "Unspecified", "cf_fx_points": "---", "cf_blocking_fennec": "---"}